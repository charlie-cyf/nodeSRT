{"type":"Program","start":0,"end":12957,"body":[{"type":"VariableDeclaration","start":0,"end":25,"declarations":[{"type":"VariableDeclarator","start":6,"end":24,"id":{"type":"Identifier","start":6,"end":8,"name":"fs"},"init":{"type":"CallExpression","start":11,"end":24,"callee":{"type":"Identifier","start":11,"end":18,"name":"require"},"arguments":[{"type":"Literal","start":19,"end":23,"value":"fs","raw":"'fs'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":26,"end":61,"declarations":[{"type":"VariableDeclarator","start":32,"end":60,"id":{"type":"Identifier","start":32,"end":39,"name":"express"},"init":{"type":"CallExpression","start":42,"end":60,"callee":{"type":"Identifier","start":42,"end":49,"name":"require"},"arguments":[{"type":"Literal","start":50,"end":59,"value":"express","raw":"'express'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":76,"end":117,"declarations":[{"type":"VariableDeclarator","start":82,"end":116,"id":{"type":"Identifier","start":82,"end":87,"name":"Grant"},"init":{"type":"CallExpression","start":90,"end":116,"callee":{"type":"MemberExpression","start":90,"end":114,"object":{"type":"CallExpression","start":90,"end":106,"callee":{"type":"Identifier","start":90,"end":97,"name":"require"},"arguments":[{"type":"Literal","start":98,"end":105,"value":"grant","raw":"'grant'"}]},"property":{"type":"Identifier","start":107,"end":114,"name":"express"},"computed":false},"arguments":[]}}],"kind":"const"},{"type":"VariableDeclaration","start":118,"end":166,"declarations":[{"type":"VariableDeclarator","start":124,"end":165,"id":{"type":"Identifier","start":124,"end":135,"name":"grantConfig"},"init":{"type":"CallExpression","start":138,"end":165,"callee":{"type":"CallExpression","start":138,"end":163,"callee":{"type":"Identifier","start":138,"end":145,"name":"require"},"arguments":[{"type":"Literal","start":146,"end":162,"value":"./config/grant","raw":"'./config/grant'"}]},"arguments":[]}}],"kind":"const"},{"type":"VariableDeclaration","start":167,"end":220,"declarations":[{"type":"VariableDeclarator","start":173,"end":219,"id":{"type":"Identifier","start":173,"end":188,"name":"providerManager"},"init":{"type":"CallExpression","start":191,"end":219,"callee":{"type":"Identifier","start":191,"end":198,"name":"require"},"arguments":[{"type":"Literal","start":199,"end":218,"value":"./server/provider","raw":"'./server/provider'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":221,"end":273,"declarations":[{"type":"VariableDeclarator","start":227,"end":272,"id":{"type":"Identifier","start":227,"end":238,"name":"controllers"},"init":{"type":"CallExpression","start":241,"end":272,"callee":{"type":"Identifier","start":241,"end":248,"name":"require"},"arguments":[{"type":"Literal","start":249,"end":271,"value":"./server/controllers","raw":"'./server/controllers'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":274,"end":320,"declarations":[{"type":"VariableDeclarator","start":280,"end":319,"id":{"type":"Identifier","start":280,"end":282,"name":"s3"},"init":{"type":"CallExpression","start":285,"end":319,"callee":{"type":"Identifier","start":285,"end":292,"name":"require"},"arguments":[{"type":"Literal","start":293,"end":318,"value":"./server/controllers/s3","raw":"'./server/controllers/s3'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":321,"end":369,"declarations":[{"type":"VariableDeclarator","start":327,"end":368,"id":{"type":"Identifier","start":327,"end":330,"name":"url"},"init":{"type":"CallExpression","start":333,"end":368,"callee":{"type":"Identifier","start":333,"end":340,"name":"require"},"arguments":[{"type":"Literal","start":341,"end":367,"value":"./server/controllers/url","raw":"'./server/controllers/url'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":370,"end":412,"declarations":[{"type":"VariableDeclarator","start":376,"end":411,"id":{"type":"Identifier","start":376,"end":388,"name":"SocketServer"},"init":{"type":"MemberExpression","start":391,"end":411,"object":{"type":"CallExpression","start":391,"end":404,"callee":{"type":"Identifier","start":391,"end":398,"name":"require"},"arguments":[{"type":"Literal","start":399,"end":403,"value":"ws","raw":"'ws'"}]},"property":{"type":"Identifier","start":405,"end":411,"name":"Server"},"computed":false}}],"kind":"const"},{"type":"VariableDeclaration","start":413,"end":457,"declarations":[{"type":"VariableDeclarator","start":419,"end":456,"id":{"type":"Identifier","start":419,"end":426,"name":"emitter"},"init":{"type":"CallExpression","start":429,"end":456,"callee":{"type":"Identifier","start":429,"end":436,"name":"require"},"arguments":[{"type":"Literal","start":437,"end":455,"value":"./server/emitter","raw":"'./server/emitter'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":458,"end":496,"declarations":[{"type":"VariableDeclarator","start":464,"end":495,"id":{"type":"Identifier","start":464,"end":469,"name":"merge"},"init":{"type":"CallExpression","start":472,"end":495,"callee":{"type":"Identifier","start":472,"end":479,"name":"require"},"arguments":[{"type":"Literal","start":480,"end":494,"value":"lodash.merge","raw":"'lodash.merge'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":497,"end":537,"declarations":[{"type":"VariableDeclarator","start":503,"end":536,"id":{"type":"Identifier","start":503,"end":508,"name":"redis"},"init":{"type":"CallExpression","start":511,"end":536,"callee":{"type":"Identifier","start":511,"end":518,"name":"require"},"arguments":[{"type":"Literal","start":519,"end":535,"value":"./server/redis","raw":"'./server/redis'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":538,"end":584,"declarations":[{"type":"VariableDeclarator","start":544,"end":583,"id":{"type":"Identifier","start":544,"end":556,"name":"cookieParser"},"init":{"type":"CallExpression","start":559,"end":583,"callee":{"type":"Identifier","start":559,"end":566,"name":"require"},"arguments":[{"type":"Literal","start":567,"end":582,"value":"cookie-parser","raw":"'cookie-parser'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":585,"end":660,"declarations":[{"type":"VariableDeclarator","start":591,"end":659,"id":{"type":"ObjectPattern","start":591,"end":623,"properties":[{"type":"Property","start":593,"end":606,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":593,"end":606,"name":"jsonStringify"},"kind":"init","value":{"type":"Identifier","start":593,"end":606,"name":"jsonStringify"}},{"type":"Property","start":608,"end":621,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":608,"end":621,"name":"getURLBuilder"},"kind":"init","value":{"type":"Identifier","start":608,"end":621,"name":"getURLBuilder"}}]},"init":{"type":"CallExpression","start":626,"end":659,"callee":{"type":"Identifier","start":626,"end":633,"name":"require"},"arguments":[{"type":"Literal","start":634,"end":658,"value":"./server/helpers/utils","raw":"'./server/helpers/utils'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":661,"end":699,"declarations":[{"type":"VariableDeclarator","start":667,"end":698,"id":{"type":"Identifier","start":667,"end":671,"name":"jobs"},"init":{"type":"CallExpression","start":674,"end":698,"callee":{"type":"Identifier","start":674,"end":681,"name":"require"},"arguments":[{"type":"Literal","start":682,"end":697,"value":"./server/jobs","raw":"'./server/jobs'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":700,"end":751,"declarations":[{"type":"VariableDeclarator","start":706,"end":750,"id":{"type":"Identifier","start":706,"end":717,"name":"interceptor"},"init":{"type":"CallExpression","start":720,"end":750,"callee":{"type":"Identifier","start":720,"end":727,"name":"require"},"arguments":[{"type":"Literal","start":728,"end":749,"value":"express-interceptor","raw":"'express-interceptor'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":752,"end":794,"declarations":[{"type":"VariableDeclarator","start":758,"end":793,"id":{"type":"Identifier","start":758,"end":764,"name":"logger"},"init":{"type":"CallExpression","start":767,"end":793,"callee":{"type":"Identifier","start":767,"end":774,"name":"require"},"arguments":[{"type":"Literal","start":775,"end":792,"value":"./server/logger","raw":"'./server/logger'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":795,"end":851,"declarations":[{"type":"VariableDeclarator","start":801,"end":850,"id":{"type":"ObjectPattern","start":801,"end":819,"properties":[{"type":"Property","start":803,"end":817,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":803,"end":817,"name":"STORAGE_PREFIX"},"kind":"init","value":{"type":"Identifier","start":803,"end":817,"name":"STORAGE_PREFIX"}}]},"init":{"type":"CallExpression","start":822,"end":850,"callee":{"type":"Identifier","start":822,"end":829,"name":"require"},"arguments":[{"type":"Literal","start":830,"end":849,"value":"./server/Uploader","raw":"'./server/Uploader'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":852,"end":904,"declarations":[{"type":"VariableDeclarator","start":858,"end":903,"id":{"type":"Identifier","start":858,"end":869,"name":"middlewares"},"init":{"type":"CallExpression","start":872,"end":903,"callee":{"type":"Identifier","start":872,"end":879,"name":"require"},"arguments":[{"type":"Literal","start":880,"end":902,"value":"./server/middlewares","raw":"'./server/middlewares'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":905,"end":959,"declarations":[{"type":"VariableDeclarator","start":911,"end":958,"id":{"type":"ObjectPattern","start":911,"end":927,"properties":[{"type":"Property","start":913,"end":925,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":913,"end":925,"name":"shortenToken"},"kind":"init","value":{"type":"Identifier","start":913,"end":925,"name":"shortenToken"}}]},"init":{"type":"CallExpression","start":930,"end":958,"callee":{"type":"Identifier","start":930,"end":937,"name":"require"},"arguments":[{"type":"Literal","start":938,"end":957,"value":"./server/Uploader","raw":"'./server/Uploader'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":960,"end":1043,"declarations":[{"type":"VariableDeclarator","start":966,"end":1042,"id":{"type":"ObjectPattern","start":966,"end":1005,"properties":[{"type":"Property","start":968,"end":984,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":968,"end":984,"name":"ProviderApiError"},"kind":"init","value":{"type":"Identifier","start":968,"end":984,"name":"ProviderApiError"}},{"type":"Property","start":986,"end":1003,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":986,"end":1003,"name":"ProviderAuthError"},"kind":"init","value":{"type":"Identifier","start":986,"end":1003,"name":"ProviderAuthError"}}]},"init":{"type":"CallExpression","start":1008,"end":1042,"callee":{"type":"Identifier","start":1008,"end":1015,"name":"require"},"arguments":[{"type":"Literal","start":1016,"end":1041,"value":"./server/provider/error","raw":"'./server/provider/error'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":1044,"end":1069,"declarations":[{"type":"VariableDeclarator","start":1050,"end":1068,"id":{"type":"Identifier","start":1050,"end":1052,"name":"ms"},"init":{"type":"CallExpression","start":1055,"end":1068,"callee":{"type":"Identifier","start":1055,"end":1062,"name":"require"},"arguments":[{"type":"Literal","start":1063,"end":1067,"value":"ms","raw":"'ms'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":1070,"end":1492,"declarations":[{"type":"VariableDeclarator","start":1076,"end":1491,"id":{"type":"Identifier","start":1076,"end":1090,"name":"defaultOptions"},"init":{"type":"ObjectExpression","start":1093,"end":1491,"properties":[{"type":"Property","start":1099,"end":1157,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1099,"end":1105,"name":"server"},"value":{"type":"ObjectExpression","start":1107,"end":1157,"properties":[{"type":"Property","start":1117,"end":1133,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1117,"end":1125,"name":"protocol"},"value":{"type":"Literal","start":1127,"end":1133,"value":"http","raw":"'http'"},"kind":"init"},{"type":"Property","start":1143,"end":1151,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1143,"end":1147,"name":"path"},"value":{"type":"Literal","start":1149,"end":1151,"value":"","raw":"''"},"kind":"init"}]},"kind":"init"},{"type":"Property","start":1163,"end":1472,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1163,"end":1178,"name":"providerOptions"},"value":{"type":"ObjectExpression","start":1180,"end":1472,"properties":[{"type":"Property","start":1190,"end":1466,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1190,"end":1192,"name":"s3"},"value":{"type":"ObjectExpression","start":1194,"end":1466,"properties":[{"type":"Property","start":1208,"end":1226,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1208,"end":1211,"name":"acl"},"value":{"type":"Literal","start":1213,"end":1226,"value":"public-read","raw":"'public-read'"},"kind":"init"},{"type":"Property","start":1240,"end":1292,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1240,"end":1248,"name":"endpoint"},"value":{"type":"Literal","start":1250,"end":1292,"value":"https://{service}.{region}.amazonaws.com","raw":"'https://{service}.{region}.amazonaws.com'"},"kind":"init"},{"type":"Property","start":1306,"end":1320,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1306,"end":1316,"name":"conditions"},"value":{"type":"ArrayExpression","start":1318,"end":1320,"elements":[]},"kind":"init"},{"type":"Property","start":1334,"end":1362,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1334,"end":1355,"name":"useAccelerateEndpoint"},"value":{"type":"Literal","start":1357,"end":1362,"value":false,"raw":"false"},"kind":"init"},{"type":"Property","start":1376,"end":1411,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1376,"end":1382,"name":"getKey"},"value":{"type":"ArrowFunctionExpression","start":1384,"end":1411,"id":null,"expression":true,"generator":false,"async":false,"params":[{"type":"Identifier","start":1385,"end":1388,"name":"req"},{"type":"Identifier","start":1390,"end":1398,"name":"filename"}],"body":{"type":"Identifier","start":1403,"end":1411,"name":"filename"}},"kind":"init"},{"type":"Property","start":1425,"end":1456,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1425,"end":1432,"name":"expires"},"value":{"type":"BinaryExpression","start":1434,"end":1456,"left":{"type":"CallExpression","start":1434,"end":1449,"callee":{"type":"Identifier","start":1434,"end":1436,"name":"ms"},"arguments":[{"type":"Literal","start":1437,"end":1448,"value":"5 minutes","raw":"'5 minutes'"}]},"operator":"/","right":{"type":"Literal","start":1452,"end":1456,"value":1000,"raw":"1000"}},"kind":"init"}]},"kind":"init"}]},"kind":"init"},{"type":"Property","start":1478,"end":1489,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1478,"end":1483,"name":"debug"},"value":{"type":"Literal","start":1485,"end":1489,"value":true,"raw":"true"},"kind":"init"}]}}],"kind":"const"},{"type":"ExpressionStatement","start":1552,"end":1616,"expression":{"type":"AssignmentExpression","start":1552,"end":1615,"operator":"=","left":{"type":"MemberExpression","start":1552,"end":1573,"object":{"type":"MemberExpression","start":1552,"end":1566,"object":{"type":"Identifier","start":1552,"end":1558,"name":"module"},"property":{"type":"Identifier","start":1559,"end":1566,"name":"exports"},"computed":false},"property":{"type":"Identifier","start":1567,"end":1573,"name":"errors"},"computed":false},"right":{"type":"ObjectExpression","start":1576,"end":1615,"properties":[{"type":"Property","start":1578,"end":1594,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":1578,"end":1594,"name":"ProviderApiError"},"kind":"init","value":{"type":"Identifier","start":1578,"end":1594,"name":"ProviderApiError"}},{"type":"Property","start":1596,"end":1613,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":1596,"end":1613,"name":"ProviderAuthError"},"kind":"init","value":{"type":"Identifier","start":1596,"end":1613,"name":"ProviderAuthError"}}]}}},{"type":"ExpressionStatement","start":1707,"end":4983,"expression":{"type":"AssignmentExpression","start":1707,"end":4982,"operator":"=","left":{"type":"MemberExpression","start":1707,"end":1725,"object":{"type":"MemberExpression","start":1707,"end":1721,"object":{"type":"Identifier","start":1707,"end":1713,"name":"module"},"property":{"type":"Identifier","start":1714,"end":1721,"name":"exports"},"computed":false},"property":{"type":"Identifier","start":1722,"end":1725,"name":"app"},"computed":false},"right":{"type":"ArrowFunctionExpression","start":1728,"end":4982,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"AssignmentPattern","start":1729,"end":1741,"left":{"type":"Identifier","start":1729,"end":1736,"name":"options"},"right":{"type":"ObjectExpression","start":1739,"end":1741,"properties":[]}}],"body":{"type":"BlockStatement","start":1746,"end":4982,"body":[{"type":"ExpressionStatement","start":1752,"end":1776,"expression":{"type":"CallExpression","start":1752,"end":1775,"callee":{"type":"Identifier","start":1752,"end":1766,"name":"validateConfig"},"arguments":[{"type":"Identifier","start":1767,"end":1774,"name":"options"}]}},{"type":"ExpressionStatement","start":1781,"end":1826,"expression":{"type":"AssignmentExpression","start":1781,"end":1825,"operator":"=","left":{"type":"Identifier","start":1781,"end":1788,"name":"options"},"right":{"type":"CallExpression","start":1791,"end":1825,"callee":{"type":"Identifier","start":1791,"end":1796,"name":"merge"},"arguments":[{"type":"ObjectExpression","start":1797,"end":1799,"properties":[]},{"type":"Identifier","start":1801,"end":1815,"name":"defaultOptions"},{"type":"Identifier","start":1817,"end":1824,"name":"options"}]}}},{"type":"VariableDeclaration","start":1831,"end":1894,"declarations":[{"type":"VariableDeclarator","start":1837,"end":1893,"id":{"type":"Identifier","start":1837,"end":1846,"name":"providers"},"init":{"type":"CallExpression","start":1849,"end":1893,"callee":{"type":"MemberExpression","start":1849,"end":1884,"object":{"type":"Identifier","start":1849,"end":1864,"name":"providerManager"},"property":{"type":"Identifier","start":1865,"end":1884,"name":"getDefaultProviders"},"computed":false},"arguments":[{"type":"Identifier","start":1885,"end":1892,"name":"options"}]}}],"kind":"const"},{"type":"ExpressionStatement","start":1899,"end":1956,"expression":{"type":"CallExpression","start":1899,"end":1955,"callee":{"type":"MemberExpression","start":1899,"end":1933,"object":{"type":"Identifier","start":1899,"end":1914,"name":"providerManager"},"property":{"type":"Identifier","start":1915,"end":1933,"name":"addProviderOptions"},"computed":false},"arguments":[{"type":"Identifier","start":1934,"end":1941,"name":"options"},{"type":"Identifier","start":1943,"end":1954,"name":"grantConfig"}]}},{"type":"VariableDeclaration","start":1961,"end":2009,"declarations":[{"type":"VariableDeclarator","start":1967,"end":2008,"id":{"type":"Identifier","start":1967,"end":1982,"name":"customProviders"},"init":{"type":"MemberExpression","start":1985,"end":2008,"object":{"type":"Identifier","start":1985,"end":1992,"name":"options"},"property":{"type":"Identifier","start":1993,"end":2008,"name":"customProviders"},"computed":false}}],"kind":"const"},{"type":"IfStatement","start":2014,"end":2127,"test":{"type":"Identifier","start":2018,"end":2033,"name":"customProviders"},"consequent":{"type":"BlockStatement","start":2035,"end":2127,"body":[{"type":"ExpressionStatement","start":2045,"end":2121,"expression":{"type":"CallExpression","start":2045,"end":2120,"callee":{"type":"MemberExpression","start":2045,"end":2079,"object":{"type":"Identifier","start":2045,"end":2060,"name":"providerManager"},"property":{"type":"Identifier","start":2061,"end":2079,"name":"addCustomProviders"},"computed":false},"arguments":[{"type":"Identifier","start":2080,"end":2095,"name":"customProviders"},{"type":"Identifier","start":2097,"end":2106,"name":"providers"},{"type":"Identifier","start":2108,"end":2119,"name":"grantConfig"}]}}]},"alternate":null},{"type":"ExpressionStatement","start":2179,"end":2199,"expression":{"type":"CallExpression","start":2179,"end":2198,"callee":{"type":"Identifier","start":2179,"end":2189,"name":"maskLogger"},"arguments":[{"type":"Identifier","start":2190,"end":2197,"name":"options"}]}},{"type":"IfStatement","start":2241,"end":2354,"test":{"type":"MemberExpression","start":2245,"end":2261,"object":{"type":"Identifier","start":2245,"end":2252,"name":"options"},"property":{"type":"Identifier","start":2253,"end":2261,"name":"redisUrl"},"computed":false},"consequent":{"type":"BlockStatement","start":2263,"end":2354,"body":[{"type":"ExpressionStatement","start":2273,"end":2348,"expression":{"type":"CallExpression","start":2273,"end":2347,"callee":{"type":"MemberExpression","start":2273,"end":2285,"object":{"type":"Identifier","start":2273,"end":2278,"name":"redis"},"property":{"type":"Identifier","start":2279,"end":2285,"name":"client"},"computed":false},"arguments":[{"type":"CallExpression","start":2286,"end":2346,"callee":{"type":"Identifier","start":2286,"end":2291,"name":"merge"},"arguments":[{"type":"ObjectExpression","start":2292,"end":2317,"properties":[{"type":"Property","start":2294,"end":2315,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2294,"end":2297,"name":"url"},"value":{"type":"MemberExpression","start":2299,"end":2315,"object":{"type":"Identifier","start":2299,"end":2306,"name":"options"},"property":{"type":"Identifier","start":2307,"end":2315,"name":"redisUrl"},"computed":false},"kind":"init"}]},{"type":"LogicalExpression","start":2319,"end":2345,"left":{"type":"MemberExpression","start":2319,"end":2339,"object":{"type":"Identifier","start":2319,"end":2326,"name":"options"},"property":{"type":"Identifier","start":2327,"end":2339,"name":"redisOptions"},"computed":false},"operator":"||","right":{"type":"ObjectExpression","start":2343,"end":2345,"properties":[]}}]}]}}]},"alternate":null},{"type":"ExpressionStatement","start":2359,"end":2414,"expression":{"type":"CallExpression","start":2359,"end":2413,"callee":{"type":"Identifier","start":2359,"end":2366,"name":"emitter"},"arguments":[{"type":"LogicalExpression","start":2367,"end":2412,"left":{"type":"MemberExpression","start":2367,"end":2392,"object":{"type":"Identifier","start":2367,"end":2374,"name":"options"},"property":{"type":"Identifier","start":2375,"end":2392,"name":"multipleInstances"},"computed":false},"operator":"&&","right":{"type":"MemberExpression","start":2396,"end":2412,"object":{"type":"Identifier","start":2396,"end":2403,"name":"options"},"property":{"type":"Identifier","start":2404,"end":2412,"name":"redisUrl"},"computed":false}}]}},{"type":"VariableDeclaration","start":2419,"end":2441,"declarations":[{"type":"VariableDeclarator","start":2425,"end":2440,"id":{"type":"Identifier","start":2425,"end":2428,"name":"app"},"init":{"type":"CallExpression","start":2431,"end":2440,"callee":{"type":"Identifier","start":2431,"end":2438,"name":"express"},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","start":2446,"end":2470,"expression":{"type":"CallExpression","start":2446,"end":2469,"callee":{"type":"MemberExpression","start":2446,"end":2453,"object":{"type":"Identifier","start":2446,"end":2449,"name":"app"},"property":{"type":"Identifier","start":2450,"end":2453,"name":"use"},"computed":false},"arguments":[{"type":"CallExpression","start":2454,"end":2468,"callee":{"type":"Identifier","start":2454,"end":2466,"name":"cookieParser"},"arguments":[]}]}},{"type":"ExpressionStatement","start":2513,"end":2550,"expression":{"type":"CallExpression","start":2513,"end":2549,"callee":{"type":"MemberExpression","start":2513,"end":2520,"object":{"type":"Identifier","start":2513,"end":2516,"name":"app"},"property":{"type":"Identifier","start":2517,"end":2520,"name":"use"},"computed":false},"arguments":[{"type":"Identifier","start":2521,"end":2548,"name":"interceptGrantErrorResponse"}]}},{"type":"ExpressionStatement","start":2555,"end":2583,"expression":{"type":"CallExpression","start":2555,"end":2582,"callee":{"type":"MemberExpression","start":2555,"end":2562,"object":{"type":"Identifier","start":2555,"end":2558,"name":"app"},"property":{"type":"Identifier","start":2559,"end":2562,"name":"use"},"computed":false},"arguments":[{"type":"CallExpression","start":2563,"end":2581,"callee":{"type":"Identifier","start":2563,"end":2568,"name":"Grant"},"arguments":[{"type":"Identifier","start":2569,"end":2580,"name":"grantConfig"}]}]}},{"type":"ExpressionStatement","start":2588,"end":3640,"expression":{"type":"CallExpression","start":2588,"end":3639,"callee":{"type":"MemberExpression","start":2588,"end":2595,"object":{"type":"Identifier","start":2588,"end":2591,"name":"app"},"property":{"type":"Identifier","start":2592,"end":2595,"name":"use"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":2596,"end":3638,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":2597,"end":2600,"name":"req"},{"type":"Identifier","start":2602,"end":2605,"name":"res"},{"type":"Identifier","start":2607,"end":2611,"name":"next"}],"body":{"type":"BlockStatement","start":2616,"end":3638,"body":[{"type":"ExpressionStatement","start":2626,"end":2699,"expression":{"type":"CallExpression","start":2626,"end":2698,"callee":{"type":"MemberExpression","start":2626,"end":2636,"object":{"type":"Identifier","start":2626,"end":2629,"name":"res"},"property":{"type":"Identifier","start":2630,"end":2636,"name":"header"},"computed":false},"arguments":[{"type":"Literal","start":2637,"end":2667,"value":"Access-Control-Allow-Methods","raw":"'Access-Control-Allow-Methods'"},{"type":"Literal","start":2669,"end":2697,"value":"GET, POST, OPTIONS, DELETE","raw":"'GET, POST, OPTIONS, DELETE'"}]}},{"type":"ExpressionStatement","start":2708,"end":2886,"expression":{"type":"CallExpression","start":2708,"end":2885,"callee":{"type":"MemberExpression","start":2708,"end":2718,"object":{"type":"Identifier","start":2708,"end":2711,"name":"res"},"property":{"type":"Identifier","start":2712,"end":2718,"name":"header"},"computed":false},"arguments":[{"type":"Literal","start":2719,"end":2749,"value":"Access-Control-Allow-Headers","raw":"'Access-Control-Allow-Headers'"},{"type":"CallExpression","start":2751,"end":2884,"callee":{"type":"MemberExpression","start":2751,"end":2879,"object":{"type":"ArrayExpression","start":2751,"end":2874,"elements":[{"type":"Literal","start":2765,"end":2782,"value":"uppy-auth-token","raw":"'uppy-auth-token'"},{"type":"Literal","start":2796,"end":2811,"value":"uppy-versions","raw":"'uppy-versions'"},{"type":"CallExpression","start":2825,"end":2864,"callee":{"type":"MemberExpression","start":2825,"end":2832,"object":{"type":"Identifier","start":2825,"end":2828,"name":"res"},"property":{"type":"Identifier","start":2829,"end":2832,"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":2833,"end":2863,"value":"Access-Control-Allow-Headers","raw":"'Access-Control-Allow-Headers'"}]}]},"property":{"type":"Identifier","start":2875,"end":2879,"name":"join"},"computed":false},"arguments":[{"type":"Literal","start":2880,"end":2883,"value":",","raw":"','"}]}]}},{"type":"VariableDeclaration","start":2895,"end":3048,"declarations":[{"type":"VariableDeclarator","start":2901,"end":3047,"id":{"type":"Identifier","start":2901,"end":2915,"name":"exposedHeaders"},"init":{"type":"ArrayExpression","start":2918,"end":3047,"elements":[{"type":"Literal","start":3007,"end":3037,"value":"Access-Control-Allow-Headers","raw":"'Access-Control-Allow-Headers'"}]}}],"kind":"const"},{"type":"IfStatement","start":3057,"end":3311,"test":{"type":"MemberExpression","start":3061,"end":3085,"object":{"type":"Identifier","start":3061,"end":3068,"name":"options"},"property":{"type":"Identifier","start":3069,"end":3085,"name":"sendSelfEndpoint"},"computed":false},"consequent":{"type":"BlockStatement","start":3087,"end":3311,"body":[{"type":"ExpressionStatement","start":3147,"end":3175,"expression":{"type":"CallExpression","start":3147,"end":3174,"callee":{"type":"MemberExpression","start":3147,"end":3166,"object":{"type":"Identifier","start":3147,"end":3161,"name":"exposedHeaders"},"property":{"type":"Identifier","start":3162,"end":3166,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":3167,"end":3173,"value":"i-am","raw":"'i-am'"}]}},{"type":"VariableDeclaration","start":3188,"end":3224,"declarations":[{"type":"VariableDeclarator","start":3194,"end":3223,"id":{"type":"ObjectPattern","start":3194,"end":3206,"properties":[{"type":"Property","start":3196,"end":3204,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":3196,"end":3204,"name":"protocol"},"kind":"init","value":{"type":"Identifier","start":3196,"end":3204,"name":"protocol"}}]},"init":{"type":"MemberExpression","start":3209,"end":3223,"object":{"type":"Identifier","start":3209,"end":3216,"name":"options"},"property":{"type":"Identifier","start":3217,"end":3223,"name":"server"},"computed":false}}],"kind":"const"},{"type":"ExpressionStatement","start":3237,"end":3301,"expression":{"type":"CallExpression","start":3237,"end":3300,"callee":{"type":"MemberExpression","start":3237,"end":3247,"object":{"type":"Identifier","start":3237,"end":3240,"name":"res"},"property":{"type":"Identifier","start":3241,"end":3247,"name":"header"},"computed":false},"arguments":[{"type":"Literal","start":3248,"end":3254,"value":"i-am","raw":"'i-am'"},{"type":"TemplateLiteral","start":3256,"end":3299,"expressions":[{"type":"Identifier","start":3259,"end":3267,"name":"protocol"},{"type":"MemberExpression","start":3273,"end":3297,"object":{"type":"Identifier","start":3273,"end":3280,"name":"options"},"property":{"type":"Identifier","start":3281,"end":3297,"name":"sendSelfEndpoint"},"computed":false}],"quasis":[{"type":"TemplateElement","start":3257,"end":3257,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":3268,"end":3271,"value":{"raw":"://","cooked":"://"},"tail":false},{"type":"TemplateElement","start":3298,"end":3298,"value":{"raw":"","cooked":""},"tail":true}]}]}}]},"alternate":null},{"type":"IfStatement","start":3320,"end":3537,"test":{"type":"CallExpression","start":3324,"end":3364,"callee":{"type":"MemberExpression","start":3324,"end":3331,"object":{"type":"Identifier","start":3324,"end":3327,"name":"res"},"property":{"type":"Identifier","start":3328,"end":3331,"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":3332,"end":3363,"value":"Access-Control-Expose-Headers","raw":"'Access-Control-Expose-Headers'"}]},"consequent":{"type":"BlockStatement","start":3366,"end":3537,"body":[{"type":"ExpressionStatement","start":3465,"end":3527,"expression":{"type":"CallExpression","start":3465,"end":3526,"callee":{"type":"MemberExpression","start":3465,"end":3484,"object":{"type":"Identifier","start":3465,"end":3479,"name":"exposedHeaders"},"property":{"type":"Identifier","start":3480,"end":3484,"name":"push"},"computed":false},"arguments":[{"type":"CallExpression","start":3485,"end":3525,"callee":{"type":"MemberExpression","start":3485,"end":3492,"object":{"type":"Identifier","start":3485,"end":3488,"name":"res"},"property":{"type":"Identifier","start":3489,"end":3492,"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":3493,"end":3524,"value":"Access-Control-Expose-Headers","raw":"'Access-Control-Expose-Headers'"}]}]}}]},"alternate":null},{"type":"ExpressionStatement","start":3546,"end":3616,"expression":{"type":"CallExpression","start":3546,"end":3615,"callee":{"type":"MemberExpression","start":3546,"end":3556,"object":{"type":"Identifier","start":3546,"end":3549,"name":"res"},"property":{"type":"Identifier","start":3550,"end":3556,"name":"header"},"computed":false},"arguments":[{"type":"Literal","start":3557,"end":3588,"value":"Access-Control-Expose-Headers","raw":"'Access-Control-Expose-Headers'"},{"type":"CallExpression","start":3590,"end":3614,"callee":{"type":"MemberExpression","start":3590,"end":3609,"object":{"type":"Identifier","start":3590,"end":3604,"name":"exposedHeaders"},"property":{"type":"Identifier","start":3605,"end":3609,"name":"join"},"computed":false},"arguments":[{"type":"Literal","start":3610,"end":3613,"value":",","raw":"','"}]}]}},{"type":"ExpressionStatement","start":3625,"end":3632,"expression":{"type":"CallExpression","start":3625,"end":3631,"callee":{"type":"Identifier","start":3625,"end":3629,"name":"next"},"arguments":[]}}]}}]}},{"type":"ExpressionStatement","start":3737,"end":3781,"expression":{"type":"CallExpression","start":3737,"end":3780,"callee":{"type":"MemberExpression","start":3737,"end":3744,"object":{"type":"Identifier","start":3737,"end":3740,"name":"app"},"property":{"type":"Identifier","start":3741,"end":3744,"name":"use"},"computed":false},"arguments":[{"type":"Literal","start":3745,"end":3748,"value":"*","raw":"'*'"},{"type":"CallExpression","start":3750,"end":3779,"callee":{"type":"Identifier","start":3750,"end":3770,"name":"getOptionsMiddleware"},"arguments":[{"type":"Identifier","start":3771,"end":3778,"name":"options"}]}]}},{"type":"ExpressionStatement","start":3786,"end":3833,"expression":{"type":"CallExpression","start":3786,"end":3832,"callee":{"type":"MemberExpression","start":3786,"end":3793,"object":{"type":"Identifier","start":3786,"end":3789,"name":"app"},"property":{"type":"Identifier","start":3790,"end":3793,"name":"use"},"computed":false},"arguments":[{"type":"Literal","start":3794,"end":3799,"value":"/s3","raw":"'/s3'"},{"type":"CallExpression","start":3801,"end":3831,"callee":{"type":"Identifier","start":3801,"end":3803,"name":"s3"},"arguments":[{"type":"MemberExpression","start":3804,"end":3830,"object":{"type":"MemberExpression","start":3804,"end":3827,"object":{"type":"Identifier","start":3804,"end":3811,"name":"options"},"property":{"type":"Identifier","start":3812,"end":3827,"name":"providerOptions"},"computed":false},"property":{"type":"Identifier","start":3828,"end":3830,"name":"s3"},"computed":false}]}]}},{"type":"ExpressionStatement","start":3838,"end":3861,"expression":{"type":"CallExpression","start":3838,"end":3860,"callee":{"type":"MemberExpression","start":3838,"end":3845,"object":{"type":"Identifier","start":3838,"end":3841,"name":"app"},"property":{"type":"Identifier","start":3842,"end":3845,"name":"use"},"computed":false},"arguments":[{"type":"Literal","start":3846,"end":3852,"value":"/url","raw":"'/url'"},{"type":"CallExpression","start":3854,"end":3859,"callee":{"type":"Identifier","start":3854,"end":3857,"name":"url"},"arguments":[]}]}},{"type":"ExpressionStatement","start":3866,"end":3958,"expression":{"type":"CallExpression","start":3866,"end":3957,"callee":{"type":"MemberExpression","start":3866,"end":3873,"object":{"type":"Identifier","start":3866,"end":3869,"name":"app"},"property":{"type":"Identifier","start":3870,"end":3873,"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":3874,"end":3899,"value":"/:providerName/callback","raw":"'/:providerName/callback'"},{"type":"MemberExpression","start":3901,"end":3934,"object":{"type":"Identifier","start":3901,"end":3912,"name":"middlewares"},"property":{"type":"Identifier","start":3913,"end":3934,"name":"hasSessionAndProvider"},"computed":false},{"type":"MemberExpression","start":3936,"end":3956,"object":{"type":"Identifier","start":3936,"end":3947,"name":"controllers"},"property":{"type":"Identifier","start":3948,"end":3956,"name":"callback"},"computed":false}]}},{"type":"ExpressionStatement","start":3963,"end":4053,"expression":{"type":"CallExpression","start":3963,"end":4052,"callee":{"type":"MemberExpression","start":3963,"end":3970,"object":{"type":"Identifier","start":3963,"end":3966,"name":"app"},"property":{"type":"Identifier","start":3967,"end":3970,"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":3971,"end":3995,"value":"/:providerName/connect","raw":"'/:providerName/connect'"},{"type":"MemberExpression","start":3997,"end":4030,"object":{"type":"Identifier","start":3997,"end":4008,"name":"middlewares"},"property":{"type":"Identifier","start":4009,"end":4030,"name":"hasSessionAndProvider"},"computed":false},{"type":"MemberExpression","start":4032,"end":4051,"object":{"type":"Identifier","start":4032,"end":4043,"name":"controllers"},"property":{"type":"Identifier","start":4044,"end":4051,"name":"connect"},"computed":false}]}},{"type":"ExpressionStatement","start":4058,"end":4150,"expression":{"type":"CallExpression","start":4058,"end":4149,"callee":{"type":"MemberExpression","start":4058,"end":4065,"object":{"type":"Identifier","start":4058,"end":4061,"name":"app"},"property":{"type":"Identifier","start":4062,"end":4065,"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":4066,"end":4091,"value":"/:providerName/redirect","raw":"'/:providerName/redirect'"},{"type":"MemberExpression","start":4093,"end":4126,"object":{"type":"Identifier","start":4093,"end":4104,"name":"middlewares"},"property":{"type":"Identifier","start":4105,"end":4126,"name":"hasSessionAndProvider"},"computed":false},{"type":"MemberExpression","start":4128,"end":4148,"object":{"type":"Identifier","start":4128,"end":4139,"name":"controllers"},"property":{"type":"Identifier","start":4140,"end":4148,"name":"redirect"},"computed":false}]}},{"type":"ExpressionStatement","start":4155,"end":4274,"expression":{"type":"CallExpression","start":4155,"end":4273,"callee":{"type":"MemberExpression","start":4155,"end":4162,"object":{"type":"Identifier","start":4155,"end":4158,"name":"app"},"property":{"type":"Identifier","start":4159,"end":4162,"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":4163,"end":4186,"value":"/:providerName/logout","raw":"'/:providerName/logout'"},{"type":"MemberExpression","start":4188,"end":4221,"object":{"type":"Identifier","start":4188,"end":4199,"name":"middlewares"},"property":{"type":"Identifier","start":4200,"end":4221,"name":"hasSessionAndProvider"},"computed":false},{"type":"MemberExpression","start":4223,"end":4252,"object":{"type":"Identifier","start":4223,"end":4234,"name":"middlewares"},"property":{"type":"Identifier","start":4235,"end":4252,"name":"gentleVerifyToken"},"computed":false},{"type":"MemberExpression","start":4254,"end":4272,"object":{"type":"Identifier","start":4254,"end":4265,"name":"controllers"},"property":{"type":"Identifier","start":4266,"end":4272,"name":"logout"},"computed":false}]}},{"type":"ExpressionStatement","start":4279,"end":4399,"expression":{"type":"CallExpression","start":4279,"end":4398,"callee":{"type":"MemberExpression","start":4279,"end":4286,"object":{"type":"Identifier","start":4279,"end":4282,"name":"app"},"property":{"type":"Identifier","start":4283,"end":4286,"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":4287,"end":4314,"value":"/:providerName/send-token","raw":"'/:providerName/send-token'"},{"type":"MemberExpression","start":4316,"end":4349,"object":{"type":"Identifier","start":4316,"end":4327,"name":"middlewares"},"property":{"type":"Identifier","start":4328,"end":4349,"name":"hasSessionAndProvider"},"computed":false},{"type":"MemberExpression","start":4351,"end":4374,"object":{"type":"Identifier","start":4351,"end":4362,"name":"middlewares"},"property":{"type":"Identifier","start":4363,"end":4374,"name":"verifyToken"},"computed":false},{"type":"MemberExpression","start":4376,"end":4397,"object":{"type":"Identifier","start":4376,"end":4387,"name":"controllers"},"property":{"type":"Identifier","start":4388,"end":4397,"name":"sendToken"},"computed":false}]}},{"type":"ExpressionStatement","start":4404,"end":4518,"expression":{"type":"CallExpression","start":4404,"end":4517,"callee":{"type":"MemberExpression","start":4404,"end":4411,"object":{"type":"Identifier","start":4404,"end":4407,"name":"app"},"property":{"type":"Identifier","start":4408,"end":4411,"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":4412,"end":4438,"value":"/:providerName/list/:id?","raw":"'/:providerName/list/:id?'"},{"type":"MemberExpression","start":4440,"end":4473,"object":{"type":"Identifier","start":4440,"end":4451,"name":"middlewares"},"property":{"type":"Identifier","start":4452,"end":4473,"name":"hasSessionAndProvider"},"computed":false},{"type":"MemberExpression","start":4475,"end":4498,"object":{"type":"Identifier","start":4475,"end":4486,"name":"middlewares"},"property":{"type":"Identifier","start":4487,"end":4498,"name":"verifyToken"},"computed":false},{"type":"MemberExpression","start":4500,"end":4516,"object":{"type":"Identifier","start":4500,"end":4511,"name":"controllers"},"property":{"type":"Identifier","start":4512,"end":4516,"name":"list"},"computed":false}]}},{"type":"ExpressionStatement","start":4523,"end":4635,"expression":{"type":"CallExpression","start":4523,"end":4634,"callee":{"type":"MemberExpression","start":4523,"end":4531,"object":{"type":"Identifier","start":4523,"end":4526,"name":"app"},"property":{"type":"Identifier","start":4527,"end":4531,"name":"post"},"computed":false},"arguments":[{"type":"Literal","start":4532,"end":4556,"value":"/:providerName/get/:id","raw":"'/:providerName/get/:id'"},{"type":"MemberExpression","start":4558,"end":4591,"object":{"type":"Identifier","start":4558,"end":4569,"name":"middlewares"},"property":{"type":"Identifier","start":4570,"end":4591,"name":"hasSessionAndProvider"},"computed":false},{"type":"MemberExpression","start":4593,"end":4616,"object":{"type":"Identifier","start":4593,"end":4604,"name":"middlewares"},"property":{"type":"Identifier","start":4605,"end":4616,"name":"verifyToken"},"computed":false},{"type":"MemberExpression","start":4618,"end":4633,"object":{"type":"Identifier","start":4618,"end":4629,"name":"controllers"},"property":{"type":"Identifier","start":4630,"end":4633,"name":"get"},"computed":false}]}},{"type":"ExpressionStatement","start":4640,"end":4792,"expression":{"type":"CallExpression","start":4640,"end":4791,"callee":{"type":"MemberExpression","start":4640,"end":4647,"object":{"type":"Identifier","start":4640,"end":4643,"name":"app"},"property":{"type":"Identifier","start":4644,"end":4647,"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":4648,"end":4678,"value":"/:providerName/thumbnail/:id","raw":"'/:providerName/thumbnail/:id'"},{"type":"MemberExpression","start":4680,"end":4713,"object":{"type":"Identifier","start":4680,"end":4691,"name":"middlewares"},"property":{"type":"Identifier","start":4692,"end":4713,"name":"hasSessionAndProvider"},"computed":false},{"type":"MemberExpression","start":4715,"end":4742,"object":{"type":"Identifier","start":4715,"end":4726,"name":"middlewares"},"property":{"type":"Identifier","start":4727,"end":4742,"name":"cookieAuthToken"},"computed":false},{"type":"MemberExpression","start":4744,"end":4767,"object":{"type":"Identifier","start":4744,"end":4755,"name":"middlewares"},"property":{"type":"Identifier","start":4756,"end":4767,"name":"verifyToken"},"computed":false},{"type":"MemberExpression","start":4769,"end":4790,"object":{"type":"Identifier","start":4769,"end":4780,"name":"controllers"},"property":{"type":"Identifier","start":4781,"end":4790,"name":"thumbnail"},"computed":false}]}},{"type":"ExpressionStatement","start":4797,"end":4873,"expression":{"type":"CallExpression","start":4797,"end":4872,"callee":{"type":"MemberExpression","start":4797,"end":4806,"object":{"type":"Identifier","start":4797,"end":4800,"name":"app"},"property":{"type":"Identifier","start":4801,"end":4806,"name":"param"},"computed":false},"arguments":[{"type":"Literal","start":4807,"end":4821,"value":"providerName","raw":"'providerName'"},{"type":"CallExpression","start":4823,"end":4871,"callee":{"type":"MemberExpression","start":4823,"end":4860,"object":{"type":"Identifier","start":4823,"end":4838,"name":"providerManager"},"property":{"type":"Identifier","start":4839,"end":4860,"name":"getProviderMiddleware"},"computed":false},"arguments":[{"type":"Identifier","start":4861,"end":4870,"name":"providers"}]}]}},{"type":"IfStatement","start":4878,"end":4964,"test":{"type":"BinaryExpression","start":4882,"end":4907,"left":{"type":"CallExpression","start":4882,"end":4896,"callee":{"type":"MemberExpression","start":4882,"end":4889,"object":{"type":"Identifier","start":4882,"end":4885,"name":"app"},"property":{"type":"Identifier","start":4886,"end":4889,"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":4890,"end":4895,"value":"env","raw":"'env'"}]},"operator":"!==","right":{"type":"Literal","start":4901,"end":4907,"value":"test","raw":"'test'"}},"consequent":{"type":"BlockStatement","start":4909,"end":4964,"body":[{"type":"ExpressionStatement","start":4919,"end":4958,"expression":{"type":"CallExpression","start":4919,"end":4957,"callee":{"type":"MemberExpression","start":4919,"end":4939,"object":{"type":"Identifier","start":4919,"end":4923,"name":"jobs"},"property":{"type":"Identifier","start":4924,"end":4939,"name":"startCleanUpJob"},"computed":false},"arguments":[{"type":"MemberExpression","start":4940,"end":4956,"object":{"type":"Identifier","start":4940,"end":4947,"name":"options"},"property":{"type":"Identifier","start":4948,"end":4956,"name":"filePath"},"computed":false}]}}]},"alternate":null},{"type":"ReturnStatement","start":4969,"end":4980,"argument":{"type":"Identifier","start":4976,"end":4979,"name":"app"}}]}}}},{"type":"ExpressionStatement","start":5084,"end":7129,"expression":{"type":"AssignmentExpression","start":5084,"end":7128,"operator":"=","left":{"type":"MemberExpression","start":5084,"end":5105,"object":{"type":"MemberExpression","start":5084,"end":5098,"object":{"type":"Identifier","start":5084,"end":5090,"name":"module"},"property":{"type":"Identifier","start":5091,"end":5098,"name":"exports"},"computed":false},"property":{"type":"Identifier","start":5099,"end":5105,"name":"socket"},"computed":false},"right":{"type":"ArrowFunctionExpression","start":5108,"end":7128,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":5109,"end":5115,"name":"server"}],"body":{"type":"BlockStatement","start":5120,"end":7128,"body":[{"type":"VariableDeclaration","start":5126,"end":5167,"declarations":[{"type":"VariableDeclarator","start":5132,"end":5166,"id":{"type":"Identifier","start":5132,"end":5135,"name":"wss"},"init":{"type":"NewExpression","start":5138,"end":5166,"callee":{"type":"Identifier","start":5142,"end":5154,"name":"SocketServer"},"arguments":[{"type":"ObjectExpression","start":5155,"end":5165,"properties":[{"type":"Property","start":5157,"end":5163,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":5157,"end":5163,"name":"server"},"kind":"init","value":{"type":"Identifier","start":5157,"end":5163,"name":"server"}}]}]}}],"kind":"const"},{"type":"VariableDeclaration","start":5172,"end":5207,"declarations":[{"type":"VariableDeclarator","start":5178,"end":5206,"id":{"type":"Identifier","start":5178,"end":5189,"name":"redisClient"},"init":{"type":"CallExpression","start":5192,"end":5206,"callee":{"type":"MemberExpression","start":5192,"end":5204,"object":{"type":"Identifier","start":5192,"end":5197,"name":"redis"},"property":{"type":"Identifier","start":5198,"end":5204,"name":"client"},"computed":false},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","start":5380,"end":7126,"expression":{"type":"CallExpression","start":5380,"end":7125,"callee":{"type":"MemberExpression","start":5380,"end":5386,"object":{"type":"Identifier","start":5380,"end":5383,"name":"wss"},"property":{"type":"Identifier","start":5384,"end":5386,"name":"on"},"computed":false},"arguments":[{"type":"Literal","start":5387,"end":5399,"value":"connection","raw":"'connection'"},{"type":"ArrowFunctionExpression","start":5401,"end":7124,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":5402,"end":5404,"name":"ws"},{"type":"Identifier","start":5406,"end":5409,"name":"req"}],"body":{"type":"BlockStatement","start":5414,"end":7124,"body":[{"type":"VariableDeclaration","start":5446,"end":5471,"declarations":[{"type":"VariableDeclarator","start":5452,"end":5470,"id":{"type":"Identifier","start":5452,"end":5460,"name":"fullPath"},"init":{"type":"MemberExpression","start":5463,"end":5470,"object":{"type":"Identifier","start":5463,"end":5466,"name":"req"},"property":{"type":"Identifier","start":5467,"end":5470,"name":"url"},"computed":false}}],"kind":"const"},{"type":"VariableDeclaration","start":5599,"end":5648,"declarations":[{"type":"VariableDeclarator","start":5605,"end":5647,"id":{"type":"Identifier","start":5605,"end":5610,"name":"token"},"init":{"type":"CallExpression","start":5613,"end":5647,"callee":{"type":"MemberExpression","start":5613,"end":5629,"object":{"type":"Identifier","start":5613,"end":5621,"name":"fullPath"},"property":{"type":"Identifier","start":5622,"end":5629,"name":"replace"},"computed":false},"arguments":[{"type":"Literal","start":5630,"end":5642,"value":{},"raw":"/^.*\\/api\\//","regex":{"pattern":"^.*\\/api\\/","flags":""}},{"type":"Literal","start":5644,"end":5646,"value":"","raw":"''"}]}}],"kind":"const"},{"type":"ExpressionStatement","start":5657,"end":5724,"expression":{"type":"CallExpression","start":5657,"end":5723,"callee":{"type":"MemberExpression","start":5657,"end":5668,"object":{"type":"Identifier","start":5657,"end":5663,"name":"logger"},"property":{"type":"Identifier","start":5664,"end":5668,"name":"info"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":5669,"end":5704,"expressions":[{"type":"Identifier","start":5697,"end":5702,"name":"token"}],"quasis":[{"type":"TemplateElement","start":5670,"end":5695,"value":{"raw":"connection received from ","cooked":"connection received from "},"tail":false},{"type":"TemplateElement","start":5703,"end":5703,"value":{"raw":"","cooked":""},"tail":true}]},{"type":"Literal","start":5706,"end":5722,"value":"socket.connect","raw":"'socket.connect'"}]}},{"type":"FunctionDeclaration","start":5827,"end":6044,"id":{"type":"Identifier","start":5836,"end":5848,"name":"sendProgress"},"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":5849,"end":5853,"name":"data"}],"body":{"type":"BlockStatement","start":5855,"end":6044,"body":[{"type":"ExpressionStatement","start":5869,"end":6034,"expression":{"type":"CallExpression","start":5869,"end":6033,"callee":{"type":"MemberExpression","start":5869,"end":5876,"object":{"type":"Identifier","start":5869,"end":5871,"name":"ws"},"property":{"type":"Identifier","start":5872,"end":5876,"name":"send"},"computed":false},"arguments":[{"type":"CallExpression","start":5877,"end":5896,"callee":{"type":"Identifier","start":5877,"end":5890,"name":"jsonStringify"},"arguments":[{"type":"Identifier","start":5891,"end":5895,"name":"data"}]},{"type":"ArrowFunctionExpression","start":5898,"end":6032,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":5899,"end":5902,"name":"err"}],"body":{"type":"BlockStatement","start":5907,"end":6032,"body":[{"type":"IfStatement","start":5925,"end":6018,"test":{"type":"Identifier","start":5929,"end":5932,"name":"err"},"consequent":{"type":"ExpressionStatement","start":5954,"end":6018,"expression":{"type":"CallExpression","start":5954,"end":6017,"callee":{"type":"MemberExpression","start":5954,"end":5966,"object":{"type":"Identifier","start":5954,"end":5960,"name":"logger"},"property":{"type":"Identifier","start":5961,"end":5966,"name":"error"},"computed":false},"arguments":[{"type":"Identifier","start":5967,"end":5970,"name":"err"},{"type":"Literal","start":5972,"end":5995,"value":"socket.progress.error","raw":"'socket.progress.error'"},{"type":"CallExpression","start":5997,"end":6016,"callee":{"type":"Identifier","start":5997,"end":6009,"name":"shortenToken"},"arguments":[{"type":"Identifier","start":6010,"end":6015,"name":"token"}]}]}},"alternate":null}]}}]}}]}},{"type":"IfStatement","start":6204,"end":6628,"test":{"type":"Identifier","start":6208,"end":6219,"name":"redisClient"},"consequent":{"type":"BlockStatement","start":6221,"end":6628,"body":[{"type":"ExpressionStatement","start":6235,"end":6618,"expression":{"type":"CallExpression","start":6235,"end":6617,"callee":{"type":"MemberExpression","start":6235,"end":6250,"object":{"type":"Identifier","start":6235,"end":6246,"name":"redisClient"},"property":{"type":"Identifier","start":6247,"end":6250,"name":"get"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":6251,"end":6279,"expressions":[{"type":"Identifier","start":6254,"end":6268,"name":"STORAGE_PREFIX"},{"type":"Identifier","start":6272,"end":6277,"name":"token"}],"quasis":[{"type":"TemplateElement","start":6252,"end":6252,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":6269,"end":6270,"value":{"raw":":","cooked":":"},"tail":false},{"type":"TemplateElement","start":6278,"end":6278,"value":{"raw":"","cooked":""},"tail":true}]},{"type":"ArrowFunctionExpression","start":6281,"end":6616,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":6282,"end":6285,"name":"err"},{"type":"Identifier","start":6287,"end":6291,"name":"data"}],"body":{"type":"BlockStatement","start":6296,"end":6616,"body":[{"type":"IfStatement","start":6314,"end":6404,"test":{"type":"Identifier","start":6318,"end":6321,"name":"err"},"consequent":{"type":"ExpressionStatement","start":6343,"end":6404,"expression":{"type":"CallExpression","start":6343,"end":6403,"callee":{"type":"MemberExpression","start":6343,"end":6355,"object":{"type":"Identifier","start":6343,"end":6349,"name":"logger"},"property":{"type":"Identifier","start":6350,"end":6355,"name":"error"},"computed":false},"arguments":[{"type":"Identifier","start":6356,"end":6359,"name":"err"},{"type":"Literal","start":6361,"end":6381,"value":"socket.redis.error","raw":"'socket.redis.error'"},{"type":"CallExpression","start":6383,"end":6402,"callee":{"type":"Identifier","start":6383,"end":6395,"name":"shortenToken"},"arguments":[{"type":"Identifier","start":6396,"end":6401,"name":"token"}]}]}},"alternate":null},{"type":"IfStatement","start":6421,"end":6602,"test":{"type":"Identifier","start":6425,"end":6429,"name":"data"},"consequent":{"type":"BlockStatement","start":6431,"end":6602,"body":[{"type":"VariableDeclaration","start":6453,"end":6497,"declarations":[{"type":"VariableDeclarator","start":6459,"end":6496,"id":{"type":"Identifier","start":6459,"end":6466,"name":"dataObj"},"init":{"type":"CallExpression","start":6469,"end":6496,"callee":{"type":"MemberExpression","start":6469,"end":6479,"object":{"type":"Identifier","start":6469,"end":6473,"name":"JSON"},"property":{"type":"Identifier","start":6474,"end":6479,"name":"parse"},"computed":false},"arguments":[{"type":"CallExpression","start":6480,"end":6495,"callee":{"type":"MemberExpression","start":6480,"end":6493,"object":{"type":"Identifier","start":6480,"end":6484,"name":"data"},"property":{"type":"Identifier","start":6485,"end":6493,"name":"toString"},"computed":false},"arguments":[]}]}}],"kind":"const"},{"type":"IfStatement","start":6518,"end":6584,"test":{"type":"MemberExpression","start":6522,"end":6536,"object":{"type":"Identifier","start":6522,"end":6529,"name":"dataObj"},"property":{"type":"Identifier","start":6530,"end":6536,"name":"action"},"computed":false},"consequent":{"type":"ExpressionStatement","start":6562,"end":6584,"expression":{"type":"CallExpression","start":6562,"end":6583,"callee":{"type":"Identifier","start":6562,"end":6574,"name":"sendProgress"},"arguments":[{"type":"Identifier","start":6575,"end":6582,"name":"dataObj"}]}},"alternate":null}]},"alternate":null}]}}]}}]},"alternate":null},{"type":"ExpressionStatement","start":6637,"end":6675,"expression":{"type":"CallExpression","start":6637,"end":6674,"callee":{"type":"MemberExpression","start":6637,"end":6651,"object":{"type":"CallExpression","start":6637,"end":6646,"callee":{"type":"Identifier","start":6637,"end":6644,"name":"emitter"},"arguments":[]},"property":{"type":"Identifier","start":6647,"end":6651,"name":"emit"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":6652,"end":6673,"expressions":[{"type":"Identifier","start":6666,"end":6671,"name":"token"}],"quasis":[{"type":"TemplateElement","start":6653,"end":6664,"value":{"raw":"connection:","cooked":"connection:"},"tail":false},{"type":"TemplateElement","start":6672,"end":6672,"value":{"raw":"","cooked":""},"tail":true}]}]}},{"type":"ExpressionStatement","start":6684,"end":6718,"expression":{"type":"CallExpression","start":6684,"end":6717,"callee":{"type":"MemberExpression","start":6684,"end":6696,"object":{"type":"CallExpression","start":6684,"end":6693,"callee":{"type":"Identifier","start":6684,"end":6691,"name":"emitter"},"arguments":[]},"property":{"type":"Identifier","start":6694,"end":6696,"name":"on"},"computed":false},"arguments":[{"type":"Identifier","start":6697,"end":6702,"name":"token"},{"type":"Identifier","start":6704,"end":6716,"name":"sendProgress"}]}},{"type":"ExpressionStatement","start":6727,"end":7016,"expression":{"type":"CallExpression","start":6727,"end":7015,"callee":{"type":"MemberExpression","start":6727,"end":6732,"object":{"type":"Identifier","start":6727,"end":6729,"name":"ws"},"property":{"type":"Identifier","start":6730,"end":6732,"name":"on"},"computed":false},"arguments":[{"type":"Literal","start":6733,"end":6742,"value":"message","raw":"'message'"},{"type":"ArrowFunctionExpression","start":6744,"end":7014,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":6745,"end":6753,"name":"jsonData"}],"body":{"type":"BlockStatement","start":6758,"end":7014,"body":[{"type":"VariableDeclaration","start":6772,"end":6817,"declarations":[{"type":"VariableDeclarator","start":6778,"end":6816,"id":{"type":"Identifier","start":6778,"end":6782,"name":"data"},"init":{"type":"CallExpression","start":6785,"end":6816,"callee":{"type":"MemberExpression","start":6785,"end":6795,"object":{"type":"Identifier","start":6785,"end":6789,"name":"JSON"},"property":{"type":"Identifier","start":6790,"end":6795,"name":"parse"},"computed":false},"arguments":[{"type":"CallExpression","start":6796,"end":6815,"callee":{"type":"MemberExpression","start":6796,"end":6813,"object":{"type":"Identifier","start":6796,"end":6804,"name":"jsonData"},"property":{"type":"Identifier","start":6805,"end":6813,"name":"toString"},"computed":false},"arguments":[]}]}}],"kind":"const"},{"type":"IfStatement","start":6873,"end":7004,"test":{"type":"CallExpression","start":6877,"end":6928,"callee":{"type":"MemberExpression","start":6877,"end":6915,"object":{"type":"ArrayExpression","start":6877,"end":6906,"elements":[{"type":"Literal","start":6878,"end":6885,"value":"pause","raw":"'pause'"},{"type":"Literal","start":6887,"end":6895,"value":"resume","raw":"'resume'"},{"type":"Literal","start":6897,"end":6905,"value":"cancel","raw":"'cancel'"}]},"property":{"type":"Identifier","start":6907,"end":6915,"name":"includes"},"computed":false},"arguments":[{"type":"MemberExpression","start":6916,"end":6927,"object":{"type":"Identifier","start":6916,"end":6920,"name":"data"},"property":{"type":"Identifier","start":6921,"end":6927,"name":"action"},"computed":false}]},"consequent":{"type":"BlockStatement","start":6930,"end":7004,"body":[{"type":"ExpressionStatement","start":6948,"end":6990,"expression":{"type":"CallExpression","start":6948,"end":6989,"callee":{"type":"MemberExpression","start":6948,"end":6962,"object":{"type":"CallExpression","start":6948,"end":6957,"callee":{"type":"Identifier","start":6948,"end":6955,"name":"emitter"},"arguments":[]},"property":{"type":"Identifier","start":6958,"end":6962,"name":"emit"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":6963,"end":6988,"expressions":[{"type":"MemberExpression","start":6966,"end":6977,"object":{"type":"Identifier","start":6966,"end":6970,"name":"data"},"property":{"type":"Identifier","start":6971,"end":6977,"name":"action"},"computed":false},{"type":"Identifier","start":6981,"end":6986,"name":"token"}],"quasis":[{"type":"TemplateElement","start":6964,"end":6964,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":6978,"end":6979,"value":{"raw":":","cooked":":"},"tail":false},{"type":"TemplateElement","start":6987,"end":6987,"value":{"raw":"","cooked":""},"tail":true}]}]}}]},"alternate":null}]}}]}},{"type":"ExpressionStatement","start":7025,"end":7118,"expression":{"type":"CallExpression","start":7025,"end":7117,"callee":{"type":"MemberExpression","start":7025,"end":7030,"object":{"type":"Identifier","start":7025,"end":7027,"name":"ws"},"property":{"type":"Identifier","start":7028,"end":7030,"name":"on"},"computed":false},"arguments":[{"type":"Literal","start":7031,"end":7038,"value":"close","raw":"'close'"},{"type":"ArrowFunctionExpression","start":7040,"end":7116,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":7046,"end":7116,"body":[{"type":"ExpressionStatement","start":7060,"end":7106,"expression":{"type":"CallExpression","start":7060,"end":7105,"callee":{"type":"MemberExpression","start":7060,"end":7084,"object":{"type":"CallExpression","start":7060,"end":7069,"callee":{"type":"Identifier","start":7060,"end":7067,"name":"emitter"},"arguments":[]},"property":{"type":"Identifier","start":7070,"end":7084,"name":"removeListener"},"computed":false},"arguments":[{"type":"Identifier","start":7085,"end":7090,"name":"token"},{"type":"Identifier","start":7092,"end":7104,"name":"sendProgress"}]}}]}}]}}]}}]}}]}}}},{"type":"VariableDeclaration","start":7227,"end":8205,"declarations":[{"type":"VariableDeclarator","start":7233,"end":8204,"id":{"type":"Identifier","start":7233,"end":7260,"name":"interceptGrantErrorResponse"},"init":{"type":"CallExpression","start":7263,"end":8204,"callee":{"type":"Identifier","start":7263,"end":7274,"name":"interceptor"},"arguments":[{"type":"ArrowFunctionExpression","start":7275,"end":8203,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":7276,"end":7279,"name":"req"},{"type":"Identifier","start":7281,"end":7284,"name":"res"}],"body":{"type":"BlockStatement","start":7289,"end":8203,"body":[{"type":"ReturnStatement","start":7295,"end":8201,"argument":{"type":"ObjectExpression","start":7302,"end":8200,"properties":[{"type":"Property","start":7312,"end":7453,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7312,"end":7327,"name":"isInterceptable"},"value":{"type":"ArrowFunctionExpression","start":7329,"end":7453,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":7335,"end":7453,"body":[{"type":"ReturnStatement","start":7393,"end":7443,"argument":{"type":"CallExpression","start":7400,"end":7442,"callee":{"type":"MemberExpression","start":7400,"end":7432,"object":{"type":"Literal","start":7400,"end":7427,"value":{},"raw":"/^\\/connect\\/\\w+\\/callback/","regex":{"pattern":"^\\/connect\\/\\w+\\/callback","flags":""}},"property":{"type":"Identifier","start":7428,"end":7432,"name":"test"},"computed":false},"arguments":[{"type":"MemberExpression","start":7433,"end":7441,"object":{"type":"Identifier","start":7433,"end":7436,"name":"req"},"property":{"type":"Identifier","start":7437,"end":7441,"name":"path"},"computed":false}]}}]}},"kind":"init"},{"type":"Property","start":7463,"end":8194,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7463,"end":7472,"name":"intercept"},"value":{"type":"ArrowFunctionExpression","start":7474,"end":8194,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":7475,"end":7479,"name":"body"},{"type":"Identifier","start":7481,"end":7485,"name":"send"}],"body":{"type":"BlockStatement","start":7490,"end":8194,"body":[{"type":"VariableDeclaration","start":7504,"end":7594,"declarations":[{"type":"VariableDeclarator","start":7510,"end":7593,"id":{"type":"Identifier","start":7510,"end":7522,"name":"unwantedBody"},"init":{"type":"Literal","start":7525,"end":7593,"value":"error=Grant%3A%20missing%20session%20or%20misconfigured%20provider","raw":"'error=Grant%3A%20missing%20session%20or%20misconfigured%20provider'"}}],"kind":"const"},{"type":"IfStatement","start":7607,"end":8184,"test":{"type":"BinaryExpression","start":7611,"end":7632,"left":{"type":"Identifier","start":7611,"end":7615,"name":"body"},"operator":"===","right":{"type":"Identifier","start":7620,"end":7632,"name":"unwantedBody"}},"consequent":{"type":"BlockStatement","start":7634,"end":8123,"body":[{"type":"ExpressionStatement","start":7652,"end":7736,"expression":{"type":"CallExpression","start":7652,"end":7735,"callee":{"type":"MemberExpression","start":7652,"end":7664,"object":{"type":"Identifier","start":7652,"end":7658,"name":"logger"},"property":{"type":"Identifier","start":7659,"end":7664,"name":"error"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":7665,"end":7705,"expressions":[{"type":"Identifier","start":7699,"end":7703,"name":"body"}],"quasis":[{"type":"TemplateElement","start":7666,"end":7697,"value":{"raw":"grant.js responded with error: ","cooked":"grant.js responded with error: "},"tail":false},{"type":"TemplateElement","start":7704,"end":7704,"value":{"raw":"","cooked":""},"tail":true}]},{"type":"Literal","start":7707,"end":7726,"value":"grant.oauth.error","raw":"'grant.oauth.error'"},{"type":"MemberExpression","start":7728,"end":7734,"object":{"type":"Identifier","start":7728,"end":7731,"name":"req"},"property":{"type":"Identifier","start":7732,"end":7734,"name":"id"},"computed":false}]}},{"type":"ExpressionStatement","start":7753,"end":7791,"expression":{"type":"CallExpression","start":7753,"end":7790,"callee":{"type":"MemberExpression","start":7753,"end":7760,"object":{"type":"Identifier","start":7753,"end":7756,"name":"res"},"property":{"type":"Identifier","start":7757,"end":7760,"name":"set"},"computed":false},"arguments":[{"type":"Literal","start":7761,"end":7775,"value":"Content-Type","raw":"'Content-Type'"},{"type":"Literal","start":7777,"end":7789,"value":"text/plain","raw":"'text/plain'"}]}},{"type":"VariableDeclaration","start":7808,"end":7862,"declarations":[{"type":"VariableDeclarator","start":7814,"end":7861,"id":{"type":"Identifier","start":7814,"end":7821,"name":"reqHint"},"init":{"type":"ConditionalExpression","start":7824,"end":7861,"test":{"type":"MemberExpression","start":7824,"end":7830,"object":{"type":"Identifier","start":7824,"end":7827,"name":"req"},"property":{"type":"Identifier","start":7828,"end":7830,"name":"id"},"computed":false},"consequent":{"type":"TemplateLiteral","start":7833,"end":7856,"expressions":[{"type":"MemberExpression","start":7848,"end":7854,"object":{"type":"Identifier","start":7848,"end":7851,"name":"req"},"property":{"type":"Identifier","start":7852,"end":7854,"name":"id"},"computed":false}],"quasis":[{"type":"TemplateElement","start":7834,"end":7846,"value":{"raw":"Request ID: ","cooked":"Request ID: "},"tail":false},{"type":"TemplateElement","start":7855,"end":7855,"value":{"raw":"","cooked":""},"tail":true}]},"alternate":{"type":"Literal","start":7859,"end":7861,"value":"","raw":"''"}}}],"kind":"const"},{"type":"ExpressionStatement","start":7879,"end":8109,"expression":{"type":"CallExpression","start":7879,"end":8108,"callee":{"type":"Identifier","start":7879,"end":7883,"name":"send"},"arguments":[{"type":"CallExpression","start":7884,"end":8107,"callee":{"type":"MemberExpression","start":7884,"end":8101,"object":{"type":"ArrayExpression","start":7884,"end":8096,"elements":[{"type":"Literal","start":7906,"end":7961,"value":"Companion was unable to complete the OAuth process :(","raw":"'Companion was unable to complete the OAuth process :('"},{"type":"Literal","start":7983,"end":8049,"value":"Error: User session is missing or the Provider was misconfigured","raw":"'Error: User session is missing or the Provider was misconfigured'"},{"type":"Identifier","start":8071,"end":8078,"name":"reqHint"}]},"property":{"type":"Identifier","start":8097,"end":8101,"name":"join"},"computed":false},"arguments":[{"type":"Literal","start":8102,"end":8106,"value":"\n","raw":"'\\n'"}]}]}}]},"alternate":{"type":"BlockStatement","start":8141,"end":8184,"body":[{"type":"ExpressionStatement","start":8159,"end":8170,"expression":{"type":"CallExpression","start":8159,"end":8169,"callee":{"type":"Identifier","start":8159,"end":8163,"name":"send"},"arguments":[{"type":"Identifier","start":8164,"end":8168,"name":"body"}]}}]}}]}},"kind":"init"}]}}]}}]}}],"kind":"const"},{"type":"VariableDeclaration","start":8244,"end":10957,"declarations":[{"type":"VariableDeclarator","start":8250,"end":10956,"id":{"type":"Identifier","start":8250,"end":8270,"name":"getOptionsMiddleware"},"init":{"type":"ArrowFunctionExpression","start":8273,"end":10956,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":8274,"end":8281,"name":"options"}],"body":{"type":"BlockStatement","start":8286,"end":10956,"body":[{"type":"VariableDeclaration","start":8292,"end":8312,"declarations":[{"type":"VariableDeclarator","start":8296,"end":8311,"id":{"type":"Identifier","start":8296,"end":8304,"name":"s3Client"},"init":{"type":"Literal","start":8307,"end":8311,"value":null,"raw":"null"}}],"kind":"let"},{"type":"IfStatement","start":8317,"end":10169,"test":{"type":"MemberExpression","start":8321,"end":8347,"object":{"type":"MemberExpression","start":8321,"end":8344,"object":{"type":"Identifier","start":8321,"end":8328,"name":"options"},"property":{"type":"Identifier","start":8329,"end":8344,"name":"providerOptions"},"computed":false},"property":{"type":"Identifier","start":8345,"end":8347,"name":"s3"},"computed":false},"consequent":{"type":"BlockStatement","start":8349,"end":10169,"body":[{"type":"VariableDeclaration","start":8359,"end":8400,"declarations":[{"type":"VariableDeclarator","start":8365,"end":8399,"id":{"type":"Identifier","start":8365,"end":8367,"name":"S3"},"init":{"type":"CallExpression","start":8370,"end":8399,"callee":{"type":"Identifier","start":8370,"end":8377,"name":"require"},"arguments":[{"type":"Literal","start":8378,"end":8398,"value":"aws-sdk/clients/s3","raw":"'aws-sdk/clients/s3'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":8409,"end":8440,"declarations":[{"type":"VariableDeclarator","start":8415,"end":8439,"id":{"type":"Identifier","start":8415,"end":8418,"name":"AWS"},"init":{"type":"CallExpression","start":8421,"end":8439,"callee":{"type":"Identifier","start":8421,"end":8428,"name":"require"},"arguments":[{"type":"Literal","start":8429,"end":8438,"value":"aws-sdk","raw":"'aws-sdk'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":8449,"end":8502,"declarations":[{"type":"VariableDeclarator","start":8455,"end":8501,"id":{"type":"Identifier","start":8455,"end":8472,"name":"s3ProviderOptions"},"init":{"type":"MemberExpression","start":8475,"end":8501,"object":{"type":"MemberExpression","start":8475,"end":8498,"object":{"type":"Identifier","start":8475,"end":8482,"name":"options"},"property":{"type":"Identifier","start":8483,"end":8498,"name":"providerOptions"},"computed":false},"property":{"type":"Identifier","start":8499,"end":8501,"name":"s3"},"computed":false}}],"kind":"const"},{"type":"IfStatement","start":8511,"end":8895,"test":{"type":"LogicalExpression","start":8515,"end":8581,"left":{"type":"MemberExpression","start":8515,"end":8544,"object":{"type":"Identifier","start":8515,"end":8532,"name":"s3ProviderOptions"},"property":{"type":"Identifier","start":8533,"end":8544,"name":"accessKeyId"},"computed":false},"operator":"||","right":{"type":"MemberExpression","start":8548,"end":8581,"object":{"type":"Identifier","start":8548,"end":8565,"name":"s3ProviderOptions"},"property":{"type":"Identifier","start":8566,"end":8581,"name":"secretAccessKey"},"computed":false}},"consequent":{"type":"BlockStatement","start":8583,"end":8895,"body":[{"type":"ThrowStatement","start":8597,"end":8885,"argument":{"type":"NewExpression","start":8603,"end":8884,"callee":{"type":"Identifier","start":8607,"end":8612,"name":"Error"},"arguments":[{"type":"Literal","start":8613,"end":8883,"value":"Found `providerOptions.s3.accessKeyId` or `providerOptions.s3.secretAccessKey` configuration, but Companion requires `key` and `secret` option names instead. Please use the `key` property instead of `accessKeyId` and the `secret` property instead of `secretAccessKey`.","raw":"'Found `providerOptions.s3.accessKeyId` or `providerOptions.s3.secretAccessKey` configuration, but Companion requires `key` and `secret` option names instead. Please use the `key` property instead of `accessKeyId` and the `secret` property instead of `secretAccessKey`.'"}]}}]},"alternate":null},{"type":"VariableDeclaration","start":8904,"end":8964,"declarations":[{"type":"VariableDeclarator","start":8910,"end":8963,"id":{"type":"Identifier","start":8910,"end":8926,"name":"rawClientOptions"},"init":{"type":"MemberExpression","start":8929,"end":8963,"object":{"type":"Identifier","start":8929,"end":8946,"name":"s3ProviderOptions"},"property":{"type":"Identifier","start":8947,"end":8963,"name":"awsClientOptions"},"computed":false}}],"kind":"const"},{"type":"IfStatement","start":8973,"end":9337,"test":{"type":"LogicalExpression","start":8977,"end":9063,"left":{"type":"Identifier","start":8977,"end":8993,"name":"rawClientOptions"},"operator":"&&","right":{"type":"LogicalExpression","start":8998,"end":9062,"left":{"type":"MemberExpression","start":8998,"end":9026,"object":{"type":"Identifier","start":8998,"end":9014,"name":"rawClientOptions"},"property":{"type":"Identifier","start":9015,"end":9026,"name":"accessKeyId"},"computed":false},"operator":"||","right":{"type":"MemberExpression","start":9030,"end":9062,"object":{"type":"Identifier","start":9030,"end":9046,"name":"rawClientOptions"},"property":{"type":"Identifier","start":9047,"end":9062,"name":"secretAccessKey"},"computed":false}}},"consequent":{"type":"BlockStatement","start":9065,"end":9337,"body":[{"type":"ThrowStatement","start":9079,"end":9327,"argument":{"type":"NewExpression","start":9085,"end":9326,"callee":{"type":"Identifier","start":9089,"end":9094,"name":"Error"},"arguments":[{"type":"Literal","start":9095,"end":9325,"value":"Found unsupported `providerOptions.s3.awsClientOptions.accessKeyId` or `providerOptions.s3.awsClientOptions.secretAccessKey` configuration. Please use the `providerOptions.s3.key` and `providerOptions.s3.secret` options instead.","raw":"'Found unsupported `providerOptions.s3.awsClientOptions.accessKeyId` or `providerOptions.s3.awsClientOptions.secretAccessKey` configuration. Please use the `providerOptions.s3.key` and `providerOptions.s3.secret` options instead.'"}]}}]},"alternate":null},{"type":"VariableDeclaration","start":9346,"end":9654,"declarations":[{"type":"VariableDeclarator","start":9352,"end":9653,"id":{"type":"Identifier","start":9352,"end":9367,"name":"s3ClientOptions"},"init":{"type":"CallExpression","start":9370,"end":9653,"callee":{"type":"MemberExpression","start":9370,"end":9383,"object":{"type":"Identifier","start":9370,"end":9376,"name":"Object"},"property":{"type":"Identifier","start":9377,"end":9383,"name":"assign"},"computed":false},"arguments":[{"type":"ObjectExpression","start":9384,"end":9634,"properties":[{"type":"Property","start":9398,"end":9420,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":9398,"end":9414,"name":"signatureVersion"},"value":{"type":"Literal","start":9416,"end":9420,"value":"v4","raw":"'v4'"},"kind":"init"},{"type":"Property","start":9434,"end":9470,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":9434,"end":9442,"name":"endpoint"},"value":{"type":"MemberExpression","start":9444,"end":9470,"object":{"type":"Identifier","start":9444,"end":9461,"name":"s3ProviderOptions"},"property":{"type":"Identifier","start":9462,"end":9470,"name":"endpoint"},"computed":false},"kind":"init"},{"type":"Property","start":9484,"end":9516,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":9484,"end":9490,"name":"region"},"value":{"type":"MemberExpression","start":9492,"end":9516,"object":{"type":"Identifier","start":9492,"end":9509,"name":"s3ProviderOptions"},"property":{"type":"Identifier","start":9510,"end":9516,"name":"region"},"computed":false},"kind":"init"},{"type":"Property","start":9562,"end":9624,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":9562,"end":9583,"name":"useAccelerateEndpoint"},"value":{"type":"MemberExpression","start":9585,"end":9624,"object":{"type":"Identifier","start":9585,"end":9602,"name":"s3ProviderOptions"},"property":{"type":"Identifier","start":9603,"end":9624,"name":"useAccelerateEndpoint"},"computed":false},"kind":"init"}]},{"type":"Identifier","start":9636,"end":9652,"name":"rawClientOptions"}]}}],"kind":"const"},{"type":"IfStatement","start":9877,"end":10119,"test":{"type":"LogicalExpression","start":9881,"end":9962,"left":{"type":"LogicalExpression","start":9881,"end":9930,"left":{"type":"MemberExpression","start":9881,"end":9902,"object":{"type":"Identifier","start":9881,"end":9898,"name":"s3ProviderOptions"},"property":{"type":"Identifier","start":9899,"end":9902,"name":"key"},"computed":false},"operator":"&&","right":{"type":"MemberExpression","start":9906,"end":9930,"object":{"type":"Identifier","start":9906,"end":9923,"name":"s3ProviderOptions"},"property":{"type":"Identifier","start":9924,"end":9930,"name":"secret"},"computed":false}},"operator":"&&","right":{"type":"UnaryExpression","start":9934,"end":9962,"operator":"!","prefix":true,"argument":{"type":"MemberExpression","start":9935,"end":9962,"object":{"type":"Identifier","start":9935,"end":9950,"name":"s3ClientOptions"},"property":{"type":"Identifier","start":9951,"end":9962,"name":"credentials"},"computed":false}}},"consequent":{"type":"BlockStatement","start":9964,"end":10119,"body":[{"type":"ExpressionStatement","start":9978,"end":10109,"expression":{"type":"AssignmentExpression","start":9978,"end":10108,"operator":"=","left":{"type":"MemberExpression","start":9978,"end":10005,"object":{"type":"Identifier","start":9978,"end":9993,"name":"s3ClientOptions"},"property":{"type":"Identifier","start":9994,"end":10005,"name":"credentials"},"computed":false},"right":{"type":"NewExpression","start":10008,"end":10108,"callee":{"type":"MemberExpression","start":10012,"end":10027,"object":{"type":"Identifier","start":10012,"end":10015,"name":"AWS"},"property":{"type":"Identifier","start":10016,"end":10027,"name":"Credentials"},"computed":false},"arguments":[{"type":"MemberExpression","start":10028,"end":10049,"object":{"type":"Identifier","start":10028,"end":10045,"name":"s3ProviderOptions"},"property":{"type":"Identifier","start":10046,"end":10049,"name":"key"},"computed":false},{"type":"MemberExpression","start":10051,"end":10075,"object":{"type":"Identifier","start":10051,"end":10068,"name":"s3ProviderOptions"},"property":{"type":"Identifier","start":10069,"end":10075,"name":"secret"},"computed":false},{"type":"MemberExpression","start":10077,"end":10107,"object":{"type":"Identifier","start":10077,"end":10094,"name":"s3ProviderOptions"},"property":{"type":"Identifier","start":10095,"end":10107,"name":"sessionToken"},"computed":false}]}}}]},"alternate":null},{"type":"ExpressionStatement","start":10128,"end":10163,"expression":{"type":"AssignmentExpression","start":10128,"end":10162,"operator":"=","left":{"type":"Identifier","start":10128,"end":10136,"name":"s3Client"},"right":{"type":"NewExpression","start":10139,"end":10162,"callee":{"type":"Identifier","start":10143,"end":10145,"name":"S3"},"arguments":[{"type":"Identifier","start":10146,"end":10161,"name":"s3ClientOptions"}]}}}]},"alternate":null},{"type":"VariableDeclaration","start":10274,"end":10931,"declarations":[{"type":"VariableDeclarator","start":10280,"end":10930,"id":{"type":"Identifier","start":10280,"end":10290,"name":"middleware"},"init":{"type":"ArrowFunctionExpression","start":10293,"end":10930,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":10294,"end":10297,"name":"req"},{"type":"Identifier","start":10299,"end":10302,"name":"res"},{"type":"Identifier","start":10304,"end":10308,"name":"next"}],"body":{"type":"BlockStatement","start":10313,"end":10930,"body":[{"type":"VariableDeclaration","start":10323,"end":10423,"declarations":[{"type":"VariableDeclarator","start":10329,"end":10422,"id":{"type":"Identifier","start":10329,"end":10345,"name":"versionFromQuery"},"init":{"type":"ConditionalExpression","start":10348,"end":10422,"test":{"type":"MemberExpression","start":10348,"end":10370,"object":{"type":"MemberExpression","start":10348,"end":10357,"object":{"type":"Identifier","start":10348,"end":10351,"name":"req"},"property":{"type":"Identifier","start":10352,"end":10357,"name":"query"},"computed":false},"property":{"type":"Identifier","start":10358,"end":10370,"name":"uppyVersions"},"computed":false},"consequent":{"type":"CallExpression","start":10373,"end":10415,"callee":{"type":"Identifier","start":10373,"end":10391,"name":"decodeURIComponent"},"arguments":[{"type":"MemberExpression","start":10392,"end":10414,"object":{"type":"MemberExpression","start":10392,"end":10401,"object":{"type":"Identifier","start":10392,"end":10395,"name":"req"},"property":{"type":"Identifier","start":10396,"end":10401,"name":"query"},"computed":false},"property":{"type":"Identifier","start":10402,"end":10414,"name":"uppyVersions"},"computed":false}]},"alternate":{"type":"Literal","start":10418,"end":10422,"value":null,"raw":"null"}}}],"kind":"const"},{"type":"ExpressionStatement","start":10432,"end":10716,"expression":{"type":"AssignmentExpression","start":10432,"end":10715,"operator":"=","left":{"type":"MemberExpression","start":10432,"end":10445,"object":{"type":"Identifier","start":10432,"end":10435,"name":"req"},"property":{"type":"Identifier","start":10436,"end":10445,"name":"companion"},"computed":false},"right":{"type":"ObjectExpression","start":10448,"end":10715,"properties":[{"type":"Property","start":10462,"end":10469,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":10462,"end":10469,"name":"options"},"kind":"init","value":{"type":"Identifier","start":10462,"end":10469,"name":"options"}},{"type":"Property","start":10483,"end":10491,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":10483,"end":10491,"name":"s3Client"},"kind":"init","value":{"type":"Identifier","start":10483,"end":10491,"name":"s3Client"}},{"type":"Property","start":10505,"end":10572,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":10505,"end":10514,"name":"authToken"},"value":{"type":"LogicalExpression","start":10516,"end":10572,"left":{"type":"CallExpression","start":10516,"end":10545,"callee":{"type":"MemberExpression","start":10516,"end":10526,"object":{"type":"Identifier","start":10516,"end":10519,"name":"req"},"property":{"type":"Identifier","start":10520,"end":10526,"name":"header"},"computed":false},"arguments":[{"type":"Literal","start":10527,"end":10544,"value":"uppy-auth-token","raw":"'uppy-auth-token'"}]},"operator":"||","right":{"type":"MemberExpression","start":10549,"end":10572,"object":{"type":"MemberExpression","start":10549,"end":10558,"object":{"type":"Identifier","start":10549,"end":10552,"name":"req"},"property":{"type":"Identifier","start":10553,"end":10558,"name":"query"},"computed":false},"property":{"type":"Identifier","start":10559,"end":10572,"name":"uppyAuthToken"},"computed":false}},"kind":"init"},{"type":"Property","start":10586,"end":10659,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":10586,"end":10599,"name":"clientVersion"},"value":{"type":"LogicalExpression","start":10601,"end":10659,"left":{"type":"LogicalExpression","start":10601,"end":10648,"left":{"type":"CallExpression","start":10601,"end":10628,"callee":{"type":"MemberExpression","start":10601,"end":10611,"object":{"type":"Identifier","start":10601,"end":10604,"name":"req"},"property":{"type":"Identifier","start":10605,"end":10611,"name":"header"},"computed":false},"arguments":[{"type":"Literal","start":10612,"end":10627,"value":"uppy-versions","raw":"'uppy-versions'"}]},"operator":"||","right":{"type":"Identifier","start":10632,"end":10648,"name":"versionFromQuery"}},"operator":"||","right":{"type":"Literal","start":10652,"end":10659,"value":"1.0.0","raw":"'1.0.0'"}},"kind":"init"},{"type":"Property","start":10673,"end":10705,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":10673,"end":10681,"name":"buildURL"},"value":{"type":"CallExpression","start":10683,"end":10705,"callee":{"type":"Identifier","start":10683,"end":10696,"name":"getURLBuilder"},"arguments":[{"type":"Identifier","start":10697,"end":10704,"name":"options"}]},"kind":"init"}]}}},{"type":"ExpressionStatement","start":10725,"end":10819,"expression":{"type":"CallExpression","start":10725,"end":10818,"callee":{"type":"MemberExpression","start":10725,"end":10736,"object":{"type":"Identifier","start":10725,"end":10731,"name":"logger"},"property":{"type":"Identifier","start":10732,"end":10736,"name":"info"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":10737,"end":10789,"expressions":[{"type":"MemberExpression","start":10760,"end":10787,"object":{"type":"MemberExpression","start":10760,"end":10773,"object":{"type":"Identifier","start":10760,"end":10763,"name":"req"},"property":{"type":"Identifier","start":10764,"end":10773,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":10774,"end":10787,"name":"clientVersion"},"computed":false}],"quasis":[{"type":"TemplateElement","start":10738,"end":10758,"value":{"raw":"uppy client version ","cooked":"uppy client version "},"tail":false},{"type":"TemplateElement","start":10788,"end":10788,"value":{"raw":"","cooked":""},"tail":true}]},{"type":"Literal","start":10791,"end":10817,"value":"companion.client.version","raw":"'companion.client.version'"}]}},{"type":"ExpressionStatement","start":10883,"end":10908,"expression":{"type":"AssignmentExpression","start":10883,"end":10907,"operator":"=","left":{"type":"MemberExpression","start":10883,"end":10891,"object":{"type":"Identifier","start":10883,"end":10886,"name":"req"},"property":{"type":"Identifier","start":10887,"end":10891,"name":"uppy"},"computed":false},"right":{"type":"MemberExpression","start":10894,"end":10907,"object":{"type":"Identifier","start":10894,"end":10897,"name":"req"},"property":{"type":"Identifier","start":10898,"end":10907,"name":"companion"},"computed":false}}},{"type":"ExpressionStatement","start":10917,"end":10924,"expression":{"type":"CallExpression","start":10917,"end":10923,"callee":{"type":"Identifier","start":10917,"end":10921,"name":"next"},"arguments":[]}}]}}}],"kind":"const"},{"type":"ReturnStatement","start":10936,"end":10954,"argument":{"type":"Identifier","start":10943,"end":10953,"name":"middleware"}}]}}}],"kind":"const"},{"type":"VariableDeclaration","start":11111,"end":11750,"declarations":[{"type":"VariableDeclarator","start":11117,"end":11749,"id":{"type":"Identifier","start":11117,"end":11127,"name":"maskLogger"},"init":{"type":"ArrowFunctionExpression","start":11130,"end":11749,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":11131,"end":11147,"name":"companionOptions"}],"body":{"type":"BlockStatement","start":11152,"end":11749,"body":[{"type":"VariableDeclaration","start":11158,"end":11177,"declarations":[{"type":"VariableDeclarator","start":11164,"end":11176,"id":{"type":"Identifier","start":11164,"end":11171,"name":"secrets"},"init":{"type":"ArrayExpression","start":11174,"end":11176,"elements":[]}}],"kind":"const"},{"type":"VariableDeclaration","start":11182,"end":11244,"declarations":[{"type":"VariableDeclarator","start":11188,"end":11243,"id":{"type":"ObjectPattern","start":11188,"end":11224,"properties":[{"type":"Property","start":11190,"end":11205,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":11190,"end":11205,"name":"providerOptions"},"kind":"init","value":{"type":"Identifier","start":11190,"end":11205,"name":"providerOptions"}},{"type":"Property","start":11207,"end":11222,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":11207,"end":11222,"name":"customProviders"},"kind":"init","value":{"type":"Identifier","start":11207,"end":11222,"name":"customProviders"}}]},"init":{"type":"Identifier","start":11227,"end":11243,"name":"companionOptions"}}],"kind":"const"},{"type":"ExpressionStatement","start":11249,"end":11427,"expression":{"type":"CallExpression","start":11249,"end":11426,"callee":{"type":"MemberExpression","start":11249,"end":11285,"object":{"type":"CallExpression","start":11249,"end":11277,"callee":{"type":"MemberExpression","start":11249,"end":11260,"object":{"type":"Identifier","start":11249,"end":11255,"name":"Object"},"property":{"type":"Identifier","start":11256,"end":11260,"name":"keys"},"computed":false},"arguments":[{"type":"Identifier","start":11261,"end":11276,"name":"providerOptions"}]},"property":{"type":"Identifier","start":11278,"end":11285,"name":"forEach"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":11286,"end":11425,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":11287,"end":11295,"name":"provider"}],"body":{"type":"BlockStatement","start":11300,"end":11425,"body":[{"type":"IfStatement","start":11310,"end":11419,"test":{"type":"MemberExpression","start":11314,"end":11346,"object":{"type":"MemberExpression","start":11314,"end":11339,"object":{"type":"Identifier","start":11314,"end":11329,"name":"providerOptions"},"property":{"type":"Identifier","start":11330,"end":11338,"name":"provider"},"computed":true},"property":{"type":"Identifier","start":11340,"end":11346,"name":"secret"},"computed":false},"consequent":{"type":"BlockStatement","start":11348,"end":11419,"body":[{"type":"ExpressionStatement","start":11362,"end":11409,"expression":{"type":"CallExpression","start":11362,"end":11408,"callee":{"type":"MemberExpression","start":11362,"end":11374,"object":{"type":"Identifier","start":11362,"end":11369,"name":"secrets"},"property":{"type":"Identifier","start":11370,"end":11374,"name":"push"},"computed":false},"arguments":[{"type":"MemberExpression","start":11375,"end":11407,"object":{"type":"MemberExpression","start":11375,"end":11400,"object":{"type":"Identifier","start":11375,"end":11390,"name":"providerOptions"},"property":{"type":"Identifier","start":11391,"end":11399,"name":"provider"},"computed":true},"property":{"type":"Identifier","start":11401,"end":11407,"name":"secret"},"computed":false}]}}]},"alternate":null}]}}]}},{"type":"IfStatement","start":11432,"end":11713,"test":{"type":"Identifier","start":11436,"end":11451,"name":"customProviders"},"consequent":{"type":"BlockStatement","start":11453,"end":11713,"body":[{"type":"ExpressionStatement","start":11463,"end":11707,"expression":{"type":"CallExpression","start":11463,"end":11706,"callee":{"type":"MemberExpression","start":11463,"end":11499,"object":{"type":"CallExpression","start":11463,"end":11491,"callee":{"type":"MemberExpression","start":11463,"end":11474,"object":{"type":"Identifier","start":11463,"end":11469,"name":"Object"},"property":{"type":"Identifier","start":11470,"end":11474,"name":"keys"},"computed":false},"arguments":[{"type":"Identifier","start":11475,"end":11490,"name":"customProviders"}]},"property":{"type":"Identifier","start":11492,"end":11499,"name":"forEach"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":11500,"end":11705,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":11501,"end":11509,"name":"provider"}],"body":{"type":"BlockStatement","start":11514,"end":11705,"body":[{"type":"IfStatement","start":11528,"end":11695,"test":{"type":"LogicalExpression","start":11532,"end":11607,"left":{"type":"MemberExpression","start":11532,"end":11564,"object":{"type":"MemberExpression","start":11532,"end":11557,"object":{"type":"Identifier","start":11532,"end":11547,"name":"customProviders"},"property":{"type":"Identifier","start":11548,"end":11556,"name":"provider"},"computed":true},"property":{"type":"Identifier","start":11558,"end":11564,"name":"config"},"computed":false},"operator":"&&","right":{"type":"MemberExpression","start":11568,"end":11607,"object":{"type":"MemberExpression","start":11568,"end":11600,"object":{"type":"MemberExpression","start":11568,"end":11593,"object":{"type":"Identifier","start":11568,"end":11583,"name":"customProviders"},"property":{"type":"Identifier","start":11584,"end":11592,"name":"provider"},"computed":true},"property":{"type":"Identifier","start":11594,"end":11600,"name":"config"},"computed":false},"property":{"type":"Identifier","start":11601,"end":11607,"name":"secret"},"computed":false}},"consequent":{"type":"BlockStatement","start":11609,"end":11695,"body":[{"type":"ExpressionStatement","start":11627,"end":11681,"expression":{"type":"CallExpression","start":11627,"end":11680,"callee":{"type":"MemberExpression","start":11627,"end":11639,"object":{"type":"Identifier","start":11627,"end":11634,"name":"secrets"},"property":{"type":"Identifier","start":11635,"end":11639,"name":"push"},"computed":false},"arguments":[{"type":"MemberExpression","start":11640,"end":11679,"object":{"type":"MemberExpression","start":11640,"end":11672,"object":{"type":"MemberExpression","start":11640,"end":11665,"object":{"type":"Identifier","start":11640,"end":11655,"name":"customProviders"},"property":{"type":"Identifier","start":11656,"end":11664,"name":"provider"},"computed":true},"property":{"type":"Identifier","start":11666,"end":11672,"name":"config"},"computed":false},"property":{"type":"Identifier","start":11673,"end":11679,"name":"secret"},"computed":false}]}}]},"alternate":null}]}}]}}]},"alternate":null},{"type":"ExpressionStatement","start":11718,"end":11747,"expression":{"type":"CallExpression","start":11718,"end":11746,"callee":{"type":"MemberExpression","start":11718,"end":11737,"object":{"type":"Identifier","start":11718,"end":11724,"name":"logger"},"property":{"type":"Identifier","start":11725,"end":11737,"name":"setMaskables"},"computed":false},"arguments":[{"type":"Identifier","start":11738,"end":11745,"name":"secrets"}]}}]}}}],"kind":"const"},{"type":"VariableDeclaration","start":11979,"end":12956,"declarations":[{"type":"VariableDeclarator","start":11985,"end":12955,"id":{"type":"Identifier","start":11985,"end":11999,"name":"validateConfig"},"init":{"type":"ArrowFunctionExpression","start":12002,"end":12955,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":12003,"end":12019,"name":"companionOptions"}],"body":{"type":"BlockStatement","start":12024,"end":12955,"body":[{"type":"VariableDeclaration","start":12030,"end":12093,"declarations":[{"type":"VariableDeclarator","start":12036,"end":12092,"id":{"type":"Identifier","start":12036,"end":12052,"name":"mandatoryOptions"},"init":{"type":"ArrayExpression","start":12055,"end":12092,"elements":[{"type":"Literal","start":12056,"end":12064,"value":"secret","raw":"'secret'"},{"type":"Literal","start":12066,"end":12076,"value":"filePath","raw":"'filePath'"},{"type":"Literal","start":12078,"end":12091,"value":"server.host","raw":"'server.host'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":12126,"end":12149,"declarations":[{"type":"VariableDeclarator","start":12132,"end":12148,"id":{"type":"Identifier","start":12132,"end":12143,"name":"unspecified"},"init":{"type":"ArrayExpression","start":12146,"end":12148,"elements":[]}}],"kind":"const"},{"type":"ExpressionStatement","start":12154,"end":12363,"expression":{"type":"CallExpression","start":12154,"end":12362,"callee":{"type":"MemberExpression","start":12154,"end":12178,"object":{"type":"Identifier","start":12154,"end":12170,"name":"mandatoryOptions"},"property":{"type":"Identifier","start":12171,"end":12178,"name":"forEach"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":12179,"end":12361,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":12180,"end":12181,"name":"i"}],"body":{"type":"BlockStatement","start":12186,"end":12361,"body":[{"type":"VariableDeclaration","start":12196,"end":12295,"declarations":[{"type":"VariableDeclarator","start":12202,"end":12294,"id":{"type":"Identifier","start":12202,"end":12207,"name":"value"},"init":{"type":"CallExpression","start":12210,"end":12294,"callee":{"type":"MemberExpression","start":12210,"end":12229,"object":{"type":"CallExpression","start":12210,"end":12222,"callee":{"type":"MemberExpression","start":12210,"end":12217,"object":{"type":"Identifier","start":12210,"end":12211,"name":"i"},"property":{"type":"Identifier","start":12212,"end":12217,"name":"split"},"computed":false},"arguments":[{"type":"Literal","start":12218,"end":12221,"value":".","raw":"'.'"}]},"property":{"type":"Identifier","start":12223,"end":12229,"name":"reduce"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":12230,"end":12275,"id":null,"expression":true,"generator":false,"async":false,"params":[{"type":"Identifier","start":12231,"end":12235,"name":"prev"},{"type":"Identifier","start":12237,"end":12241,"name":"curr"}],"body":{"type":"ConditionalExpression","start":12246,"end":12275,"test":{"type":"Identifier","start":12246,"end":12250,"name":"prev"},"consequent":{"type":"MemberExpression","start":12253,"end":12263,"object":{"type":"Identifier","start":12253,"end":12257,"name":"prev"},"property":{"type":"Identifier","start":12258,"end":12262,"name":"curr"},"computed":true},"alternate":{"type":"Identifier","start":12266,"end":12275,"name":"undefined"}}},{"type":"Identifier","start":12277,"end":12293,"name":"companionOptions"}]}}],"kind":"const"},{"type":"IfStatement","start":12304,"end":12355,"test":{"type":"UnaryExpression","start":12308,"end":12314,"operator":"!","prefix":true,"argument":{"type":"Identifier","start":12309,"end":12314,"name":"value"}},"consequent":{"type":"ExpressionStatement","start":12328,"end":12355,"expression":{"type":"CallExpression","start":12328,"end":12354,"callee":{"type":"MemberExpression","start":12328,"end":12344,"object":{"type":"Identifier","start":12328,"end":12339,"name":"unspecified"},"property":{"type":"Identifier","start":12340,"end":12344,"name":"push"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":12345,"end":12353,"expressions":[{"type":"Identifier","start":12349,"end":12350,"name":"i"}],"quasis":[{"type":"TemplateElement","start":12346,"end":12347,"value":{"raw":"\"","cooked":"\""},"tail":false},{"type":"TemplateElement","start":12351,"end":12352,"value":{"raw":"\"","cooked":"\""},"tail":true}]}]}},"alternate":null}]}}]}},{"type":"IfStatement","start":12421,"end":12613,"test":{"type":"MemberExpression","start":12425,"end":12443,"object":{"type":"Identifier","start":12425,"end":12436,"name":"unspecified"},"property":{"type":"Identifier","start":12437,"end":12443,"name":"length"},"computed":false},"consequent":{"type":"BlockStatement","start":12445,"end":12613,"body":[{"type":"VariableDeclaration","start":12455,"end":12534,"declarations":[{"type":"VariableDeclarator","start":12461,"end":12533,"id":{"type":"Identifier","start":12461,"end":12474,"name":"messagePrefix"},"init":{"type":"Literal","start":12477,"end":12533,"value":"Please specify the following options to use companion:","raw":"'Please specify the following options to use companion:'"}}],"kind":"const"},{"type":"ThrowStatement","start":12543,"end":12607,"argument":{"type":"NewExpression","start":12549,"end":12606,"callee":{"type":"Identifier","start":12553,"end":12558,"name":"Error"},"arguments":[{"type":"TemplateLiteral","start":12559,"end":12605,"expressions":[{"type":"Identifier","start":12562,"end":12575,"name":"messagePrefix"},{"type":"CallExpression","start":12580,"end":12603,"callee":{"type":"MemberExpression","start":12580,"end":12596,"object":{"type":"Identifier","start":12580,"end":12591,"name":"unspecified"},"property":{"type":"Identifier","start":12592,"end":12596,"name":"join"},"computed":false},"arguments":[{"type":"Literal","start":12597,"end":12602,"value":",\n","raw":"',\\n'"}]}],"quasis":[{"type":"TemplateElement","start":12560,"end":12560,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":12576,"end":12578,"value":{"raw":"\\n","cooked":"\n"},"tail":false},{"type":"TemplateElement","start":12604,"end":12604,"value":{"raw":"","cooked":""},"tail":true}]}]}}]},"alternate":null},{"type":"TryStatement","start":12681,"end":12953,"block":{"type":"BlockStatement","start":12685,"end":12788,"body":[{"type":"ExpressionStatement","start":12717,"end":12782,"expression":{"type":"CallExpression","start":12717,"end":12781,"callee":{"type":"MemberExpression","start":12717,"end":12730,"object":{"type":"Identifier","start":12717,"end":12719,"name":"fs"},"property":{"type":"Identifier","start":12720,"end":12730,"name":"accessSync"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":12731,"end":12761,"expressions":[{"type":"MemberExpression","start":12734,"end":12759,"object":{"type":"Identifier","start":12734,"end":12750,"name":"companionOptions"},"property":{"type":"Identifier","start":12751,"end":12759,"name":"filePath"},"computed":false}],"quasis":[{"type":"TemplateElement","start":12732,"end":12732,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":12760,"end":12760,"value":{"raw":"","cooked":""},"tail":true}]},{"type":"BinaryExpression","start":12763,"end":12780,"left":{"type":"MemberExpression","start":12763,"end":12770,"object":{"type":"Identifier","start":12763,"end":12765,"name":"fs"},"property":{"type":"Identifier","start":12766,"end":12770,"name":"R_OK"},"computed":false},"operator":"|","right":{"type":"MemberExpression","start":12773,"end":12780,"object":{"type":"Identifier","start":12773,"end":12775,"name":"fs"},"property":{"type":"Identifier","start":12776,"end":12780,"name":"W_OK"},"computed":false}}]}}]},"handler":{"type":"CatchClause","start":12793,"end":12953,"param":{"type":"Identifier","start":12800,"end":12803,"name":"err"},"body":{"type":"BlockStatement","start":12805,"end":12953,"body":[{"type":"ThrowStatement","start":12815,"end":12947,"argument":{"type":"NewExpression","start":12821,"end":12946,"callee":{"type":"Identifier","start":12825,"end":12830,"name":"Error"},"arguments":[{"type":"TemplateLiteral","start":12831,"end":12945,"expressions":[{"type":"MemberExpression","start":12848,"end":12873,"object":{"type":"Identifier","start":12848,"end":12864,"name":"companionOptions"},"property":{"type":"Identifier","start":12865,"end":12873,"name":"filePath"},"computed":false}],"quasis":[{"type":"TemplateElement","start":12832,"end":12846,"value":{"raw":"No access to \"","cooked":"No access to \""},"tail":false},{"type":"TemplateElement","start":12874,"end":12944,"value":{"raw":"\". Please ensure the directory exists and with read/write permissions.","cooked":"\". Please ensure the directory exists and with read/write permissions."},"tail":true}]}]}}]}},"finalizer":null}]}}}],"kind":"const"}],"sourceType":"script"}