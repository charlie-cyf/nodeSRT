{"type":"Program","start":0,"end":7882,"body":[{"type":"VariableDeclaration","start":0,"end":35,"declarations":[{"type":"VariableDeclarator","start":6,"end":34,"id":{"type":"Identifier","start":6,"end":13,"name":"express"},"init":{"type":"CallExpression","start":16,"end":34,"callee":{"type":"Identifier","start":16,"end":23,"name":"require"},"arguments":[{"type":"Literal","start":24,"end":33,"value":"express","raw":"'express'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":36,"end":70,"declarations":[{"type":"VariableDeclarator","start":42,"end":69,"id":{"type":"Identifier","start":42,"end":44,"name":"qs"},"init":{"type":"CallExpression","start":47,"end":69,"callee":{"type":"Identifier","start":47,"end":54,"name":"require"},"arguments":[{"type":"Literal","start":55,"end":68,"value":"querystring","raw":"'querystring'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":71,"end":113,"declarations":[{"type":"VariableDeclarator","start":77,"end":112,"id":{"type":"Identifier","start":77,"end":86,"name":"companion"},"init":{"type":"CallExpression","start":89,"end":112,"callee":{"type":"Identifier","start":89,"end":96,"name":"require"},"arguments":[{"type":"Literal","start":97,"end":111,"value":"../companion","raw":"'../companion'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":114,"end":147,"declarations":[{"type":"VariableDeclarator","start":120,"end":146,"id":{"type":"Identifier","start":120,"end":126,"name":"helmet"},"init":{"type":"CallExpression","start":129,"end":146,"callee":{"type":"Identifier","start":129,"end":136,"name":"require"},"arguments":[{"type":"Literal","start":137,"end":145,"value":"helmet","raw":"'helmet'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":148,"end":181,"declarations":[{"type":"VariableDeclarator","start":154,"end":180,"id":{"type":"Identifier","start":154,"end":160,"name":"morgan"},"init":{"type":"CallExpression","start":163,"end":180,"callee":{"type":"Identifier","start":163,"end":170,"name":"require"},"arguments":[{"type":"Literal","start":171,"end":179,"value":"morgan","raw":"'morgan'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":182,"end":224,"declarations":[{"type":"VariableDeclarator","start":188,"end":223,"id":{"type":"Identifier","start":188,"end":198,"name":"bodyParser"},"init":{"type":"CallExpression","start":201,"end":223,"callee":{"type":"Identifier","start":201,"end":208,"name":"require"},"arguments":[{"type":"Literal","start":209,"end":222,"value":"body-parser","raw":"'body-parser'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":225,"end":266,"declarations":[{"type":"VariableDeclarator","start":231,"end":265,"id":{"type":"Identifier","start":231,"end":236,"name":"redis"},"init":{"type":"CallExpression","start":239,"end":265,"callee":{"type":"Identifier","start":239,"end":246,"name":"require"},"arguments":[{"type":"Literal","start":247,"end":264,"value":"../server/redis","raw":"'../server/redis'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":267,"end":310,"declarations":[{"type":"VariableDeclarator","start":273,"end":309,"id":{"type":"Identifier","start":273,"end":279,"name":"logger"},"init":{"type":"CallExpression","start":282,"end":309,"callee":{"type":"Identifier","start":282,"end":289,"name":"require"},"arguments":[{"type":"Literal","start":290,"end":308,"value":"../server/logger","raw":"'../server/logger'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":311,"end":367,"declarations":[{"type":"VariableDeclarator","start":317,"end":366,"id":{"type":"ObjectPattern","start":317,"end":329,"properties":[{"type":"Property","start":319,"end":327,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":319,"end":327,"name":"parseURL"},"kind":"init","value":{"type":"Identifier","start":319,"end":327,"name":"parseURL"}}]},"init":{"type":"CallExpression","start":332,"end":366,"callee":{"type":"Identifier","start":332,"end":339,"name":"require"},"arguments":[{"type":"Literal","start":340,"end":365,"value":"../server/helpers/utils","raw":"'../server/helpers/utils'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":368,"end":406,"declarations":[{"type":"VariableDeclarator","start":374,"end":405,"id":{"type":"Identifier","start":374,"end":379,"name":"merge"},"init":{"type":"CallExpression","start":382,"end":405,"callee":{"type":"Identifier","start":382,"end":389,"name":"require"},"arguments":[{"type":"Literal","start":390,"end":404,"value":"lodash.merge","raw":"'lodash.merge'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":421,"end":471,"declarations":[{"type":"VariableDeclarator","start":427,"end":470,"id":{"type":"Identifier","start":427,"end":437,"name":"promBundle"},"init":{"type":"CallExpression","start":440,"end":470,"callee":{"type":"Identifier","start":440,"end":447,"name":"require"},"arguments":[{"type":"Literal","start":448,"end":469,"value":"express-prom-bundle","raw":"'express-prom-bundle'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":472,"end":515,"declarations":[{"type":"VariableDeclarator","start":478,"end":514,"id":{"type":"Identifier","start":478,"end":485,"name":"session"},"init":{"type":"CallExpression","start":488,"end":514,"callee":{"type":"Identifier","start":488,"end":495,"name":"require"},"arguments":[{"type":"Literal","start":496,"end":513,"value":"express-session","raw":"'express-session'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":516,"end":569,"declarations":[{"type":"VariableDeclarator","start":522,"end":568,"id":{"type":"Identifier","start":522,"end":534,"name":"addRequestId"},"init":{"type":"CallExpression","start":537,"end":568,"callee":{"type":"CallExpression","start":537,"end":566,"callee":{"type":"Identifier","start":537,"end":544,"name":"require"},"arguments":[{"type":"Literal","start":545,"end":565,"value":"express-request-id","raw":"'express-request-id'"}]},"arguments":[]}}],"kind":"const"},{"type":"VariableDeclaration","start":570,"end":605,"declarations":[{"type":"VariableDeclarator","start":576,"end":604,"id":{"type":"Identifier","start":576,"end":582,"name":"helper"},"init":{"type":"CallExpression","start":585,"end":604,"callee":{"type":"Identifier","start":585,"end":592,"name":"require"},"arguments":[{"type":"Literal","start":593,"end":603,"value":"./helper","raw":"'./helper'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":620,"end":670,"declarations":[{"type":"VariableDeclarator","start":626,"end":669,"id":{"type":"ObjectPattern","start":626,"end":637,"properties":[{"type":"Property","start":628,"end":635,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":628,"end":635,"name":"version"},"kind":"init","value":{"type":"Identifier","start":628,"end":635,"name":"version"}}]},"init":{"type":"CallExpression","start":640,"end":669,"callee":{"type":"Identifier","start":640,"end":647,"name":"require"},"arguments":[{"type":"Literal","start":648,"end":668,"value":"../../package.json","raw":"'../../package.json'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":671,"end":693,"declarations":[{"type":"VariableDeclarator","start":677,"end":692,"id":{"type":"Identifier","start":677,"end":680,"name":"app"},"init":{"type":"CallExpression","start":683,"end":692,"callee":{"type":"Identifier","start":683,"end":690,"name":"express"},"arguments":[]}}],"kind":"const"},{"type":"VariableDeclaration","start":726,"end":788,"declarations":[{"type":"VariableDeclarator","start":732,"end":787,"id":{"type":"Identifier","start":732,"end":749,"name":"metricsMiddleware"},"init":{"type":"CallExpression","start":752,"end":787,"callee":{"type":"Identifier","start":752,"end":762,"name":"promBundle"},"arguments":[{"type":"ObjectExpression","start":763,"end":786,"properties":[{"type":"Property","start":765,"end":784,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":765,"end":778,"name":"includeMethod"},"value":{"type":"Literal","start":780,"end":784,"value":true,"raw":"true"},"kind":"init"}]}]}}],"kind":"const"},{"type":"VariableDeclaration","start":789,"end":837,"declarations":[{"type":"VariableDeclarator","start":795,"end":836,"id":{"type":"Identifier","start":795,"end":805,"name":"promClient"},"init":{"type":"MemberExpression","start":808,"end":836,"object":{"type":"Identifier","start":808,"end":825,"name":"metricsMiddleware"},"property":{"type":"Identifier","start":826,"end":836,"name":"promClient"},"computed":false}}],"kind":"const"},{"type":"VariableDeclaration","start":838,"end":901,"declarations":[{"type":"VariableDeclarator","start":844,"end":900,"id":{"type":"Identifier","start":844,"end":865,"name":"collectDefaultMetrics"},"init":{"type":"MemberExpression","start":868,"end":900,"object":{"type":"Identifier","start":868,"end":878,"name":"promClient"},"property":{"type":"Identifier","start":879,"end":900,"name":"collectDefaultMetrics"},"computed":false}}],"kind":"const"},{"type":"VariableDeclaration","start":902,"end":995,"declarations":[{"type":"VariableDeclarator","start":908,"end":994,"id":{"type":"Identifier","start":908,"end":920,"name":"promInterval"},"init":{"type":"CallExpression","start":923,"end":994,"callee":{"type":"Identifier","start":923,"end":944,"name":"collectDefaultMetrics"},"arguments":[{"type":"ObjectExpression","start":945,"end":993,"properties":[{"type":"Property","start":947,"end":976,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":947,"end":955,"name":"register"},"value":{"type":"MemberExpression","start":957,"end":976,"object":{"type":"Identifier","start":957,"end":967,"name":"promClient"},"property":{"type":"Identifier","start":968,"end":976,"name":"register"},"computed":false},"kind":"init"},{"type":"Property","start":978,"end":991,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":978,"end":985,"name":"timeout"},"value":{"type":"Literal","start":987,"end":991,"value":5000,"raw":"5000"},"kind":"init"}]}]}}],"kind":"const"},{"type":"VariableDeclaration","start":1033,"end":1141,"declarations":[{"type":"VariableDeclarator","start":1039,"end":1140,"id":{"type":"Identifier","start":1039,"end":1051,"name":"versionGauge"},"init":{"type":"NewExpression","start":1054,"end":1140,"callee":{"type":"MemberExpression","start":1058,"end":1074,"object":{"type":"Identifier","start":1058,"end":1068,"name":"promClient"},"property":{"type":"Identifier","start":1069,"end":1074,"name":"Gauge"},"computed":false},"arguments":[{"type":"ObjectExpression","start":1075,"end":1139,"properties":[{"type":"Property","start":1077,"end":1102,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1077,"end":1081,"name":"name"},"value":{"type":"Literal","start":1083,"end":1102,"value":"companion_version","raw":"'companion_version'"},"kind":"init"},{"type":"Property","start":1104,"end":1137,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1104,"end":1108,"name":"help"},"value":{"type":"Literal","start":1110,"end":1137,"value":"npm version as an integer","raw":"'npm version as an integer'"},"kind":"init"}]}]}}],"kind":"const"},{"type":"VariableDeclaration","start":1156,"end":1209,"declarations":[{"type":"VariableDeclarator","start":1162,"end":1208,"id":{"type":"Identifier","start":1162,"end":1175,"name":"numberVersion"},"init":{"type":"BinaryExpression","start":1178,"end":1208,"left":{"type":"CallExpression","start":1178,"end":1204,"callee":{"type":"MemberExpression","start":1178,"end":1193,"object":{"type":"Identifier","start":1178,"end":1185,"name":"version"},"property":{"type":"Identifier","start":1186,"end":1193,"name":"replace"},"computed":false},"arguments":[{"type":"Literal","start":1194,"end":1199,"value":{},"raw":"/\\D/g","regex":{"pattern":"\\D","flags":"g"}},{"type":"Literal","start":1201,"end":1203,"value":"","raw":"''"}]},"operator":"*","right":{"type":"Literal","start":1207,"end":1208,"value":1,"raw":"1"}}}],"kind":"const"},{"type":"ExpressionStatement","start":1210,"end":1242,"expression":{"type":"CallExpression","start":1210,"end":1241,"callee":{"type":"MemberExpression","start":1210,"end":1226,"object":{"type":"Identifier","start":1210,"end":1222,"name":"versionGauge"},"property":{"type":"Identifier","start":1223,"end":1226,"name":"set"},"computed":false},"arguments":[{"type":"Identifier","start":1227,"end":1240,"name":"numberVersion"}]}},{"type":"IfStatement","start":1243,"end":1310,"test":{"type":"BinaryExpression","start":1247,"end":1272,"left":{"type":"CallExpression","start":1247,"end":1261,"callee":{"type":"MemberExpression","start":1247,"end":1254,"object":{"type":"Identifier","start":1247,"end":1250,"name":"app"},"property":{"type":"Identifier","start":1251,"end":1254,"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":1255,"end":1260,"value":"env","raw":"'env'"}]},"operator":"!==","right":{"type":"Literal","start":1266,"end":1272,"value":"test","raw":"'test'"}},"consequent":{"type":"BlockStatement","start":1274,"end":1310,"body":[{"type":"ExpressionStatement","start":1280,"end":1308,"expression":{"type":"CallExpression","start":1280,"end":1307,"callee":{"type":"Identifier","start":1280,"end":1293,"name":"clearInterval"},"arguments":[{"type":"Identifier","start":1294,"end":1306,"name":"promInterval"}]}}]},"alternate":null},{"type":"VariableDeclaration","start":1382,"end":1447,"declarations":[{"type":"VariableDeclarator","start":1388,"end":1446,"id":{"type":"Identifier","start":1388,"end":1401,"name":"sensitiveKeys"},"init":{"type":"NewExpression","start":1404,"end":1446,"callee":{"type":"Identifier","start":1408,"end":1411,"name":"Set"},"arguments":[{"type":"ArrayExpression","start":1412,"end":1445,"elements":[{"type":"Literal","start":1413,"end":1427,"value":"access_token","raw":"'access_token'"},{"type":"Literal","start":1429,"end":1444,"value":"uppyAuthToken","raw":"'uppyAuthToken'"}]}]}}],"kind":"const"},{"type":"FunctionDeclaration","start":1903,"end":2416,"id":{"type":"Identifier","start":1912,"end":1923,"name":"censorQuery"},"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":1924,"end":1932,"name":"rawQuery"}],"body":{"type":"BlockStatement","start":1934,"end":2416,"body":[{"type":"VariableDeclaration","start":1985,"end":2002,"declarations":[{"type":"VariableDeclarator","start":1991,"end":2001,"id":{"type":"Identifier","start":1991,"end":1996,"name":"query"},"init":{"type":"ObjectExpression","start":1999,"end":2001,"properties":[]}}],"kind":"const"},{"type":"VariableDeclaration","start":2007,"end":2028,"declarations":[{"type":"VariableDeclarator","start":2011,"end":2027,"id":{"type":"Identifier","start":2011,"end":2019,"name":"censored"},"init":{"type":"Literal","start":2022,"end":2027,"value":false,"raw":"false"}}],"kind":"let"},{"type":"ExpressionStatement","start":2033,"end":2382,"expression":{"type":"CallExpression","start":2033,"end":2381,"callee":{"type":"MemberExpression","start":2033,"end":2062,"object":{"type":"CallExpression","start":2033,"end":2054,"callee":{"type":"MemberExpression","start":2033,"end":2044,"object":{"type":"Identifier","start":2033,"end":2039,"name":"Object"},"property":{"type":"Identifier","start":2040,"end":2044,"name":"keys"},"computed":false},"arguments":[{"type":"Identifier","start":2045,"end":2053,"name":"rawQuery"}]},"property":{"type":"Identifier","start":2055,"end":2062,"name":"forEach"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":2063,"end":2380,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":2064,"end":2067,"name":"key"}],"body":{"type":"BlockStatement","start":2072,"end":2380,"body":[{"type":"IfStatement","start":2082,"end":2152,"test":{"type":"BinaryExpression","start":2086,"end":2119,"left":{"type":"UnaryExpression","start":2086,"end":2106,"operator":"typeof","prefix":true,"argument":{"type":"MemberExpression","start":2093,"end":2106,"object":{"type":"Identifier","start":2093,"end":2101,"name":"rawQuery"},"property":{"type":"Identifier","start":2102,"end":2105,"name":"key"},"computed":true}},"operator":"!==","right":{"type":"Literal","start":2111,"end":2119,"value":"string","raw":"'string'"}},"consequent":{"type":"BlockStatement","start":2121,"end":2152,"body":[{"type":"ReturnStatement","start":2135,"end":2142,"argument":null}]},"alternate":null},{"type":"IfStatement","start":2161,"end":2374,"test":{"type":"CallExpression","start":2165,"end":2187,"callee":{"type":"MemberExpression","start":2165,"end":2182,"object":{"type":"Identifier","start":2165,"end":2178,"name":"sensitiveKeys"},"property":{"type":"Identifier","start":2179,"end":2182,"name":"has"},"computed":false},"arguments":[{"type":"Identifier","start":2183,"end":2186,"name":"key"}]},"consequent":{"type":"BlockStatement","start":2189,"end":2309,"body":[{"type":"ExpressionStatement","start":2246,"end":2270,"expression":{"type":"AssignmentExpression","start":2246,"end":2269,"operator":"=","left":{"type":"MemberExpression","start":2246,"end":2256,"object":{"type":"Identifier","start":2246,"end":2251,"name":"query"},"property":{"type":"Identifier","start":2252,"end":2255,"name":"key"},"computed":true},"right":{"type":"Literal","start":2259,"end":2269,"value":"********","raw":"'********'"}}},{"type":"ExpressionStatement","start":2283,"end":2299,"expression":{"type":"AssignmentExpression","start":2283,"end":2298,"operator":"=","left":{"type":"Identifier","start":2283,"end":2291,"name":"censored"},"right":{"type":"Literal","start":2294,"end":2298,"value":true,"raw":"true"}}}]},"alternate":{"type":"BlockStatement","start":2323,"end":2374,"body":[{"type":"ExpressionStatement","start":2337,"end":2364,"expression":{"type":"AssignmentExpression","start":2337,"end":2363,"operator":"=","left":{"type":"MemberExpression","start":2337,"end":2347,"object":{"type":"Identifier","start":2337,"end":2342,"name":"query"},"property":{"type":"Identifier","start":2343,"end":2346,"name":"key"},"computed":true},"right":{"type":"MemberExpression","start":2350,"end":2363,"object":{"type":"Identifier","start":2350,"end":2358,"name":"rawQuery"},"property":{"type":"Identifier","start":2359,"end":2362,"name":"key"},"computed":true}}}]}}]}}]}},{"type":"ReturnStatement","start":2387,"end":2414,"argument":{"type":"ObjectExpression","start":2394,"end":2413,"properties":[{"type":"Property","start":2396,"end":2401,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":2396,"end":2401,"name":"query"},"kind":"init","value":{"type":"Identifier","start":2396,"end":2401,"name":"query"}},{"type":"Property","start":2403,"end":2411,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":2403,"end":2411,"name":"censored"},"kind":"init","value":{"type":"Identifier","start":2403,"end":2411,"name":"censored"}}]}}]}},{"type":"ExpressionStatement","start":2417,"end":2439,"expression":{"type":"CallExpression","start":2417,"end":2438,"callee":{"type":"MemberExpression","start":2417,"end":2424,"object":{"type":"Identifier","start":2417,"end":2420,"name":"app"},"property":{"type":"Identifier","start":2421,"end":2424,"name":"use"},"computed":false},"arguments":[{"type":"Identifier","start":2425,"end":2437,"name":"addRequestId"}]}},{"type":"ExpressionStatement","start":2464,"end":2492,"expression":{"type":"CallExpression","start":2464,"end":2491,"callee":{"type":"MemberExpression","start":2464,"end":2471,"object":{"type":"Identifier","start":2464,"end":2467,"name":"app"},"property":{"type":"Identifier","start":2468,"end":2471,"name":"use"},"computed":false},"arguments":[{"type":"CallExpression","start":2472,"end":2490,"callee":{"type":"Identifier","start":2472,"end":2478,"name":"morgan"},"arguments":[{"type":"Literal","start":2479,"end":2489,"value":"combined","raw":"'combined'"}]}]}},{"type":"ExpressionStatement","start":2493,"end":2677,"expression":{"type":"CallExpression","start":2493,"end":2676,"callee":{"type":"MemberExpression","start":2493,"end":2505,"object":{"type":"Identifier","start":2493,"end":2499,"name":"morgan"},"property":{"type":"Identifier","start":2500,"end":2505,"name":"token"},"computed":false},"arguments":[{"type":"Literal","start":2506,"end":2511,"value":"url","raw":"'url'"},{"type":"ArrowFunctionExpression","start":2513,"end":2675,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":2514,"end":2517,"name":"req"},{"type":"Identifier","start":2519,"end":2522,"name":"res"}],"body":{"type":"BlockStatement","start":2527,"end":2675,"body":[{"type":"VariableDeclaration","start":2533,"end":2584,"declarations":[{"type":"VariableDeclarator","start":2539,"end":2583,"id":{"type":"ObjectPattern","start":2539,"end":2558,"properties":[{"type":"Property","start":2541,"end":2546,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":2541,"end":2546,"name":"query"},"kind":"init","value":{"type":"Identifier","start":2541,"end":2546,"name":"query"}},{"type":"Property","start":2548,"end":2556,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":2548,"end":2556,"name":"censored"},"kind":"init","value":{"type":"Identifier","start":2548,"end":2556,"name":"censored"}}]},"init":{"type":"CallExpression","start":2561,"end":2583,"callee":{"type":"Identifier","start":2561,"end":2572,"name":"censorQuery"},"arguments":[{"type":"MemberExpression","start":2573,"end":2582,"object":{"type":"Identifier","start":2573,"end":2576,"name":"req"},"property":{"type":"Identifier","start":2577,"end":2582,"name":"query"},"computed":false}]}}],"kind":"const"},{"type":"ReturnStatement","start":2589,"end":2673,"argument":{"type":"ConditionalExpression","start":2596,"end":2672,"test":{"type":"Identifier","start":2596,"end":2604,"name":"censored"},"consequent":{"type":"TemplateLiteral","start":2607,"end":2643,"expressions":[{"type":"MemberExpression","start":2610,"end":2618,"object":{"type":"Identifier","start":2610,"end":2613,"name":"req"},"property":{"type":"Identifier","start":2614,"end":2618,"name":"path"},"computed":false},{"type":"CallExpression","start":2622,"end":2641,"callee":{"type":"MemberExpression","start":2622,"end":2634,"object":{"type":"Identifier","start":2622,"end":2624,"name":"qs"},"property":{"type":"Identifier","start":2625,"end":2634,"name":"stringify"},"computed":false},"arguments":[{"type":"Identifier","start":2635,"end":2640,"name":"query"}]}],"quasis":[{"type":"TemplateElement","start":2608,"end":2608,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":2619,"end":2620,"value":{"raw":"?","cooked":"?"},"tail":false},{"type":"TemplateElement","start":2642,"end":2642,"value":{"raw":"","cooked":""},"tail":true}]},"alternate":{"type":"LogicalExpression","start":2646,"end":2672,"left":{"type":"MemberExpression","start":2646,"end":2661,"object":{"type":"Identifier","start":2646,"end":2649,"name":"req"},"property":{"type":"Identifier","start":2650,"end":2661,"name":"originalUrl"},"computed":false},"operator":"||","right":{"type":"MemberExpression","start":2665,"end":2672,"object":{"type":"Identifier","start":2665,"end":2668,"name":"req"},"property":{"type":"Identifier","start":2669,"end":2672,"name":"url"},"computed":false}}}}]}}]}},{"type":"ExpressionStatement","start":2678,"end":3083,"expression":{"type":"CallExpression","start":2678,"end":3082,"callee":{"type":"MemberExpression","start":2678,"end":2690,"object":{"type":"Identifier","start":2678,"end":2684,"name":"morgan"},"property":{"type":"Identifier","start":2685,"end":2690,"name":"token"},"computed":false},"arguments":[{"type":"Literal","start":2691,"end":2701,"value":"referrer","raw":"'referrer'"},{"type":"ArrowFunctionExpression","start":2703,"end":3081,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":2704,"end":2707,"name":"req"},{"type":"Identifier","start":2709,"end":2712,"name":"res"}],"body":{"type":"BlockStatement","start":2717,"end":3081,"body":[{"type":"VariableDeclaration","start":2723,"end":2779,"declarations":[{"type":"VariableDeclarator","start":2729,"end":2778,"id":{"type":"Identifier","start":2729,"end":2732,"name":"ref"},"init":{"type":"LogicalExpression","start":2735,"end":2778,"left":{"type":"MemberExpression","start":2735,"end":2754,"object":{"type":"MemberExpression","start":2735,"end":2746,"object":{"type":"Identifier","start":2735,"end":2738,"name":"req"},"property":{"type":"Identifier","start":2739,"end":2746,"name":"headers"},"computed":false},"property":{"type":"Identifier","start":2747,"end":2754,"name":"referer"},"computed":false},"operator":"||","right":{"type":"MemberExpression","start":2758,"end":2778,"object":{"type":"MemberExpression","start":2758,"end":2769,"object":{"type":"Identifier","start":2758,"end":2761,"name":"req"},"property":{"type":"Identifier","start":2762,"end":2769,"name":"headers"},"computed":false},"property":{"type":"Identifier","start":2770,"end":2778,"name":"referrer"},"computed":false}}}],"kind":"const"},{"type":"IfStatement","start":2784,"end":3079,"test":{"type":"BinaryExpression","start":2788,"end":2811,"left":{"type":"UnaryExpression","start":2788,"end":2798,"operator":"typeof","prefix":true,"argument":{"type":"Identifier","start":2795,"end":2798,"name":"ref"}},"operator":"===","right":{"type":"Literal","start":2803,"end":2811,"value":"string","raw":"'string'"}},"consequent":{"type":"BlockStatement","start":2813,"end":3079,"body":[{"type":"VariableDeclaration","start":2823,"end":2852,"declarations":[{"type":"VariableDeclarator","start":2829,"end":2851,"id":{"type":"Identifier","start":2829,"end":2835,"name":"parsed"},"init":{"type":"CallExpression","start":2838,"end":2851,"callee":{"type":"Identifier","start":2838,"end":2846,"name":"parseURL"},"arguments":[{"type":"Identifier","start":2847,"end":2850,"name":"ref"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":2861,"end":2919,"declarations":[{"type":"VariableDeclarator","start":2867,"end":2918,"id":{"type":"Identifier","start":2867,"end":2875,"name":"rawQuery"},"init":{"type":"CallExpression","start":2878,"end":2918,"callee":{"type":"MemberExpression","start":2878,"end":2886,"object":{"type":"Identifier","start":2878,"end":2880,"name":"qs"},"property":{"type":"Identifier","start":2881,"end":2886,"name":"parse"},"computed":false},"arguments":[{"type":"CallExpression","start":2887,"end":2917,"callee":{"type":"MemberExpression","start":2887,"end":2908,"object":{"type":"MemberExpression","start":2887,"end":2900,"object":{"type":"Identifier","start":2887,"end":2893,"name":"parsed"},"property":{"type":"Identifier","start":2894,"end":2900,"name":"search"},"computed":false},"property":{"type":"Identifier","start":2901,"end":2908,"name":"replace"},"computed":false},"arguments":[{"type":"Literal","start":2909,"end":2912,"value":"?","raw":"'?'"},{"type":"Literal","start":2914,"end":2916,"value":"","raw":"''"}]}]}}],"kind":"const"},{"type":"VariableDeclaration","start":2928,"end":2978,"declarations":[{"type":"VariableDeclarator","start":2934,"end":2977,"id":{"type":"ObjectPattern","start":2934,"end":2953,"properties":[{"type":"Property","start":2936,"end":2941,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":2936,"end":2941,"name":"query"},"kind":"init","value":{"type":"Identifier","start":2936,"end":2941,"name":"query"}},{"type":"Property","start":2943,"end":2951,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":2943,"end":2951,"name":"censored"},"kind":"init","value":{"type":"Identifier","start":2943,"end":2951,"name":"censored"}}]},"init":{"type":"CallExpression","start":2956,"end":2977,"callee":{"type":"Identifier","start":2956,"end":2967,"name":"censorQuery"},"arguments":[{"type":"Identifier","start":2968,"end":2976,"name":"rawQuery"}]}}],"kind":"const"},{"type":"ReturnStatement","start":2987,"end":3073,"argument":{"type":"ConditionalExpression","start":2994,"end":3072,"test":{"type":"Identifier","start":2994,"end":3002,"name":"censored"},"consequent":{"type":"TemplateLiteral","start":3005,"end":3058,"expressions":[{"type":"MemberExpression","start":3008,"end":3033,"object":{"type":"CallExpression","start":3008,"end":3030,"callee":{"type":"MemberExpression","start":3008,"end":3025,"object":{"type":"MemberExpression","start":3008,"end":3019,"object":{"type":"Identifier","start":3008,"end":3014,"name":"parsed"},"property":{"type":"Identifier","start":3015,"end":3019,"name":"href"},"computed":false},"property":{"type":"Identifier","start":3020,"end":3025,"name":"split"},"computed":false},"arguments":[{"type":"Literal","start":3026,"end":3029,"value":"?","raw":"'?'"}]},"property":{"type":"Literal","start":3031,"end":3032,"value":0,"raw":"0"},"computed":true},{"type":"CallExpression","start":3037,"end":3056,"callee":{"type":"MemberExpression","start":3037,"end":3049,"object":{"type":"Identifier","start":3037,"end":3039,"name":"qs"},"property":{"type":"Identifier","start":3040,"end":3049,"name":"stringify"},"computed":false},"arguments":[{"type":"Identifier","start":3050,"end":3055,"name":"query"}]}],"quasis":[{"type":"TemplateElement","start":3006,"end":3006,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":3034,"end":3035,"value":{"raw":"?","cooked":"?"},"tail":false},{"type":"TemplateElement","start":3057,"end":3057,"value":{"raw":"","cooked":""},"tail":true}]},"alternate":{"type":"MemberExpression","start":3061,"end":3072,"object":{"type":"Identifier","start":3061,"end":3067,"name":"parsed"},"property":{"type":"Identifier","start":3068,"end":3072,"name":"href"},"computed":false}}}]},"alternate":null}]}}]}},{"type":"ExpressionStatement","start":3129,"end":3156,"expression":{"type":"CallExpression","start":3129,"end":3155,"callee":{"type":"MemberExpression","start":3129,"end":3136,"object":{"type":"Identifier","start":3129,"end":3132,"name":"app"},"property":{"type":"Identifier","start":3133,"end":3136,"name":"use"},"computed":false},"arguments":[{"type":"Identifier","start":3137,"end":3154,"name":"metricsMiddleware"}]}},{"type":"ExpressionStatement","start":3157,"end":3184,"expression":{"type":"CallExpression","start":3157,"end":3183,"callee":{"type":"MemberExpression","start":3157,"end":3164,"object":{"type":"Identifier","start":3157,"end":3160,"name":"app"},"property":{"type":"Identifier","start":3161,"end":3164,"name":"use"},"computed":false},"arguments":[{"type":"CallExpression","start":3165,"end":3182,"callee":{"type":"MemberExpression","start":3165,"end":3180,"object":{"type":"Identifier","start":3165,"end":3175,"name":"bodyParser"},"property":{"type":"Identifier","start":3176,"end":3180,"name":"json"},"computed":false},"arguments":[]}]}},{"type":"ExpressionStatement","start":3185,"end":3237,"expression":{"type":"CallExpression","start":3185,"end":3236,"callee":{"type":"MemberExpression","start":3185,"end":3192,"object":{"type":"Identifier","start":3185,"end":3188,"name":"app"},"property":{"type":"Identifier","start":3189,"end":3192,"name":"use"},"computed":false},"arguments":[{"type":"CallExpression","start":3193,"end":3235,"callee":{"type":"MemberExpression","start":3193,"end":3214,"object":{"type":"Identifier","start":3193,"end":3203,"name":"bodyParser"},"property":{"type":"Identifier","start":3204,"end":3214,"name":"urlencoded"},"computed":false},"arguments":[{"type":"ObjectExpression","start":3215,"end":3234,"properties":[{"type":"Property","start":3217,"end":3232,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3217,"end":3225,"name":"extended"},"value":{"type":"Literal","start":3227,"end":3232,"value":false,"raw":"false"},"kind":"init"}]}]}]}},{"type":"ExpressionStatement","start":3278,"end":3307,"expression":{"type":"CallExpression","start":3278,"end":3306,"callee":{"type":"MemberExpression","start":3278,"end":3285,"object":{"type":"Identifier","start":3278,"end":3281,"name":"app"},"property":{"type":"Identifier","start":3282,"end":3285,"name":"use"},"computed":false},"arguments":[{"type":"CallExpression","start":3286,"end":3305,"callee":{"type":"MemberExpression","start":3286,"end":3303,"object":{"type":"Identifier","start":3286,"end":3292,"name":"helmet"},"property":{"type":"Identifier","start":3293,"end":3303,"name":"frameguard"},"computed":false},"arguments":[]}]}},{"type":"ExpressionStatement","start":3308,"end":3336,"expression":{"type":"CallExpression","start":3308,"end":3335,"callee":{"type":"MemberExpression","start":3308,"end":3315,"object":{"type":"Identifier","start":3308,"end":3311,"name":"app"},"property":{"type":"Identifier","start":3312,"end":3315,"name":"use"},"computed":false},"arguments":[{"type":"CallExpression","start":3316,"end":3334,"callee":{"type":"MemberExpression","start":3316,"end":3332,"object":{"type":"Identifier","start":3316,"end":3322,"name":"helmet"},"property":{"type":"Identifier","start":3323,"end":3332,"name":"xssFilter"},"computed":false},"arguments":[]}]}},{"type":"ExpressionStatement","start":3337,"end":3363,"expression":{"type":"CallExpression","start":3337,"end":3362,"callee":{"type":"MemberExpression","start":3337,"end":3344,"object":{"type":"Identifier","start":3337,"end":3340,"name":"app"},"property":{"type":"Identifier","start":3341,"end":3344,"name":"use"},"computed":false},"arguments":[{"type":"CallExpression","start":3345,"end":3361,"callee":{"type":"MemberExpression","start":3345,"end":3359,"object":{"type":"Identifier","start":3345,"end":3351,"name":"helmet"},"property":{"type":"Identifier","start":3352,"end":3359,"name":"noSniff"},"computed":false},"arguments":[]}]}},{"type":"ExpressionStatement","start":3364,"end":3391,"expression":{"type":"CallExpression","start":3364,"end":3390,"callee":{"type":"MemberExpression","start":3364,"end":3371,"object":{"type":"Identifier","start":3364,"end":3367,"name":"app"},"property":{"type":"Identifier","start":3368,"end":3371,"name":"use"},"computed":false},"arguments":[{"type":"CallExpression","start":3372,"end":3389,"callee":{"type":"MemberExpression","start":3372,"end":3387,"object":{"type":"Identifier","start":3372,"end":3378,"name":"helmet"},"property":{"type":"Identifier","start":3379,"end":3387,"name":"ieNoOpen"},"computed":false},"arguments":[]}]}},{"type":"ExpressionStatement","start":3392,"end":3420,"expression":{"type":"CallExpression","start":3392,"end":3419,"callee":{"type":"MemberExpression","start":3392,"end":3403,"object":{"type":"Identifier","start":3392,"end":3395,"name":"app"},"property":{"type":"Identifier","start":3396,"end":3403,"name":"disable"},"computed":false},"arguments":[{"type":"Literal","start":3404,"end":3418,"value":"x-powered-by","raw":"'x-powered-by'"}]}},{"type":"VariableDeclaration","start":3421,"end":3475,"declarations":[{"type":"VariableDeclarator","start":3427,"end":3474,"id":{"type":"Identifier","start":3427,"end":3443,"name":"companionOptions"},"init":{"type":"CallExpression","start":3446,"end":3474,"callee":{"type":"MemberExpression","start":3446,"end":3472,"object":{"type":"Identifier","start":3446,"end":3452,"name":"helper"},"property":{"type":"Identifier","start":3453,"end":3472,"name":"getCompanionOptions"},"computed":false},"arguments":[]}}],"kind":"const"},{"type":"VariableDeclaration","start":3476,"end":3586,"declarations":[{"type":"VariableDeclarator","start":3482,"end":3585,"id":{"type":"Identifier","start":3482,"end":3496,"name":"sessionOptions"},"init":{"type":"ObjectExpression","start":3499,"end":3585,"properties":[{"type":"Property","start":3505,"end":3536,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3505,"end":3511,"name":"secret"},"value":{"type":"MemberExpression","start":3513,"end":3536,"object":{"type":"Identifier","start":3513,"end":3529,"name":"companionOptions"},"property":{"type":"Identifier","start":3530,"end":3536,"name":"secret"},"computed":false},"kind":"init"},{"type":"Property","start":3542,"end":3554,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3542,"end":3548,"name":"resave"},"value":{"type":"Literal","start":3550,"end":3554,"value":true,"raw":"true"},"kind":"init"},{"type":"Property","start":3560,"end":3583,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3560,"end":3577,"name":"saveUninitialized"},"value":{"type":"Literal","start":3579,"end":3583,"value":true,"raw":"true"},"kind":"init"}]}}],"kind":"const"},{"type":"IfStatement","start":3587,"end":3859,"test":{"type":"MemberExpression","start":3591,"end":3616,"object":{"type":"Identifier","start":3591,"end":3607,"name":"companionOptions"},"property":{"type":"Identifier","start":3608,"end":3616,"name":"redisUrl"},"computed":false},"consequent":{"type":"BlockStatement","start":3618,"end":3859,"body":[{"type":"VariableDeclaration","start":3624,"end":3677,"declarations":[{"type":"VariableDeclarator","start":3630,"end":3676,"id":{"type":"Identifier","start":3630,"end":3640,"name":"RedisStore"},"init":{"type":"CallExpression","start":3643,"end":3676,"callee":{"type":"CallExpression","start":3643,"end":3667,"callee":{"type":"Identifier","start":3643,"end":3650,"name":"require"},"arguments":[{"type":"Literal","start":3651,"end":3666,"value":"connect-redis","raw":"'connect-redis'"}]},"arguments":[{"type":"Identifier","start":3668,"end":3675,"name":"session"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":3682,"end":3789,"declarations":[{"type":"VariableDeclarator","start":3688,"end":3788,"id":{"type":"Identifier","start":3688,"end":3699,"name":"redisClient"},"init":{"type":"CallExpression","start":3702,"end":3788,"callee":{"type":"MemberExpression","start":3702,"end":3714,"object":{"type":"Identifier","start":3702,"end":3707,"name":"redis"},"property":{"type":"Identifier","start":3708,"end":3714,"name":"client"},"computed":false},"arguments":[{"type":"CallExpression","start":3715,"end":3787,"callee":{"type":"Identifier","start":3715,"end":3720,"name":"merge"},"arguments":[{"type":"ObjectExpression","start":3721,"end":3755,"properties":[{"type":"Property","start":3723,"end":3753,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3723,"end":3726,"name":"url"},"value":{"type":"MemberExpression","start":3728,"end":3753,"object":{"type":"Identifier","start":3728,"end":3744,"name":"companionOptions"},"property":{"type":"Identifier","start":3745,"end":3753,"name":"redisUrl"},"computed":false},"kind":"init"}]},{"type":"MemberExpression","start":3757,"end":3786,"object":{"type":"Identifier","start":3757,"end":3773,"name":"companionOptions"},"property":{"type":"Identifier","start":3774,"end":3786,"name":"redisOptions"},"computed":false}]}]}}],"kind":"const"},{"type":"ExpressionStatement","start":3794,"end":3857,"expression":{"type":"AssignmentExpression","start":3794,"end":3856,"operator":"=","left":{"type":"MemberExpression","start":3794,"end":3814,"object":{"type":"Identifier","start":3794,"end":3808,"name":"sessionOptions"},"property":{"type":"Identifier","start":3809,"end":3814,"name":"store"},"computed":false},"right":{"type":"NewExpression","start":3817,"end":3856,"callee":{"type":"Identifier","start":3821,"end":3831,"name":"RedisStore"},"arguments":[{"type":"ObjectExpression","start":3832,"end":3855,"properties":[{"type":"Property","start":3834,"end":3853,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3834,"end":3840,"name":"client"},"value":{"type":"Identifier","start":3842,"end":3853,"name":"redisClient"},"kind":"init"}]}]}}}]},"alternate":null},{"type":"IfStatement","start":3860,"end":4039,"test":{"type":"MemberExpression","start":3864,"end":3899,"object":{"type":"MemberExpression","start":3864,"end":3875,"object":{"type":"Identifier","start":3864,"end":3871,"name":"process"},"property":{"type":"Identifier","start":3872,"end":3875,"name":"env"},"computed":false},"property":{"type":"Identifier","start":3876,"end":3899,"name":"COMPANION_COOKIE_DOMAIN"},"computed":false},"consequent":{"type":"BlockStatement","start":3901,"end":4039,"body":[{"type":"ExpressionStatement","start":3907,"end":4037,"expression":{"type":"AssignmentExpression","start":3907,"end":4036,"operator":"=","left":{"type":"MemberExpression","start":3907,"end":3928,"object":{"type":"Identifier","start":3907,"end":3921,"name":"sessionOptions"},"property":{"type":"Identifier","start":3922,"end":3928,"name":"cookie"},"computed":false},"right":{"type":"ObjectExpression","start":3931,"end":4036,"properties":[{"type":"Property","start":3941,"end":3984,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3941,"end":3947,"name":"domain"},"value":{"type":"MemberExpression","start":3949,"end":3984,"object":{"type":"MemberExpression","start":3949,"end":3960,"object":{"type":"Identifier","start":3949,"end":3956,"name":"process"},"property":{"type":"Identifier","start":3957,"end":3960,"name":"env"},"computed":false},"property":{"type":"Identifier","start":3961,"end":3984,"name":"COMPANION_COOKIE_DOMAIN"},"computed":false},"kind":"init"},{"type":"Property","start":3994,"end":4021,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3994,"end":4000,"name":"maxAge"},"value":{"type":"BinaryExpression","start":4002,"end":4021,"left":{"type":"BinaryExpression","start":4002,"end":4014,"left":{"type":"BinaryExpression","start":4002,"end":4009,"left":{"type":"Literal","start":4002,"end":4004,"value":24,"raw":"24"},"operator":"*","right":{"type":"Literal","start":4007,"end":4009,"value":60,"raw":"60"}},"operator":"*","right":{"type":"Literal","start":4012,"end":4014,"value":60,"raw":"60"}},"operator":"*","right":{"type":"Literal","start":4017,"end":4021,"value":1000,"raw":"1000"}},"kind":"init"}]}}}]},"alternate":null},{"type":"ExpressionStatement","start":4040,"end":4073,"expression":{"type":"CallExpression","start":4040,"end":4072,"callee":{"type":"MemberExpression","start":4040,"end":4047,"object":{"type":"Identifier","start":4040,"end":4043,"name":"app"},"property":{"type":"Identifier","start":4044,"end":4047,"name":"use"},"computed":false},"arguments":[{"type":"CallExpression","start":4048,"end":4071,"callee":{"type":"Identifier","start":4048,"end":4055,"name":"session"},"arguments":[{"type":"Identifier","start":4056,"end":4070,"name":"sessionOptions"}]}]}},{"type":"ExpressionStatement","start":4074,"end":5239,"expression":{"type":"CallExpression","start":4074,"end":5238,"callee":{"type":"MemberExpression","start":4074,"end":4081,"object":{"type":"Identifier","start":4074,"end":4077,"name":"app"},"property":{"type":"Identifier","start":4078,"end":4081,"name":"use"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":4082,"end":5237,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":4083,"end":4086,"name":"req"},{"type":"Identifier","start":4088,"end":4091,"name":"res"},{"type":"Identifier","start":4093,"end":4097,"name":"next"}],"body":{"type":"BlockStatement","start":4102,"end":5237,"body":[{"type":"VariableDeclaration","start":4108,"end":4166,"declarations":[{"type":"VariableDeclarator","start":4114,"end":4165,"id":{"type":"Identifier","start":4114,"end":4122,"name":"protocol"},"init":{"type":"LogicalExpression","start":4125,"end":4165,"left":{"type":"MemberExpression","start":4125,"end":4155,"object":{"type":"MemberExpression","start":4125,"end":4136,"object":{"type":"Identifier","start":4125,"end":4132,"name":"process"},"property":{"type":"Identifier","start":4133,"end":4136,"name":"env"},"computed":false},"property":{"type":"Identifier","start":4137,"end":4155,"name":"COMPANION_PROTOCOL"},"computed":false},"operator":"||","right":{"type":"Literal","start":4159,"end":4165,"value":"http","raw":"'http'"}}}],"kind":"const"},{"type":"IfStatement","start":4389,"end":5032,"test":{"type":"MemberExpression","start":4393,"end":4429,"object":{"type":"MemberExpression","start":4393,"end":4404,"object":{"type":"Identifier","start":4393,"end":4400,"name":"process"},"property":{"type":"Identifier","start":4401,"end":4404,"name":"env"},"computed":false},"property":{"type":"Identifier","start":4405,"end":4429,"name":"COMPANION_CLIENT_ORIGINS"},"computed":false},"consequent":{"type":"BlockStatement","start":4431,"end":4934,"body":[{"type":"VariableDeclaration","start":4441,"end":4602,"declarations":[{"type":"VariableDeclarator","start":4447,"end":4601,"id":{"type":"Identifier","start":4447,"end":4456,"name":"whitelist"},"init":{"type":"CallExpression","start":4459,"end":4601,"callee":{"type":"MemberExpression","start":4459,"end":4536,"object":{"type":"CallExpression","start":4459,"end":4519,"callee":{"type":"MemberExpression","start":4459,"end":4514,"object":{"type":"MemberExpression","start":4459,"end":4495,"object":{"type":"MemberExpression","start":4459,"end":4470,"object":{"type":"Identifier","start":4459,"end":4466,"name":"process"},"property":{"type":"Identifier","start":4467,"end":4470,"name":"env"},"computed":false},"property":{"type":"Identifier","start":4471,"end":4495,"name":"COMPANION_CLIENT_ORIGINS"},"computed":false},"property":{"type":"Identifier","start":4509,"end":4514,"name":"split"},"computed":false},"arguments":[{"type":"Literal","start":4515,"end":4518,"value":",","raw":"','"}]},"property":{"type":"Identifier","start":4533,"end":4536,"name":"map"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":4537,"end":4600,"id":null,"expression":true,"generator":false,"async":false,"params":[{"type":"Identifier","start":4538,"end":4541,"name":"url"}],"body":{"type":"ConditionalExpression","start":4546,"end":4600,"test":{"type":"CallExpression","start":4546,"end":4569,"callee":{"type":"MemberExpression","start":4546,"end":4564,"object":{"type":"Identifier","start":4546,"end":4552,"name":"helper"},"property":{"type":"Identifier","start":4553,"end":4564,"name":"hasProtocol"},"computed":false},"arguments":[{"type":"Identifier","start":4565,"end":4568,"name":"url"}]},"consequent":{"type":"Identifier","start":4572,"end":4575,"name":"url"},"alternate":{"type":"TemplateLiteral","start":4578,"end":4600,"expressions":[{"type":"Identifier","start":4581,"end":4589,"name":"protocol"},{"type":"Identifier","start":4595,"end":4598,"name":"url"}],"quasis":[{"type":"TemplateElement","start":4579,"end":4579,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":4590,"end":4593,"value":{"raw":"://","cooked":"://"},"tail":false},{"type":"TemplateElement","start":4599,"end":4599,"value":{"raw":"","cooked":""},"tail":true}]}}}]}}],"kind":"const"},{"type":"IfStatement","start":4633,"end":4928,"test":{"type":"LogicalExpression","start":4637,"end":4701,"left":{"type":"MemberExpression","start":4637,"end":4655,"object":{"type":"MemberExpression","start":4637,"end":4648,"object":{"type":"Identifier","start":4637,"end":4640,"name":"req"},"property":{"type":"Identifier","start":4641,"end":4648,"name":"headers"},"computed":false},"property":{"type":"Identifier","start":4649,"end":4655,"name":"origin"},"computed":false},"operator":"&&","right":{"type":"BinaryExpression","start":4659,"end":4701,"left":{"type":"CallExpression","start":4659,"end":4696,"callee":{"type":"MemberExpression","start":4659,"end":4676,"object":{"type":"Identifier","start":4659,"end":4668,"name":"whitelist"},"property":{"type":"Identifier","start":4669,"end":4676,"name":"indexOf"},"computed":false},"arguments":[{"type":"MemberExpression","start":4677,"end":4695,"object":{"type":"MemberExpression","start":4677,"end":4688,"object":{"type":"Identifier","start":4677,"end":4680,"name":"req"},"property":{"type":"Identifier","start":4681,"end":4688,"name":"headers"},"computed":false},"property":{"type":"Identifier","start":4689,"end":4695,"name":"origin"},"computed":false}]},"operator":">","right":{"type":"UnaryExpression","start":4699,"end":4701,"operator":"-","prefix":true,"argument":{"type":"Literal","start":4700,"end":4701,"value":1,"raw":"1"}}}},"consequent":{"type":"BlockStatement","start":4703,"end":4928,"body":[{"type":"ExpressionStatement","start":4717,"end":4782,"expression":{"type":"CallExpression","start":4717,"end":4781,"callee":{"type":"MemberExpression","start":4717,"end":4730,"object":{"type":"Identifier","start":4717,"end":4720,"name":"res"},"property":{"type":"Identifier","start":4721,"end":4730,"name":"setHeader"},"computed":false},"arguments":[{"type":"Literal","start":4731,"end":4760,"value":"Access-Control-Allow-Origin","raw":"'Access-Control-Allow-Origin'"},{"type":"MemberExpression","start":4762,"end":4780,"object":{"type":"MemberExpression","start":4762,"end":4773,"object":{"type":"Identifier","start":4762,"end":4765,"name":"req"},"property":{"type":"Identifier","start":4766,"end":4773,"name":"headers"},"computed":false},"property":{"type":"Identifier","start":4774,"end":4780,"name":"origin"},"computed":false}]}},{"type":"ExpressionStatement","start":4860,"end":4918,"expression":{"type":"CallExpression","start":4860,"end":4917,"callee":{"type":"MemberExpression","start":4860,"end":4873,"object":{"type":"Identifier","start":4860,"end":4863,"name":"res"},"property":{"type":"Identifier","start":4864,"end":4873,"name":"setHeader"},"computed":false},"arguments":[{"type":"Literal","start":4874,"end":4908,"value":"Access-Control-Allow-Credentials","raw":"'Access-Control-Allow-Credentials'"},{"type":"Literal","start":4910,"end":4916,"value":"true","raw":"'true'"}]}}]},"alternate":null}]},"alternate":{"type":"BlockStatement","start":4944,"end":5032,"body":[{"type":"ExpressionStatement","start":4954,"end":5026,"expression":{"type":"CallExpression","start":4954,"end":5025,"callee":{"type":"MemberExpression","start":4954,"end":4967,"object":{"type":"Identifier","start":4954,"end":4957,"name":"res"},"property":{"type":"Identifier","start":4958,"end":4967,"name":"setHeader"},"computed":false},"arguments":[{"type":"Literal","start":4968,"end":4997,"value":"Access-Control-Allow-Origin","raw":"'Access-Control-Allow-Origin'"},{"type":"LogicalExpression","start":4999,"end":5024,"left":{"type":"MemberExpression","start":4999,"end":5017,"object":{"type":"MemberExpression","start":4999,"end":5010,"object":{"type":"Identifier","start":4999,"end":5002,"name":"req"},"property":{"type":"Identifier","start":5003,"end":5010,"name":"headers"},"computed":false},"property":{"type":"Identifier","start":5011,"end":5017,"name":"origin"},"computed":false},"operator":"||","right":{"type":"Literal","start":5021,"end":5024,"value":"*","raw":"'*'"}}]}}]}},{"type":"ExpressionStatement","start":5037,"end":5125,"expression":{"type":"CallExpression","start":5037,"end":5124,"callee":{"type":"MemberExpression","start":5037,"end":5050,"object":{"type":"Identifier","start":5037,"end":5040,"name":"res"},"property":{"type":"Identifier","start":5041,"end":5050,"name":"setHeader"},"computed":false},"arguments":[{"type":"Literal","start":5051,"end":5081,"value":"Access-Control-Allow-Methods","raw":"'Access-Control-Allow-Methods'"},{"type":"Literal","start":5083,"end":5123,"value":"GET, POST, OPTIONS, PUT, PATCH, DELETE","raw":"'GET, POST, OPTIONS, PUT, PATCH, DELETE'"}]}},{"type":"ExpressionStatement","start":5130,"end":5223,"expression":{"type":"CallExpression","start":5130,"end":5222,"callee":{"type":"MemberExpression","start":5130,"end":5143,"object":{"type":"Identifier","start":5130,"end":5133,"name":"res"},"property":{"type":"Identifier","start":5134,"end":5143,"name":"setHeader"},"computed":false},"arguments":[{"type":"Literal","start":5144,"end":5174,"value":"Access-Control-Allow-Headers","raw":"'Access-Control-Allow-Headers'"},{"type":"Literal","start":5176,"end":5221,"value":"Authorization, Origin, Content-Type, Accept","raw":"'Authorization, Origin, Content-Type, Accept'"}]}},{"type":"ExpressionStatement","start":5228,"end":5235,"expression":{"type":"CallExpression","start":5228,"end":5234,"callee":{"type":"Identifier","start":5228,"end":5232,"name":"next"},"arguments":[]}}]}}]}},{"type":"ExpressionStatement","start":5250,"end":5398,"expression":{"type":"CallExpression","start":5250,"end":5397,"callee":{"type":"MemberExpression","start":5250,"end":5257,"object":{"type":"Identifier","start":5250,"end":5253,"name":"app"},"property":{"type":"Identifier","start":5254,"end":5257,"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":5258,"end":5261,"value":"/","raw":"'/'"},{"type":"ArrowFunctionExpression","start":5263,"end":5396,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":5264,"end":5267,"name":"req"},{"type":"Identifier","start":5269,"end":5272,"name":"res"}],"body":{"type":"BlockStatement","start":5277,"end":5396,"body":[{"type":"ExpressionStatement","start":5283,"end":5327,"expression":{"type":"CallExpression","start":5283,"end":5326,"callee":{"type":"MemberExpression","start":5283,"end":5296,"object":{"type":"Identifier","start":5283,"end":5286,"name":"res"},"property":{"type":"Identifier","start":5287,"end":5296,"name":"setHeader"},"computed":false},"arguments":[{"type":"Literal","start":5297,"end":5311,"value":"Content-Type","raw":"'Content-Type'"},{"type":"Literal","start":5313,"end":5325,"value":"text/plain","raw":"'text/plain'"}]}},{"type":"ExpressionStatement","start":5332,"end":5394,"expression":{"type":"CallExpression","start":5332,"end":5393,"callee":{"type":"MemberExpression","start":5332,"end":5340,"object":{"type":"Identifier","start":5332,"end":5335,"name":"res"},"property":{"type":"Identifier","start":5336,"end":5340,"name":"send"},"computed":false},"arguments":[{"type":"CallExpression","start":5341,"end":5392,"callee":{"type":"MemberExpression","start":5341,"end":5374,"object":{"type":"Identifier","start":5341,"end":5347,"name":"helper"},"property":{"type":"Identifier","start":5348,"end":5374,"name":"buildHelpfulStartupMessage"},"computed":false},"arguments":[{"type":"Identifier","start":5375,"end":5391,"name":"companionOptions"}]}]}}]}}]}},{"type":"VariableDeclaration","start":5399,"end":5416,"declarations":[{"type":"VariableDeclarator","start":5403,"end":5415,"id":{"type":"Identifier","start":5403,"end":5415,"name":"companionApp"},"init":null}],"kind":"let"},{"type":"TryStatement","start":5417,"end":5600,"block":{"type":"BlockStatement","start":5421,"end":5504,"body":[{"type":"ExpressionStatement","start":5455,"end":5502,"expression":{"type":"AssignmentExpression","start":5455,"end":5501,"operator":"=","left":{"type":"Identifier","start":5455,"end":5467,"name":"companionApp"},"right":{"type":"CallExpression","start":5470,"end":5501,"callee":{"type":"MemberExpression","start":5470,"end":5483,"object":{"type":"Identifier","start":5470,"end":5479,"name":"companion"},"property":{"type":"Identifier","start":5480,"end":5483,"name":"app"},"computed":false},"arguments":[{"type":"Identifier","start":5484,"end":5500,"name":"companionOptions"}]}}}]},"handler":{"type":"CatchClause","start":5505,"end":5600,"param":{"type":"Identifier","start":5512,"end":5517,"name":"error"},"body":{"type":"BlockStatement","start":5519,"end":5600,"body":[{"type":"ExpressionStatement","start":5525,"end":5577,"expression":{"type":"CallExpression","start":5525,"end":5576,"callee":{"type":"MemberExpression","start":5525,"end":5538,"object":{"type":"Identifier","start":5525,"end":5532,"name":"console"},"property":{"type":"Identifier","start":5533,"end":5538,"name":"error"},"computed":false},"arguments":[{"type":"Literal","start":5539,"end":5549,"value":"\u001b[31m","raw":"'\\x1b[31m'"},{"type":"MemberExpression","start":5551,"end":5564,"object":{"type":"Identifier","start":5551,"end":5556,"name":"error"},"property":{"type":"Identifier","start":5557,"end":5564,"name":"message"},"computed":false},{"type":"Literal","start":5566,"end":5575,"value":"\u001b[0m","raw":"'\\x1b[0m'"}]}},{"type":"ExpressionStatement","start":5582,"end":5598,"expression":{"type":"CallExpression","start":5582,"end":5597,"callee":{"type":"MemberExpression","start":5582,"end":5594,"object":{"type":"Identifier","start":5582,"end":5589,"name":"process"},"property":{"type":"Identifier","start":5590,"end":5594,"name":"exit"},"computed":false},"arguments":[{"type":"Literal","start":5595,"end":5596,"value":1,"raw":"1"}]}}]}},"finalizer":null},{"type":"IfStatement","start":5639,"end":5765,"test":{"type":"MemberExpression","start":5643,"end":5669,"object":{"type":"MemberExpression","start":5643,"end":5654,"object":{"type":"Identifier","start":5643,"end":5650,"name":"process"},"property":{"type":"Identifier","start":5651,"end":5654,"name":"env"},"computed":false},"property":{"type":"Identifier","start":5655,"end":5669,"name":"COMPANION_PATH"},"computed":false},"consequent":{"type":"BlockStatement","start":5671,"end":5729,"body":[{"type":"ExpressionStatement","start":5677,"end":5727,"expression":{"type":"CallExpression","start":5677,"end":5726,"callee":{"type":"MemberExpression","start":5677,"end":5684,"object":{"type":"Identifier","start":5677,"end":5680,"name":"app"},"property":{"type":"Identifier","start":5681,"end":5684,"name":"use"},"computed":false},"arguments":[{"type":"MemberExpression","start":5685,"end":5711,"object":{"type":"MemberExpression","start":5685,"end":5696,"object":{"type":"Identifier","start":5685,"end":5692,"name":"process"},"property":{"type":"Identifier","start":5693,"end":5696,"name":"env"},"computed":false},"property":{"type":"Identifier","start":5697,"end":5711,"name":"COMPANION_PATH"},"computed":false},{"type":"Identifier","start":5713,"end":5725,"name":"companionApp"}]}}]},"alternate":{"type":"BlockStatement","start":5735,"end":5765,"body":[{"type":"ExpressionStatement","start":5741,"end":5763,"expression":{"type":"CallExpression","start":5741,"end":5762,"callee":{"type":"MemberExpression","start":5741,"end":5748,"object":{"type":"Identifier","start":5741,"end":5744,"name":"app"},"property":{"type":"Identifier","start":5745,"end":5748,"name":"use"},"computed":false},"arguments":[{"type":"Identifier","start":5749,"end":5761,"name":"companionApp"}]}}]}},{"type":"IfStatement","start":6202,"end":6967,"test":{"type":"LogicalExpression","start":6206,"end":6303,"left":{"type":"BinaryExpression","start":6206,"end":6265,"left":{"type":"MemberExpression","start":6206,"end":6254,"object":{"type":"MemberExpression","start":6206,"end":6217,"object":{"type":"Identifier","start":6206,"end":6213,"name":"process"},"property":{"type":"Identifier","start":6214,"end":6217,"name":"env"},"computed":false},"property":{"type":"Identifier","start":6218,"end":6254,"name":"COMPANION_ONEDRIVE_DOMAIN_VALIDATION"},"computed":false},"operator":"===","right":{"type":"Literal","start":6259,"end":6265,"value":"true","raw":"'true'"}},"operator":"&&","right":{"type":"MemberExpression","start":6269,"end":6303,"object":{"type":"MemberExpression","start":6269,"end":6280,"object":{"type":"Identifier","start":6269,"end":6276,"name":"process"},"property":{"type":"Identifier","start":6277,"end":6280,"name":"env"},"computed":false},"property":{"type":"Identifier","start":6281,"end":6303,"name":"COMPANION_ONEDRIVE_KEY"},"computed":false}},"consequent":{"type":"BlockStatement","start":6305,"end":6967,"body":[{"type":"ExpressionStatement","start":6311,"end":6965,"expression":{"type":"CallExpression","start":6311,"end":6964,"callee":{"type":"MemberExpression","start":6311,"end":6318,"object":{"type":"Identifier","start":6311,"end":6314,"name":"app"},"property":{"type":"Identifier","start":6315,"end":6318,"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":6319,"end":6369,"value":"/.well-known/microsoft-identity-association.json","raw":"'/.well-known/microsoft-identity-association.json'"},{"type":"ArrowFunctionExpression","start":6371,"end":6963,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":6372,"end":6375,"name":"req"},{"type":"Identifier","start":6377,"end":6380,"name":"res"}],"body":{"type":"BlockStatement","start":6385,"end":6963,"body":[{"type":"VariableDeclaration","start":6395,"end":6561,"declarations":[{"type":"VariableDeclarator","start":6401,"end":6560,"id":{"type":"Identifier","start":6401,"end":6408,"name":"content"},"init":{"type":"CallExpression","start":6411,"end":6560,"callee":{"type":"MemberExpression","start":6411,"end":6425,"object":{"type":"Identifier","start":6411,"end":6415,"name":"JSON"},"property":{"type":"Identifier","start":6416,"end":6425,"name":"stringify"},"computed":false},"arguments":[{"type":"ObjectExpression","start":6426,"end":6559,"properties":[{"type":"Property","start":6440,"end":6549,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6440,"end":6462,"name":"associatedApplications"},"value":{"type":"ArrayExpression","start":6464,"end":6549,"elements":[{"type":"ObjectExpression","start":6482,"end":6535,"properties":[{"type":"Property","start":6484,"end":6533,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6484,"end":6497,"name":"applicationId"},"value":{"type":"MemberExpression","start":6499,"end":6533,"object":{"type":"MemberExpression","start":6499,"end":6510,"object":{"type":"Identifier","start":6499,"end":6506,"name":"process"},"property":{"type":"Identifier","start":6507,"end":6510,"name":"env"},"computed":false},"property":{"type":"Identifier","start":6511,"end":6533,"name":"COMPANION_ONEDRIVE_KEY"},"computed":false},"kind":"init"}]}]},"kind":"init"}]}]}}],"kind":"const"},{"type":"ExpressionStatement","start":6570,"end":6640,"expression":{"type":"CallExpression","start":6570,"end":6639,"callee":{"type":"MemberExpression","start":6570,"end":6580,"object":{"type":"Identifier","start":6570,"end":6573,"name":"res"},"property":{"type":"Identifier","start":6574,"end":6580,"name":"header"},"computed":false},"arguments":[{"type":"Literal","start":6581,"end":6597,"value":"Content-Length","raw":"'Content-Length'"},{"type":"TemplateLiteral","start":6599,"end":6638,"expressions":[{"type":"CallExpression","start":6602,"end":6636,"callee":{"type":"MemberExpression","start":6602,"end":6619,"object":{"type":"Identifier","start":6602,"end":6608,"name":"Buffer"},"property":{"type":"Identifier","start":6609,"end":6619,"name":"byteLength"},"computed":false},"arguments":[{"type":"Identifier","start":6620,"end":6627,"name":"content"},{"type":"Literal","start":6629,"end":6635,"value":"utf8","raw":"'utf8'"}]}],"quasis":[{"type":"TemplateElement","start":6600,"end":6600,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":6637,"end":6637,"value":{"raw":"","cooked":""},"tail":true}]}]}},{"type":"ExpressionStatement","start":6851,"end":6910,"expression":{"type":"CallExpression","start":6851,"end":6909,"callee":{"type":"MemberExpression","start":6851,"end":6864,"object":{"type":"Identifier","start":6851,"end":6854,"name":"res"},"property":{"type":"Identifier","start":6855,"end":6864,"name":"writeHead"},"computed":false},"arguments":[{"type":"Literal","start":6865,"end":6868,"value":200,"raw":"200"},{"type":"ObjectExpression","start":6870,"end":6908,"properties":[{"type":"Property","start":6872,"end":6906,"method":false,"shorthand":false,"computed":false,"key":{"type":"Literal","start":6872,"end":6886,"value":"Content-Type","raw":"'Content-Type'"},"value":{"type":"Literal","start":6888,"end":6906,"value":"application/json","raw":"'application/json'"},"kind":"init"}]}]}},{"type":"ExpressionStatement","start":6919,"end":6938,"expression":{"type":"CallExpression","start":6919,"end":6937,"callee":{"type":"MemberExpression","start":6919,"end":6928,"object":{"type":"Identifier","start":6919,"end":6922,"name":"res"},"property":{"type":"Identifier","start":6923,"end":6928,"name":"write"},"computed":false},"arguments":[{"type":"Identifier","start":6929,"end":6936,"name":"content"}]}},{"type":"ExpressionStatement","start":6947,"end":6957,"expression":{"type":"CallExpression","start":6947,"end":6956,"callee":{"type":"MemberExpression","start":6947,"end":6954,"object":{"type":"Identifier","start":6947,"end":6950,"name":"res"},"property":{"type":"Identifier","start":6951,"end":6954,"name":"end"},"computed":false},"arguments":[]}}]}}]}}]},"alternate":null},{"type":"ExpressionStatement","start":6968,"end":7060,"expression":{"type":"CallExpression","start":6968,"end":7059,"callee":{"type":"MemberExpression","start":6968,"end":6975,"object":{"type":"Identifier","start":6968,"end":6971,"name":"app"},"property":{"type":"Identifier","start":6972,"end":6975,"name":"use"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":6976,"end":7058,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":6977,"end":6980,"name":"req"},{"type":"Identifier","start":6982,"end":6985,"name":"res"},{"type":"Identifier","start":6987,"end":6991,"name":"next"}],"body":{"type":"BlockStatement","start":6996,"end":7058,"body":[{"type":"ReturnStatement","start":7002,"end":7056,"argument":{"type":"CallExpression","start":7009,"end":7055,"callee":{"type":"MemberExpression","start":7009,"end":7029,"object":{"type":"CallExpression","start":7009,"end":7024,"callee":{"type":"MemberExpression","start":7009,"end":7019,"object":{"type":"Identifier","start":7009,"end":7012,"name":"res"},"property":{"type":"Identifier","start":7013,"end":7019,"name":"status"},"computed":false},"arguments":[{"type":"Literal","start":7020,"end":7023,"value":404,"raw":"404"}]},"property":{"type":"Identifier","start":7025,"end":7029,"name":"json"},"computed":false},"arguments":[{"type":"ObjectExpression","start":7030,"end":7054,"properties":[{"type":"Property","start":7032,"end":7052,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7032,"end":7039,"name":"message"},"value":{"type":"Literal","start":7041,"end":7052,"value":"Not Found","raw":"'Not Found'"},"kind":"init"}]}]}}]}}]}},{"type":"ExpressionStatement","start":7075,"end":7837,"expression":{"type":"CallExpression","start":7075,"end":7836,"callee":{"type":"MemberExpression","start":7075,"end":7082,"object":{"type":"Identifier","start":7075,"end":7078,"name":"app"},"property":{"type":"Identifier","start":7079,"end":7082,"name":"use"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":7083,"end":7835,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":7084,"end":7087,"name":"err"},{"type":"Identifier","start":7089,"end":7092,"name":"req"},{"type":"Identifier","start":7094,"end":7097,"name":"res"},{"type":"Identifier","start":7099,"end":7103,"name":"next"}],"body":{"type":"BlockStatement","start":7108,"end":7835,"body":[{"type":"VariableDeclaration","start":7114,"end":7141,"declarations":[{"type":"VariableDeclarator","start":7120,"end":7140,"id":{"type":"Identifier","start":7120,"end":7133,"name":"logStackTrace"},"init":{"type":"Literal","start":7136,"end":7140,"value":true,"raw":"true"}}],"kind":"const"},{"type":"IfStatement","start":7146,"end":7833,"test":{"type":"BinaryExpression","start":7150,"end":7181,"left":{"type":"CallExpression","start":7150,"end":7164,"callee":{"type":"MemberExpression","start":7150,"end":7157,"object":{"type":"Identifier","start":7150,"end":7153,"name":"app"},"property":{"type":"Identifier","start":7154,"end":7157,"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":7158,"end":7163,"value":"env","raw":"'env'"}]},"operator":"===","right":{"type":"Literal","start":7169,"end":7181,"value":"production","raw":"'production'"}},"consequent":{"type":"BlockStatement","start":7183,"end":7651,"body":[{"type":"IfStatement","start":7329,"end":7545,"test":{"type":"LogicalExpression","start":7333,"end":7378,"left":{"type":"BinaryExpression","start":7333,"end":7351,"left":{"type":"MemberExpression","start":7333,"end":7343,"object":{"type":"Identifier","start":7333,"end":7336,"name":"err"},"property":{"type":"Identifier","start":7337,"end":7343,"name":"status"},"computed":false},"operator":"===","right":{"type":"Literal","start":7348,"end":7351,"value":400,"raw":"400"}},"operator":"&&","right":{"type":"BinaryExpression","start":7355,"end":7378,"left":{"type":"Identifier","start":7355,"end":7358,"name":"err"},"operator":"instanceof","right":{"type":"Identifier","start":7370,"end":7378,"name":"URIError"}}},"consequent":{"type":"BlockStatement","start":7380,"end":7452,"body":[{"type":"ExpressionStatement","start":7394,"end":7442,"expression":{"type":"CallExpression","start":7394,"end":7441,"callee":{"type":"MemberExpression","start":7394,"end":7406,"object":{"type":"Identifier","start":7394,"end":7400,"name":"logger"},"property":{"type":"Identifier","start":7401,"end":7406,"name":"error"},"computed":false},"arguments":[{"type":"MemberExpression","start":7407,"end":7418,"object":{"type":"Identifier","start":7407,"end":7410,"name":"err"},"property":{"type":"Identifier","start":7411,"end":7418,"name":"message"},"computed":false},{"type":"Literal","start":7420,"end":7432,"value":"root.error","raw":"'root.error'"},{"type":"MemberExpression","start":7434,"end":7440,"object":{"type":"Identifier","start":7434,"end":7437,"name":"req"},"property":{"type":"Identifier","start":7438,"end":7440,"name":"id"},"computed":false}]}}]},"alternate":{"type":"BlockStatement","start":7466,"end":7545,"body":[{"type":"ExpressionStatement","start":7480,"end":7535,"expression":{"type":"CallExpression","start":7480,"end":7534,"callee":{"type":"MemberExpression","start":7480,"end":7492,"object":{"type":"Identifier","start":7480,"end":7486,"name":"logger"},"property":{"type":"Identifier","start":7487,"end":7492,"name":"error"},"computed":false},"arguments":[{"type":"Identifier","start":7493,"end":7496,"name":"err"},{"type":"Literal","start":7498,"end":7510,"value":"root.error","raw":"'root.error'"},{"type":"MemberExpression","start":7512,"end":7518,"object":{"type":"Identifier","start":7512,"end":7515,"name":"req"},"property":{"type":"Identifier","start":7516,"end":7518,"name":"id"},"computed":false},{"type":"Identifier","start":7520,"end":7533,"name":"logStackTrace"}]}}]}},{"type":"ExpressionStatement","start":7554,"end":7645,"expression":{"type":"CallExpression","start":7554,"end":7644,"callee":{"type":"MemberExpression","start":7554,"end":7588,"object":{"type":"CallExpression","start":7554,"end":7583,"callee":{"type":"MemberExpression","start":7554,"end":7564,"object":{"type":"Identifier","start":7554,"end":7557,"name":"res"},"property":{"type":"Identifier","start":7558,"end":7564,"name":"status"},"computed":false},"arguments":[{"type":"LogicalExpression","start":7565,"end":7582,"left":{"type":"MemberExpression","start":7565,"end":7575,"object":{"type":"Identifier","start":7565,"end":7568,"name":"err"},"property":{"type":"Identifier","start":7569,"end":7575,"name":"status"},"computed":false},"operator":"||","right":{"type":"Literal","start":7579,"end":7582,"value":500,"raw":"500"}}]},"property":{"type":"Identifier","start":7584,"end":7588,"name":"json"},"computed":false},"arguments":[{"type":"ObjectExpression","start":7589,"end":7643,"properties":[{"type":"Property","start":7591,"end":7622,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7591,"end":7598,"name":"message"},"value":{"type":"Literal","start":7600,"end":7622,"value":"Something went wrong","raw":"'Something went wrong'"},"kind":"init"},{"type":"Property","start":7624,"end":7641,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7624,"end":7633,"name":"requestId"},"value":{"type":"MemberExpression","start":7635,"end":7641,"object":{"type":"Identifier","start":7635,"end":7638,"name":"req"},"property":{"type":"Identifier","start":7639,"end":7641,"name":"id"},"computed":false},"kind":"init"}]}]}}]},"alternate":{"type":"BlockStatement","start":7661,"end":7833,"body":[{"type":"ExpressionStatement","start":7671,"end":7726,"expression":{"type":"CallExpression","start":7671,"end":7725,"callee":{"type":"MemberExpression","start":7671,"end":7683,"object":{"type":"Identifier","start":7671,"end":7677,"name":"logger"},"property":{"type":"Identifier","start":7678,"end":7683,"name":"error"},"computed":false},"arguments":[{"type":"Identifier","start":7684,"end":7687,"name":"err"},{"type":"Literal","start":7689,"end":7701,"value":"root.error","raw":"'root.error'"},{"type":"MemberExpression","start":7703,"end":7709,"object":{"type":"Identifier","start":7703,"end":7706,"name":"req"},"property":{"type":"Identifier","start":7707,"end":7709,"name":"id"},"computed":false},{"type":"Identifier","start":7711,"end":7724,"name":"logStackTrace"}]}},{"type":"ExpressionStatement","start":7735,"end":7827,"expression":{"type":"CallExpression","start":7735,"end":7826,"callee":{"type":"MemberExpression","start":7735,"end":7769,"object":{"type":"CallExpression","start":7735,"end":7764,"callee":{"type":"MemberExpression","start":7735,"end":7745,"object":{"type":"Identifier","start":7735,"end":7738,"name":"res"},"property":{"type":"Identifier","start":7739,"end":7745,"name":"status"},"computed":false},"arguments":[{"type":"LogicalExpression","start":7746,"end":7763,"left":{"type":"MemberExpression","start":7746,"end":7756,"object":{"type":"Identifier","start":7746,"end":7749,"name":"err"},"property":{"type":"Identifier","start":7750,"end":7756,"name":"status"},"computed":false},"operator":"||","right":{"type":"Literal","start":7760,"end":7763,"value":500,"raw":"500"}}]},"property":{"type":"Identifier","start":7765,"end":7769,"name":"json"},"computed":false},"arguments":[{"type":"ObjectExpression","start":7770,"end":7825,"properties":[{"type":"Property","start":7772,"end":7792,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7772,"end":7779,"name":"message"},"value":{"type":"MemberExpression","start":7781,"end":7792,"object":{"type":"Identifier","start":7781,"end":7784,"name":"err"},"property":{"type":"Identifier","start":7785,"end":7792,"name":"message"},"computed":false},"kind":"init"},{"type":"Property","start":7794,"end":7804,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7794,"end":7799,"name":"error"},"value":{"type":"Identifier","start":7801,"end":7804,"name":"err"},"kind":"init"},{"type":"Property","start":7806,"end":7823,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7806,"end":7815,"name":"requestId"},"value":{"type":"MemberExpression","start":7817,"end":7823,"object":{"type":"Identifier","start":7817,"end":7820,"name":"req"},"property":{"type":"Identifier","start":7821,"end":7823,"name":"id"},"computed":false},"kind":"init"}]}]}}]}}]}}]}},{"type":"ExpressionStatement","start":7838,"end":7881,"expression":{"type":"AssignmentExpression","start":7838,"end":7880,"operator":"=","left":{"type":"MemberExpression","start":7838,"end":7852,"object":{"type":"Identifier","start":7838,"end":7844,"name":"module"},"property":{"type":"Identifier","start":7845,"end":7852,"name":"exports"},"computed":false},"right":{"type":"ObjectExpression","start":7855,"end":7880,"properties":[{"type":"Property","start":7857,"end":7860,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":7857,"end":7860,"name":"app"},"kind":"init","value":{"type":"Identifier","start":7857,"end":7860,"name":"app"}},{"type":"Property","start":7862,"end":7878,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":7862,"end":7878,"name":"companionOptions"},"kind":"init","value":{"type":"Identifier","start":7862,"end":7878,"name":"companionOptions"}}]}}}],"sourceType":"script"}