{"type":"Program","start":0,"end":4474,"body":[{"type":"VariableDeclaration","start":0,"end":29,"declarations":[{"type":"VariableDeclarator","start":6,"end":28,"id":{"type":"Identifier","start":6,"end":10,"name":"http"},"init":{"type":"CallExpression","start":13,"end":28,"callee":{"type":"Identifier","start":13,"end":20,"name":"require"},"arguments":[{"type":"Literal","start":21,"end":27,"value":"http","raw":"'http'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":30,"end":61,"declarations":[{"type":"VariableDeclarator","start":36,"end":60,"id":{"type":"Identifier","start":36,"end":41,"name":"https"},"init":{"type":"CallExpression","start":44,"end":60,"callee":{"type":"Identifier","start":44,"end":51,"name":"require"},"arguments":[{"type":"Literal","start":52,"end":59,"value":"https","raw":"'https'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":62,"end":89,"declarations":[{"type":"VariableDeclarator","start":68,"end":88,"id":{"type":"Identifier","start":68,"end":71,"name":"dns"},"init":{"type":"CallExpression","start":74,"end":88,"callee":{"type":"Identifier","start":74,"end":81,"name":"require"},"arguments":[{"type":"Literal","start":82,"end":87,"value":"dns","raw":"'dns'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":90,"end":130,"declarations":[{"type":"VariableDeclarator","start":96,"end":129,"id":{"type":"Identifier","start":96,"end":105,"name":"ipAddress"},"init":{"type":"CallExpression","start":108,"end":129,"callee":{"type":"Identifier","start":108,"end":115,"name":"require"},"arguments":[{"type":"Literal","start":116,"end":128,"value":"ip-address","raw":"'ip-address'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":131,"end":183,"declarations":[{"type":"VariableDeclarator","start":137,"end":182,"id":{"type":"Identifier","start":137,"end":157,"name":"FORBIDDEN_IP_ADDRESS"},"init":{"type":"Literal","start":160,"end":182,"value":"Forbidden IP address","raw":"'Forbidden IP address'"}}],"kind":"const"},{"type":"FunctionDeclaration","start":184,"end":390,"id":{"type":"Identifier","start":193,"end":204,"name":"isIPAddress"},"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":205,"end":212,"name":"address"}],"body":{"type":"BlockStatement","start":214,"end":390,"body":[{"type":"VariableDeclaration","start":220,"end":272,"declarations":[{"type":"VariableDeclarator","start":226,"end":271,"id":{"type":"Identifier","start":226,"end":237,"name":"addressAsV6"},"init":{"type":"NewExpression","start":240,"end":271,"callee":{"type":"MemberExpression","start":244,"end":262,"object":{"type":"Identifier","start":244,"end":253,"name":"ipAddress"},"property":{"type":"Identifier","start":254,"end":262,"name":"Address6"},"computed":false},"arguments":[{"type":"Identifier","start":263,"end":270,"name":"address"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":277,"end":329,"declarations":[{"type":"VariableDeclarator","start":283,"end":328,"id":{"type":"Identifier","start":283,"end":294,"name":"addressAsV4"},"init":{"type":"NewExpression","start":297,"end":328,"callee":{"type":"MemberExpression","start":301,"end":319,"object":{"type":"Identifier","start":301,"end":310,"name":"ipAddress"},"property":{"type":"Identifier","start":311,"end":319,"name":"Address4"},"computed":false},"arguments":[{"type":"Identifier","start":320,"end":327,"name":"address"}]}}],"kind":"const"},{"type":"ReturnStatement","start":334,"end":388,"argument":{"type":"LogicalExpression","start":341,"end":387,"left":{"type":"CallExpression","start":341,"end":362,"callee":{"type":"MemberExpression","start":341,"end":360,"object":{"type":"Identifier","start":341,"end":352,"name":"addressAsV6"},"property":{"type":"Identifier","start":353,"end":360,"name":"isValid"},"computed":false},"arguments":[]},"operator":"||","right":{"type":"CallExpression","start":366,"end":387,"callee":{"type":"MemberExpression","start":366,"end":385,"object":{"type":"Identifier","start":366,"end":377,"name":"addressAsV4"},"property":{"type":"Identifier","start":378,"end":385,"name":"isValid"},"computed":false},"arguments":[]}}}]}},{"type":"FunctionDeclaration","start":790,"end":2592,"id":{"type":"Identifier","start":799,"end":810,"name":"isPrivateIP"},"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":811,"end":820,"name":"ipAddress"}],"body":{"type":"BlockStatement","start":822,"end":2592,"body":[{"type":"VariableDeclaration","start":828,"end":850,"declarations":[{"type":"VariableDeclarator","start":832,"end":849,"id":{"type":"Identifier","start":832,"end":841,"name":"isPrivate"},"init":{"type":"Literal","start":844,"end":849,"value":false,"raw":"false"}}],"kind":"let"},{"type":"VariableDeclaration","start":914,"end":934,"declarations":[{"type":"VariableDeclarator","start":920,"end":933,"id":{"type":"Identifier","start":920,"end":928,"name":"ipPrefix"},"init":{"type":"ArrayExpression","start":931,"end":933,"elements":[]}}],"kind":"const"},{"type":"ExpressionStatement","start":980,"end":1002,"expression":{"type":"CallExpression","start":980,"end":1001,"callee":{"type":"MemberExpression","start":980,"end":993,"object":{"type":"Identifier","start":980,"end":988,"name":"ipPrefix"},"property":{"type":"Identifier","start":989,"end":993,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":994,"end":1000,"value":"127.","raw":"'127.'"}]}},{"type":"ExpressionStatement","start":1007,"end":1027,"expression":{"type":"CallExpression","start":1007,"end":1026,"callee":{"type":"MemberExpression","start":1007,"end":1020,"object":{"type":"Identifier","start":1007,"end":1015,"name":"ipPrefix"},"property":{"type":"Identifier","start":1016,"end":1020,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1021,"end":1025,"value":"0.","raw":"'0.'"}]}},{"type":"ExpressionStatement","start":1135,"end":1156,"expression":{"type":"CallExpression","start":1135,"end":1155,"callee":{"type":"MemberExpression","start":1135,"end":1148,"object":{"type":"Identifier","start":1135,"end":1143,"name":"ipPrefix"},"property":{"type":"Identifier","start":1144,"end":1148,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1149,"end":1154,"value":"10.","raw":"'10.'"}]}},{"type":"ExpressionStatement","start":1161,"end":1186,"expression":{"type":"CallExpression","start":1161,"end":1185,"callee":{"type":"MemberExpression","start":1161,"end":1174,"object":{"type":"Identifier","start":1161,"end":1169,"name":"ipPrefix"},"property":{"type":"Identifier","start":1170,"end":1174,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1175,"end":1184,"value":"172.16.","raw":"'172.16.'"}]}},{"type":"ExpressionStatement","start":1191,"end":1216,"expression":{"type":"CallExpression","start":1191,"end":1215,"callee":{"type":"MemberExpression","start":1191,"end":1204,"object":{"type":"Identifier","start":1191,"end":1199,"name":"ipPrefix"},"property":{"type":"Identifier","start":1200,"end":1204,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1205,"end":1214,"value":"172.17.","raw":"'172.17.'"}]}},{"type":"ExpressionStatement","start":1221,"end":1246,"expression":{"type":"CallExpression","start":1221,"end":1245,"callee":{"type":"MemberExpression","start":1221,"end":1234,"object":{"type":"Identifier","start":1221,"end":1229,"name":"ipPrefix"},"property":{"type":"Identifier","start":1230,"end":1234,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1235,"end":1244,"value":"172.18.","raw":"'172.18.'"}]}},{"type":"ExpressionStatement","start":1251,"end":1276,"expression":{"type":"CallExpression","start":1251,"end":1275,"callee":{"type":"MemberExpression","start":1251,"end":1264,"object":{"type":"Identifier","start":1251,"end":1259,"name":"ipPrefix"},"property":{"type":"Identifier","start":1260,"end":1264,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1265,"end":1274,"value":"172.19.","raw":"'172.19.'"}]}},{"type":"ExpressionStatement","start":1281,"end":1306,"expression":{"type":"CallExpression","start":1281,"end":1305,"callee":{"type":"MemberExpression","start":1281,"end":1294,"object":{"type":"Identifier","start":1281,"end":1289,"name":"ipPrefix"},"property":{"type":"Identifier","start":1290,"end":1294,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1295,"end":1304,"value":"172.20.","raw":"'172.20.'"}]}},{"type":"ExpressionStatement","start":1311,"end":1336,"expression":{"type":"CallExpression","start":1311,"end":1335,"callee":{"type":"MemberExpression","start":1311,"end":1324,"object":{"type":"Identifier","start":1311,"end":1319,"name":"ipPrefix"},"property":{"type":"Identifier","start":1320,"end":1324,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1325,"end":1334,"value":"172.21.","raw":"'172.21.'"}]}},{"type":"ExpressionStatement","start":1341,"end":1366,"expression":{"type":"CallExpression","start":1341,"end":1365,"callee":{"type":"MemberExpression","start":1341,"end":1354,"object":{"type":"Identifier","start":1341,"end":1349,"name":"ipPrefix"},"property":{"type":"Identifier","start":1350,"end":1354,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1355,"end":1364,"value":"172.22.","raw":"'172.22.'"}]}},{"type":"ExpressionStatement","start":1371,"end":1396,"expression":{"type":"CallExpression","start":1371,"end":1395,"callee":{"type":"MemberExpression","start":1371,"end":1384,"object":{"type":"Identifier","start":1371,"end":1379,"name":"ipPrefix"},"property":{"type":"Identifier","start":1380,"end":1384,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1385,"end":1394,"value":"172.23.","raw":"'172.23.'"}]}},{"type":"ExpressionStatement","start":1401,"end":1426,"expression":{"type":"CallExpression","start":1401,"end":1425,"callee":{"type":"MemberExpression","start":1401,"end":1414,"object":{"type":"Identifier","start":1401,"end":1409,"name":"ipPrefix"},"property":{"type":"Identifier","start":1410,"end":1414,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1415,"end":1424,"value":"172.24.","raw":"'172.24.'"}]}},{"type":"ExpressionStatement","start":1431,"end":1456,"expression":{"type":"CallExpression","start":1431,"end":1455,"callee":{"type":"MemberExpression","start":1431,"end":1444,"object":{"type":"Identifier","start":1431,"end":1439,"name":"ipPrefix"},"property":{"type":"Identifier","start":1440,"end":1444,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1445,"end":1454,"value":"172.25.","raw":"'172.25.'"}]}},{"type":"ExpressionStatement","start":1461,"end":1486,"expression":{"type":"CallExpression","start":1461,"end":1485,"callee":{"type":"MemberExpression","start":1461,"end":1474,"object":{"type":"Identifier","start":1461,"end":1469,"name":"ipPrefix"},"property":{"type":"Identifier","start":1470,"end":1474,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1475,"end":1484,"value":"172.26.","raw":"'172.26.'"}]}},{"type":"ExpressionStatement","start":1491,"end":1516,"expression":{"type":"CallExpression","start":1491,"end":1515,"callee":{"type":"MemberExpression","start":1491,"end":1504,"object":{"type":"Identifier","start":1491,"end":1499,"name":"ipPrefix"},"property":{"type":"Identifier","start":1500,"end":1504,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1505,"end":1514,"value":"172.27.","raw":"'172.27.'"}]}},{"type":"ExpressionStatement","start":1521,"end":1546,"expression":{"type":"CallExpression","start":1521,"end":1545,"callee":{"type":"MemberExpression","start":1521,"end":1534,"object":{"type":"Identifier","start":1521,"end":1529,"name":"ipPrefix"},"property":{"type":"Identifier","start":1530,"end":1534,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1535,"end":1544,"value":"172.28.","raw":"'172.28.'"}]}},{"type":"ExpressionStatement","start":1551,"end":1576,"expression":{"type":"CallExpression","start":1551,"end":1575,"callee":{"type":"MemberExpression","start":1551,"end":1564,"object":{"type":"Identifier","start":1551,"end":1559,"name":"ipPrefix"},"property":{"type":"Identifier","start":1560,"end":1564,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1565,"end":1574,"value":"172.29.","raw":"'172.29.'"}]}},{"type":"ExpressionStatement","start":1581,"end":1606,"expression":{"type":"CallExpression","start":1581,"end":1605,"callee":{"type":"MemberExpression","start":1581,"end":1594,"object":{"type":"Identifier","start":1581,"end":1589,"name":"ipPrefix"},"property":{"type":"Identifier","start":1590,"end":1594,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1595,"end":1604,"value":"172.30.","raw":"'172.30.'"}]}},{"type":"ExpressionStatement","start":1611,"end":1636,"expression":{"type":"CallExpression","start":1611,"end":1635,"callee":{"type":"MemberExpression","start":1611,"end":1624,"object":{"type":"Identifier","start":1611,"end":1619,"name":"ipPrefix"},"property":{"type":"Identifier","start":1620,"end":1624,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1625,"end":1634,"value":"172.31.","raw":"'172.31.'"}]}},{"type":"ExpressionStatement","start":1641,"end":1667,"expression":{"type":"CallExpression","start":1641,"end":1666,"callee":{"type":"MemberExpression","start":1641,"end":1654,"object":{"type":"Identifier","start":1641,"end":1649,"name":"ipPrefix"},"property":{"type":"Identifier","start":1650,"end":1654,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1655,"end":1665,"value":"192.168.","raw":"'192.168.'"}]}},{"type":"ExpressionStatement","start":1672,"end":1698,"expression":{"type":"CallExpression","start":1672,"end":1697,"callee":{"type":"MemberExpression","start":1672,"end":1685,"object":{"type":"Identifier","start":1672,"end":1680,"name":"ipPrefix"},"property":{"type":"Identifier","start":1681,"end":1685,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1686,"end":1696,"value":"169.254.","raw":"'169.254.'"}]}},{"type":"ExpressionStatement","start":1914,"end":1934,"expression":{"type":"CallExpression","start":1914,"end":1933,"callee":{"type":"MemberExpression","start":1914,"end":1927,"object":{"type":"Identifier","start":1914,"end":1922,"name":"ipPrefix"},"property":{"type":"Identifier","start":1923,"end":1927,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1928,"end":1932,"value":"fc","raw":"'fc'"}]}},{"type":"ExpressionStatement","start":1939,"end":1959,"expression":{"type":"CallExpression","start":1939,"end":1958,"callee":{"type":"MemberExpression","start":1939,"end":1952,"object":{"type":"Identifier","start":1939,"end":1947,"name":"ipPrefix"},"property":{"type":"Identifier","start":1948,"end":1952,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1953,"end":1957,"value":"fd","raw":"'fd'"}]}},{"type":"ExpressionStatement","start":1964,"end":1984,"expression":{"type":"CallExpression","start":1964,"end":1983,"callee":{"type":"MemberExpression","start":1964,"end":1977,"object":{"type":"Identifier","start":1964,"end":1972,"name":"ipPrefix"},"property":{"type":"Identifier","start":1973,"end":1977,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1978,"end":1982,"value":"fe","raw":"'fe'"}]}},{"type":"ExpressionStatement","start":1989,"end":2009,"expression":{"type":"CallExpression","start":1989,"end":2008,"callee":{"type":"MemberExpression","start":1989,"end":2002,"object":{"type":"Identifier","start":1989,"end":1997,"name":"ipPrefix"},"property":{"type":"Identifier","start":1998,"end":2002,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":2003,"end":2007,"value":"ff","raw":"'ff'"}]}},{"type":"ExpressionStatement","start":2014,"end":2035,"expression":{"type":"CallExpression","start":2014,"end":2034,"callee":{"type":"MemberExpression","start":2014,"end":2027,"object":{"type":"Identifier","start":2014,"end":2022,"name":"ipPrefix"},"property":{"type":"Identifier","start":2023,"end":2027,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":2028,"end":2033,"value":"::1","raw":"'::1'"}]}},{"type":"VariableDeclaration","start":2319,"end":2369,"declarations":[{"type":"VariableDeclarator","start":2325,"end":2368,"id":{"type":"Identifier","start":2325,"end":2335,"name":"ipToVerify"},"init":{"type":"CallExpression","start":2338,"end":2368,"callee":{"type":"MemberExpression","start":2338,"end":2366,"object":{"type":"CallExpression","start":2338,"end":2354,"callee":{"type":"MemberExpression","start":2338,"end":2352,"object":{"type":"Identifier","start":2338,"end":2347,"name":"ipAddress"},"property":{"type":"Identifier","start":2348,"end":2352,"name":"trim"},"computed":false},"arguments":[]},"property":{"type":"Identifier","start":2355,"end":2366,"name":"toLowerCase"},"computed":false},"arguments":[]}}],"kind":"const"},{"type":"ForOfStatement","start":2426,"end":2568,"await":false,"left":{"type":"VariableDeclaration","start":2431,"end":2443,"declarations":[{"type":"VariableDeclarator","start":2437,"end":2443,"id":{"type":"Identifier","start":2437,"end":2443,"name":"prefix"},"init":null}],"kind":"const"},"right":{"type":"Identifier","start":2447,"end":2455,"name":"ipPrefix"},"body":{"type":"BlockStatement","start":2457,"end":2568,"body":[{"type":"IfStatement","start":2467,"end":2562,"test":{"type":"CallExpression","start":2471,"end":2500,"callee":{"type":"MemberExpression","start":2471,"end":2492,"object":{"type":"Identifier","start":2471,"end":2481,"name":"ipToVerify"},"property":{"type":"Identifier","start":2482,"end":2492,"name":"startsWith"},"computed":false},"arguments":[{"type":"Identifier","start":2493,"end":2499,"name":"prefix"}]},"consequent":{"type":"BlockStatement","start":2502,"end":2562,"body":[{"type":"ExpressionStatement","start":2516,"end":2533,"expression":{"type":"AssignmentExpression","start":2516,"end":2532,"operator":"=","left":{"type":"Identifier","start":2516,"end":2525,"name":"isPrivate"},"right":{"type":"Literal","start":2528,"end":2532,"value":true,"raw":"true"}}},{"type":"BreakStatement","start":2546,"end":2552,"label":null}]},"alternate":null}]}},{"type":"ReturnStatement","start":2573,"end":2590,"argument":{"type":"Identifier","start":2580,"end":2589,"name":"isPrivate"}}]}},{"type":"ExpressionStatement","start":2593,"end":2652,"expression":{"type":"AssignmentExpression","start":2593,"end":2651,"operator":"=","left":{"type":"MemberExpression","start":2593,"end":2628,"object":{"type":"MemberExpression","start":2593,"end":2607,"object":{"type":"Identifier","start":2593,"end":2599,"name":"module"},"property":{"type":"Identifier","start":2600,"end":2607,"name":"exports"},"computed":false},"property":{"type":"Identifier","start":2608,"end":2628,"name":"FORBIDDEN_IP_ADDRESS"},"computed":false},"right":{"type":"Identifier","start":2631,"end":2651,"name":"FORBIDDEN_IP_ADDRESS"}}},{"type":"ExpressionStatement","start":2921,"end":3166,"expression":{"type":"AssignmentExpression","start":2921,"end":3165,"operator":"=","left":{"type":"MemberExpression","start":2921,"end":2957,"object":{"type":"MemberExpression","start":2921,"end":2935,"object":{"type":"Identifier","start":2921,"end":2927,"name":"module"},"property":{"type":"Identifier","start":2928,"end":2935,"name":"exports"},"computed":false},"property":{"type":"Identifier","start":2936,"end":2957,"name":"getProtectedHttpAgent"},"computed":false},"right":{"type":"ArrowFunctionExpression","start":2960,"end":3165,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":2961,"end":2969,"name":"protocol"},{"type":"Identifier","start":2971,"end":2986,"name":"blockPrivateIPs"}],"body":{"type":"BlockStatement","start":2991,"end":3165,"body":[{"type":"IfStatement","start":2997,"end":3095,"test":{"type":"Identifier","start":3001,"end":3016,"name":"blockPrivateIPs"},"consequent":{"type":"BlockStatement","start":3018,"end":3095,"body":[{"type":"ReturnStatement","start":3028,"end":3089,"argument":{"type":"ConditionalExpression","start":3035,"end":3088,"test":{"type":"CallExpression","start":3035,"end":3063,"callee":{"type":"MemberExpression","start":3035,"end":3054,"object":{"type":"Identifier","start":3035,"end":3043,"name":"protocol"},"property":{"type":"Identifier","start":3044,"end":3054,"name":"startsWith"},"computed":false},"arguments":[{"type":"Literal","start":3055,"end":3062,"value":"https","raw":"'https'"}]},"consequent":{"type":"Identifier","start":3066,"end":3076,"name":"HttpsAgent"},"alternate":{"type":"Identifier","start":3079,"end":3088,"name":"HttpAgent"}}}]},"alternate":null},{"type":"ReturnStatement","start":3100,"end":3163,"argument":{"type":"ConditionalExpression","start":3107,"end":3162,"test":{"type":"CallExpression","start":3107,"end":3135,"callee":{"type":"MemberExpression","start":3107,"end":3126,"object":{"type":"Identifier","start":3107,"end":3115,"name":"protocol"},"property":{"type":"Identifier","start":3116,"end":3126,"name":"startsWith"},"computed":false},"arguments":[{"type":"Literal","start":3127,"end":3134,"value":"https","raw":"'https'"}]},"consequent":{"type":"MemberExpression","start":3138,"end":3149,"object":{"type":"Identifier","start":3138,"end":3143,"name":"https"},"property":{"type":"Identifier","start":3144,"end":3149,"name":"Agent"},"computed":false},"alternate":{"type":"MemberExpression","start":3152,"end":3162,"object":{"type":"Identifier","start":3152,"end":3156,"name":"http"},"property":{"type":"Identifier","start":3157,"end":3162,"name":"Agent"},"computed":false}}}]}}}},{"type":"FunctionDeclaration","start":3167,"end":3755,"id":{"type":"Identifier","start":3176,"end":3185,"name":"dnsLookup"},"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":3186,"end":3194,"name":"hostname"},{"type":"Identifier","start":3196,"end":3203,"name":"options"},{"type":"Identifier","start":3205,"end":3213,"name":"callback"}],"body":{"type":"BlockStatement","start":3215,"end":3755,"body":[{"type":"ExpressionStatement","start":3221,"end":3753,"expression":{"type":"CallExpression","start":3221,"end":3752,"callee":{"type":"MemberExpression","start":3221,"end":3231,"object":{"type":"Identifier","start":3221,"end":3224,"name":"dns"},"property":{"type":"Identifier","start":3225,"end":3231,"name":"lookup"},"computed":false},"arguments":[{"type":"Identifier","start":3232,"end":3240,"name":"hostname"},{"type":"Identifier","start":3242,"end":3249,"name":"options"},{"type":"ArrowFunctionExpression","start":3251,"end":3751,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":3252,"end":3255,"name":"err"},{"type":"Identifier","start":3257,"end":3266,"name":"addresses"},{"type":"Identifier","start":3268,"end":3279,"name":"maybeFamily"}],"body":{"type":"BlockStatement","start":3284,"end":3751,"body":[{"type":"IfStatement","start":3294,"end":3385,"test":{"type":"Identifier","start":3298,"end":3301,"name":"err"},"consequent":{"type":"BlockStatement","start":3303,"end":3385,"body":[{"type":"ExpressionStatement","start":3317,"end":3355,"expression":{"type":"CallExpression","start":3317,"end":3354,"callee":{"type":"Identifier","start":3317,"end":3325,"name":"callback"},"arguments":[{"type":"Identifier","start":3326,"end":3329,"name":"err"},{"type":"Identifier","start":3331,"end":3340,"name":"addresses"},{"type":"Identifier","start":3342,"end":3353,"name":"maybeFamily"}]}},{"type":"ReturnStatement","start":3368,"end":3375,"argument":null}]},"alternate":null},{"type":"VariableDeclaration","start":3394,"end":3477,"declarations":[{"type":"VariableDeclarator","start":3400,"end":3476,"id":{"type":"Identifier","start":3400,"end":3410,"name":"toValidate"},"init":{"type":"ConditionalExpression","start":3413,"end":3476,"test":{"type":"CallExpression","start":3413,"end":3437,"callee":{"type":"MemberExpression","start":3413,"end":3426,"object":{"type":"Identifier","start":3413,"end":3418,"name":"Array"},"property":{"type":"Identifier","start":3419,"end":3426,"name":"isArray"},"computed":false},"arguments":[{"type":"Identifier","start":3427,"end":3436,"name":"addresses"}]},"consequent":{"type":"Identifier","start":3440,"end":3449,"name":"addresses"},"alternate":{"type":"ArrayExpression","start":3452,"end":3476,"elements":[{"type":"ObjectExpression","start":3453,"end":3475,"properties":[{"type":"Property","start":3455,"end":3473,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3455,"end":3462,"name":"address"},"value":{"type":"Identifier","start":3464,"end":3473,"name":"addresses"},"kind":"init"}]}]}}}],"kind":"const"},{"type":"ForOfStatement","start":3486,"end":3698,"await":false,"left":{"type":"VariableDeclaration","start":3491,"end":3503,"declarations":[{"type":"VariableDeclarator","start":3497,"end":3503,"id":{"type":"Identifier","start":3497,"end":3503,"name":"record"},"init":null}],"kind":"const"},"right":{"type":"Identifier","start":3507,"end":3517,"name":"toValidate"},"body":{"type":"BlockStatement","start":3519,"end":3698,"body":[{"type":"IfStatement","start":3533,"end":3688,"test":{"type":"CallExpression","start":3537,"end":3564,"callee":{"type":"Identifier","start":3537,"end":3548,"name":"isPrivateIP"},"arguments":[{"type":"MemberExpression","start":3549,"end":3563,"object":{"type":"Identifier","start":3549,"end":3555,"name":"record"},"property":{"type":"Identifier","start":3556,"end":3563,"name":"address"},"computed":false}]},"consequent":{"type":"BlockStatement","start":3566,"end":3688,"body":[{"type":"ExpressionStatement","start":3584,"end":3650,"expression":{"type":"CallExpression","start":3584,"end":3649,"callee":{"type":"Identifier","start":3584,"end":3592,"name":"callback"},"arguments":[{"type":"NewExpression","start":3593,"end":3624,"callee":{"type":"Identifier","start":3597,"end":3602,"name":"Error"},"arguments":[{"type":"Identifier","start":3603,"end":3623,"name":"FORBIDDEN_IP_ADDRESS"}]},{"type":"Identifier","start":3626,"end":3635,"name":"addresses"},{"type":"Identifier","start":3637,"end":3648,"name":"maybeFamily"}]}},{"type":"ReturnStatement","start":3667,"end":3674,"argument":null}]},"alternate":null}]}},{"type":"ExpressionStatement","start":3707,"end":3745,"expression":{"type":"CallExpression","start":3707,"end":3744,"callee":{"type":"Identifier","start":3707,"end":3715,"name":"callback"},"arguments":[{"type":"Identifier","start":3716,"end":3719,"name":"err"},{"type":"Identifier","start":3721,"end":3730,"name":"addresses"},{"type":"Identifier","start":3732,"end":3743,"name":"maybeFamily"}]}}]}}]}}]}},{"type":"ClassDeclaration","start":3756,"end":4113,"id":{"type":"Identifier","start":3762,"end":3771,"name":"HttpAgent"},"superClass":{"type":"MemberExpression","start":3780,"end":3790,"object":{"type":"Identifier","start":3780,"end":3784,"name":"http"},"property":{"type":"Identifier","start":3785,"end":3790,"name":"Agent"},"computed":false},"body":{"type":"ClassBody","start":3791,"end":4113,"body":[{"type":"MethodDefinition","start":3797,"end":4111,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":3797,"end":3813,"name":"createConnection"},"value":{"type":"FunctionExpression","start":3813,"end":4111,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":3814,"end":3821,"name":"options"},{"type":"Identifier","start":3823,"end":3831,"name":"callback"}],"body":{"type":"BlockStatement","start":3833,"end":4111,"body":[{"type":"ExpressionStatement","start":3843,"end":3870,"expression":{"type":"AssignmentExpression","start":3843,"end":3869,"operator":"=","left":{"type":"MemberExpression","start":3843,"end":3857,"object":{"type":"Identifier","start":3843,"end":3850,"name":"options"},"property":{"type":"Identifier","start":3851,"end":3857,"name":"lookup"},"computed":false},"right":{"type":"Identifier","start":3860,"end":3869,"name":"dnsLookup"}}},{"type":"IfStatement","start":3879,"end":4025,"test":{"type":"LogicalExpression","start":3883,"end":3937,"left":{"type":"CallExpression","start":3883,"end":3908,"callee":{"type":"Identifier","start":3883,"end":3894,"name":"isIPAddress"},"arguments":[{"type":"MemberExpression","start":3895,"end":3907,"object":{"type":"Identifier","start":3895,"end":3902,"name":"options"},"property":{"type":"Identifier","start":3903,"end":3907,"name":"host"},"computed":false}]},"operator":"&&","right":{"type":"CallExpression","start":3912,"end":3937,"callee":{"type":"Identifier","start":3912,"end":3923,"name":"isPrivateIP"},"arguments":[{"type":"MemberExpression","start":3924,"end":3936,"object":{"type":"Identifier","start":3924,"end":3931,"name":"options"},"property":{"type":"Identifier","start":3932,"end":3936,"name":"host"},"computed":false}]}},"consequent":{"type":"BlockStatement","start":3939,"end":4025,"body":[{"type":"ExpressionStatement","start":3953,"end":3995,"expression":{"type":"CallExpression","start":3953,"end":3994,"callee":{"type":"Identifier","start":3953,"end":3961,"name":"callback"},"arguments":[{"type":"NewExpression","start":3962,"end":3993,"callee":{"type":"Identifier","start":3966,"end":3971,"name":"Error"},"arguments":[{"type":"Identifier","start":3972,"end":3992,"name":"FORBIDDEN_IP_ADDRESS"}]}]}},{"type":"ReturnStatement","start":4008,"end":4015,"argument":null}]},"alternate":null},{"type":"ReturnStatement","start":4056,"end":4105,"argument":{"type":"CallExpression","start":4063,"end":4104,"callee":{"type":"MemberExpression","start":4063,"end":4085,"object":{"type":"Super","start":4063,"end":4068},"property":{"type":"Identifier","start":4069,"end":4085,"name":"createConnection"},"computed":false},"arguments":[{"type":"Identifier","start":4086,"end":4093,"name":"options"},{"type":"Identifier","start":4095,"end":4103,"name":"callback"}]}}]}}}]}},{"type":"ClassDeclaration","start":4114,"end":4473,"id":{"type":"Identifier","start":4120,"end":4130,"name":"HttpsAgent"},"superClass":{"type":"MemberExpression","start":4139,"end":4150,"object":{"type":"Identifier","start":4139,"end":4144,"name":"https"},"property":{"type":"Identifier","start":4145,"end":4150,"name":"Agent"},"computed":false},"body":{"type":"ClassBody","start":4151,"end":4473,"body":[{"type":"MethodDefinition","start":4157,"end":4471,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":4157,"end":4173,"name":"createConnection"},"value":{"type":"FunctionExpression","start":4173,"end":4471,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":4174,"end":4181,"name":"options"},{"type":"Identifier","start":4183,"end":4191,"name":"callback"}],"body":{"type":"BlockStatement","start":4193,"end":4471,"body":[{"type":"ExpressionStatement","start":4203,"end":4230,"expression":{"type":"AssignmentExpression","start":4203,"end":4229,"operator":"=","left":{"type":"MemberExpression","start":4203,"end":4217,"object":{"type":"Identifier","start":4203,"end":4210,"name":"options"},"property":{"type":"Identifier","start":4211,"end":4217,"name":"lookup"},"computed":false},"right":{"type":"Identifier","start":4220,"end":4229,"name":"dnsLookup"}}},{"type":"IfStatement","start":4239,"end":4385,"test":{"type":"LogicalExpression","start":4243,"end":4297,"left":{"type":"CallExpression","start":4243,"end":4268,"callee":{"type":"Identifier","start":4243,"end":4254,"name":"isIPAddress"},"arguments":[{"type":"MemberExpression","start":4255,"end":4267,"object":{"type":"Identifier","start":4255,"end":4262,"name":"options"},"property":{"type":"Identifier","start":4263,"end":4267,"name":"host"},"computed":false}]},"operator":"&&","right":{"type":"CallExpression","start":4272,"end":4297,"callee":{"type":"Identifier","start":4272,"end":4283,"name":"isPrivateIP"},"arguments":[{"type":"MemberExpression","start":4284,"end":4296,"object":{"type":"Identifier","start":4284,"end":4291,"name":"options"},"property":{"type":"Identifier","start":4292,"end":4296,"name":"host"},"computed":false}]}},"consequent":{"type":"BlockStatement","start":4299,"end":4385,"body":[{"type":"ExpressionStatement","start":4313,"end":4355,"expression":{"type":"CallExpression","start":4313,"end":4354,"callee":{"type":"Identifier","start":4313,"end":4321,"name":"callback"},"arguments":[{"type":"NewExpression","start":4322,"end":4353,"callee":{"type":"Identifier","start":4326,"end":4331,"name":"Error"},"arguments":[{"type":"Identifier","start":4332,"end":4352,"name":"FORBIDDEN_IP_ADDRESS"}]}]}},{"type":"ReturnStatement","start":4368,"end":4375,"argument":null}]},"alternate":null},{"type":"ReturnStatement","start":4416,"end":4465,"argument":{"type":"CallExpression","start":4423,"end":4464,"callee":{"type":"MemberExpression","start":4423,"end":4445,"object":{"type":"Super","start":4423,"end":4428},"property":{"type":"Identifier","start":4429,"end":4445,"name":"createConnection"},"computed":false},"arguments":[{"type":"Identifier","start":4446,"end":4453,"name":"options"},{"type":"Identifier","start":4455,"end":4463,"name":"callback"}]}}]}}}]}}],"sourceType":"script"}