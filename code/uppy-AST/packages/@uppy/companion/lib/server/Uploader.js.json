{"type":"Program","start":0,"end":20576,"body":[{"type":"VariableDeclaration","start":0,"end":25,"declarations":[{"type":"VariableDeclarator","start":6,"end":24,"id":{"type":"Identifier","start":6,"end":8,"name":"fs"},"init":{"type":"CallExpression","start":11,"end":24,"callee":{"type":"Identifier","start":11,"end":18,"name":"require"},"arguments":[{"type":"Literal","start":19,"end":23,"value":"fs","raw":"'fs'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":26,"end":55,"declarations":[{"type":"VariableDeclarator","start":32,"end":54,"id":{"type":"Identifier","start":32,"end":36,"name":"path"},"init":{"type":"CallExpression","start":39,"end":54,"callee":{"type":"Identifier","start":39,"end":46,"name":"require"},"arguments":[{"type":"Literal","start":47,"end":53,"value":"path","raw":"'path'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":56,"end":93,"declarations":[{"type":"VariableDeclarator","start":62,"end":92,"id":{"type":"Identifier","start":62,"end":65,"name":"tus"},"init":{"type":"CallExpression","start":68,"end":92,"callee":{"type":"Identifier","start":68,"end":75,"name":"require"},"arguments":[{"type":"Literal","start":76,"end":91,"value":"tus-js-client","raw":"'tus-js-client'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":94,"end":123,"declarations":[{"type":"VariableDeclarator","start":100,"end":122,"id":{"type":"Identifier","start":100,"end":104,"name":"uuid"},"init":{"type":"CallExpression","start":107,"end":122,"callee":{"type":"Identifier","start":107,"end":114,"name":"require"},"arguments":[{"type":"Literal","start":115,"end":121,"value":"uuid","raw":"'uuid'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":124,"end":161,"declarations":[{"type":"VariableDeclarator","start":130,"end":160,"id":{"type":"Identifier","start":130,"end":138,"name":"isObject"},"init":{"type":"CallExpression","start":141,"end":160,"callee":{"type":"Identifier","start":141,"end":148,"name":"require"},"arguments":[{"type":"Literal","start":149,"end":159,"value":"isobject","raw":"'isobject'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":162,"end":201,"declarations":[{"type":"VariableDeclarator","start":168,"end":200,"id":{"type":"Identifier","start":168,"end":177,"name":"validator"},"init":{"type":"CallExpression","start":180,"end":200,"callee":{"type":"Identifier","start":180,"end":187,"name":"require"},"arguments":[{"type":"Literal","start":188,"end":199,"value":"validator","raw":"'validator'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":202,"end":237,"declarations":[{"type":"VariableDeclarator","start":208,"end":236,"id":{"type":"Identifier","start":208,"end":215,"name":"request"},"init":{"type":"CallExpression","start":218,"end":236,"callee":{"type":"Identifier","start":218,"end":225,"name":"require"},"arguments":[{"type":"Literal","start":226,"end":235,"value":"request","raw":"'request'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":238,"end":275,"declarations":[{"type":"VariableDeclarator","start":244,"end":274,"id":{"type":"Identifier","start":244,"end":251,"name":"emitter"},"init":{"type":"CallExpression","start":254,"end":274,"callee":{"type":"Identifier","start":254,"end":261,"name":"require"},"arguments":[{"type":"Literal","start":262,"end":273,"value":"./emitter","raw":"'./emitter'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":276,"end":326,"declarations":[{"type":"VariableDeclarator","start":282,"end":325,"id":{"type":"Identifier","start":282,"end":296,"name":"serializeError"},"init":{"type":"CallExpression","start":299,"end":325,"callee":{"type":"Identifier","start":299,"end":306,"name":"require"},"arguments":[{"type":"Literal","start":307,"end":324,"value":"serialize-error","raw":"'serialize-error'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":327,"end":390,"declarations":[{"type":"VariableDeclarator","start":333,"end":389,"id":{"type":"ObjectPattern","start":333,"end":360,"properties":[{"type":"Property","start":335,"end":348,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":335,"end":348,"name":"jsonStringify"},"kind":"init","value":{"type":"Identifier","start":335,"end":348,"name":"jsonStringify"}},{"type":"Property","start":350,"end":358,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":350,"end":358,"name":"hasMatch"},"kind":"init","value":{"type":"Identifier","start":350,"end":358,"name":"hasMatch"}}]},"init":{"type":"CallExpression","start":363,"end":389,"callee":{"type":"Identifier","start":363,"end":370,"name":"require"},"arguments":[{"type":"Literal","start":371,"end":388,"value":"./helpers/utils","raw":"'./helpers/utils'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":391,"end":426,"declarations":[{"type":"VariableDeclarator","start":397,"end":425,"id":{"type":"Identifier","start":397,"end":403,"name":"logger"},"init":{"type":"CallExpression","start":406,"end":425,"callee":{"type":"Identifier","start":406,"end":413,"name":"require"},"arguments":[{"type":"Literal","start":414,"end":424,"value":"./logger","raw":"'./logger'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":427,"end":480,"declarations":[{"type":"VariableDeclarator","start":433,"end":479,"id":{"type":"Identifier","start":433,"end":447,"name":"headerSanitize"},"init":{"type":"CallExpression","start":450,"end":479,"callee":{"type":"Identifier","start":450,"end":457,"name":"require"},"arguments":[{"type":"Literal","start":458,"end":478,"value":"./header-blacklist","raw":"'./header-blacklist'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":481,"end":514,"declarations":[{"type":"VariableDeclarator","start":487,"end":513,"id":{"type":"Identifier","start":487,"end":492,"name":"redis"},"init":{"type":"CallExpression","start":495,"end":513,"callee":{"type":"Identifier","start":495,"end":502,"name":"require"},"arguments":[{"type":"Literal","start":503,"end":512,"value":"./redis","raw":"'./redis'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":515,"end":552,"declarations":[{"type":"VariableDeclarator","start":521,"end":551,"id":{"type":"Identifier","start":521,"end":539,"name":"DEFAULT_FIELD_NAME"},"init":{"type":"Literal","start":542,"end":551,"value":"files[]","raw":"'files[]'"}}],"kind":"const"},{"type":"VariableDeclaration","start":553,"end":666,"declarations":[{"type":"VariableDeclarator","start":559,"end":665,"id":{"type":"Identifier","start":559,"end":568,"name":"PROTOCOLS"},"init":{"type":"CallExpression","start":571,"end":665,"callee":{"type":"MemberExpression","start":571,"end":584,"object":{"type":"Identifier","start":571,"end":577,"name":"Object"},"property":{"type":"Identifier","start":578,"end":584,"name":"freeze"},"computed":false},"arguments":[{"type":"ObjectExpression","start":585,"end":664,"properties":[{"type":"Property","start":591,"end":613,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":591,"end":600,"name":"multipart"},"value":{"type":"Literal","start":602,"end":613,"value":"multipart","raw":"'multipart'"},"kind":"init"},{"type":"Property","start":619,"end":646,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":619,"end":630,"name":"s3Multipart"},"value":{"type":"Literal","start":632,"end":646,"value":"s3-multipart","raw":"'s3-multipart'"},"kind":"init"},{"type":"Property","start":652,"end":662,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":652,"end":655,"name":"tus"},"value":{"type":"Literal","start":657,"end":662,"value":"tus","raw":"'tus'"},"kind":"init"}]}]}}],"kind":"const"},{"type":"ClassDeclaration","start":667,"end":20468,"id":{"type":"Identifier","start":673,"end":681,"name":"Uploader"},"superClass":null,"body":{"type":"ClassBody","start":682,"end":20468,"body":[{"type":"MethodDefinition","start":1504,"end":3570,"kind":"constructor","static":false,"computed":false,"key":{"type":"Identifier","start":1504,"end":1515,"name":"constructor"},"value":{"type":"FunctionExpression","start":1515,"end":3570,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":1516,"end":1523,"name":"options"}],"body":{"type":"BlockStatement","start":1525,"end":3570,"body":[{"type":"IfStatement","start":1535,"end":1677,"test":{"type":"UnaryExpression","start":1539,"end":1569,"operator":"!","prefix":true,"argument":{"type":"CallExpression","start":1540,"end":1569,"callee":{"type":"MemberExpression","start":1540,"end":1560,"object":{"type":"ThisExpression","start":1540,"end":1544},"property":{"type":"Identifier","start":1545,"end":1560,"name":"validateOptions"},"computed":false},"arguments":[{"type":"Identifier","start":1561,"end":1568,"name":"options"}]}},"consequent":{"type":"BlockStatement","start":1571,"end":1677,"body":[{"type":"ExpressionStatement","start":1585,"end":1647,"expression":{"type":"CallExpression","start":1585,"end":1646,"callee":{"type":"MemberExpression","start":1585,"end":1597,"object":{"type":"Identifier","start":1585,"end":1591,"name":"logger"},"property":{"type":"Identifier","start":1592,"end":1597,"name":"debug"},"computed":false},"arguments":[{"type":"MemberExpression","start":1598,"end":1618,"object":{"type":"ThisExpression","start":1598,"end":1602},"property":{"type":"Identifier","start":1603,"end":1618,"name":"_errRespMessage"},"computed":false},{"type":"Literal","start":1620,"end":1645,"value":"uploader.validator.fail","raw":"'uploader.validator.fail'"}]}},{"type":"ReturnStatement","start":1660,"end":1667,"argument":null}]},"alternate":null},{"type":"ExpressionStatement","start":1686,"end":1709,"expression":{"type":"AssignmentExpression","start":1686,"end":1708,"operator":"=","left":{"type":"MemberExpression","start":1686,"end":1698,"object":{"type":"ThisExpression","start":1686,"end":1690},"property":{"type":"Identifier","start":1691,"end":1698,"name":"options"},"computed":false},"right":{"type":"Identifier","start":1701,"end":1708,"name":"options"}}},{"type":"ExpressionStatement","start":1718,"end":1741,"expression":{"type":"AssignmentExpression","start":1718,"end":1740,"operator":"=","left":{"type":"MemberExpression","start":1718,"end":1728,"object":{"type":"ThisExpression","start":1718,"end":1722},"property":{"type":"Identifier","start":1723,"end":1728,"name":"token"},"computed":false},"right":{"type":"CallExpression","start":1731,"end":1740,"callee":{"type":"MemberExpression","start":1731,"end":1738,"object":{"type":"Identifier","start":1731,"end":1735,"name":"uuid"},"property":{"type":"Identifier","start":1736,"end":1738,"name":"v4"},"computed":false},"arguments":[]}}},{"type":"ExpressionStatement","start":1750,"end":1834,"expression":{"type":"AssignmentExpression","start":1750,"end":1833,"operator":"=","left":{"type":"MemberExpression","start":1750,"end":1759,"object":{"type":"ThisExpression","start":1750,"end":1754},"property":{"type":"Identifier","start":1755,"end":1759,"name":"path"},"computed":false},"right":{"type":"TemplateLiteral","start":1762,"end":1833,"expressions":[{"type":"MemberExpression","start":1765,"end":1788,"object":{"type":"MemberExpression","start":1765,"end":1777,"object":{"type":"ThisExpression","start":1765,"end":1769},"property":{"type":"Identifier","start":1770,"end":1777,"name":"options"},"computed":false},"property":{"type":"Identifier","start":1778,"end":1788,"name":"pathPrefix"},"computed":false},{"type":"MemberExpression","start":1792,"end":1817,"object":{"type":"Identifier","start":1792,"end":1800,"name":"Uploader"},"property":{"type":"Identifier","start":1801,"end":1817,"name":"FILE_NAME_PREFIX"},"computed":false},{"type":"MemberExpression","start":1821,"end":1831,"object":{"type":"ThisExpression","start":1821,"end":1825},"property":{"type":"Identifier","start":1826,"end":1831,"name":"token"},"computed":false}],"quasis":[{"type":"TemplateElement","start":1763,"end":1763,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":1789,"end":1790,"value":{"raw":"/","cooked":"/"},"tail":false},{"type":"TemplateElement","start":1818,"end":1819,"value":{"raw":"-","cooked":"-"},"tail":false},{"type":"TemplateElement","start":1832,"end":1832,"value":{"raw":"","cooked":""},"tail":true}]}}},{"type":"ExpressionStatement","start":1843,"end":1895,"expression":{"type":"AssignmentExpression","start":1843,"end":1894,"operator":"=","left":{"type":"MemberExpression","start":1843,"end":1864,"object":{"type":"MemberExpression","start":1843,"end":1855,"object":{"type":"ThisExpression","start":1843,"end":1847},"property":{"type":"Identifier","start":1848,"end":1855,"name":"options"},"computed":false},"property":{"type":"Identifier","start":1856,"end":1864,"name":"metadata"},"computed":false},"right":{"type":"LogicalExpression","start":1867,"end":1894,"left":{"type":"MemberExpression","start":1867,"end":1888,"object":{"type":"MemberExpression","start":1867,"end":1879,"object":{"type":"ThisExpression","start":1867,"end":1871},"property":{"type":"Identifier","start":1872,"end":1879,"name":"options"},"computed":false},"property":{"type":"Identifier","start":1880,"end":1888,"name":"metadata"},"computed":false},"operator":"||","right":{"type":"ObjectExpression","start":1892,"end":1894,"properties":[]}}}},{"type":"ExpressionStatement","start":1904,"end":1974,"expression":{"type":"AssignmentExpression","start":1904,"end":1973,"operator":"=","left":{"type":"MemberExpression","start":1904,"end":1926,"object":{"type":"MemberExpression","start":1904,"end":1916,"object":{"type":"ThisExpression","start":1904,"end":1908},"property":{"type":"Identifier","start":1909,"end":1916,"name":"options"},"computed":false},"property":{"type":"Identifier","start":1917,"end":1926,"name":"fieldname"},"computed":false},"right":{"type":"LogicalExpression","start":1929,"end":1973,"left":{"type":"MemberExpression","start":1929,"end":1951,"object":{"type":"MemberExpression","start":1929,"end":1941,"object":{"type":"ThisExpression","start":1929,"end":1933},"property":{"type":"Identifier","start":1934,"end":1941,"name":"options"},"computed":false},"property":{"type":"Identifier","start":1942,"end":1951,"name":"fieldname"},"computed":false},"operator":"||","right":{"type":"Identifier","start":1955,"end":1973,"name":"DEFAULT_FIELD_NAME"}}}},{"type":"ExpressionStatement","start":1983,"end":2060,"expression":{"type":"AssignmentExpression","start":1983,"end":2059,"operator":"=","left":{"type":"MemberExpression","start":1983,"end":2002,"object":{"type":"ThisExpression","start":1983,"end":1987},"property":{"type":"Identifier","start":1988,"end":2002,"name":"uploadFileName"},"computed":false},"right":{"type":"LogicalExpression","start":2005,"end":2059,"left":{"type":"MemberExpression","start":2005,"end":2031,"object":{"type":"MemberExpression","start":2005,"end":2026,"object":{"type":"MemberExpression","start":2005,"end":2017,"object":{"type":"ThisExpression","start":2005,"end":2009},"property":{"type":"Identifier","start":2010,"end":2017,"name":"options"},"computed":false},"property":{"type":"Identifier","start":2018,"end":2026,"name":"metadata"},"computed":false},"property":{"type":"Identifier","start":2027,"end":2031,"name":"name"},"computed":false},"operator":"||","right":{"type":"CallExpression","start":2035,"end":2059,"callee":{"type":"MemberExpression","start":2035,"end":2048,"object":{"type":"Identifier","start":2035,"end":2039,"name":"path"},"property":{"type":"Identifier","start":2040,"end":2048,"name":"basename"},"computed":false},"arguments":[{"type":"MemberExpression","start":2049,"end":2058,"object":{"type":"ThisExpression","start":2049,"end":2053},"property":{"type":"Identifier","start":2054,"end":2058,"name":"path"},"computed":false}]}}}},{"type":"ExpressionStatement","start":2069,"end":2095,"expression":{"type":"AssignmentExpression","start":2069,"end":2094,"operator":"=","left":{"type":"MemberExpression","start":2069,"end":2086,"object":{"type":"ThisExpression","start":2069,"end":2073},"property":{"type":"Identifier","start":2074,"end":2086,"name":"streamsEnded"},"computed":false},"right":{"type":"Literal","start":2089,"end":2094,"value":false,"raw":"false"}}},{"type":"ExpressionStatement","start":2104,"end":2131,"expression":{"type":"AssignmentExpression","start":2104,"end":2130,"operator":"=","left":{"type":"MemberExpression","start":2104,"end":2122,"object":{"type":"ThisExpression","start":2104,"end":2108},"property":{"type":"Identifier","start":2109,"end":2122,"name":"uploadStopped"},"computed":false},"right":{"type":"Literal","start":2125,"end":2130,"value":false,"raw":"false"}}},{"type":"ExpressionStatement","start":2140,"end":2165,"expression":{"type":"AssignmentExpression","start":2140,"end":2164,"operator":"=","left":{"type":"MemberExpression","start":2140,"end":2157,"object":{"type":"ThisExpression","start":2140,"end":2144},"property":{"type":"Identifier","start":2145,"end":2157,"name":"duplexStream"},"computed":false},"right":{"type":"Literal","start":2160,"end":2164,"value":null,"raw":"null"}}},{"type":"ExpressionStatement","start":2474,"end":2664,"expression":{"type":"AssignmentExpression","start":2474,"end":2663,"operator":"=","left":{"type":"MemberExpression","start":2474,"end":2490,"object":{"type":"ThisExpression","start":2474,"end":2478},"property":{"type":"Identifier","start":2479,"end":2490,"name":"writeStream"},"computed":false},"right":{"type":"CallExpression","start":2493,"end":2663,"callee":{"type":"MemberExpression","start":2493,"end":2580,"object":{"type":"CallExpression","start":2493,"end":2541,"callee":{"type":"MemberExpression","start":2493,"end":2513,"object":{"type":"Identifier","start":2493,"end":2495,"name":"fs"},"property":{"type":"Identifier","start":2496,"end":2513,"name":"createWriteStream"},"computed":false},"arguments":[{"type":"MemberExpression","start":2514,"end":2523,"object":{"type":"ThisExpression","start":2514,"end":2518},"property":{"type":"Identifier","start":2519,"end":2523,"name":"path"},"computed":false},{"type":"ObjectExpression","start":2525,"end":2540,"properties":[{"type":"Property","start":2527,"end":2538,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2527,"end":2531,"name":"mode"},"value":{"type":"Literal","start":2533,"end":2538,"value":438,"raw":"0o666"},"kind":"init"}]}]},"property":{"type":"Identifier","start":2578,"end":2580,"name":"on"},"computed":false},"arguments":[{"type":"Literal","start":2581,"end":2588,"value":"error","raw":"'error'"},{"type":"ArrowFunctionExpression","start":2590,"end":2662,"id":null,"expression":true,"generator":false,"async":false,"params":[{"type":"Identifier","start":2591,"end":2594,"name":"err"}],"body":{"type":"CallExpression","start":2599,"end":2662,"callee":{"type":"MemberExpression","start":2599,"end":2611,"object":{"type":"Identifier","start":2599,"end":2605,"name":"logger"},"property":{"type":"Identifier","start":2606,"end":2611,"name":"error"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":2612,"end":2620,"expressions":[{"type":"Identifier","start":2615,"end":2618,"name":"err"}],"quasis":[{"type":"TemplateElement","start":2613,"end":2613,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":2619,"end":2619,"value":{"raw":"","cooked":""},"tail":true}]},{"type":"Literal","start":2622,"end":2644,"value":"uploader.write.error","raw":"'uploader.write.error'"},{"type":"MemberExpression","start":2646,"end":2661,"object":{"type":"ThisExpression","start":2646,"end":2650},"property":{"type":"Identifier","start":2651,"end":2661,"name":"shortToken"},"computed":false}]}}]}}},{"type":"ExpressionStatement","start":2703,"end":2728,"expression":{"type":"AssignmentExpression","start":2703,"end":2727,"operator":"=","left":{"type":"MemberExpression","start":2703,"end":2723,"object":{"type":"ThisExpression","start":2703,"end":2707},"property":{"type":"Identifier","start":2708,"end":2723,"name":"emittedProgress"},"computed":false},"right":{"type":"Literal","start":2726,"end":2727,"value":0,"raw":"0"}}},{"type":"ExpressionStatement","start":2737,"end":2768,"expression":{"type":"AssignmentExpression","start":2737,"end":2767,"operator":"=","left":{"type":"MemberExpression","start":2737,"end":2749,"object":{"type":"ThisExpression","start":2737,"end":2741},"property":{"type":"Identifier","start":2742,"end":2749,"name":"storage"},"computed":false},"right":{"type":"MemberExpression","start":2752,"end":2767,"object":{"type":"Identifier","start":2752,"end":2759,"name":"options"},"property":{"type":"Identifier","start":2760,"end":2767,"name":"storage"},"computed":false}}},{"type":"ExpressionStatement","start":2777,"end":2798,"expression":{"type":"AssignmentExpression","start":2777,"end":2797,"operator":"=","left":{"type":"MemberExpression","start":2777,"end":2789,"object":{"type":"ThisExpression","start":2777,"end":2781},"property":{"type":"Identifier","start":2782,"end":2789,"name":"_paused"},"computed":false},"right":{"type":"Literal","start":2792,"end":2797,"value":false,"raw":"false"}}},{"type":"IfStatement","start":2807,"end":3564,"test":{"type":"BinaryExpression","start":2811,"end":2850,"left":{"type":"MemberExpression","start":2811,"end":2832,"object":{"type":"MemberExpression","start":2811,"end":2823,"object":{"type":"ThisExpression","start":2811,"end":2815},"property":{"type":"Identifier","start":2816,"end":2823,"name":"options"},"computed":false},"property":{"type":"Identifier","start":2824,"end":2832,"name":"protocol"},"computed":false},"operator":"===","right":{"type":"MemberExpression","start":2837,"end":2850,"object":{"type":"Identifier","start":2837,"end":2846,"name":"PROTOCOLS"},"property":{"type":"Identifier","start":2847,"end":2850,"name":"tus"},"computed":false}},"consequent":{"type":"BlockStatement","start":2852,"end":3564,"body":[{"type":"ExpressionStatement","start":2866,"end":3050,"expression":{"type":"CallExpression","start":2866,"end":3049,"callee":{"type":"MemberExpression","start":2866,"end":2878,"object":{"type":"CallExpression","start":2866,"end":2875,"callee":{"type":"Identifier","start":2866,"end":2873,"name":"emitter"},"arguments":[]},"property":{"type":"Identifier","start":2876,"end":2878,"name":"on"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":2879,"end":2900,"expressions":[{"type":"MemberExpression","start":2888,"end":2898,"object":{"type":"ThisExpression","start":2888,"end":2892},"property":{"type":"Identifier","start":2893,"end":2898,"name":"token"},"computed":false}],"quasis":[{"type":"TemplateElement","start":2880,"end":2886,"value":{"raw":"pause:","cooked":"pause:"},"tail":false},{"type":"TemplateElement","start":2899,"end":2899,"value":{"raw":"","cooked":""},"tail":true}]},{"type":"ArrowFunctionExpression","start":2902,"end":3048,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":2908,"end":3048,"body":[{"type":"ExpressionStatement","start":2926,"end":2946,"expression":{"type":"AssignmentExpression","start":2926,"end":2945,"operator":"=","left":{"type":"MemberExpression","start":2926,"end":2938,"object":{"type":"ThisExpression","start":2926,"end":2930},"property":{"type":"Identifier","start":2931,"end":2938,"name":"_paused"},"computed":false},"right":{"type":"Literal","start":2941,"end":2945,"value":true,"raw":"true"}}},{"type":"IfStatement","start":2963,"end":3034,"test":{"type":"MemberExpression","start":2967,"end":2975,"object":{"type":"ThisExpression","start":2967,"end":2971},"property":{"type":"Identifier","start":2972,"end":2975,"name":"tus"},"computed":false},"consequent":{"type":"BlockStatement","start":2977,"end":3034,"body":[{"type":"ExpressionStatement","start":2999,"end":3016,"expression":{"type":"CallExpression","start":2999,"end":3015,"callee":{"type":"MemberExpression","start":2999,"end":3013,"object":{"type":"MemberExpression","start":2999,"end":3007,"object":{"type":"ThisExpression","start":2999,"end":3003},"property":{"type":"Identifier","start":3004,"end":3007,"name":"tus"},"computed":false},"property":{"type":"Identifier","start":3008,"end":3013,"name":"abort"},"computed":false},"arguments":[]}}]},"alternate":null}]}}]}},{"type":"ExpressionStatement","start":3063,"end":3249,"expression":{"type":"CallExpression","start":3063,"end":3248,"callee":{"type":"MemberExpression","start":3063,"end":3075,"object":{"type":"CallExpression","start":3063,"end":3072,"callee":{"type":"Identifier","start":3063,"end":3070,"name":"emitter"},"arguments":[]},"property":{"type":"Identifier","start":3073,"end":3075,"name":"on"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":3076,"end":3098,"expressions":[{"type":"MemberExpression","start":3086,"end":3096,"object":{"type":"ThisExpression","start":3086,"end":3090},"property":{"type":"Identifier","start":3091,"end":3096,"name":"token"},"computed":false}],"quasis":[{"type":"TemplateElement","start":3077,"end":3084,"value":{"raw":"resume:","cooked":"resume:"},"tail":false},{"type":"TemplateElement","start":3097,"end":3097,"value":{"raw":"","cooked":""},"tail":true}]},{"type":"ArrowFunctionExpression","start":3100,"end":3247,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":3106,"end":3247,"body":[{"type":"ExpressionStatement","start":3124,"end":3145,"expression":{"type":"AssignmentExpression","start":3124,"end":3144,"operator":"=","left":{"type":"MemberExpression","start":3124,"end":3136,"object":{"type":"ThisExpression","start":3124,"end":3128},"property":{"type":"Identifier","start":3129,"end":3136,"name":"_paused"},"computed":false},"right":{"type":"Literal","start":3139,"end":3144,"value":false,"raw":"false"}}},{"type":"IfStatement","start":3162,"end":3233,"test":{"type":"MemberExpression","start":3166,"end":3174,"object":{"type":"ThisExpression","start":3166,"end":3170},"property":{"type":"Identifier","start":3171,"end":3174,"name":"tus"},"computed":false},"consequent":{"type":"BlockStatement","start":3176,"end":3233,"body":[{"type":"ExpressionStatement","start":3198,"end":3215,"expression":{"type":"CallExpression","start":3198,"end":3214,"callee":{"type":"MemberExpression","start":3198,"end":3212,"object":{"type":"MemberExpression","start":3198,"end":3206,"object":{"type":"ThisExpression","start":3198,"end":3202},"property":{"type":"Identifier","start":3203,"end":3206,"name":"tus"},"computed":false},"property":{"type":"Identifier","start":3207,"end":3212,"name":"start"},"computed":false},"arguments":[]}}]},"alternate":null}]}}]}},{"type":"ExpressionStatement","start":3262,"end":3554,"expression":{"type":"CallExpression","start":3262,"end":3553,"callee":{"type":"MemberExpression","start":3262,"end":3274,"object":{"type":"CallExpression","start":3262,"end":3271,"callee":{"type":"Identifier","start":3262,"end":3269,"name":"emitter"},"arguments":[]},"property":{"type":"Identifier","start":3272,"end":3274,"name":"on"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":3275,"end":3297,"expressions":[{"type":"MemberExpression","start":3285,"end":3295,"object":{"type":"ThisExpression","start":3285,"end":3289},"property":{"type":"Identifier","start":3290,"end":3295,"name":"token"},"computed":false}],"quasis":[{"type":"TemplateElement","start":3276,"end":3283,"value":{"raw":"cancel:","cooked":"cancel:"},"tail":false},{"type":"TemplateElement","start":3296,"end":3296,"value":{"raw":"","cooked":""},"tail":true}]},{"type":"ArrowFunctionExpression","start":3299,"end":3552,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":3305,"end":3552,"body":[{"type":"ExpressionStatement","start":3323,"end":3343,"expression":{"type":"AssignmentExpression","start":3323,"end":3342,"operator":"=","left":{"type":"MemberExpression","start":3323,"end":3335,"object":{"type":"ThisExpression","start":3323,"end":3327},"property":{"type":"Identifier","start":3328,"end":3335,"name":"_paused"},"computed":false},"right":{"type":"Literal","start":3338,"end":3342,"value":true,"raw":"true"}}},{"type":"IfStatement","start":3360,"end":3506,"test":{"type":"MemberExpression","start":3364,"end":3372,"object":{"type":"ThisExpression","start":3364,"end":3368},"property":{"type":"Identifier","start":3369,"end":3372,"name":"tus"},"computed":false},"consequent":{"type":"BlockStatement","start":3374,"end":3506,"body":[{"type":"VariableDeclaration","start":3396,"end":3435,"declarations":[{"type":"VariableDeclarator","start":3402,"end":3434,"id":{"type":"Identifier","start":3402,"end":3417,"name":"shouldTerminate"},"init":{"type":"UnaryExpression","start":3420,"end":3434,"operator":"!","prefix":true,"argument":{"type":"UnaryExpression","start":3421,"end":3434,"operator":"!","prefix":true,"argument":{"type":"MemberExpression","start":3422,"end":3434,"object":{"type":"MemberExpression","start":3422,"end":3430,"object":{"type":"ThisExpression","start":3422,"end":3426},"property":{"type":"Identifier","start":3427,"end":3430,"name":"tus"},"computed":false},"property":{"type":"Identifier","start":3431,"end":3434,"name":"url"},"computed":false}}}}],"kind":"const"},{"type":"ExpressionStatement","start":3456,"end":3488,"expression":{"type":"CallExpression","start":3456,"end":3487,"callee":{"type":"MemberExpression","start":3456,"end":3470,"object":{"type":"MemberExpression","start":3456,"end":3464,"object":{"type":"ThisExpression","start":3456,"end":3460},"property":{"type":"Identifier","start":3461,"end":3464,"name":"tus"},"computed":false},"property":{"type":"Identifier","start":3465,"end":3470,"name":"abort"},"computed":false},"arguments":[{"type":"Identifier","start":3471,"end":3486,"name":"shouldTerminate"}]}}]},"alternate":null},{"type":"ExpressionStatement","start":3523,"end":3538,"expression":{"type":"CallExpression","start":3523,"end":3537,"callee":{"type":"MemberExpression","start":3523,"end":3535,"object":{"type":"ThisExpression","start":3523,"end":3527},"property":{"type":"Identifier","start":3528,"end":3535,"name":"cleanUp"},"computed":false},"arguments":[]}}]}}]}}]},"alternate":null}]}}},{"type":"MethodDefinition","start":3879,"end":3951,"kind":"method","static":true,"computed":false,"key":{"type":"Identifier","start":3886,"end":3898,"name":"shortenToken"},"value":{"type":"FunctionExpression","start":3898,"end":3951,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":3899,"end":3904,"name":"token"}],"body":{"type":"BlockStatement","start":3906,"end":3951,"body":[{"type":"ReturnStatement","start":3916,"end":3945,"argument":{"type":"CallExpression","start":3923,"end":3944,"callee":{"type":"MemberExpression","start":3923,"end":3938,"object":{"type":"Identifier","start":3923,"end":3928,"name":"token"},"property":{"type":"Identifier","start":3929,"end":3938,"name":"substring"},"computed":false},"arguments":[{"type":"Literal","start":3939,"end":3940,"value":0,"raw":"0"},{"type":"Literal","start":3942,"end":3943,"value":8,"raw":"8"}]}}]}}},{"type":"MethodDefinition","start":3956,"end":4859,"kind":"method","static":true,"computed":false,"key":{"type":"Identifier","start":3963,"end":3975,"name":"reqToOptions"},"value":{"type":"FunctionExpression","start":3975,"end":4859,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":3976,"end":3979,"name":"req"},{"type":"Identifier","start":3981,"end":3985,"name":"size"}],"body":{"type":"BlockStatement","start":3987,"end":4859,"body":[{"type":"VariableDeclaration","start":3997,"end":4084,"declarations":[{"type":"VariableDeclarator","start":4003,"end":4083,"id":{"type":"Identifier","start":4003,"end":4019,"name":"useFormDataIsSet"},"init":{"type":"CallExpression","start":4022,"end":4083,"callee":{"type":"MemberExpression","start":4022,"end":4058,"object":{"type":"MemberExpression","start":4022,"end":4053,"object":{"type":"MemberExpression","start":4022,"end":4038,"object":{"type":"Identifier","start":4022,"end":4028,"name":"Object"},"property":{"type":"Identifier","start":4029,"end":4038,"name":"prototype"},"computed":false},"property":{"type":"Identifier","start":4039,"end":4053,"name":"hasOwnProperty"},"computed":false},"property":{"type":"Identifier","start":4054,"end":4058,"name":"call"},"computed":false},"arguments":[{"type":"MemberExpression","start":4059,"end":4067,"object":{"type":"Identifier","start":4059,"end":4062,"name":"req"},"property":{"type":"Identifier","start":4063,"end":4067,"name":"body"},"computed":false},{"type":"Literal","start":4069,"end":4082,"value":"useFormData","raw":"'useFormData'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":4093,"end":4160,"declarations":[{"type":"VariableDeclarator","start":4099,"end":4159,"id":{"type":"Identifier","start":4099,"end":4110,"name":"useFormData"},"init":{"type":"ConditionalExpression","start":4113,"end":4159,"test":{"type":"Identifier","start":4113,"end":4129,"name":"useFormDataIsSet"},"consequent":{"type":"MemberExpression","start":4132,"end":4152,"object":{"type":"MemberExpression","start":4132,"end":4140,"object":{"type":"Identifier","start":4132,"end":4135,"name":"req"},"property":{"type":"Identifier","start":4136,"end":4140,"name":"body"},"computed":false},"property":{"type":"Identifier","start":4141,"end":4152,"name":"useFormData"},"computed":false},"alternate":{"type":"Literal","start":4155,"end":4159,"value":true,"raw":"true"}}}],"kind":"const"},{"type":"ReturnStatement","start":4169,"end":4853,"argument":{"type":"ObjectExpression","start":4176,"end":4852,"properties":[{"type":"Property","start":4190,"end":4229,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4190,"end":4206,"name":"companionOptions"},"value":{"type":"MemberExpression","start":4208,"end":4229,"object":{"type":"MemberExpression","start":4208,"end":4221,"object":{"type":"Identifier","start":4208,"end":4211,"name":"req"},"property":{"type":"Identifier","start":4212,"end":4221,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":4222,"end":4229,"name":"options"},"computed":false},"kind":"init"},{"type":"Property","start":4243,"end":4270,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4243,"end":4251,"name":"endpoint"},"value":{"type":"MemberExpression","start":4253,"end":4270,"object":{"type":"MemberExpression","start":4253,"end":4261,"object":{"type":"Identifier","start":4253,"end":4256,"name":"req"},"property":{"type":"Identifier","start":4257,"end":4261,"name":"body"},"computed":false},"property":{"type":"Identifier","start":4262,"end":4270,"name":"endpoint"},"computed":false},"kind":"init"},{"type":"Property","start":4284,"end":4313,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4284,"end":4293,"name":"uploadUrl"},"value":{"type":"MemberExpression","start":4295,"end":4313,"object":{"type":"MemberExpression","start":4295,"end":4303,"object":{"type":"Identifier","start":4295,"end":4298,"name":"req"},"property":{"type":"Identifier","start":4299,"end":4303,"name":"body"},"computed":false},"property":{"type":"Identifier","start":4304,"end":4313,"name":"uploadUrl"},"computed":false},"kind":"init"},{"type":"Property","start":4327,"end":4354,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4327,"end":4335,"name":"protocol"},"value":{"type":"MemberExpression","start":4337,"end":4354,"object":{"type":"MemberExpression","start":4337,"end":4345,"object":{"type":"Identifier","start":4337,"end":4340,"name":"req"},"property":{"type":"Identifier","start":4341,"end":4345,"name":"body"},"computed":false},"property":{"type":"Identifier","start":4346,"end":4354,"name":"protocol"},"computed":false},"kind":"init"},{"type":"Property","start":4368,"end":4395,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4368,"end":4376,"name":"metadata"},"value":{"type":"MemberExpression","start":4378,"end":4395,"object":{"type":"MemberExpression","start":4378,"end":4386,"object":{"type":"Identifier","start":4378,"end":4381,"name":"req"},"property":{"type":"Identifier","start":4382,"end":4386,"name":"body"},"computed":false},"property":{"type":"Identifier","start":4387,"end":4395,"name":"metadata"},"computed":false},"kind":"init"},{"type":"Property","start":4409,"end":4440,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4409,"end":4419,"name":"httpMethod"},"value":{"type":"MemberExpression","start":4421,"end":4440,"object":{"type":"MemberExpression","start":4421,"end":4429,"object":{"type":"Identifier","start":4421,"end":4424,"name":"req"},"property":{"type":"Identifier","start":4425,"end":4429,"name":"body"},"computed":false},"property":{"type":"Identifier","start":4430,"end":4440,"name":"httpMethod"},"computed":false},"kind":"init"},{"type":"Property","start":4454,"end":4465,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":4454,"end":4465,"name":"useFormData"},"kind":"init","value":{"type":"Identifier","start":4454,"end":4465,"name":"useFormData"}},{"type":"Property","start":4479,"end":4483,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":4479,"end":4483,"name":"size"},"kind":"init","value":{"type":"Identifier","start":4479,"end":4483,"name":"size"}},{"type":"Property","start":4497,"end":4526,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4497,"end":4506,"name":"fieldname"},"value":{"type":"MemberExpression","start":4508,"end":4526,"object":{"type":"MemberExpression","start":4508,"end":4516,"object":{"type":"Identifier","start":4508,"end":4511,"name":"req"},"property":{"type":"Identifier","start":4512,"end":4516,"name":"body"},"computed":false},"property":{"type":"Identifier","start":4517,"end":4526,"name":"fieldname"},"computed":false},"kind":"init"},{"type":"Property","start":4540,"end":4587,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4540,"end":4550,"name":"pathPrefix"},"value":{"type":"TemplateLiteral","start":4552,"end":4587,"expressions":[{"type":"MemberExpression","start":4555,"end":4585,"object":{"type":"MemberExpression","start":4555,"end":4576,"object":{"type":"MemberExpression","start":4555,"end":4568,"object":{"type":"Identifier","start":4555,"end":4558,"name":"req"},"property":{"type":"Identifier","start":4559,"end":4568,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":4569,"end":4576,"name":"options"},"computed":false},"property":{"type":"Identifier","start":4577,"end":4585,"name":"filePath"},"computed":false}],"quasis":[{"type":"TemplateElement","start":4553,"end":4553,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":4586,"end":4586,"value":{"raw":"","cooked":""},"tail":true}]},"kind":"init"},{"type":"Property","start":4601,"end":4624,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4601,"end":4608,"name":"storage"},"value":{"type":"CallExpression","start":4610,"end":4624,"callee":{"type":"MemberExpression","start":4610,"end":4622,"object":{"type":"Identifier","start":4610,"end":4615,"name":"redis"},"property":{"type":"Identifier","start":4616,"end":4622,"name":"client"},"computed":false},"arguments":[]},"kind":"init"},{"type":"Property","start":4638,"end":4803,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4638,"end":4640,"name":"s3"},"value":{"type":"ConditionalExpression","start":4642,"end":4803,"test":{"type":"MemberExpression","start":4642,"end":4664,"object":{"type":"MemberExpression","start":4642,"end":4655,"object":{"type":"Identifier","start":4642,"end":4645,"name":"req"},"property":{"type":"Identifier","start":4646,"end":4655,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":4656,"end":4664,"name":"s3Client"},"computed":false},"consequent":{"type":"ObjectExpression","start":4667,"end":4796,"properties":[{"type":"Property","start":4685,"end":4715,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4685,"end":4691,"name":"client"},"value":{"type":"MemberExpression","start":4693,"end":4715,"object":{"type":"MemberExpression","start":4693,"end":4706,"object":{"type":"Identifier","start":4693,"end":4696,"name":"req"},"property":{"type":"Identifier","start":4697,"end":4706,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":4707,"end":4715,"name":"s3Client"},"computed":false},"kind":"init"},{"type":"Property","start":4733,"end":4782,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4733,"end":4740,"name":"options"},"value":{"type":"MemberExpression","start":4742,"end":4782,"object":{"type":"MemberExpression","start":4742,"end":4779,"object":{"type":"MemberExpression","start":4742,"end":4763,"object":{"type":"MemberExpression","start":4742,"end":4755,"object":{"type":"Identifier","start":4742,"end":4745,"name":"req"},"property":{"type":"Identifier","start":4746,"end":4755,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":4756,"end":4763,"name":"options"},"computed":false},"property":{"type":"Identifier","start":4764,"end":4779,"name":"providerOptions"},"computed":false},"property":{"type":"Identifier","start":4780,"end":4782,"name":"s3"},"computed":false},"kind":"init"}]},"alternate":{"type":"Literal","start":4799,"end":4803,"value":null,"raw":"null"}},"kind":"init"},{"type":"Property","start":4817,"end":4842,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4817,"end":4824,"name":"headers"},"value":{"type":"MemberExpression","start":4826,"end":4842,"object":{"type":"MemberExpression","start":4826,"end":4834,"object":{"type":"Identifier","start":4826,"end":4829,"name":"req"},"property":{"type":"Identifier","start":4830,"end":4834,"name":"body"},"computed":false},"property":{"type":"Identifier","start":4835,"end":4842,"name":"headers"},"computed":false},"kind":"init"}]}}]}}},{"type":"MethodDefinition","start":4932,"end":5004,"kind":"get","static":false,"computed":false,"key":{"type":"Identifier","start":4936,"end":4948,"name":"bytesWritten"},"value":{"type":"FunctionExpression","start":4948,"end":5004,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":4951,"end":5004,"body":[{"type":"ReturnStatement","start":4961,"end":4998,"argument":{"type":"MemberExpression","start":4968,"end":4997,"object":{"type":"MemberExpression","start":4968,"end":4984,"object":{"type":"ThisExpression","start":4968,"end":4972},"property":{"type":"Identifier","start":4973,"end":4984,"name":"writeStream"},"computed":false},"property":{"type":"Identifier","start":4985,"end":4997,"name":"bytesWritten"},"computed":false}}]}}},{"type":"MethodDefinition","start":5154,"end":7672,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":5154,"end":5169,"name":"validateOptions"},"value":{"type":"FunctionExpression","start":5169,"end":7672,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":5170,"end":5177,"name":"options"}],"body":{"type":"BlockStatement","start":5179,"end":7672,"body":[{"type":"IfStatement","start":5221,"end":5672,"test":{"type":"MemberExpression","start":5225,"end":5243,"object":{"type":"Identifier","start":5225,"end":5232,"name":"options"},"property":{"type":"Identifier","start":5233,"end":5243,"name":"httpMethod"},"computed":false},"consequent":{"type":"BlockStatement","start":5245,"end":5672,"body":[{"type":"IfStatement","start":5259,"end":5424,"test":{"type":"BinaryExpression","start":5263,"end":5301,"left":{"type":"UnaryExpression","start":5263,"end":5288,"operator":"typeof","prefix":true,"argument":{"type":"MemberExpression","start":5270,"end":5288,"object":{"type":"Identifier","start":5270,"end":5277,"name":"options"},"property":{"type":"Identifier","start":5278,"end":5288,"name":"httpMethod"},"computed":false}},"operator":"!==","right":{"type":"Literal","start":5293,"end":5301,"value":"string","raw":"'string'"}},"consequent":{"type":"BlockStatement","start":5303,"end":5424,"body":[{"type":"ExpressionStatement","start":5321,"end":5380,"expression":{"type":"AssignmentExpression","start":5321,"end":5379,"operator":"=","left":{"type":"MemberExpression","start":5321,"end":5341,"object":{"type":"ThisExpression","start":5321,"end":5325},"property":{"type":"Identifier","start":5326,"end":5341,"name":"_errRespMessage"},"computed":false},"right":{"type":"Literal","start":5344,"end":5379,"value":"unsupported HTTP METHOD specified","raw":"'unsupported HTTP METHOD specified'"}}},{"type":"ReturnStatement","start":5397,"end":5410,"argument":{"type":"Literal","start":5404,"end":5409,"value":false,"raw":"false"}}]},"alternate":null},{"type":"VariableDeclaration","start":5437,"end":5485,"declarations":[{"type":"VariableDeclarator","start":5443,"end":5484,"id":{"type":"Identifier","start":5443,"end":5449,"name":"method"},"init":{"type":"CallExpression","start":5452,"end":5484,"callee":{"type":"MemberExpression","start":5452,"end":5482,"object":{"type":"MemberExpression","start":5452,"end":5470,"object":{"type":"Identifier","start":5452,"end":5459,"name":"options"},"property":{"type":"Identifier","start":5460,"end":5470,"name":"httpMethod"},"computed":false},"property":{"type":"Identifier","start":5471,"end":5482,"name":"toLowerCase"},"computed":false},"arguments":[]}}],"kind":"const"},{"type":"IfStatement","start":5498,"end":5662,"test":{"type":"LogicalExpression","start":5502,"end":5539,"left":{"type":"BinaryExpression","start":5502,"end":5518,"left":{"type":"Identifier","start":5502,"end":5508,"name":"method"},"operator":"!==","right":{"type":"Literal","start":5513,"end":5518,"value":"put","raw":"'put'"}},"operator":"&&","right":{"type":"BinaryExpression","start":5522,"end":5539,"left":{"type":"Identifier","start":5522,"end":5528,"name":"method"},"operator":"!==","right":{"type":"Literal","start":5533,"end":5539,"value":"post","raw":"'post'"}}},"consequent":{"type":"BlockStatement","start":5541,"end":5662,"body":[{"type":"ExpressionStatement","start":5559,"end":5618,"expression":{"type":"AssignmentExpression","start":5559,"end":5617,"operator":"=","left":{"type":"MemberExpression","start":5559,"end":5579,"object":{"type":"ThisExpression","start":5559,"end":5563},"property":{"type":"Identifier","start":5564,"end":5579,"name":"_errRespMessage"},"computed":false},"right":{"type":"Literal","start":5582,"end":5617,"value":"unsupported HTTP METHOD specified","raw":"'unsupported HTTP METHOD specified'"}}},{"type":"ReturnStatement","start":5635,"end":5648,"argument":{"type":"Literal","start":5642,"end":5647,"value":false,"raw":"false"}}]},"alternate":null}]},"alternate":null},{"type":"IfStatement","start":5711,"end":5877,"test":{"type":"LogicalExpression","start":5715,"end":5773,"left":{"type":"MemberExpression","start":5715,"end":5732,"object":{"type":"Identifier","start":5715,"end":5722,"name":"options"},"property":{"type":"Identifier","start":5723,"end":5732,"name":"fieldname"},"computed":false},"operator":"&&","right":{"type":"BinaryExpression","start":5736,"end":5773,"left":{"type":"UnaryExpression","start":5736,"end":5760,"operator":"typeof","prefix":true,"argument":{"type":"MemberExpression","start":5743,"end":5760,"object":{"type":"Identifier","start":5743,"end":5750,"name":"options"},"property":{"type":"Identifier","start":5751,"end":5760,"name":"fieldname"},"computed":false}},"operator":"!==","right":{"type":"Literal","start":5765,"end":5773,"value":"string","raw":"'string'"}}},"consequent":{"type":"BlockStatement","start":5775,"end":5877,"body":[{"type":"ExpressionStatement","start":5789,"end":5841,"expression":{"type":"AssignmentExpression","start":5789,"end":5840,"operator":"=","left":{"type":"MemberExpression","start":5789,"end":5809,"object":{"type":"ThisExpression","start":5789,"end":5793},"property":{"type":"Identifier","start":5794,"end":5809,"name":"_errRespMessage"},"computed":false},"right":{"type":"Literal","start":5812,"end":5840,"value":"fieldname must be a string","raw":"'fieldname must be a string'"}}},{"type":"ReturnStatement","start":5854,"end":5867,"argument":{"type":"Literal","start":5861,"end":5866,"value":false,"raw":"false"}}]},"alternate":null},{"type":"IfStatement","start":5915,"end":6070,"test":{"type":"LogicalExpression","start":5919,"end":5966,"left":{"type":"MemberExpression","start":5919,"end":5935,"object":{"type":"Identifier","start":5919,"end":5926,"name":"options"},"property":{"type":"Identifier","start":5927,"end":5935,"name":"metadata"},"computed":false},"operator":"&&","right":{"type":"UnaryExpression","start":5939,"end":5966,"operator":"!","prefix":true,"argument":{"type":"CallExpression","start":5940,"end":5966,"callee":{"type":"Identifier","start":5940,"end":5948,"name":"isObject"},"arguments":[{"type":"MemberExpression","start":5949,"end":5965,"object":{"type":"Identifier","start":5949,"end":5956,"name":"options"},"property":{"type":"Identifier","start":5957,"end":5965,"name":"metadata"},"computed":false}]}}},"consequent":{"type":"BlockStatement","start":5968,"end":6070,"body":[{"type":"ExpressionStatement","start":5982,"end":6034,"expression":{"type":"AssignmentExpression","start":5982,"end":6033,"operator":"=","left":{"type":"MemberExpression","start":5982,"end":6002,"object":{"type":"ThisExpression","start":5982,"end":5986},"property":{"type":"Identifier","start":5987,"end":6002,"name":"_errRespMessage"},"computed":false},"right":{"type":"Literal","start":6005,"end":6033,"value":"metadata must be an object","raw":"'metadata must be an object'"}}},{"type":"ReturnStatement","start":6047,"end":6060,"argument":{"type":"Literal","start":6054,"end":6059,"value":false,"raw":"false"}}]},"alternate":null},{"type":"IfStatement","start":6107,"end":6259,"test":{"type":"LogicalExpression","start":6111,"end":6156,"left":{"type":"MemberExpression","start":6111,"end":6126,"object":{"type":"Identifier","start":6111,"end":6118,"name":"options"},"property":{"type":"Identifier","start":6119,"end":6126,"name":"headers"},"computed":false},"operator":"&&","right":{"type":"UnaryExpression","start":6130,"end":6156,"operator":"!","prefix":true,"argument":{"type":"CallExpression","start":6131,"end":6156,"callee":{"type":"Identifier","start":6131,"end":6139,"name":"isObject"},"arguments":[{"type":"MemberExpression","start":6140,"end":6155,"object":{"type":"Identifier","start":6140,"end":6147,"name":"options"},"property":{"type":"Identifier","start":6148,"end":6155,"name":"headers"},"computed":false}]}}},"consequent":{"type":"BlockStatement","start":6158,"end":6259,"body":[{"type":"ExpressionStatement","start":6172,"end":6223,"expression":{"type":"AssignmentExpression","start":6172,"end":6222,"operator":"=","left":{"type":"MemberExpression","start":6172,"end":6192,"object":{"type":"ThisExpression","start":6172,"end":6176},"property":{"type":"Identifier","start":6177,"end":6192,"name":"_errRespMessage"},"computed":false},"right":{"type":"Literal","start":6195,"end":6222,"value":"headers must be an object","raw":"'headers must be an object'"}}},{"type":"ReturnStatement","start":6236,"end":6249,"argument":{"type":"Literal","start":6243,"end":6248,"value":false,"raw":"false"}}]},"alternate":null},{"type":"IfStatement","start":6393,"end":6599,"test":{"type":"LogicalExpression","start":6397,"end":6491,"left":{"type":"MemberExpression","start":6397,"end":6413,"object":{"type":"Identifier","start":6397,"end":6404,"name":"options"},"property":{"type":"Identifier","start":6405,"end":6413,"name":"protocol"},"computed":false},"operator":"&&","right":{"type":"UnaryExpression","start":6417,"end":6491,"operator":"!","prefix":true,"argument":{"type":"CallExpression","start":6418,"end":6491,"callee":{"type":"MemberExpression","start":6418,"end":6445,"object":{"type":"CallExpression","start":6418,"end":6440,"callee":{"type":"MemberExpression","start":6418,"end":6429,"object":{"type":"Identifier","start":6418,"end":6424,"name":"Object"},"property":{"type":"Identifier","start":6425,"end":6429,"name":"keys"},"computed":false},"arguments":[{"type":"Identifier","start":6430,"end":6439,"name":"PROTOCOLS"}]},"property":{"type":"Identifier","start":6441,"end":6445,"name":"some"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":6446,"end":6490,"id":null,"expression":true,"generator":false,"async":false,"params":[{"type":"Identifier","start":6447,"end":6450,"name":"key"}],"body":{"type":"BinaryExpression","start":6455,"end":6490,"left":{"type":"MemberExpression","start":6455,"end":6469,"object":{"type":"Identifier","start":6455,"end":6464,"name":"PROTOCOLS"},"property":{"type":"Identifier","start":6465,"end":6468,"name":"key"},"computed":true},"operator":"===","right":{"type":"MemberExpression","start":6474,"end":6490,"object":{"type":"Identifier","start":6474,"end":6481,"name":"options"},"property":{"type":"Identifier","start":6482,"end":6490,"name":"protocol"},"computed":false}}}]}}},"consequent":{"type":"BlockStatement","start":6493,"end":6599,"body":[{"type":"ExpressionStatement","start":6507,"end":6563,"expression":{"type":"AssignmentExpression","start":6507,"end":6562,"operator":"=","left":{"type":"MemberExpression","start":6507,"end":6527,"object":{"type":"ThisExpression","start":6507,"end":6511},"property":{"type":"Identifier","start":6512,"end":6527,"name":"_errRespMessage"},"computed":false},"right":{"type":"Literal","start":6530,"end":6562,"value":"unsupported protocol specified","raw":"'unsupported protocol specified'"}}},{"type":"ReturnStatement","start":6576,"end":6589,"argument":{"type":"Literal","start":6583,"end":6588,"value":false,"raw":"false"}}]},"alternate":null},{"type":"IfStatement","start":6761,"end":6845,"test":{"type":"BinaryExpression","start":6765,"end":6807,"left":{"type":"MemberExpression","start":6765,"end":6781,"object":{"type":"Identifier","start":6765,"end":6772,"name":"options"},"property":{"type":"Identifier","start":6773,"end":6781,"name":"protocol"},"computed":false},"operator":"===","right":{"type":"MemberExpression","start":6786,"end":6807,"object":{"type":"Identifier","start":6786,"end":6795,"name":"PROTOCOLS"},"property":{"type":"Identifier","start":6796,"end":6807,"name":"s3Multipart"},"computed":false}},"consequent":{"type":"BlockStatement","start":6809,"end":6845,"body":[{"type":"ReturnStatement","start":6823,"end":6835,"argument":{"type":"Literal","start":6830,"end":6834,"value":true,"raw":"true"}}]},"alternate":null},{"type":"IfStatement","start":6854,"end":6999,"test":{"type":"LogicalExpression","start":6858,"end":6897,"left":{"type":"UnaryExpression","start":6858,"end":6875,"operator":"!","prefix":true,"argument":{"type":"MemberExpression","start":6859,"end":6875,"object":{"type":"Identifier","start":6859,"end":6866,"name":"options"},"property":{"type":"Identifier","start":6867,"end":6875,"name":"endpoint"},"computed":false}},"operator":"&&","right":{"type":"UnaryExpression","start":6879,"end":6897,"operator":"!","prefix":true,"argument":{"type":"MemberExpression","start":6880,"end":6897,"object":{"type":"Identifier","start":6880,"end":6887,"name":"options"},"property":{"type":"Identifier","start":6888,"end":6897,"name":"uploadUrl"},"computed":false}}},"consequent":{"type":"BlockStatement","start":6899,"end":6999,"body":[{"type":"ExpressionStatement","start":6913,"end":6963,"expression":{"type":"AssignmentExpression","start":6913,"end":6962,"operator":"=","left":{"type":"MemberExpression","start":6913,"end":6933,"object":{"type":"ThisExpression","start":6913,"end":6917},"property":{"type":"Identifier","start":6918,"end":6933,"name":"_errRespMessage"},"computed":false},"right":{"type":"Literal","start":6936,"end":6962,"value":"no destination specified","raw":"'no destination specified'"}}},{"type":"ReturnStatement","start":6976,"end":6989,"argument":{"type":"Literal","start":6983,"end":6988,"value":false,"raw":"false"}}]},"alternate":null},{"type":"VariableDeclaration","start":7008,"end":7103,"declarations":[{"type":"VariableDeclarator","start":7014,"end":7102,"id":{"type":"Identifier","start":7014,"end":7027,"name":"validatorOpts"},"init":{"type":"ObjectExpression","start":7030,"end":7102,"properties":[{"type":"Property","start":7032,"end":7054,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7032,"end":7048,"name":"require_protocol"},"value":{"type":"Literal","start":7050,"end":7054,"value":true,"raw":"true"},"kind":"init"},{"type":"Property","start":7056,"end":7100,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7056,"end":7067,"name":"require_tld"},"value":{"type":"UnaryExpression","start":7069,"end":7100,"operator":"!","prefix":true,"argument":{"type":"MemberExpression","start":7070,"end":7100,"object":{"type":"MemberExpression","start":7070,"end":7094,"object":{"type":"Identifier","start":7070,"end":7077,"name":"options"},"property":{"type":"Identifier","start":7078,"end":7094,"name":"companionOptions"},"computed":false},"property":{"type":"Identifier","start":7095,"end":7100,"name":"debug"},"computed":false}},"kind":"init"}]}}],"kind":"const"},{"type":"ReturnStatement","start":7112,"end":7666,"argument":{"type":"CallExpression","start":7119,"end":7665,"callee":{"type":"MemberExpression","start":7119,"end":7162,"object":{"type":"ArrayExpression","start":7119,"end":7156,"elements":[{"type":"MemberExpression","start":7120,"end":7136,"object":{"type":"Identifier","start":7120,"end":7127,"name":"options"},"property":{"type":"Identifier","start":7128,"end":7136,"name":"endpoint"},"computed":false},{"type":"MemberExpression","start":7138,"end":7155,"object":{"type":"Identifier","start":7138,"end":7145,"name":"options"},"property":{"type":"Identifier","start":7146,"end":7155,"name":"uploadUrl"},"computed":false}]},"property":{"type":"Identifier","start":7157,"end":7162,"name":"every"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":7163,"end":7664,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":7164,"end":7167,"name":"url"}],"body":{"type":"BlockStatement","start":7172,"end":7664,"body":[{"type":"IfStatement","start":7186,"end":7346,"test":{"type":"LogicalExpression","start":7190,"end":7233,"left":{"type":"Identifier","start":7190,"end":7193,"name":"url"},"operator":"&&","right":{"type":"UnaryExpression","start":7197,"end":7233,"operator":"!","prefix":true,"argument":{"type":"CallExpression","start":7198,"end":7233,"callee":{"type":"MemberExpression","start":7198,"end":7213,"object":{"type":"Identifier","start":7198,"end":7207,"name":"validator"},"property":{"type":"Identifier","start":7208,"end":7213,"name":"isURL"},"computed":false},"arguments":[{"type":"Identifier","start":7214,"end":7217,"name":"url"},{"type":"Identifier","start":7219,"end":7232,"name":"validatorOpts"}]}}},"consequent":{"type":"BlockStatement","start":7235,"end":7346,"body":[{"type":"ExpressionStatement","start":7253,"end":7302,"expression":{"type":"AssignmentExpression","start":7253,"end":7301,"operator":"=","left":{"type":"MemberExpression","start":7253,"end":7273,"object":{"type":"ThisExpression","start":7253,"end":7257},"property":{"type":"Identifier","start":7258,"end":7273,"name":"_errRespMessage"},"computed":false},"right":{"type":"Literal","start":7276,"end":7301,"value":"invalid destination url","raw":"'invalid destination url'"}}},{"type":"ReturnStatement","start":7319,"end":7332,"argument":{"type":"Literal","start":7326,"end":7331,"value":false,"raw":"false"}}]},"alternate":null},{"type":"VariableDeclaration","start":7359,"end":7415,"declarations":[{"type":"VariableDeclarator","start":7365,"end":7414,"id":{"type":"Identifier","start":7365,"end":7376,"name":"allowedUrls"},"init":{"type":"MemberExpression","start":7379,"end":7414,"object":{"type":"MemberExpression","start":7379,"end":7403,"object":{"type":"Identifier","start":7379,"end":7386,"name":"options"},"property":{"type":"Identifier","start":7387,"end":7403,"name":"companionOptions"},"computed":false},"property":{"type":"Identifier","start":7404,"end":7414,"name":"uploadUrls"},"computed":false}}],"kind":"const"},{"type":"IfStatement","start":7428,"end":7629,"test":{"type":"LogicalExpression","start":7432,"end":7481,"left":{"type":"LogicalExpression","start":7432,"end":7450,"left":{"type":"Identifier","start":7432,"end":7443,"name":"allowedUrls"},"operator":"&&","right":{"type":"Identifier","start":7447,"end":7450,"name":"url"}},"operator":"&&","right":{"type":"UnaryExpression","start":7454,"end":7481,"operator":"!","prefix":true,"argument":{"type":"CallExpression","start":7455,"end":7481,"callee":{"type":"Identifier","start":7455,"end":7463,"name":"hasMatch"},"arguments":[{"type":"Identifier","start":7464,"end":7467,"name":"url"},{"type":"Identifier","start":7469,"end":7480,"name":"allowedUrls"}]}}},"consequent":{"type":"BlockStatement","start":7483,"end":7629,"body":[{"type":"ExpressionStatement","start":7501,"end":7585,"expression":{"type":"AssignmentExpression","start":7501,"end":7584,"operator":"=","left":{"type":"MemberExpression","start":7501,"end":7521,"object":{"type":"ThisExpression","start":7501,"end":7505},"property":{"type":"Identifier","start":7506,"end":7521,"name":"_errRespMessage"},"computed":false},"right":{"type":"Literal","start":7524,"end":7584,"value":"upload destination does not match any allowed destinations","raw":"'upload destination does not match any allowed destinations'"}}},{"type":"ReturnStatement","start":7602,"end":7615,"argument":{"type":"Literal","start":7609,"end":7614,"value":false,"raw":"false"}}]},"alternate":null},{"type":"ReturnStatement","start":7642,"end":7654,"argument":{"type":"Literal","start":7649,"end":7653,"value":true,"raw":"true"}}]}}]}}]}}},{"type":"MethodDefinition","start":7677,"end":7740,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":7677,"end":7685,"name":"hasError"},"value":{"type":"FunctionExpression","start":7685,"end":7740,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":7688,"end":7740,"body":[{"type":"ReturnStatement","start":7698,"end":7734,"argument":{"type":"BinaryExpression","start":7705,"end":7733,"left":{"type":"MemberExpression","start":7705,"end":7725,"object":{"type":"ThisExpression","start":7705,"end":7709},"property":{"type":"Identifier","start":7710,"end":7725,"name":"_errRespMessage"},"computed":false},"operator":"!=","right":{"type":"Literal","start":7729,"end":7733,"value":null,"raw":"null"}}}]}}},{"type":"MethodDefinition","start":7974,"end":8048,"kind":"get","static":false,"computed":false,"key":{"type":"Identifier","start":7978,"end":7988,"name":"shortToken"},"value":{"type":"FunctionExpression","start":7988,"end":8048,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":7991,"end":8048,"body":[{"type":"ReturnStatement","start":8001,"end":8042,"argument":{"type":"CallExpression","start":8008,"end":8041,"callee":{"type":"MemberExpression","start":8008,"end":8029,"object":{"type":"Identifier","start":8008,"end":8016,"name":"Uploader"},"property":{"type":"Identifier","start":8017,"end":8029,"name":"shortenToken"},"computed":false},"arguments":[{"type":"MemberExpression","start":8030,"end":8040,"object":{"type":"ThisExpression","start":8030,"end":8034},"property":{"type":"Identifier","start":8035,"end":8040,"name":"token"},"computed":false}]}}]}}},{"type":"MethodDefinition","start":8110,"end":8300,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":8110,"end":8123,"name":"onSocketReady"},"value":{"type":"FunctionExpression","start":8123,"end":8300,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":8124,"end":8132,"name":"callback"}],"body":{"type":"BlockStatement","start":8134,"end":8300,"body":[{"type":"ExpressionStatement","start":8144,"end":8205,"expression":{"type":"CallExpression","start":8144,"end":8204,"callee":{"type":"MemberExpression","start":8144,"end":8158,"object":{"type":"CallExpression","start":8144,"end":8153,"callee":{"type":"Identifier","start":8144,"end":8151,"name":"emitter"},"arguments":[]},"property":{"type":"Identifier","start":8154,"end":8158,"name":"once"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":8159,"end":8185,"expressions":[{"type":"MemberExpression","start":8173,"end":8183,"object":{"type":"ThisExpression","start":8173,"end":8177},"property":{"type":"Identifier","start":8178,"end":8183,"name":"token"},"computed":false}],"quasis":[{"type":"TemplateElement","start":8160,"end":8171,"value":{"raw":"connection:","cooked":"connection:"},"tail":false},{"type":"TemplateElement","start":8184,"end":8184,"value":{"raw":"","cooked":""},"tail":true}]},{"type":"ArrowFunctionExpression","start":8187,"end":8203,"id":null,"expression":true,"generator":false,"async":false,"params":[],"body":{"type":"CallExpression","start":8193,"end":8203,"callee":{"type":"Identifier","start":8193,"end":8201,"name":"callback"},"arguments":[]}}]}},{"type":"ExpressionStatement","start":8214,"end":8294,"expression":{"type":"CallExpression","start":8214,"end":8293,"callee":{"type":"MemberExpression","start":8214,"end":8226,"object":{"type":"Identifier","start":8214,"end":8220,"name":"logger"},"property":{"type":"Identifier","start":8221,"end":8226,"name":"debug"},"computed":false},"arguments":[{"type":"Literal","start":8227,"end":8251,"value":"waiting for connection","raw":"'waiting for connection'"},{"type":"Literal","start":8253,"end":8275,"value":"uploader.socket.wait","raw":"'uploader.socket.wait'"},{"type":"MemberExpression","start":8277,"end":8292,"object":{"type":"ThisExpression","start":8277,"end":8281},"property":{"type":"Identifier","start":8282,"end":8292,"name":"shortToken"},"computed":false}]}}]}}},{"type":"MethodDefinition","start":8305,"end":8735,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":8305,"end":8312,"name":"cleanUp"},"value":{"type":"FunctionExpression","start":8312,"end":8735,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":8315,"end":8735,"body":[{"type":"ExpressionStatement","start":8325,"end":8509,"expression":{"type":"CallExpression","start":8325,"end":8508,"callee":{"type":"MemberExpression","start":8325,"end":8334,"object":{"type":"Identifier","start":8325,"end":8327,"name":"fs"},"property":{"type":"Identifier","start":8328,"end":8334,"name":"unlink"},"computed":false},"arguments":[{"type":"MemberExpression","start":8335,"end":8344,"object":{"type":"ThisExpression","start":8335,"end":8339},"property":{"type":"Identifier","start":8340,"end":8344,"name":"path"},"computed":false},{"type":"ArrowFunctionExpression","start":8346,"end":8507,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":8347,"end":8350,"name":"err"}],"body":{"type":"BlockStatement","start":8355,"end":8507,"body":[{"type":"IfStatement","start":8369,"end":8497,"test":{"type":"Identifier","start":8373,"end":8376,"name":"err"},"consequent":{"type":"BlockStatement","start":8378,"end":8497,"body":[{"type":"ExpressionStatement","start":8396,"end":8483,"expression":{"type":"CallExpression","start":8396,"end":8482,"callee":{"type":"MemberExpression","start":8396,"end":8408,"object":{"type":"Identifier","start":8396,"end":8402,"name":"logger"},"property":{"type":"Identifier","start":8403,"end":8408,"name":"error"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":8409,"end":8455,"expressions":[{"type":"MemberExpression","start":8432,"end":8441,"object":{"type":"ThisExpression","start":8432,"end":8436},"property":{"type":"Identifier","start":8437,"end":8441,"name":"path"},"computed":false},{"type":"Identifier","start":8450,"end":8453,"name":"err"}],"quasis":[{"type":"TemplateElement","start":8410,"end":8430,"value":{"raw":"cleanup failed for: ","cooked":"cleanup failed for: "},"tail":false},{"type":"TemplateElement","start":8442,"end":8448,"value":{"raw":" err: ","cooked":" err: "},"tail":false},{"type":"TemplateElement","start":8454,"end":8454,"value":{"raw":"","cooked":""},"tail":true}]},{"type":"Literal","start":8457,"end":8481,"value":"uploader.cleanup.error","raw":"'uploader.cleanup.error'"}]}}]},"alternate":null}]}}]}},{"type":"ExpressionStatement","start":8518,"end":8570,"expression":{"type":"CallExpression","start":8518,"end":8569,"callee":{"type":"MemberExpression","start":8518,"end":8546,"object":{"type":"CallExpression","start":8518,"end":8527,"callee":{"type":"Identifier","start":8518,"end":8525,"name":"emitter"},"arguments":[]},"property":{"type":"Identifier","start":8528,"end":8546,"name":"removeAllListeners"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":8547,"end":8568,"expressions":[{"type":"MemberExpression","start":8556,"end":8566,"object":{"type":"ThisExpression","start":8556,"end":8560},"property":{"type":"Identifier","start":8561,"end":8566,"name":"token"},"computed":false}],"quasis":[{"type":"TemplateElement","start":8548,"end":8554,"value":{"raw":"pause:","cooked":"pause:"},"tail":false},{"type":"TemplateElement","start":8567,"end":8567,"value":{"raw":"","cooked":""},"tail":true}]}]}},{"type":"ExpressionStatement","start":8579,"end":8632,"expression":{"type":"CallExpression","start":8579,"end":8631,"callee":{"type":"MemberExpression","start":8579,"end":8607,"object":{"type":"CallExpression","start":8579,"end":8588,"callee":{"type":"Identifier","start":8579,"end":8586,"name":"emitter"},"arguments":[]},"property":{"type":"Identifier","start":8589,"end":8607,"name":"removeAllListeners"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":8608,"end":8630,"expressions":[{"type":"MemberExpression","start":8618,"end":8628,"object":{"type":"ThisExpression","start":8618,"end":8622},"property":{"type":"Identifier","start":8623,"end":8628,"name":"token"},"computed":false}],"quasis":[{"type":"TemplateElement","start":8609,"end":8616,"value":{"raw":"resume:","cooked":"resume:"},"tail":false},{"type":"TemplateElement","start":8629,"end":8629,"value":{"raw":"","cooked":""},"tail":true}]}]}},{"type":"ExpressionStatement","start":8641,"end":8694,"expression":{"type":"CallExpression","start":8641,"end":8693,"callee":{"type":"MemberExpression","start":8641,"end":8669,"object":{"type":"CallExpression","start":8641,"end":8650,"callee":{"type":"Identifier","start":8641,"end":8648,"name":"emitter"},"arguments":[]},"property":{"type":"Identifier","start":8651,"end":8669,"name":"removeAllListeners"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":8670,"end":8692,"expressions":[{"type":"MemberExpression","start":8680,"end":8690,"object":{"type":"ThisExpression","start":8680,"end":8684},"property":{"type":"Identifier","start":8685,"end":8690,"name":"token"},"computed":false}],"quasis":[{"type":"TemplateElement","start":8671,"end":8678,"value":{"raw":"cancel:","cooked":"cancel:"},"tail":false},{"type":"TemplateElement","start":8691,"end":8691,"value":{"raw":"","cooked":""},"tail":true}]}]}},{"type":"ExpressionStatement","start":8703,"end":8729,"expression":{"type":"AssignmentExpression","start":8703,"end":8728,"operator":"=","left":{"type":"MemberExpression","start":8703,"end":8721,"object":{"type":"ThisExpression","start":8703,"end":8707},"property":{"type":"Identifier","start":8708,"end":8721,"name":"uploadStopped"},"computed":false},"right":{"type":"Literal","start":8724,"end":8728,"value":true,"raw":"true"}}}]}}},{"type":"MethodDefinition","start":8838,"end":10794,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":8838,"end":8849,"name":"handleChunk"},"value":{"type":"FunctionExpression","start":8849,"end":10794,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":8850,"end":8853,"name":"err"},{"type":"Identifier","start":8855,"end":8860,"name":"chunk"}],"body":{"type":"BlockStatement","start":8862,"end":10794,"body":[{"type":"IfStatement","start":8872,"end":8927,"test":{"type":"MemberExpression","start":8876,"end":8894,"object":{"type":"ThisExpression","start":8876,"end":8880},"property":{"type":"Identifier","start":8881,"end":8894,"name":"uploadStopped"},"computed":false},"consequent":{"type":"BlockStatement","start":8896,"end":8927,"body":[{"type":"ReturnStatement","start":8910,"end":8917,"argument":null}]},"alternate":null},{"type":"IfStatement","start":8936,"end":9112,"test":{"type":"Identifier","start":8940,"end":8943,"name":"err"},"consequent":{"type":"BlockStatement","start":8945,"end":9112,"body":[{"type":"ExpressionStatement","start":8959,"end":9021,"expression":{"type":"CallExpression","start":8959,"end":9020,"callee":{"type":"MemberExpression","start":8959,"end":8971,"object":{"type":"Identifier","start":8959,"end":8965,"name":"logger"},"property":{"type":"Identifier","start":8966,"end":8971,"name":"error"},"computed":false},"arguments":[{"type":"Identifier","start":8972,"end":8975,"name":"err"},{"type":"Literal","start":8977,"end":9002,"value":"uploader.download.error","raw":"'uploader.download.error'"},{"type":"MemberExpression","start":9004,"end":9019,"object":{"type":"ThisExpression","start":9004,"end":9008},"property":{"type":"Identifier","start":9009,"end":9019,"name":"shortToken"},"computed":false}]}},{"type":"ExpressionStatement","start":9034,"end":9054,"expression":{"type":"CallExpression","start":9034,"end":9053,"callee":{"type":"MemberExpression","start":9034,"end":9048,"object":{"type":"ThisExpression","start":9034,"end":9038},"property":{"type":"Identifier","start":9039,"end":9048,"name":"emitError"},"computed":false},"arguments":[{"type":"Identifier","start":9049,"end":9052,"name":"err"}]}},{"type":"ExpressionStatement","start":9067,"end":9082,"expression":{"type":"CallExpression","start":9067,"end":9081,"callee":{"type":"MemberExpression","start":9067,"end":9079,"object":{"type":"ThisExpression","start":9067,"end":9071},"property":{"type":"Identifier","start":9072,"end":9079,"name":"cleanUp"},"computed":false},"arguments":[]}},{"type":"ReturnStatement","start":9095,"end":9102,"argument":null}]},"alternate":null},{"type":"VariableDeclaration","start":9233,"end":9295,"declarations":[{"type":"VariableDeclarator","start":9239,"end":9294,"id":{"type":"Identifier","start":9239,"end":9247,"name":"protocol"},"init":{"type":"LogicalExpression","start":9250,"end":9294,"left":{"type":"MemberExpression","start":9250,"end":9271,"object":{"type":"MemberExpression","start":9250,"end":9262,"object":{"type":"ThisExpression","start":9250,"end":9254},"property":{"type":"Identifier","start":9255,"end":9262,"name":"options"},"computed":false},"property":{"type":"Identifier","start":9263,"end":9271,"name":"protocol"},"computed":false},"operator":"||","right":{"type":"MemberExpression","start":9275,"end":9294,"object":{"type":"Identifier","start":9275,"end":9284,"name":"PROTOCOLS"},"property":{"type":"Identifier","start":9285,"end":9294,"name":"multipart"},"computed":false}}}],"kind":"const"},{"type":"IfStatement","start":9392,"end":10579,"test":{"type":"BinaryExpression","start":9396,"end":9410,"left":{"type":"Identifier","start":9396,"end":9401,"name":"chunk"},"operator":"===","right":{"type":"Literal","start":9406,"end":9410,"value":null,"raw":"null"}},"consequent":{"type":"BlockStatement","start":9412,"end":10579,"body":[{"type":"ExpressionStatement","start":9426,"end":10531,"expression":{"type":"CallExpression","start":9426,"end":10530,"callee":{"type":"MemberExpression","start":9426,"end":9445,"object":{"type":"MemberExpression","start":9426,"end":9442,"object":{"type":"ThisExpression","start":9426,"end":9430},"property":{"type":"Identifier","start":9431,"end":9442,"name":"writeStream"},"computed":false},"property":{"type":"Identifier","start":9443,"end":9445,"name":"on"},"computed":false},"arguments":[{"type":"Literal","start":9446,"end":9454,"value":"finish","raw":"'finish'"},{"type":"ArrowFunctionExpression","start":9456,"end":10529,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":9462,"end":10529,"body":[{"type":"ExpressionStatement","start":9480,"end":9505,"expression":{"type":"AssignmentExpression","start":9480,"end":9504,"operator":"=","left":{"type":"MemberExpression","start":9480,"end":9497,"object":{"type":"ThisExpression","start":9480,"end":9484},"property":{"type":"Identifier","start":9485,"end":9497,"name":"streamsEnded"},"computed":false},"right":{"type":"Literal","start":9500,"end":9504,"value":true,"raw":"true"}}},{"type":"SwitchStatement","start":9522,"end":10515,"discriminant":{"type":"Identifier","start":9530,"end":9538,"name":"protocol"},"cases":[{"type":"SwitchCase","start":9562,"end":9749,"consequent":[{"type":"IfStatement","start":9612,"end":9718,"test":{"type":"MemberExpression","start":9616,"end":9637,"object":{"type":"MemberExpression","start":9616,"end":9628,"object":{"type":"ThisExpression","start":9616,"end":9620},"property":{"type":"Identifier","start":9621,"end":9628,"name":"options"},"computed":false},"property":{"type":"Identifier","start":9629,"end":9637,"name":"endpoint"},"computed":false},"consequent":{"type":"BlockStatement","start":9639,"end":9718,"body":[{"type":"ExpressionStatement","start":9669,"end":9692,"expression":{"type":"CallExpression","start":9669,"end":9691,"callee":{"type":"MemberExpression","start":9669,"end":9689,"object":{"type":"ThisExpression","start":9669,"end":9673},"property":{"type":"Identifier","start":9674,"end":9689,"name":"uploadMultipart"},"computed":false},"arguments":[]}}]},"alternate":null},{"type":"BreakStatement","start":9743,"end":9749,"label":null}],"test":{"type":"MemberExpression","start":9567,"end":9586,"object":{"type":"Identifier","start":9567,"end":9576,"name":"PROTOCOLS"},"property":{"type":"Identifier","start":9577,"end":9586,"name":"multipart"},"computed":false}},{"type":"SwitchCase","start":9770,"end":10133,"consequent":[{"type":"IfStatement","start":9822,"end":10102,"test":{"type":"UnaryExpression","start":9826,"end":9840,"operator":"!","prefix":true,"argument":{"type":"MemberExpression","start":9827,"end":9840,"object":{"type":"ThisExpression","start":9827,"end":9831},"property":{"type":"Identifier","start":9832,"end":9840,"name":"s3Upload"},"computed":false}},"consequent":{"type":"BlockStatement","start":9842,"end":9923,"body":[{"type":"ExpressionStatement","start":9872,"end":9897,"expression":{"type":"CallExpression","start":9872,"end":9896,"callee":{"type":"MemberExpression","start":9872,"end":9894,"object":{"type":"ThisExpression","start":9872,"end":9876},"property":{"type":"Identifier","start":9877,"end":9894,"name":"uploadS3Multipart"},"computed":false},"arguments":[]}}]},"alternate":{"type":"BlockStatement","start":9953,"end":10102,"body":[{"type":"ExpressionStatement","start":9983,"end":10076,"expression":{"type":"CallExpression","start":9983,"end":10075,"callee":{"type":"MemberExpression","start":9983,"end":9994,"object":{"type":"Identifier","start":9983,"end":9989,"name":"logger"},"property":{"type":"Identifier","start":9990,"end":9994,"name":"warn"},"computed":false},"arguments":[{"type":"Literal","start":9995,"end":10032,"value":"handleChunk() called multiple times","raw":"'handleChunk() called multiple times'"},{"type":"Literal","start":10034,"end":10057,"value":"uploader.s3.duplicate","raw":"'uploader.s3.duplicate'"},{"type":"MemberExpression","start":10059,"end":10074,"object":{"type":"ThisExpression","start":10059,"end":10063},"property":{"type":"Identifier","start":10064,"end":10074,"name":"shortToken"},"computed":false}]}}]}},{"type":"BreakStatement","start":10127,"end":10133,"label":null}],"test":{"type":"MemberExpression","start":9775,"end":9796,"object":{"type":"Identifier","start":9775,"end":9784,"name":"PROTOCOLS"},"property":{"type":"Identifier","start":9785,"end":9796,"name":"s3Multipart"},"computed":false}},{"type":"SwitchCase","start":10154,"end":10497,"consequent":[{"type":"IfStatement","start":10198,"end":10466,"test":{"type":"UnaryExpression","start":10202,"end":10211,"operator":"!","prefix":true,"argument":{"type":"MemberExpression","start":10203,"end":10211,"object":{"type":"ThisExpression","start":10203,"end":10207},"property":{"type":"Identifier","start":10208,"end":10211,"name":"tus"},"computed":false}},"consequent":{"type":"BlockStatement","start":10213,"end":10286,"body":[{"type":"ExpressionStatement","start":10243,"end":10260,"expression":{"type":"CallExpression","start":10243,"end":10259,"callee":{"type":"MemberExpression","start":10243,"end":10257,"object":{"type":"ThisExpression","start":10243,"end":10247},"property":{"type":"Identifier","start":10248,"end":10257,"name":"uploadTus"},"computed":false},"arguments":[]}}]},"alternate":{"type":"BlockStatement","start":10316,"end":10466,"body":[{"type":"ExpressionStatement","start":10346,"end":10440,"expression":{"type":"CallExpression","start":10346,"end":10439,"callee":{"type":"MemberExpression","start":10346,"end":10357,"object":{"type":"Identifier","start":10346,"end":10352,"name":"logger"},"property":{"type":"Identifier","start":10353,"end":10357,"name":"warn"},"computed":false},"arguments":[{"type":"Literal","start":10358,"end":10395,"value":"handleChunk() called multiple times","raw":"'handleChunk() called multiple times'"},{"type":"Literal","start":10397,"end":10421,"value":"uploader.tus.duplicate","raw":"'uploader.tus.duplicate'"},{"type":"MemberExpression","start":10423,"end":10438,"object":{"type":"ThisExpression","start":10423,"end":10427},"property":{"type":"Identifier","start":10428,"end":10438,"name":"shortToken"},"computed":false}]}}]}},{"type":"BreakStatement","start":10491,"end":10497,"label":null}],"test":{"type":"MemberExpression","start":10159,"end":10172,"object":{"type":"Identifier","start":10159,"end":10168,"name":"PROTOCOLS"},"property":{"type":"Identifier","start":10169,"end":10172,"name":"tus"},"computed":false}}]}]}}]}},{"type":"ReturnStatement","start":10544,"end":10569,"argument":{"type":"CallExpression","start":10551,"end":10568,"callee":{"type":"MemberExpression","start":10551,"end":10566,"object":{"type":"ThisExpression","start":10551,"end":10555},"property":{"type":"Identifier","start":10556,"end":10566,"name":"endStreams"},"computed":false},"arguments":[]}}]},"alternate":null},{"type":"ExpressionStatement","start":10588,"end":10788,"expression":{"type":"CallExpression","start":10588,"end":10787,"callee":{"type":"MemberExpression","start":10588,"end":10610,"object":{"type":"MemberExpression","start":10588,"end":10604,"object":{"type":"ThisExpression","start":10588,"end":10592},"property":{"type":"Identifier","start":10593,"end":10604,"name":"writeStream"},"computed":false},"property":{"type":"Identifier","start":10605,"end":10610,"name":"write"},"computed":false},"arguments":[{"type":"Identifier","start":10611,"end":10616,"name":"chunk"},{"type":"ArrowFunctionExpression","start":10618,"end":10786,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":10624,"end":10786,"body":[{"type":"ExpressionStatement","start":10638,"end":10728,"expression":{"type":"CallExpression","start":10638,"end":10727,"callee":{"type":"MemberExpression","start":10638,"end":10650,"object":{"type":"Identifier","start":10638,"end":10644,"name":"logger"},"property":{"type":"Identifier","start":10645,"end":10650,"name":"debug"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":10651,"end":10679,"expressions":[{"type":"MemberExpression","start":10654,"end":10671,"object":{"type":"ThisExpression","start":10654,"end":10658},"property":{"type":"Identifier","start":10659,"end":10671,"name":"bytesWritten"},"computed":false}],"quasis":[{"type":"TemplateElement","start":10652,"end":10652,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":10672,"end":10678,"value":{"raw":" bytes","cooked":" bytes"},"tail":true}]},{"type":"Literal","start":10681,"end":10709,"value":"uploader.download.progress","raw":"'uploader.download.progress'"},{"type":"MemberExpression","start":10711,"end":10726,"object":{"type":"ThisExpression","start":10711,"end":10715},"property":{"type":"Identifier","start":10716,"end":10726,"name":"shortToken"},"computed":false}]}},{"type":"ReturnStatement","start":10741,"end":10776,"argument":{"type":"CallExpression","start":10748,"end":10775,"callee":{"type":"MemberExpression","start":10748,"end":10773,"object":{"type":"ThisExpression","start":10748,"end":10752},"property":{"type":"Identifier","start":10753,"end":10773,"name":"emitIllusiveProgress"},"computed":false},"arguments":[]}}]}}]}}]}}},{"type":"MethodDefinition","start":10883,"end":11289,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":10883,"end":10897,"name":"writeToStreams"},"value":{"type":"FunctionExpression","start":10897,"end":11289,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":10898,"end":10903,"name":"chunk"},{"type":"Identifier","start":10905,"end":10907,"name":"cb"}],"body":{"type":"BlockStatement","start":10909,"end":11289,"body":[{"type":"VariableDeclaration","start":10919,"end":10935,"declarations":[{"type":"VariableDeclarator","start":10925,"end":10934,"id":{"type":"Identifier","start":10925,"end":10929,"name":"done"},"init":{"type":"ArrayExpression","start":10932,"end":10934,"elements":[]}}],"kind":"const"},{"type":"VariableDeclaration","start":10944,"end":10989,"declarations":[{"type":"VariableDeclarator","start":10950,"end":10988,"id":{"type":"Identifier","start":10950,"end":10960,"name":"doneLength"},"init":{"type":"ConditionalExpression","start":10963,"end":10988,"test":{"type":"MemberExpression","start":10963,"end":10980,"object":{"type":"ThisExpression","start":10963,"end":10967},"property":{"type":"Identifier","start":10968,"end":10980,"name":"duplexStream"},"computed":false},"consequent":{"type":"Literal","start":10983,"end":10984,"value":2,"raw":"2"},"alternate":{"type":"Literal","start":10987,"end":10988,"value":1,"raw":"1"}}}],"kind":"const"},{"type":"VariableDeclaration","start":10998,"end":11141,"declarations":[{"type":"VariableDeclarator","start":11004,"end":11140,"id":{"type":"Identifier","start":11004,"end":11010,"name":"onDone"},"init":{"type":"ArrowFunctionExpression","start":11013,"end":11140,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":11019,"end":11140,"body":[{"type":"ExpressionStatement","start":11033,"end":11049,"expression":{"type":"CallExpression","start":11033,"end":11048,"callee":{"type":"MemberExpression","start":11033,"end":11042,"object":{"type":"Identifier","start":11033,"end":11037,"name":"done"},"property":{"type":"Identifier","start":11038,"end":11042,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":11043,"end":11047,"value":true,"raw":"true"}]}},{"type":"IfStatement","start":11062,"end":11130,"test":{"type":"BinaryExpression","start":11066,"end":11091,"left":{"type":"MemberExpression","start":11066,"end":11077,"object":{"type":"Identifier","start":11066,"end":11070,"name":"done"},"property":{"type":"Identifier","start":11071,"end":11077,"name":"length"},"computed":false},"operator":">=","right":{"type":"Identifier","start":11081,"end":11091,"name":"doneLength"}},"consequent":{"type":"BlockStatement","start":11093,"end":11130,"body":[{"type":"ExpressionStatement","start":11111,"end":11116,"expression":{"type":"CallExpression","start":11111,"end":11115,"callee":{"type":"Identifier","start":11111,"end":11113,"name":"cb"},"arguments":[]}}]},"alternate":null}]}}}],"kind":"const"},{"type":"ExpressionStatement","start":11150,"end":11188,"expression":{"type":"CallExpression","start":11150,"end":11187,"callee":{"type":"MemberExpression","start":11150,"end":11172,"object":{"type":"MemberExpression","start":11150,"end":11166,"object":{"type":"ThisExpression","start":11150,"end":11154},"property":{"type":"Identifier","start":11155,"end":11166,"name":"writeStream"},"computed":false},"property":{"type":"Identifier","start":11167,"end":11172,"name":"write"},"computed":false},"arguments":[{"type":"Identifier","start":11173,"end":11178,"name":"chunk"},{"type":"Identifier","start":11180,"end":11186,"name":"onDone"}]}},{"type":"IfStatement","start":11197,"end":11283,"test":{"type":"MemberExpression","start":11201,"end":11218,"object":{"type":"ThisExpression","start":11201,"end":11205},"property":{"type":"Identifier","start":11206,"end":11218,"name":"duplexStream"},"computed":false},"consequent":{"type":"BlockStatement","start":11220,"end":11283,"body":[{"type":"ExpressionStatement","start":11234,"end":11273,"expression":{"type":"CallExpression","start":11234,"end":11272,"callee":{"type":"MemberExpression","start":11234,"end":11257,"object":{"type":"MemberExpression","start":11234,"end":11251,"object":{"type":"ThisExpression","start":11234,"end":11238},"property":{"type":"Identifier","start":11239,"end":11251,"name":"duplexStream"},"computed":false},"property":{"type":"Identifier","start":11252,"end":11257,"name":"write"},"computed":false},"arguments":[{"type":"Identifier","start":11258,"end":11263,"name":"chunk"},{"type":"Identifier","start":11265,"end":11271,"name":"onDone"}]}}]},"alternate":null}]}}},{"type":"MethodDefinition","start":11294,"end":11426,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":11294,"end":11304,"name":"endStreams"},"value":{"type":"FunctionExpression","start":11304,"end":11426,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":11307,"end":11426,"body":[{"type":"ExpressionStatement","start":11317,"end":11340,"expression":{"type":"CallExpression","start":11317,"end":11339,"callee":{"type":"MemberExpression","start":11317,"end":11337,"object":{"type":"MemberExpression","start":11317,"end":11333,"object":{"type":"ThisExpression","start":11317,"end":11321},"property":{"type":"Identifier","start":11322,"end":11333,"name":"writeStream"},"computed":false},"property":{"type":"Identifier","start":11334,"end":11337,"name":"end"},"computed":false},"arguments":[]}},{"type":"IfStatement","start":11349,"end":11420,"test":{"type":"MemberExpression","start":11353,"end":11370,"object":{"type":"ThisExpression","start":11353,"end":11357},"property":{"type":"Identifier","start":11358,"end":11370,"name":"duplexStream"},"computed":false},"consequent":{"type":"BlockStatement","start":11372,"end":11420,"body":[{"type":"ExpressionStatement","start":11386,"end":11410,"expression":{"type":"CallExpression","start":11386,"end":11409,"callee":{"type":"MemberExpression","start":11386,"end":11407,"object":{"type":"MemberExpression","start":11386,"end":11403,"object":{"type":"ThisExpression","start":11386,"end":11390},"property":{"type":"Identifier","start":11391,"end":11403,"name":"duplexStream"},"computed":false},"property":{"type":"Identifier","start":11404,"end":11407,"name":"end"},"computed":false},"arguments":[]}}]},"alternate":null}]}}},{"type":"MethodDefinition","start":11431,"end":11636,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":11431,"end":11442,"name":"getResponse"},"value":{"type":"FunctionExpression","start":11442,"end":11636,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":11445,"end":11636,"body":[{"type":"IfStatement","start":11455,"end":11569,"test":{"type":"MemberExpression","start":11459,"end":11479,"object":{"type":"ThisExpression","start":11459,"end":11463},"property":{"type":"Identifier","start":11464,"end":11479,"name":"_errRespMessage"},"computed":false},"consequent":{"type":"BlockStatement","start":11481,"end":11569,"body":[{"type":"ReturnStatement","start":11495,"end":11559,"argument":{"type":"ObjectExpression","start":11502,"end":11558,"properties":[{"type":"Property","start":11504,"end":11543,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":11504,"end":11508,"name":"body"},"value":{"type":"ObjectExpression","start":11510,"end":11543,"properties":[{"type":"Property","start":11512,"end":11541,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":11512,"end":11519,"name":"message"},"value":{"type":"MemberExpression","start":11521,"end":11541,"object":{"type":"ThisExpression","start":11521,"end":11525},"property":{"type":"Identifier","start":11526,"end":11541,"name":"_errRespMessage"},"computed":false},"kind":"init"}]},"kind":"init"},{"type":"Property","start":11545,"end":11556,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":11545,"end":11551,"name":"status"},"value":{"type":"Literal","start":11553,"end":11556,"value":400,"raw":"400"},"kind":"init"}]}}]},"alternate":null},{"type":"ReturnStatement","start":11578,"end":11630,"argument":{"type":"ObjectExpression","start":11585,"end":11629,"properties":[{"type":"Property","start":11587,"end":11614,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":11587,"end":11591,"name":"body"},"value":{"type":"ObjectExpression","start":11593,"end":11614,"properties":[{"type":"Property","start":11595,"end":11612,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":11595,"end":11600,"name":"token"},"value":{"type":"MemberExpression","start":11602,"end":11612,"object":{"type":"ThisExpression","start":11602,"end":11606},"property":{"type":"Identifier","start":11607,"end":11612,"name":"token"},"computed":false},"kind":"init"}]},"kind":"init"},{"type":"Property","start":11616,"end":11627,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":11616,"end":11622,"name":"status"},"value":{"type":"Literal","start":11624,"end":11627,"value":200,"raw":"200"},"kind":"init"}]}}]}}},{"type":"MethodDefinition","start":11743,"end":11906,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":11743,"end":11752,"name":"saveState"},"value":{"type":"FunctionExpression","start":11752,"end":11906,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":11753,"end":11758,"name":"state"}],"body":{"type":"BlockStatement","start":11760,"end":11906,"body":[{"type":"IfStatement","start":11770,"end":11808,"test":{"type":"UnaryExpression","start":11774,"end":11787,"operator":"!","prefix":true,"argument":{"type":"MemberExpression","start":11775,"end":11787,"object":{"type":"ThisExpression","start":11775,"end":11779},"property":{"type":"Identifier","start":11780,"end":11787,"name":"storage"},"computed":false}},"consequent":{"type":"ReturnStatement","start":11801,"end":11808,"argument":null},"alternate":null},{"type":"ExpressionStatement","start":11817,"end":11900,"expression":{"type":"CallExpression","start":11817,"end":11899,"callee":{"type":"MemberExpression","start":11817,"end":11833,"object":{"type":"MemberExpression","start":11817,"end":11829,"object":{"type":"ThisExpression","start":11817,"end":11821},"property":{"type":"Identifier","start":11822,"end":11829,"name":"storage"},"computed":false},"property":{"type":"Identifier","start":11830,"end":11833,"name":"set"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":11834,"end":11876,"expressions":[{"type":"MemberExpression","start":11837,"end":11860,"object":{"type":"Identifier","start":11837,"end":11845,"name":"Uploader"},"property":{"type":"Identifier","start":11846,"end":11860,"name":"STORAGE_PREFIX"},"computed":false},{"type":"MemberExpression","start":11864,"end":11874,"object":{"type":"ThisExpression","start":11864,"end":11868},"property":{"type":"Identifier","start":11869,"end":11874,"name":"token"},"computed":false}],"quasis":[{"type":"TemplateElement","start":11835,"end":11835,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":11861,"end":11862,"value":{"raw":":","cooked":":"},"tail":false},{"type":"TemplateElement","start":11875,"end":11875,"value":{"raw":"","cooked":""},"tail":true}]},{"type":"CallExpression","start":11878,"end":11898,"callee":{"type":"Identifier","start":11878,"end":11891,"name":"jsonStringify"},"arguments":[{"type":"Identifier","start":11892,"end":11897,"name":"state"}]}]}}]}}},{"type":"MethodDefinition","start":12253,"end":12994,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":12253,"end":12273,"name":"emitIllusiveProgress"},"value":{"type":"FunctionExpression","start":12273,"end":12994,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"AssignmentPattern","start":12274,"end":12291,"left":{"type":"Identifier","start":12274,"end":12287,"name":"bytesUploaded"},"right":{"type":"Literal","start":12290,"end":12291,"value":0,"raw":"0"}}],"body":{"type":"BlockStatement","start":12293,"end":12994,"body":[{"type":"IfStatement","start":12303,"end":12352,"test":{"type":"MemberExpression","start":12307,"end":12319,"object":{"type":"ThisExpression","start":12307,"end":12311},"property":{"type":"Identifier","start":12312,"end":12319,"name":"_paused"},"computed":false},"consequent":{"type":"BlockStatement","start":12321,"end":12352,"body":[{"type":"ReturnStatement","start":12335,"end":12342,"argument":null}]},"alternate":null},{"type":"VariableDeclaration","start":12361,"end":12436,"declarations":[{"type":"VariableDeclarator","start":12365,"end":12435,"id":{"type":"Identifier","start":12365,"end":12375,"name":"bytesTotal"},"init":{"type":"ConditionalExpression","start":12378,"end":12435,"test":{"type":"MemberExpression","start":12378,"end":12395,"object":{"type":"ThisExpression","start":12378,"end":12382},"property":{"type":"Identifier","start":12383,"end":12395,"name":"streamsEnded"},"computed":false},"consequent":{"type":"MemberExpression","start":12398,"end":12415,"object":{"type":"ThisExpression","start":12398,"end":12402},"property":{"type":"Identifier","start":12403,"end":12415,"name":"bytesWritten"},"computed":false},"alternate":{"type":"MemberExpression","start":12418,"end":12435,"object":{"type":"MemberExpression","start":12418,"end":12430,"object":{"type":"ThisExpression","start":12418,"end":12422},"property":{"type":"Identifier","start":12423,"end":12430,"name":"options"},"computed":false},"property":{"type":"Identifier","start":12431,"end":12435,"name":"size"},"computed":false}}}],"kind":"let"},{"type":"IfStatement","start":12445,"end":12546,"test":{"type":"UnaryExpression","start":12449,"end":12467,"operator":"!","prefix":true,"argument":{"type":"MemberExpression","start":12450,"end":12467,"object":{"type":"ThisExpression","start":12450,"end":12454},"property":{"type":"Identifier","start":12455,"end":12467,"name":"streamsEnded"},"computed":false}},"consequent":{"type":"BlockStatement","start":12469,"end":12546,"body":[{"type":"ExpressionStatement","start":12483,"end":12536,"expression":{"type":"AssignmentExpression","start":12483,"end":12535,"operator":"=","left":{"type":"Identifier","start":12483,"end":12493,"name":"bytesTotal"},"right":{"type":"CallExpression","start":12496,"end":12535,"callee":{"type":"MemberExpression","start":12496,"end":12504,"object":{"type":"Identifier","start":12496,"end":12500,"name":"Math"},"property":{"type":"Identifier","start":12501,"end":12504,"name":"max"},"computed":false},"arguments":[{"type":"Identifier","start":12505,"end":12515,"name":"bytesTotal"},{"type":"MemberExpression","start":12517,"end":12534,"object":{"type":"ThisExpression","start":12517,"end":12521},"property":{"type":"Identifier","start":12522,"end":12534,"name":"bytesWritten"},"computed":false}]}}}]},"alternate":null},{"type":"VariableDeclaration","start":12722,"end":12798,"declarations":[{"type":"VariableDeclarator","start":12728,"end":12797,"id":{"type":"Identifier","start":12728,"end":12749,"name":"illusiveBytesUploaded"},"init":{"type":"BinaryExpression","start":12752,"end":12797,"left":{"type":"BinaryExpression","start":12753,"end":12774,"left":{"type":"MemberExpression","start":12753,"end":12770,"object":{"type":"ThisExpression","start":12753,"end":12757},"property":{"type":"Identifier","start":12758,"end":12770,"name":"bytesWritten"},"computed":false},"operator":"/","right":{"type":"Literal","start":12773,"end":12774,"value":2,"raw":"2"}},"operator":"+","right":{"type":"BinaryExpression","start":12779,"end":12796,"left":{"type":"Identifier","start":12779,"end":12792,"name":"bytesUploaded"},"operator":"/","right":{"type":"Literal","start":12795,"end":12796,"value":2,"raw":"2"}}}}],"kind":"const"},{"type":"ExpressionStatement","start":12807,"end":12926,"expression":{"type":"CallExpression","start":12807,"end":12925,"callee":{"type":"MemberExpression","start":12807,"end":12819,"object":{"type":"Identifier","start":12807,"end":12813,"name":"logger"},"property":{"type":"Identifier","start":12814,"end":12819,"name":"debug"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":12820,"end":12877,"expressions":[{"type":"Identifier","start":12823,"end":12836,"name":"bytesUploaded"},{"type":"Identifier","start":12840,"end":12861,"name":"illusiveBytesUploaded"},{"type":"Identifier","start":12865,"end":12875,"name":"bytesTotal"}],"quasis":[{"type":"TemplateElement","start":12821,"end":12821,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":12837,"end":12838,"value":{"raw":" ","cooked":" "},"tail":false},{"type":"TemplateElement","start":12862,"end":12863,"value":{"raw":" ","cooked":" "},"tail":false},{"type":"TemplateElement","start":12876,"end":12876,"value":{"raw":"","cooked":""},"tail":true}]},{"type":"Literal","start":12879,"end":12907,"value":"uploader.illusive.progress","raw":"'uploader.illusive.progress'"},{"type":"MemberExpression","start":12909,"end":12924,"object":{"type":"ThisExpression","start":12909,"end":12913},"property":{"type":"Identifier","start":12914,"end":12924,"name":"shortToken"},"computed":false}]}},{"type":"ExpressionStatement","start":12935,"end":12988,"expression":{"type":"CallExpression","start":12935,"end":12987,"callee":{"type":"MemberExpression","start":12935,"end":12952,"object":{"type":"ThisExpression","start":12935,"end":12939},"property":{"type":"Identifier","start":12940,"end":12952,"name":"emitProgress"},"computed":false},"arguments":[{"type":"Identifier","start":12953,"end":12974,"name":"illusiveBytesUploaded"},{"type":"Identifier","start":12976,"end":12986,"name":"bytesTotal"}]}}]}}},{"type":"MethodDefinition","start":13100,"end":14060,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":13100,"end":13112,"name":"emitProgress"},"value":{"type":"FunctionExpression","start":13112,"end":14060,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":13113,"end":13126,"name":"bytesUploaded"},{"type":"Identifier","start":13128,"end":13138,"name":"bytesTotal"}],"body":{"type":"BlockStatement","start":13140,"end":14060,"body":[{"type":"ExpressionStatement","start":13150,"end":13195,"expression":{"type":"AssignmentExpression","start":13150,"end":13194,"operator":"=","left":{"type":"Identifier","start":13150,"end":13160,"name":"bytesTotal"},"right":{"type":"LogicalExpression","start":13163,"end":13194,"left":{"type":"Identifier","start":13163,"end":13173,"name":"bytesTotal"},"operator":"||","right":{"type":"MemberExpression","start":13177,"end":13194,"object":{"type":"MemberExpression","start":13177,"end":13189,"object":{"type":"ThisExpression","start":13177,"end":13181},"property":{"type":"Identifier","start":13182,"end":13189,"name":"options"},"computed":false},"property":{"type":"Identifier","start":13190,"end":13194,"name":"size"},"computed":false}}}},{"type":"IfStatement","start":13204,"end":13335,"test":{"type":"LogicalExpression","start":13208,"end":13278,"left":{"type":"LogicalExpression","start":13208,"end":13257,"left":{"type":"MemberExpression","start":13208,"end":13216,"object":{"type":"ThisExpression","start":13208,"end":13212},"property":{"type":"Identifier","start":13213,"end":13216,"name":"tus"},"computed":false},"operator":"&&","right":{"type":"MemberExpression","start":13220,"end":13257,"object":{"type":"MemberExpression","start":13220,"end":13236,"object":{"type":"MemberExpression","start":13220,"end":13228,"object":{"type":"ThisExpression","start":13220,"end":13224},"property":{"type":"Identifier","start":13225,"end":13228,"name":"tus"},"computed":false},"property":{"type":"Identifier","start":13229,"end":13236,"name":"options"},"computed":false},"property":{"type":"Identifier","start":13237,"end":13257,"name":"uploadLengthDeferred"},"computed":false}},"operator":"&&","right":{"type":"MemberExpression","start":13261,"end":13278,"object":{"type":"ThisExpression","start":13261,"end":13265},"property":{"type":"Identifier","start":13266,"end":13278,"name":"streamsEnded"},"computed":false}},"consequent":{"type":"BlockStatement","start":13280,"end":13335,"body":[{"type":"ExpressionStatement","start":13294,"end":13325,"expression":{"type":"AssignmentExpression","start":13294,"end":13324,"operator":"=","left":{"type":"Identifier","start":13294,"end":13304,"name":"bytesTotal"},"right":{"type":"MemberExpression","start":13307,"end":13324,"object":{"type":"ThisExpression","start":13307,"end":13311},"property":{"type":"Identifier","start":13312,"end":13324,"name":"bytesWritten"},"computed":false}}}]},"alternate":null},{"type":"VariableDeclaration","start":13344,"end":13398,"declarations":[{"type":"VariableDeclarator","start":13350,"end":13397,"id":{"type":"Identifier","start":13350,"end":13360,"name":"percentage"},"init":{"type":"BinaryExpression","start":13364,"end":13396,"left":{"type":"BinaryExpression","start":13364,"end":13390,"left":{"type":"Identifier","start":13364,"end":13377,"name":"bytesUploaded"},"operator":"/","right":{"type":"Identifier","start":13380,"end":13390,"name":"bytesTotal"}},"operator":"*","right":{"type":"Literal","start":13393,"end":13396,"value":100,"raw":"100"}}}],"kind":"const"},{"type":"VariableDeclaration","start":13407,"end":13454,"declarations":[{"type":"VariableDeclarator","start":13413,"end":13453,"id":{"type":"Identifier","start":13413,"end":13429,"name":"formatPercentage"},"init":{"type":"CallExpression","start":13432,"end":13453,"callee":{"type":"MemberExpression","start":13432,"end":13450,"object":{"type":"Identifier","start":13432,"end":13442,"name":"percentage"},"property":{"type":"Identifier","start":13443,"end":13450,"name":"toFixed"},"computed":false},"arguments":[{"type":"Literal","start":13451,"end":13452,"value":2,"raw":"2"}]}}],"kind":"const"},{"type":"ExpressionStatement","start":13463,"end":13576,"expression":{"type":"CallExpression","start":13463,"end":13575,"callee":{"type":"MemberExpression","start":13463,"end":13475,"object":{"type":"Identifier","start":13463,"end":13469,"name":"logger"},"property":{"type":"Identifier","start":13470,"end":13475,"name":"debug"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":13476,"end":13529,"expressions":[{"type":"Identifier","start":13479,"end":13492,"name":"bytesUploaded"},{"type":"Identifier","start":13496,"end":13506,"name":"bytesTotal"},{"type":"Identifier","start":13510,"end":13526,"name":"formatPercentage"}],"quasis":[{"type":"TemplateElement","start":13477,"end":13477,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":13493,"end":13494,"value":{"raw":" ","cooked":" "},"tail":false},{"type":"TemplateElement","start":13507,"end":13508,"value":{"raw":" ","cooked":" "},"tail":false},{"type":"TemplateElement","start":13527,"end":13528,"value":{"raw":"%","cooked":"%"},"tail":true}]},{"type":"Literal","start":13531,"end":13557,"value":"uploader.upload.progress","raw":"'uploader.upload.progress'"},{"type":"MemberExpression","start":13559,"end":13574,"object":{"type":"ThisExpression","start":13559,"end":13563},"property":{"type":"Identifier","start":13564,"end":13574,"name":"shortToken"},"computed":false}]}},{"type":"VariableDeclaration","start":13585,"end":13727,"declarations":[{"type":"VariableDeclarator","start":13591,"end":13726,"id":{"type":"Identifier","start":13591,"end":13601,"name":"dataToEmit"},"init":{"type":"ObjectExpression","start":13604,"end":13726,"properties":[{"type":"Property","start":13618,"end":13636,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":13618,"end":13624,"name":"action"},"value":{"type":"Literal","start":13626,"end":13636,"value":"progress","raw":"'progress'"},"kind":"init"},{"type":"Property","start":13650,"end":13716,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":13650,"end":13657,"name":"payload"},"value":{"type":"ObjectExpression","start":13659,"end":13716,"properties":[{"type":"Property","start":13661,"end":13687,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":13661,"end":13669,"name":"progress"},"value":{"type":"Identifier","start":13671,"end":13687,"name":"formatPercentage"},"kind":"init"},{"type":"Property","start":13689,"end":13702,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":13689,"end":13702,"name":"bytesUploaded"},"kind":"init","value":{"type":"Identifier","start":13689,"end":13702,"name":"bytesUploaded"}},{"type":"Property","start":13704,"end":13714,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":13704,"end":13714,"name":"bytesTotal"},"kind":"init","value":{"type":"Identifier","start":13704,"end":13714,"name":"bytesTotal"}}]},"kind":"init"}]}}],"kind":"const"},{"type":"ExpressionStatement","start":13736,"end":13763,"expression":{"type":"CallExpression","start":13736,"end":13762,"callee":{"type":"MemberExpression","start":13736,"end":13750,"object":{"type":"ThisExpression","start":13736,"end":13740},"property":{"type":"Identifier","start":13741,"end":13750,"name":"saveState"},"computed":false},"arguments":[{"type":"Identifier","start":13751,"end":13761,"name":"dataToEmit"}]}},{"type":"VariableDeclaration","start":13831,"end":13880,"declarations":[{"type":"VariableDeclarator","start":13837,"end":13879,"id":{"type":"Identifier","start":13837,"end":13854,"name":"roundedPercentage"},"init":{"type":"CallExpression","start":13857,"end":13879,"callee":{"type":"MemberExpression","start":13857,"end":13867,"object":{"type":"Identifier","start":13857,"end":13861,"name":"Math"},"property":{"type":"Identifier","start":13862,"end":13867,"name":"floor"},"computed":false},"arguments":[{"type":"Identifier","start":13868,"end":13878,"name":"percentage"}]}}],"kind":"const"},{"type":"IfStatement","start":13889,"end":14054,"test":{"type":"BinaryExpression","start":13893,"end":13935,"left":{"type":"MemberExpression","start":13893,"end":13913,"object":{"type":"ThisExpression","start":13893,"end":13897},"property":{"type":"Identifier","start":13898,"end":13913,"name":"emittedProgress"},"computed":false},"operator":"!==","right":{"type":"Identifier","start":13918,"end":13935,"name":"roundedPercentage"}},"consequent":{"type":"BlockStatement","start":13937,"end":14054,"body":[{"type":"ExpressionStatement","start":13951,"end":13992,"expression":{"type":"AssignmentExpression","start":13951,"end":13991,"operator":"=","left":{"type":"MemberExpression","start":13951,"end":13971,"object":{"type":"ThisExpression","start":13951,"end":13955},"property":{"type":"Identifier","start":13956,"end":13971,"name":"emittedProgress"},"computed":false},"right":{"type":"Identifier","start":13974,"end":13991,"name":"roundedPercentage"}}},{"type":"ExpressionStatement","start":14005,"end":14044,"expression":{"type":"CallExpression","start":14005,"end":14043,"callee":{"type":"MemberExpression","start":14005,"end":14019,"object":{"type":"CallExpression","start":14005,"end":14014,"callee":{"type":"Identifier","start":14005,"end":14012,"name":"emitter"},"arguments":[]},"property":{"type":"Identifier","start":14015,"end":14019,"name":"emit"},"computed":false},"arguments":[{"type":"MemberExpression","start":14020,"end":14030,"object":{"type":"ThisExpression","start":14020,"end":14024},"property":{"type":"Identifier","start":14025,"end":14030,"name":"token"},"computed":false},{"type":"Identifier","start":14032,"end":14042,"name":"dataToEmit"}]}}]},"alternate":null}]}}},{"type":"MethodDefinition","start":14148,"end":14408,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":14148,"end":14159,"name":"emitSuccess"},"value":{"type":"FunctionExpression","start":14159,"end":14408,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":14160,"end":14163,"name":"url"},{"type":"AssignmentPattern","start":14165,"end":14179,"left":{"type":"Identifier","start":14165,"end":14174,"name":"extraData"},"right":{"type":"ObjectExpression","start":14177,"end":14179,"properties":[]}}],"body":{"type":"BlockStatement","start":14181,"end":14408,"body":[{"type":"VariableDeclaration","start":14191,"end":14322,"declarations":[{"type":"VariableDeclarator","start":14197,"end":14321,"id":{"type":"Identifier","start":14197,"end":14205,"name":"emitData"},"init":{"type":"ObjectExpression","start":14208,"end":14321,"properties":[{"type":"Property","start":14222,"end":14239,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":14222,"end":14228,"name":"action"},"value":{"type":"Literal","start":14230,"end":14239,"value":"success","raw":"'success'"},"kind":"init"},{"type":"Property","start":14253,"end":14311,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":14253,"end":14260,"name":"payload"},"value":{"type":"CallExpression","start":14262,"end":14311,"callee":{"type":"MemberExpression","start":14262,"end":14275,"object":{"type":"Identifier","start":14262,"end":14268,"name":"Object"},"property":{"type":"Identifier","start":14269,"end":14275,"name":"assign"},"computed":false},"arguments":[{"type":"Identifier","start":14276,"end":14285,"name":"extraData"},{"type":"ObjectExpression","start":14287,"end":14310,"properties":[{"type":"Property","start":14289,"end":14303,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":14289,"end":14297,"name":"complete"},"value":{"type":"Literal","start":14299,"end":14303,"value":true,"raw":"true"},"kind":"init"},{"type":"Property","start":14305,"end":14308,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":14305,"end":14308,"name":"url"},"kind":"init","value":{"type":"Identifier","start":14305,"end":14308,"name":"url"}}]}]},"kind":"init"}]}}],"kind":"const"},{"type":"ExpressionStatement","start":14331,"end":14356,"expression":{"type":"CallExpression","start":14331,"end":14355,"callee":{"type":"MemberExpression","start":14331,"end":14345,"object":{"type":"ThisExpression","start":14331,"end":14335},"property":{"type":"Identifier","start":14336,"end":14345,"name":"saveState"},"computed":false},"arguments":[{"type":"Identifier","start":14346,"end":14354,"name":"emitData"}]}},{"type":"ExpressionStatement","start":14365,"end":14402,"expression":{"type":"CallExpression","start":14365,"end":14401,"callee":{"type":"MemberExpression","start":14365,"end":14379,"object":{"type":"CallExpression","start":14365,"end":14374,"callee":{"type":"Identifier","start":14365,"end":14372,"name":"emitter"},"arguments":[]},"property":{"type":"Identifier","start":14375,"end":14379,"name":"emit"},"computed":false},"arguments":[{"type":"MemberExpression","start":14380,"end":14390,"object":{"type":"ThisExpression","start":14380,"end":14384},"property":{"type":"Identifier","start":14385,"end":14390,"name":"token"},"computed":false},{"type":"Identifier","start":14392,"end":14400,"name":"emitData"}]}}]}}},{"type":"MethodDefinition","start":14496,"end":14909,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":14496,"end":14505,"name":"emitError"},"value":{"type":"FunctionExpression","start":14505,"end":14909,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":14506,"end":14509,"name":"err"},{"type":"AssignmentPattern","start":14511,"end":14525,"left":{"type":"Identifier","start":14511,"end":14520,"name":"extraData"},"right":{"type":"ObjectExpression","start":14523,"end":14525,"properties":[]}}],"body":{"type":"BlockStatement","start":14527,"end":14909,"body":[{"type":"VariableDeclaration","start":14537,"end":14579,"declarations":[{"type":"VariableDeclarator","start":14543,"end":14578,"id":{"type":"Identifier","start":14543,"end":14556,"name":"serializedErr"},"init":{"type":"CallExpression","start":14559,"end":14578,"callee":{"type":"Identifier","start":14559,"end":14573,"name":"serializeError"},"arguments":[{"type":"Identifier","start":14574,"end":14577,"name":"err"}]}}],"kind":"const"},{"type":"ExpressionStatement","start":14651,"end":14678,"expression":{"type":"UnaryExpression","start":14651,"end":14677,"operator":"delete","prefix":true,"argument":{"type":"MemberExpression","start":14658,"end":14677,"object":{"type":"Identifier","start":14658,"end":14671,"name":"serializedErr"},"property":{"type":"Identifier","start":14672,"end":14677,"name":"stack"},"computed":false}}},{"type":"VariableDeclaration","start":14687,"end":14819,"declarations":[{"type":"VariableDeclarator","start":14693,"end":14818,"id":{"type":"Identifier","start":14693,"end":14703,"name":"dataToEmit"},"init":{"type":"ObjectExpression","start":14706,"end":14818,"properties":[{"type":"Property","start":14720,"end":14735,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":14720,"end":14726,"name":"action"},"value":{"type":"Literal","start":14728,"end":14735,"value":"error","raw":"'error'"},"kind":"init"},{"type":"Property","start":14749,"end":14808,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":14749,"end":14756,"name":"payload"},"value":{"type":"CallExpression","start":14758,"end":14808,"callee":{"type":"MemberExpression","start":14758,"end":14771,"object":{"type":"Identifier","start":14758,"end":14764,"name":"Object"},"property":{"type":"Identifier","start":14765,"end":14771,"name":"assign"},"computed":false},"arguments":[{"type":"Identifier","start":14772,"end":14781,"name":"extraData"},{"type":"ObjectExpression","start":14783,"end":14807,"properties":[{"type":"Property","start":14785,"end":14805,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":14785,"end":14790,"name":"error"},"value":{"type":"Identifier","start":14792,"end":14805,"name":"serializedErr"},"kind":"init"}]}]},"kind":"init"}]}}],"kind":"const"},{"type":"ExpressionStatement","start":14828,"end":14855,"expression":{"type":"CallExpression","start":14828,"end":14854,"callee":{"type":"MemberExpression","start":14828,"end":14842,"object":{"type":"ThisExpression","start":14828,"end":14832},"property":{"type":"Identifier","start":14833,"end":14842,"name":"saveState"},"computed":false},"arguments":[{"type":"Identifier","start":14843,"end":14853,"name":"dataToEmit"}]}},{"type":"ExpressionStatement","start":14864,"end":14903,"expression":{"type":"CallExpression","start":14864,"end":14902,"callee":{"type":"MemberExpression","start":14864,"end":14878,"object":{"type":"CallExpression","start":14864,"end":14873,"callee":{"type":"Identifier","start":14864,"end":14871,"name":"emitter"},"arguments":[]},"property":{"type":"Identifier","start":14874,"end":14878,"name":"emit"},"computed":false},"arguments":[{"type":"MemberExpression","start":14879,"end":14889,"object":{"type":"ThisExpression","start":14879,"end":14883},"property":{"type":"Identifier","start":14884,"end":14889,"name":"token"},"computed":false},{"type":"Identifier","start":14891,"end":14901,"name":"dataToEmit"}]}}]}}},{"type":"MethodDefinition","start":14958,"end":16479,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":14958,"end":14967,"name":"uploadTus"},"value":{"type":"FunctionExpression","start":14967,"end":16479,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":14970,"end":16479,"body":[{"type":"VariableDeclaration","start":14980,"end":15024,"declarations":[{"type":"VariableDeclarator","start":14986,"end":15023,"id":{"type":"Identifier","start":14986,"end":14990,"name":"file"},"init":{"type":"CallExpression","start":14993,"end":15023,"callee":{"type":"MemberExpression","start":14993,"end":15012,"object":{"type":"Identifier","start":14993,"end":14995,"name":"fs"},"property":{"type":"Identifier","start":14996,"end":15012,"name":"createReadStream"},"computed":false},"arguments":[{"type":"MemberExpression","start":15013,"end":15022,"object":{"type":"ThisExpression","start":15013,"end":15017},"property":{"type":"Identifier","start":15018,"end":15022,"name":"path"},"computed":false}]}}],"kind":"const"},{"type":"VariableDeclaration","start":15033,"end":15055,"declarations":[{"type":"VariableDeclarator","start":15039,"end":15054,"id":{"type":"Identifier","start":15039,"end":15047,"name":"uploader"},"init":{"type":"ThisExpression","start":15050,"end":15054}}],"kind":"const"},{"type":"ExpressionStatement","start":15086,"end":16404,"expression":{"type":"AssignmentExpression","start":15086,"end":16403,"operator":"=","left":{"type":"MemberExpression","start":15086,"end":15094,"object":{"type":"ThisExpression","start":15086,"end":15090},"property":{"type":"Identifier","start":15091,"end":15094,"name":"tus"},"computed":false},"right":{"type":"NewExpression","start":15097,"end":16403,"callee":{"type":"MemberExpression","start":15101,"end":15111,"object":{"type":"Identifier","start":15101,"end":15104,"name":"tus"},"property":{"type":"Identifier","start":15105,"end":15111,"name":"Upload"},"computed":false},"arguments":[{"type":"Identifier","start":15112,"end":15116,"name":"file"},{"type":"ObjectExpression","start":15118,"end":16402,"properties":[{"type":"Property","start":15132,"end":15163,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":15132,"end":15140,"name":"endpoint"},"value":{"type":"MemberExpression","start":15142,"end":15163,"object":{"type":"MemberExpression","start":15142,"end":15154,"object":{"type":"ThisExpression","start":15142,"end":15146},"property":{"type":"Identifier","start":15147,"end":15154,"name":"options"},"computed":false},"property":{"type":"Identifier","start":15155,"end":15163,"name":"endpoint"},"computed":false},"kind":"init"},{"type":"Property","start":15177,"end":15210,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":15177,"end":15186,"name":"uploadUrl"},"value":{"type":"MemberExpression","start":15188,"end":15210,"object":{"type":"MemberExpression","start":15188,"end":15200,"object":{"type":"ThisExpression","start":15188,"end":15192},"property":{"type":"Identifier","start":15193,"end":15200,"name":"options"},"computed":false},"property":{"type":"Identifier","start":15201,"end":15210,"name":"uploadUrl"},"computed":false},"kind":"init"},{"type":"Property","start":15250,"end":15277,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":15250,"end":15270,"name":"uploadLengthDeferred"},"value":{"type":"Literal","start":15272,"end":15277,"value":false,"raw":"false"},"kind":"init"},{"type":"Property","start":15291,"end":15303,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":15291,"end":15297,"name":"resume"},"value":{"type":"Literal","start":15299,"end":15303,"value":true,"raw":"true"},"kind":"init"},{"type":"Property","start":15317,"end":15351,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":15317,"end":15328,"name":"retryDelays"},"value":{"type":"ArrayExpression","start":15330,"end":15351,"elements":[{"type":"Literal","start":15331,"end":15332,"value":0,"raw":"0"},{"type":"Literal","start":15334,"end":15338,"value":1000,"raw":"1000"},{"type":"Literal","start":15340,"end":15344,"value":3000,"raw":"3000"},{"type":"Literal","start":15346,"end":15350,"value":5000,"raw":"5000"}]},"kind":"init"},{"type":"Property","start":15365,"end":15394,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":15365,"end":15375,"name":"uploadSize"},"value":{"type":"MemberExpression","start":15377,"end":15394,"object":{"type":"ThisExpression","start":15377,"end":15381},"property":{"type":"Identifier","start":15382,"end":15394,"name":"bytesWritten"},"computed":false},"kind":"init"},{"type":"Property","start":15408,"end":15767,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":15408,"end":15416,"name":"metadata"},"value":{"type":"CallExpression","start":15418,"end":15767,"callee":{"type":"MemberExpression","start":15418,"end":15431,"object":{"type":"Identifier","start":15418,"end":15424,"name":"Object"},"property":{"type":"Identifier","start":15425,"end":15431,"name":"assign"},"computed":false},"arguments":[{"type":"ObjectExpression","start":15432,"end":15743,"properties":[{"type":"Property","start":15646,"end":15675,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":15646,"end":15654,"name":"filename"},"value":{"type":"MemberExpression","start":15656,"end":15675,"object":{"type":"ThisExpression","start":15656,"end":15660},"property":{"type":"Identifier","start":15661,"end":15675,"name":"uploadFileName"},"computed":false},"kind":"init"},{"type":"Property","start":15693,"end":15729,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":15693,"end":15701,"name":"filetype"},"value":{"type":"MemberExpression","start":15703,"end":15729,"object":{"type":"MemberExpression","start":15703,"end":15724,"object":{"type":"MemberExpression","start":15703,"end":15715,"object":{"type":"ThisExpression","start":15703,"end":15707},"property":{"type":"Identifier","start":15708,"end":15715,"name":"options"},"computed":false},"property":{"type":"Identifier","start":15716,"end":15724,"name":"metadata"},"computed":false},"property":{"type":"Identifier","start":15725,"end":15729,"name":"type"},"computed":false},"kind":"init"}]},{"type":"MemberExpression","start":15745,"end":15766,"object":{"type":"MemberExpression","start":15745,"end":15757,"object":{"type":"ThisExpression","start":15745,"end":15749},"property":{"type":"Identifier","start":15750,"end":15757,"name":"options"},"computed":false},"property":{"type":"Identifier","start":15758,"end":15766,"name":"metadata"},"computed":false}]},"kind":"init"},{"type":"Property","start":15864,"end":15996,"method":true,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":15864,"end":15871,"name":"onError"},"kind":"init","value":{"type":"FunctionExpression","start":15871,"end":15996,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":15872,"end":15877,"name":"error"}],"body":{"type":"BlockStatement","start":15879,"end":15996,"body":[{"type":"ExpressionStatement","start":15897,"end":15939,"expression":{"type":"CallExpression","start":15897,"end":15938,"callee":{"type":"MemberExpression","start":15897,"end":15909,"object":{"type":"Identifier","start":15897,"end":15903,"name":"logger"},"property":{"type":"Identifier","start":15904,"end":15909,"name":"error"},"computed":false},"arguments":[{"type":"Identifier","start":15910,"end":15915,"name":"error"},{"type":"Literal","start":15917,"end":15937,"value":"uploader.tus.error","raw":"'uploader.tus.error'"}]}},{"type":"ExpressionStatement","start":15956,"end":15982,"expression":{"type":"CallExpression","start":15956,"end":15981,"callee":{"type":"MemberExpression","start":15956,"end":15974,"object":{"type":"Identifier","start":15956,"end":15964,"name":"uploader"},"property":{"type":"Identifier","start":15965,"end":15974,"name":"emitError"},"computed":false},"arguments":[{"type":"Identifier","start":15975,"end":15980,"name":"error"}]}}]}}},{"type":"Property","start":16144,"end":16259,"method":true,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":16144,"end":16154,"name":"onProgress"},"kind":"init","value":{"type":"FunctionExpression","start":16154,"end":16259,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":16155,"end":16168,"name":"bytesUploaded"},{"type":"Identifier","start":16170,"end":16180,"name":"bytesTotal"}],"body":{"type":"BlockStatement","start":16182,"end":16259,"body":[{"type":"ExpressionStatement","start":16200,"end":16245,"expression":{"type":"CallExpression","start":16200,"end":16244,"callee":{"type":"MemberExpression","start":16200,"end":16229,"object":{"type":"Identifier","start":16200,"end":16208,"name":"uploader"},"property":{"type":"Identifier","start":16209,"end":16229,"name":"emitIllusiveProgress"},"computed":false},"arguments":[{"type":"Identifier","start":16230,"end":16243,"name":"bytesUploaded"}]}}]}}},{"type":"Property","start":16273,"end":16392,"method":true,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":16273,"end":16282,"name":"onSuccess"},"kind":"init","value":{"type":"FunctionExpression","start":16282,"end":16392,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":16285,"end":16392,"body":[{"type":"ExpressionStatement","start":16303,"end":16342,"expression":{"type":"CallExpression","start":16303,"end":16341,"callee":{"type":"MemberExpression","start":16303,"end":16323,"object":{"type":"Identifier","start":16303,"end":16311,"name":"uploader"},"property":{"type":"Identifier","start":16312,"end":16323,"name":"emitSuccess"},"computed":false},"arguments":[{"type":"MemberExpression","start":16324,"end":16340,"object":{"type":"MemberExpression","start":16324,"end":16336,"object":{"type":"Identifier","start":16324,"end":16332,"name":"uploader"},"property":{"type":"Identifier","start":16333,"end":16336,"name":"tus"},"computed":false},"property":{"type":"Identifier","start":16337,"end":16340,"name":"url"},"computed":false}]}},{"type":"ExpressionStatement","start":16359,"end":16378,"expression":{"type":"CallExpression","start":16359,"end":16377,"callee":{"type":"MemberExpression","start":16359,"end":16375,"object":{"type":"Identifier","start":16359,"end":16367,"name":"uploader"},"property":{"type":"Identifier","start":16368,"end":16375,"name":"cleanUp"},"computed":false},"arguments":[]}}]}}}]}]}}},{"type":"IfStatement","start":16413,"end":16473,"test":{"type":"UnaryExpression","start":16417,"end":16430,"operator":"!","prefix":true,"argument":{"type":"MemberExpression","start":16418,"end":16430,"object":{"type":"ThisExpression","start":16418,"end":16422},"property":{"type":"Identifier","start":16423,"end":16430,"name":"_paused"},"computed":false}},"consequent":{"type":"BlockStatement","start":16432,"end":16473,"body":[{"type":"ExpressionStatement","start":16446,"end":16463,"expression":{"type":"CallExpression","start":16446,"end":16462,"callee":{"type":"MemberExpression","start":16446,"end":16460,"object":{"type":"MemberExpression","start":16446,"end":16454,"object":{"type":"ThisExpression","start":16446,"end":16450},"property":{"type":"Identifier","start":16451,"end":16454,"name":"tus"},"computed":false},"property":{"type":"Identifier","start":16455,"end":16460,"name":"start"},"computed":false},"arguments":[]}}]},"alternate":null}]}}},{"type":"MethodDefinition","start":16484,"end":18851,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":16484,"end":16499,"name":"uploadMultipart"},"value":{"type":"FunctionExpression","start":16499,"end":18851,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":16502,"end":18851,"body":[{"type":"VariableDeclaration","start":16512,"end":16556,"declarations":[{"type":"VariableDeclarator","start":16518,"end":16555,"id":{"type":"Identifier","start":16518,"end":16522,"name":"file"},"init":{"type":"CallExpression","start":16525,"end":16555,"callee":{"type":"MemberExpression","start":16525,"end":16544,"object":{"type":"Identifier","start":16525,"end":16527,"name":"fs"},"property":{"type":"Identifier","start":16528,"end":16544,"name":"createReadStream"},"computed":false},"arguments":[{"type":"MemberExpression","start":16545,"end":16554,"object":{"type":"ThisExpression","start":16545,"end":16549},"property":{"type":"Identifier","start":16550,"end":16554,"name":"path"},"computed":false}]}}],"kind":"const"},{"type":"VariableDeclaration","start":16592,"end":16614,"declarations":[{"type":"VariableDeclarator","start":16596,"end":16613,"id":{"type":"Identifier","start":16596,"end":16609,"name":"bytesUploaded"},"init":{"type":"Literal","start":16612,"end":16613,"value":0,"raw":"0"}}],"kind":"let"},{"type":"ExpressionStatement","start":16623,"end":16758,"expression":{"type":"CallExpression","start":16623,"end":16757,"callee":{"type":"MemberExpression","start":16623,"end":16630,"object":{"type":"Identifier","start":16623,"end":16627,"name":"file"},"property":{"type":"Identifier","start":16628,"end":16630,"name":"on"},"computed":false},"arguments":[{"type":"Literal","start":16631,"end":16637,"value":"data","raw":"'data'"},{"type":"ArrowFunctionExpression","start":16639,"end":16756,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":16640,"end":16644,"name":"data"}],"body":{"type":"BlockStatement","start":16649,"end":16756,"body":[{"type":"ExpressionStatement","start":16663,"end":16692,"expression":{"type":"AssignmentExpression","start":16663,"end":16691,"operator":"+=","left":{"type":"Identifier","start":16663,"end":16676,"name":"bytesUploaded"},"right":{"type":"MemberExpression","start":16680,"end":16691,"object":{"type":"Identifier","start":16680,"end":16684,"name":"data"},"property":{"type":"Identifier","start":16685,"end":16691,"name":"length"},"computed":false}}},{"type":"ExpressionStatement","start":16705,"end":16746,"expression":{"type":"CallExpression","start":16705,"end":16745,"callee":{"type":"MemberExpression","start":16705,"end":16730,"object":{"type":"ThisExpression","start":16705,"end":16709},"property":{"type":"Identifier","start":16710,"end":16730,"name":"emitIllusiveProgress"},"computed":false},"arguments":[{"type":"Identifier","start":16731,"end":16744,"name":"bytesUploaded"}]}}]}}]}},{"type":"VariableDeclaration","start":16767,"end":16859,"declarations":[{"type":"VariableDeclarator","start":16773,"end":16858,"id":{"type":"Identifier","start":16773,"end":16783,"name":"httpMethod"},"init":{"type":"ConditionalExpression","start":16786,"end":16858,"test":{"type":"BinaryExpression","start":16786,"end":16841,"left":{"type":"CallExpression","start":16786,"end":16831,"callee":{"type":"MemberExpression","start":16786,"end":16829,"object":{"type":"LogicalExpression","start":16787,"end":16816,"left":{"type":"MemberExpression","start":16787,"end":16810,"object":{"type":"MemberExpression","start":16787,"end":16799,"object":{"type":"ThisExpression","start":16787,"end":16791},"property":{"type":"Identifier","start":16792,"end":16799,"name":"options"},"computed":false},"property":{"type":"Identifier","start":16800,"end":16810,"name":"httpMethod"},"computed":false},"operator":"||","right":{"type":"Literal","start":16814,"end":16816,"value":"","raw":"''"}},"property":{"type":"Identifier","start":16818,"end":16829,"name":"toLowerCase"},"computed":false},"arguments":[]},"operator":"===","right":{"type":"Literal","start":16836,"end":16841,"value":"put","raw":"'put'"}},"consequent":{"type":"Literal","start":16844,"end":16849,"value":"put","raw":"'put'"},"alternate":{"type":"Literal","start":16852,"end":16858,"value":"post","raw":"'post'"}}}],"kind":"const"},{"type":"VariableDeclaration","start":16868,"end":16921,"declarations":[{"type":"VariableDeclarator","start":16874,"end":16920,"id":{"type":"Identifier","start":16874,"end":16881,"name":"headers"},"init":{"type":"CallExpression","start":16884,"end":16920,"callee":{"type":"Identifier","start":16884,"end":16898,"name":"headerSanitize"},"arguments":[{"type":"MemberExpression","start":16899,"end":16919,"object":{"type":"MemberExpression","start":16899,"end":16911,"object":{"type":"ThisExpression","start":16899,"end":16903},"property":{"type":"Identifier","start":16904,"end":16911,"name":"options"},"computed":false},"property":{"type":"Identifier","start":16912,"end":16919,"name":"headers"},"computed":false}]}}],"kind":"const"},{"type":"VariableDeclaration","start":16930,"end":17005,"declarations":[{"type":"VariableDeclarator","start":16936,"end":17004,"id":{"type":"Identifier","start":16936,"end":16946,"name":"reqOptions"},"init":{"type":"ObjectExpression","start":16949,"end":17004,"properties":[{"type":"Property","start":16951,"end":16977,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":16951,"end":16954,"name":"url"},"value":{"type":"MemberExpression","start":16956,"end":16977,"object":{"type":"MemberExpression","start":16956,"end":16968,"object":{"type":"ThisExpression","start":16956,"end":16960},"property":{"type":"Identifier","start":16961,"end":16968,"name":"options"},"computed":false},"property":{"type":"Identifier","start":16969,"end":16977,"name":"endpoint"},"computed":false},"kind":"init"},{"type":"Property","start":16979,"end":16986,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":16979,"end":16986,"name":"headers"},"kind":"init","value":{"type":"Identifier","start":16979,"end":16986,"name":"headers"}},{"type":"Property","start":16988,"end":17002,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":16988,"end":16996,"name":"encoding"},"value":{"type":"Literal","start":16998,"end":17002,"value":null,"raw":"null"},"kind":"init"}]}}],"kind":"const"},{"type":"IfStatement","start":17014,"end":17476,"test":{"type":"MemberExpression","start":17018,"end":17042,"object":{"type":"MemberExpression","start":17018,"end":17030,"object":{"type":"ThisExpression","start":17018,"end":17022},"property":{"type":"Identifier","start":17023,"end":17030,"name":"options"},"computed":false},"property":{"type":"Identifier","start":17031,"end":17042,"name":"useFormData"},"computed":false},"consequent":{"type":"BlockStatement","start":17044,"end":17415,"body":[{"type":"ExpressionStatement","start":17058,"end":17405,"expression":{"type":"AssignmentExpression","start":17058,"end":17404,"operator":"=","left":{"type":"MemberExpression","start":17058,"end":17077,"object":{"type":"Identifier","start":17058,"end":17068,"name":"reqOptions"},"property":{"type":"Identifier","start":17069,"end":17077,"name":"formData"},"computed":false},"right":{"type":"CallExpression","start":17080,"end":17404,"callee":{"type":"MemberExpression","start":17080,"end":17093,"object":{"type":"Identifier","start":17080,"end":17086,"name":"Object"},"property":{"type":"Identifier","start":17087,"end":17093,"name":"assign"},"computed":false},"arguments":[{"type":"ObjectExpression","start":17094,"end":17096,"properties":[]},{"type":"MemberExpression","start":17098,"end":17119,"object":{"type":"MemberExpression","start":17098,"end":17110,"object":{"type":"ThisExpression","start":17098,"end":17102},"property":{"type":"Identifier","start":17103,"end":17110,"name":"options"},"computed":false},"property":{"type":"Identifier","start":17111,"end":17119,"name":"metadata"},"computed":false},{"type":"ObjectExpression","start":17121,"end":17403,"properties":[{"type":"Property","start":17139,"end":17389,"method":false,"shorthand":false,"computed":true,"key":{"type":"MemberExpression","start":17140,"end":17162,"object":{"type":"MemberExpression","start":17140,"end":17152,"object":{"type":"ThisExpression","start":17140,"end":17144},"property":{"type":"Identifier","start":17145,"end":17152,"name":"options"},"computed":false},"property":{"type":"Identifier","start":17153,"end":17162,"name":"fieldname"},"computed":false},"value":{"type":"ObjectExpression","start":17165,"end":17389,"properties":[{"type":"Property","start":17187,"end":17198,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":17187,"end":17192,"name":"value"},"value":{"type":"Identifier","start":17194,"end":17198,"name":"file"},"kind":"init"},{"type":"Property","start":17220,"end":17371,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":17220,"end":17227,"name":"options"},"value":{"type":"ObjectExpression","start":17229,"end":17371,"properties":[{"type":"Property","start":17255,"end":17284,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":17255,"end":17263,"name":"filename"},"value":{"type":"MemberExpression","start":17265,"end":17284,"object":{"type":"ThisExpression","start":17265,"end":17269},"property":{"type":"Identifier","start":17270,"end":17284,"name":"uploadFileName"},"computed":false},"kind":"init"},{"type":"Property","start":17310,"end":17349,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":17310,"end":17321,"name":"contentType"},"value":{"type":"MemberExpression","start":17323,"end":17349,"object":{"type":"MemberExpression","start":17323,"end":17344,"object":{"type":"MemberExpression","start":17323,"end":17335,"object":{"type":"ThisExpression","start":17323,"end":17327},"property":{"type":"Identifier","start":17328,"end":17335,"name":"options"},"computed":false},"property":{"type":"Identifier","start":17336,"end":17344,"name":"metadata"},"computed":false},"property":{"type":"Identifier","start":17345,"end":17349,"name":"type"},"computed":false},"kind":"init"}]},"kind":"init"}]},"kind":"init"}]}]}}}]},"alternate":{"type":"BlockStatement","start":17429,"end":17476,"body":[{"type":"ExpressionStatement","start":17443,"end":17466,"expression":{"type":"AssignmentExpression","start":17443,"end":17465,"operator":"=","left":{"type":"MemberExpression","start":17443,"end":17458,"object":{"type":"Identifier","start":17443,"end":17453,"name":"reqOptions"},"property":{"type":"Identifier","start":17454,"end":17458,"name":"body"},"computed":false},"right":{"type":"Identifier","start":17461,"end":17465,"name":"file"}}}]}},{"type":"ExpressionStatement","start":17485,"end":18845,"expression":{"type":"CallExpression","start":17485,"end":18844,"callee":{"type":"MemberExpression","start":17485,"end":17504,"object":{"type":"Identifier","start":17485,"end":17492,"name":"request"},"property":{"type":"Identifier","start":17493,"end":17503,"name":"httpMethod"},"computed":true},"arguments":[{"type":"Identifier","start":17505,"end":17515,"name":"reqOptions"},{"type":"ArrowFunctionExpression","start":17517,"end":18843,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":17518,"end":17523,"name":"error"},{"type":"Identifier","start":17525,"end":17533,"name":"response"},{"type":"Identifier","start":17535,"end":17539,"name":"body"}],"body":{"type":"BlockStatement","start":17544,"end":18843,"body":[{"type":"IfStatement","start":17558,"end":17710,"test":{"type":"Identifier","start":17562,"end":17567,"name":"error"},"consequent":{"type":"BlockStatement","start":17569,"end":17710,"body":[{"type":"ExpressionStatement","start":17587,"end":17633,"expression":{"type":"CallExpression","start":17587,"end":17632,"callee":{"type":"MemberExpression","start":17587,"end":17599,"object":{"type":"Identifier","start":17587,"end":17593,"name":"logger"},"property":{"type":"Identifier","start":17594,"end":17599,"name":"error"},"computed":false},"arguments":[{"type":"Identifier","start":17600,"end":17605,"name":"error"},{"type":"Literal","start":17607,"end":17631,"value":"upload.multipart.error","raw":"'upload.multipart.error'"}]}},{"type":"ExpressionStatement","start":17650,"end":17672,"expression":{"type":"CallExpression","start":17650,"end":17671,"callee":{"type":"MemberExpression","start":17650,"end":17664,"object":{"type":"ThisExpression","start":17650,"end":17654},"property":{"type":"Identifier","start":17655,"end":17664,"name":"emitError"},"computed":false},"arguments":[{"type":"Identifier","start":17665,"end":17670,"name":"error"}]}},{"type":"ReturnStatement","start":17689,"end":17696,"argument":null}]},"alternate":null},{"type":"VariableDeclaration","start":17723,"end":17756,"declarations":[{"type":"VariableDeclarator","start":17729,"end":17755,"id":{"type":"Identifier","start":17729,"end":17736,"name":"headers"},"init":{"type":"MemberExpression","start":17739,"end":17755,"object":{"type":"Identifier","start":17739,"end":17747,"name":"response"},"property":{"type":"Identifier","start":17748,"end":17755,"name":"headers"},"computed":false}}],"kind":"const"},{"type":"ExpressionStatement","start":17817,"end":17846,"expression":{"type":"UnaryExpression","start":17817,"end":17845,"operator":"delete","prefix":true,"argument":{"type":"MemberExpression","start":17824,"end":17845,"object":{"type":"Identifier","start":17824,"end":17831,"name":"headers"},"property":{"type":"Literal","start":17832,"end":17844,"value":"set-cookie","raw":"'set-cookie'"},"computed":true}}},{"type":"ExpressionStatement","start":17859,"end":17889,"expression":{"type":"UnaryExpression","start":17859,"end":17888,"operator":"delete","prefix":true,"argument":{"type":"MemberExpression","start":17866,"end":17888,"object":{"type":"Identifier","start":17866,"end":17873,"name":"headers"},"property":{"type":"Literal","start":17874,"end":17887,"value":"set-cookie2","raw":"'set-cookie2'"},"computed":true}}},{"type":"VariableDeclaration","start":17902,"end":18102,"declarations":[{"type":"VariableDeclarator","start":17908,"end":18101,"id":{"type":"Identifier","start":17908,"end":17915,"name":"respObj"},"init":{"type":"ObjectExpression","start":17918,"end":18101,"properties":[{"type":"Property","start":17936,"end":17965,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":17936,"end":17948,"name":"responseText"},"value":{"type":"CallExpression","start":17950,"end":17965,"callee":{"type":"MemberExpression","start":17950,"end":17963,"object":{"type":"Identifier","start":17950,"end":17954,"name":"body"},"property":{"type":"Identifier","start":17955,"end":17963,"name":"toString"},"computed":false},"arguments":[]},"kind":"init"},{"type":"Property","start":17983,"end":18010,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":17983,"end":17989,"name":"status"},"value":{"type":"MemberExpression","start":17991,"end":18010,"object":{"type":"Identifier","start":17991,"end":17999,"name":"response"},"property":{"type":"Identifier","start":18000,"end":18010,"name":"statusCode"},"computed":false},"kind":"init"},{"type":"Property","start":18028,"end":18062,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":18028,"end":18038,"name":"statusText"},"value":{"type":"MemberExpression","start":18040,"end":18062,"object":{"type":"Identifier","start":18040,"end":18048,"name":"response"},"property":{"type":"Identifier","start":18049,"end":18062,"name":"statusMessage"},"computed":false},"kind":"init"},{"type":"Property","start":18080,"end":18087,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":18080,"end":18087,"name":"headers"},"kind":"init","value":{"type":"Identifier","start":18080,"end":18087,"name":"headers"}}]}}],"kind":"const"},{"type":"IfStatement","start":18115,"end":18805,"test":{"type":"BinaryExpression","start":18119,"end":18145,"left":{"type":"MemberExpression","start":18119,"end":18138,"object":{"type":"Identifier","start":18119,"end":18127,"name":"response"},"property":{"type":"Identifier","start":18128,"end":18138,"name":"statusCode"},"computed":false},"operator":">=","right":{"type":"Literal","start":18142,"end":18145,"value":400,"raw":"400"}},"consequent":{"type":"BlockStatement","start":18147,"end":18347,"body":[{"type":"ExpressionStatement","start":18165,"end":18257,"expression":{"type":"CallExpression","start":18165,"end":18256,"callee":{"type":"MemberExpression","start":18165,"end":18177,"object":{"type":"Identifier","start":18165,"end":18171,"name":"logger"},"property":{"type":"Identifier","start":18172,"end":18177,"name":"error"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":18178,"end":18229,"expressions":[{"type":"MemberExpression","start":18208,"end":18227,"object":{"type":"Identifier","start":18208,"end":18216,"name":"response"},"property":{"type":"Identifier","start":18217,"end":18227,"name":"statusCode"},"computed":false}],"quasis":[{"type":"TemplateElement","start":18179,"end":18206,"value":{"raw":"upload failed with status: ","cooked":"upload failed with status: "},"tail":false},{"type":"TemplateElement","start":18228,"end":18228,"value":{"raw":"","cooked":""},"tail":true}]},{"type":"Literal","start":18231,"end":18255,"value":"upload.multipart.error","raw":"'upload.multipart.error'"}]}},{"type":"ExpressionStatement","start":18274,"end":18333,"expression":{"type":"CallExpression","start":18274,"end":18332,"callee":{"type":"MemberExpression","start":18274,"end":18288,"object":{"type":"ThisExpression","start":18274,"end":18278},"property":{"type":"Identifier","start":18279,"end":18288,"name":"emitError"},"computed":false},"arguments":[{"type":"NewExpression","start":18289,"end":18322,"callee":{"type":"Identifier","start":18293,"end":18298,"name":"Error"},"arguments":[{"type":"MemberExpression","start":18299,"end":18321,"object":{"type":"Identifier","start":18299,"end":18307,"name":"response"},"property":{"type":"Identifier","start":18308,"end":18321,"name":"statusMessage"},"computed":false}]},{"type":"Identifier","start":18324,"end":18331,"name":"respObj"}]}}]},"alternate":{"type":"IfStatement","start":18365,"end":18805,"test":{"type":"LogicalExpression","start":18369,"end":18443,"left":{"type":"BinaryExpression","start":18369,"end":18404,"left":{"type":"Identifier","start":18369,"end":18382,"name":"bytesUploaded"},"operator":"!==","right":{"type":"MemberExpression","start":18387,"end":18404,"object":{"type":"ThisExpression","start":18387,"end":18391},"property":{"type":"Identifier","start":18392,"end":18404,"name":"bytesWritten"},"computed":false}},"operator":"&&","right":{"type":"BinaryExpression","start":18408,"end":18443,"left":{"type":"Identifier","start":18408,"end":18421,"name":"bytesUploaded"},"operator":"!==","right":{"type":"MemberExpression","start":18426,"end":18443,"object":{"type":"MemberExpression","start":18426,"end":18438,"object":{"type":"ThisExpression","start":18426,"end":18430},"property":{"type":"Identifier","start":18431,"end":18438,"name":"options"},"computed":false},"property":{"type":"Identifier","start":18439,"end":18443,"name":"size"},"computed":false}}},"consequent":{"type":"BlockStatement","start":18445,"end":18709,"body":[{"type":"VariableDeclaration","start":18463,"end":18571,"declarations":[{"type":"VariableDeclarator","start":18469,"end":18570,"id":{"type":"Identifier","start":18469,"end":18475,"name":"errMsg"},"init":{"type":"TemplateLiteral","start":18478,"end":18570,"expressions":[{"type":"Identifier","start":18495,"end":18508,"name":"bytesUploaded"},{"type":"MemberExpression","start":18515,"end":18532,"object":{"type":"ThisExpression","start":18515,"end":18519},"property":{"type":"Identifier","start":18520,"end":18532,"name":"bytesWritten"},"computed":false},{"type":"MemberExpression","start":18549,"end":18568,"object":{"type":"Identifier","start":18549,"end":18557,"name":"response"},"property":{"type":"Identifier","start":18558,"end":18568,"name":"statusCode"},"computed":false}],"quasis":[{"type":"TemplateElement","start":18479,"end":18493,"value":{"raw":"uploaded only ","cooked":"uploaded only "},"tail":false},{"type":"TemplateElement","start":18509,"end":18513,"value":{"raw":" of ","cooked":" of "},"tail":false},{"type":"TemplateElement","start":18533,"end":18547,"value":{"raw":" with status: ","cooked":" with status: "},"tail":false},{"type":"TemplateElement","start":18569,"end":18569,"value":{"raw":"","cooked":""},"tail":true}]}}],"kind":"const"},{"type":"ExpressionStatement","start":18588,"end":18644,"expression":{"type":"CallExpression","start":18588,"end":18643,"callee":{"type":"MemberExpression","start":18588,"end":18600,"object":{"type":"Identifier","start":18588,"end":18594,"name":"logger"},"property":{"type":"Identifier","start":18595,"end":18600,"name":"error"},"computed":false},"arguments":[{"type":"Identifier","start":18601,"end":18607,"name":"errMsg"},{"type":"Literal","start":18609,"end":18642,"value":"upload.multipart.mismatch.error","raw":"'upload.multipart.mismatch.error'"}]}},{"type":"ExpressionStatement","start":18661,"end":18695,"expression":{"type":"CallExpression","start":18661,"end":18694,"callee":{"type":"MemberExpression","start":18661,"end":18675,"object":{"type":"ThisExpression","start":18661,"end":18665},"property":{"type":"Identifier","start":18666,"end":18675,"name":"emitError"},"computed":false},"arguments":[{"type":"NewExpression","start":18676,"end":18693,"callee":{"type":"Identifier","start":18680,"end":18685,"name":"Error"},"arguments":[{"type":"Identifier","start":18686,"end":18692,"name":"errMsg"}]}]}}]},"alternate":{"type":"BlockStatement","start":18727,"end":18805,"body":[{"type":"ExpressionStatement","start":18745,"end":18791,"expression":{"type":"CallExpression","start":18745,"end":18790,"callee":{"type":"MemberExpression","start":18745,"end":18761,"object":{"type":"ThisExpression","start":18745,"end":18749},"property":{"type":"Identifier","start":18750,"end":18761,"name":"emitSuccess"},"computed":false},"arguments":[{"type":"Literal","start":18762,"end":18766,"value":null,"raw":"null"},{"type":"ObjectExpression","start":18768,"end":18789,"properties":[{"type":"Property","start":18770,"end":18787,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":18770,"end":18778,"name":"response"},"value":{"type":"Identifier","start":18780,"end":18787,"name":"respObj"},"kind":"init"}]}]}}]}}},{"type":"ExpressionStatement","start":18818,"end":18833,"expression":{"type":"CallExpression","start":18818,"end":18832,"callee":{"type":"MemberExpression","start":18818,"end":18830,"object":{"type":"ThisExpression","start":18818,"end":18822},"property":{"type":"Identifier","start":18823,"end":18830,"name":"cleanUp"},"computed":false},"arguments":[]}}]}}]}}]}}},{"type":"MethodDefinition","start":18927,"end":19059,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":18927,"end":18944,"name":"uploadS3Multipart"},"value":{"type":"FunctionExpression","start":18944,"end":19059,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":18947,"end":19059,"body":[{"type":"VariableDeclaration","start":18957,"end":19001,"declarations":[{"type":"VariableDeclarator","start":18963,"end":19000,"id":{"type":"Identifier","start":18963,"end":18967,"name":"file"},"init":{"type":"CallExpression","start":18970,"end":19000,"callee":{"type":"MemberExpression","start":18970,"end":18989,"object":{"type":"Identifier","start":18970,"end":18972,"name":"fs"},"property":{"type":"Identifier","start":18973,"end":18989,"name":"createReadStream"},"computed":false},"arguments":[{"type":"MemberExpression","start":18990,"end":18999,"object":{"type":"ThisExpression","start":18990,"end":18994},"property":{"type":"Identifier","start":18995,"end":18999,"name":"path"},"computed":false}]}}],"kind":"const"},{"type":"ReturnStatement","start":19010,"end":19053,"argument":{"type":"CallExpression","start":19017,"end":19052,"callee":{"type":"MemberExpression","start":19017,"end":19046,"object":{"type":"ThisExpression","start":19017,"end":19021},"property":{"type":"Identifier","start":19022,"end":19046,"name":"_uploadS3MultipartStream"},"computed":false},"arguments":[{"type":"Identifier","start":19047,"end":19051,"name":"file"}]}}]}}},{"type":"MethodDefinition","start":19110,"end":20466,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":19110,"end":19134,"name":"_uploadS3MultipartStream"},"value":{"type":"FunctionExpression","start":19134,"end":20466,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":19135,"end":19141,"name":"stream"}],"body":{"type":"BlockStatement","start":19143,"end":20466,"body":[{"type":"IfStatement","start":19153,"end":19308,"test":{"type":"UnaryExpression","start":19157,"end":19173,"operator":"!","prefix":true,"argument":{"type":"MemberExpression","start":19158,"end":19173,"object":{"type":"MemberExpression","start":19158,"end":19170,"object":{"type":"ThisExpression","start":19158,"end":19162},"property":{"type":"Identifier","start":19163,"end":19170,"name":"options"},"computed":false},"property":{"type":"Identifier","start":19171,"end":19173,"name":"s3"},"computed":false}},"consequent":{"type":"BlockStatement","start":19175,"end":19308,"body":[{"type":"ExpressionStatement","start":19189,"end":19278,"expression":{"type":"CallExpression","start":19189,"end":19277,"callee":{"type":"MemberExpression","start":19189,"end":19203,"object":{"type":"ThisExpression","start":19189,"end":19193},"property":{"type":"Identifier","start":19194,"end":19203,"name":"emitError"},"computed":false},"arguments":[{"type":"NewExpression","start":19204,"end":19276,"callee":{"type":"Identifier","start":19208,"end":19213,"name":"Error"},"arguments":[{"type":"Literal","start":19214,"end":19275,"value":"The S3 client is not configured on this companion instance.","raw":"'The S3 client is not configured on this companion instance.'"}]}]}},{"type":"ReturnStatement","start":19291,"end":19298,"argument":null}]},"alternate":null},{"type":"VariableDeclaration","start":19317,"end":19389,"declarations":[{"type":"VariableDeclarator","start":19323,"end":19388,"id":{"type":"Identifier","start":19323,"end":19331,"name":"filename"},"init":{"type":"LogicalExpression","start":19334,"end":19388,"left":{"type":"MemberExpression","start":19334,"end":19360,"object":{"type":"MemberExpression","start":19334,"end":19355,"object":{"type":"MemberExpression","start":19334,"end":19346,"object":{"type":"ThisExpression","start":19334,"end":19338},"property":{"type":"Identifier","start":19339,"end":19346,"name":"options"},"computed":false},"property":{"type":"Identifier","start":19347,"end":19355,"name":"metadata"},"computed":false},"property":{"type":"Identifier","start":19356,"end":19360,"name":"name"},"computed":false},"operator":"||","right":{"type":"CallExpression","start":19364,"end":19388,"callee":{"type":"MemberExpression","start":19364,"end":19377,"object":{"type":"Identifier","start":19364,"end":19368,"name":"path"},"property":{"type":"Identifier","start":19369,"end":19377,"name":"basename"},"computed":false},"arguments":[{"type":"MemberExpression","start":19378,"end":19387,"object":{"type":"ThisExpression","start":19378,"end":19382},"property":{"type":"Identifier","start":19383,"end":19387,"name":"path"},"computed":false}]}}}],"kind":"const"},{"type":"VariableDeclaration","start":19398,"end":19442,"declarations":[{"type":"VariableDeclarator","start":19404,"end":19441,"id":{"type":"ObjectPattern","start":19404,"end":19423,"properties":[{"type":"Property","start":19406,"end":19412,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":19406,"end":19412,"name":"client"},"kind":"init","value":{"type":"Identifier","start":19406,"end":19412,"name":"client"}},{"type":"Property","start":19414,"end":19421,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":19414,"end":19421,"name":"options"},"kind":"init","value":{"type":"Identifier","start":19414,"end":19421,"name":"options"}}]},"init":{"type":"MemberExpression","start":19426,"end":19441,"object":{"type":"MemberExpression","start":19426,"end":19438,"object":{"type":"ThisExpression","start":19426,"end":19430},"property":{"type":"Identifier","start":19431,"end":19438,"name":"options"},"computed":false},"property":{"type":"Identifier","start":19439,"end":19441,"name":"s3"},"computed":false}}],"kind":"const"},{"type":"VariableDeclaration","start":19451,"end":19709,"declarations":[{"type":"VariableDeclarator","start":19457,"end":19708,"id":{"type":"Identifier","start":19457,"end":19463,"name":"upload"},"init":{"type":"CallExpression","start":19466,"end":19708,"callee":{"type":"MemberExpression","start":19466,"end":19479,"object":{"type":"Identifier","start":19466,"end":19472,"name":"client"},"property":{"type":"Identifier","start":19473,"end":19479,"name":"upload"},"computed":false},"arguments":[{"type":"ObjectExpression","start":19480,"end":19707,"properties":[{"type":"Property","start":19494,"end":19516,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":19494,"end":19500,"name":"Bucket"},"value":{"type":"MemberExpression","start":19502,"end":19516,"object":{"type":"Identifier","start":19502,"end":19509,"name":"options"},"property":{"type":"Identifier","start":19510,"end":19516,"name":"bucket"},"computed":false},"kind":"init"},{"type":"Property","start":19530,"end":19588,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":19530,"end":19533,"name":"Key"},"value":{"type":"CallExpression","start":19535,"end":19588,"callee":{"type":"MemberExpression","start":19535,"end":19549,"object":{"type":"Identifier","start":19535,"end":19542,"name":"options"},"property":{"type":"Identifier","start":19543,"end":19549,"name":"getKey"},"computed":false},"arguments":[{"type":"Literal","start":19550,"end":19554,"value":null,"raw":"null"},{"type":"Identifier","start":19556,"end":19564,"name":"filename"},{"type":"MemberExpression","start":19566,"end":19587,"object":{"type":"MemberExpression","start":19566,"end":19578,"object":{"type":"ThisExpression","start":19566,"end":19570},"property":{"type":"Identifier","start":19571,"end":19578,"name":"options"},"computed":false},"property":{"type":"Identifier","start":19579,"end":19587,"name":"metadata"},"computed":false}]},"kind":"init"},{"type":"Property","start":19602,"end":19618,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":19602,"end":19605,"name":"ACL"},"value":{"type":"MemberExpression","start":19607,"end":19618,"object":{"type":"Identifier","start":19607,"end":19614,"name":"options"},"property":{"type":"Identifier","start":19615,"end":19618,"name":"acl"},"computed":false},"kind":"init"},{"type":"Property","start":19632,"end":19671,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":19632,"end":19643,"name":"ContentType"},"value":{"type":"MemberExpression","start":19645,"end":19671,"object":{"type":"MemberExpression","start":19645,"end":19666,"object":{"type":"MemberExpression","start":19645,"end":19657,"object":{"type":"ThisExpression","start":19645,"end":19649},"property":{"type":"Identifier","start":19650,"end":19657,"name":"options"},"computed":false},"property":{"type":"Identifier","start":19658,"end":19666,"name":"metadata"},"computed":false},"property":{"type":"Identifier","start":19667,"end":19671,"name":"type"},"computed":false},"kind":"init"},{"type":"Property","start":19685,"end":19697,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":19685,"end":19689,"name":"Body"},"value":{"type":"Identifier","start":19691,"end":19697,"name":"stream"},"kind":"init"}]}]}}],"kind":"const"},{"type":"ExpressionStatement","start":19718,"end":19741,"expression":{"type":"AssignmentExpression","start":19718,"end":19740,"operator":"=","left":{"type":"MemberExpression","start":19718,"end":19731,"object":{"type":"ThisExpression","start":19718,"end":19722},"property":{"type":"Identifier","start":19723,"end":19731,"name":"s3Upload"},"computed":false},"right":{"type":"Identifier","start":19734,"end":19740,"name":"upload"}}},{"type":"ExpressionStatement","start":19750,"end":19864,"expression":{"type":"CallExpression","start":19750,"end":19863,"callee":{"type":"MemberExpression","start":19750,"end":19759,"object":{"type":"Identifier","start":19750,"end":19756,"name":"upload"},"property":{"type":"Identifier","start":19757,"end":19759,"name":"on"},"computed":false},"arguments":[{"type":"Literal","start":19760,"end":19780,"value":"httpUploadProgress","raw":"'httpUploadProgress'"},{"type":"ArrowFunctionExpression","start":19782,"end":19862,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"ObjectPattern","start":19783,"end":19800,"properties":[{"type":"Property","start":19785,"end":19791,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":19785,"end":19791,"name":"loaded"},"kind":"init","value":{"type":"Identifier","start":19785,"end":19791,"name":"loaded"}},{"type":"Property","start":19793,"end":19798,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":19793,"end":19798,"name":"total"},"kind":"init","value":{"type":"Identifier","start":19793,"end":19798,"name":"total"}}]}],"body":{"type":"BlockStatement","start":19805,"end":19862,"body":[{"type":"ExpressionStatement","start":19819,"end":19852,"expression":{"type":"CallExpression","start":19819,"end":19851,"callee":{"type":"MemberExpression","start":19819,"end":19836,"object":{"type":"ThisExpression","start":19819,"end":19823},"property":{"type":"Identifier","start":19824,"end":19836,"name":"emitProgress"},"computed":false},"arguments":[{"type":"Identifier","start":19837,"end":19843,"name":"loaded"},{"type":"Identifier","start":19845,"end":19850,"name":"total"}]}}]}}]}},{"type":"ExpressionStatement","start":19873,"end":20460,"expression":{"type":"CallExpression","start":19873,"end":20459,"callee":{"type":"MemberExpression","start":19873,"end":19884,"object":{"type":"Identifier","start":19873,"end":19879,"name":"upload"},"property":{"type":"Identifier","start":19880,"end":19884,"name":"send"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":19885,"end":20458,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":19886,"end":19891,"name":"error"},{"type":"Identifier","start":19893,"end":19897,"name":"data"}],"body":{"type":"BlockStatement","start":19902,"end":20458,"body":[{"type":"ExpressionStatement","start":19916,"end":19937,"expression":{"type":"AssignmentExpression","start":19916,"end":19936,"operator":"=","left":{"type":"MemberExpression","start":19916,"end":19929,"object":{"type":"ThisExpression","start":19916,"end":19920},"property":{"type":"Identifier","start":19921,"end":19929,"name":"s3Upload"},"computed":false},"right":{"type":"Literal","start":19932,"end":19936,"value":null,"raw":"null"}}},{"type":"IfStatement","start":19950,"end":20420,"test":{"type":"Identifier","start":19954,"end":19959,"name":"error"},"consequent":{"type":"BlockStatement","start":19961,"end":20015,"body":[{"type":"ExpressionStatement","start":19979,"end":20001,"expression":{"type":"CallExpression","start":19979,"end":20000,"callee":{"type":"MemberExpression","start":19979,"end":19993,"object":{"type":"ThisExpression","start":19979,"end":19983},"property":{"type":"Identifier","start":19984,"end":19993,"name":"emitError"},"computed":false},"arguments":[{"type":"Identifier","start":19994,"end":19999,"name":"error"}]}}]},"alternate":{"type":"BlockStatement","start":20033,"end":20420,"body":[{"type":"VariableDeclaration","start":20051,"end":20108,"declarations":[{"type":"VariableDeclarator","start":20057,"end":20107,"id":{"type":"Identifier","start":20057,"end":20060,"name":"url"},"init":{"type":"ConditionalExpression","start":20063,"end":20107,"test":{"type":"LogicalExpression","start":20063,"end":20084,"left":{"type":"Identifier","start":20063,"end":20067,"name":"data"},"operator":"&&","right":{"type":"MemberExpression","start":20071,"end":20084,"object":{"type":"Identifier","start":20071,"end":20075,"name":"data"},"property":{"type":"Identifier","start":20076,"end":20084,"name":"Location"},"computed":false}},"consequent":{"type":"MemberExpression","start":20087,"end":20100,"object":{"type":"Identifier","start":20087,"end":20091,"name":"data"},"property":{"type":"Identifier","start":20092,"end":20100,"name":"Location"},"computed":false},"alternate":{"type":"Literal","start":20103,"end":20107,"value":null,"raw":"null"}}}],"kind":"const"},{"type":"ExpressionStatement","start":20125,"end":20406,"expression":{"type":"CallExpression","start":20125,"end":20405,"callee":{"type":"MemberExpression","start":20125,"end":20141,"object":{"type":"ThisExpression","start":20125,"end":20129},"property":{"type":"Identifier","start":20130,"end":20141,"name":"emitSuccess"},"computed":false},"arguments":[{"type":"Identifier","start":20142,"end":20145,"name":"url"},{"type":"ObjectExpression","start":20147,"end":20404,"properties":[{"type":"Property","start":20169,"end":20386,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":20169,"end":20177,"name":"response"},"value":{"type":"ObjectExpression","start":20179,"end":20386,"properties":[{"type":"Property","start":20205,"end":20239,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":20205,"end":20217,"name":"responseText"},"value":{"type":"CallExpression","start":20219,"end":20239,"callee":{"type":"MemberExpression","start":20219,"end":20233,"object":{"type":"Identifier","start":20219,"end":20223,"name":"JSON"},"property":{"type":"Identifier","start":20224,"end":20233,"name":"stringify"},"computed":false},"arguments":[{"type":"Identifier","start":20234,"end":20238,"name":"data"}]},"kind":"init"},{"type":"Property","start":20265,"end":20364,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":20265,"end":20272,"name":"headers"},"value":{"type":"ObjectExpression","start":20274,"end":20364,"properties":[{"type":"Property","start":20304,"end":20338,"method":false,"shorthand":false,"computed":false,"key":{"type":"Literal","start":20304,"end":20318,"value":"content-type","raw":"'content-type'"},"value":{"type":"Literal","start":20320,"end":20338,"value":"application/json","raw":"'application/json'"},"kind":"init"}]},"kind":"init"}]},"kind":"init"}]}]}}]}},{"type":"ExpressionStatement","start":20433,"end":20448,"expression":{"type":"CallExpression","start":20433,"end":20447,"callee":{"type":"MemberExpression","start":20433,"end":20445,"object":{"type":"ThisExpression","start":20433,"end":20437},"property":{"type":"Identifier","start":20438,"end":20445,"name":"cleanUp"},"computed":false},"arguments":[]}}]}}]}}]}}}]}},{"type":"ExpressionStatement","start":20469,"end":20509,"expression":{"type":"AssignmentExpression","start":20469,"end":20508,"operator":"=","left":{"type":"MemberExpression","start":20469,"end":20494,"object":{"type":"Identifier","start":20469,"end":20477,"name":"Uploader"},"property":{"type":"Identifier","start":20478,"end":20494,"name":"FILE_NAME_PREFIX"},"computed":false},"right":{"type":"Literal","start":20497,"end":20508,"value":"uppy-file","raw":"'uppy-file'"}}},{"type":"ExpressionStatement","start":20510,"end":20548,"expression":{"type":"AssignmentExpression","start":20510,"end":20547,"operator":"=","left":{"type":"MemberExpression","start":20510,"end":20533,"object":{"type":"Identifier","start":20510,"end":20518,"name":"Uploader"},"property":{"type":"Identifier","start":20519,"end":20533,"name":"STORAGE_PREFIX"},"computed":false},"right":{"type":"Literal","start":20536,"end":20547,"value":"companion","raw":"'companion'"}}},{"type":"ExpressionStatement","start":20549,"end":20575,"expression":{"type":"AssignmentExpression","start":20549,"end":20574,"operator":"=","left":{"type":"MemberExpression","start":20549,"end":20563,"object":{"type":"Identifier","start":20549,"end":20555,"name":"module"},"property":{"type":"Identifier","start":20556,"end":20563,"name":"exports"},"computed":false},"right":{"type":"Identifier","start":20566,"end":20574,"name":"Uploader"}}}],"sourceType":"script"}