{"type":"Program","start":0,"end":1425,"loc":{"start":{"line":1,"column":0},"end":{"line":58,"column":0}},"body":[{"type":"VariableDeclaration","start":0,"end":37,"loc":{"start":{"line":1,"column":0},"end":{"line":1,"column":37}},"declarations":[{"type":"VariableDeclarator","start":6,"end":36,"loc":{"start":{"line":1,"column":6},"end":{"line":1,"column":36}},"id":{"type":"Identifier","start":6,"end":14,"loc":{"start":{"line":1,"column":6},"end":{"line":1,"column":14}},"name":"isObject"},"init":{"type":"CallExpression","start":17,"end":36,"loc":{"start":{"line":1,"column":17},"end":{"line":1,"column":36}},"callee":{"type":"Identifier","start":17,"end":24,"loc":{"start":{"line":1,"column":17},"end":{"line":1,"column":24}},"name":"require"},"arguments":[{"type":"Literal","start":25,"end":35,"loc":{"start":{"line":1,"column":25},"end":{"line":1,"column":35}},"value":"isobject","raw":"'isobject'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":38,"end":73,"loc":{"start":{"line":2,"column":0},"end":{"line":2,"column":35}},"declarations":[{"type":"VariableDeclarator","start":44,"end":72,"loc":{"start":{"line":2,"column":6},"end":{"line":2,"column":34}},"id":{"type":"Identifier","start":44,"end":50,"loc":{"start":{"line":2,"column":6},"end":{"line":2,"column":12}},"name":"logger"},"init":{"type":"CallExpression","start":53,"end":72,"loc":{"start":{"line":2,"column":15},"end":{"line":2,"column":34}},"callee":{"type":"Identifier","start":53,"end":60,"loc":{"start":{"line":2,"column":15},"end":{"line":2,"column":22}},"name":"require"},"arguments":[{"type":"Literal","start":61,"end":71,"loc":{"start":{"line":2,"column":23},"end":{"line":2,"column":33}},"value":"./logger","raw":"'./logger'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":109,"end":496,"loc":{"start":{"line":6,"column":0},"end":{"line":27,"column":2}},"declarations":[{"type":"VariableDeclarator","start":115,"end":495,"loc":{"start":{"line":6,"column":6},"end":{"line":27,"column":1}},"id":{"type":"Identifier","start":115,"end":129,"loc":{"start":{"line":6,"column":6},"end":{"line":6,"column":20}},"name":"forbiddenNames"},"init":{"type":"ArrayExpression","start":132,"end":495,"loc":{"start":{"line":6,"column":23},"end":{"line":27,"column":1}},"elements":[{"type":"Literal","start":138,"end":154,"loc":{"start":{"line":7,"column":4},"end":{"line":7,"column":20}},"value":"accept-charset","raw":"'accept-charset'"},{"type":"Literal","start":160,"end":177,"loc":{"start":{"line":8,"column":4},"end":{"line":8,"column":21}},"value":"accept-encoding","raw":"'accept-encoding'"},{"type":"Literal","start":183,"end":215,"loc":{"start":{"line":9,"column":4},"end":{"line":9,"column":36}},"value":"access-control-request-headers","raw":"'access-control-request-headers'"},{"type":"Literal","start":221,"end":252,"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":35}},"value":"access-control-request-method","raw":"'access-control-request-method'"},{"type":"Literal","start":258,"end":270,"loc":{"start":{"line":11,"column":4},"end":{"line":11,"column":16}},"value":"connection","raw":"'connection'"},{"type":"Literal","start":276,"end":292,"loc":{"start":{"line":12,"column":4},"end":{"line":12,"column":20}},"value":"content-length","raw":"'content-length'"},{"type":"Literal","start":298,"end":306,"loc":{"start":{"line":13,"column":4},"end":{"line":13,"column":12}},"value":"cookie","raw":"'cookie'"},{"type":"Literal","start":312,"end":321,"loc":{"start":{"line":14,"column":4},"end":{"line":14,"column":13}},"value":"cookie2","raw":"'cookie2'"},{"type":"Literal","start":327,"end":333,"loc":{"start":{"line":15,"column":4},"end":{"line":15,"column":10}},"value":"date","raw":"'date'"},{"type":"Literal","start":339,"end":344,"loc":{"start":{"line":16,"column":4},"end":{"line":16,"column":9}},"value":"dnt","raw":"'dnt'"},{"type":"Literal","start":350,"end":358,"loc":{"start":{"line":17,"column":4},"end":{"line":17,"column":12}},"value":"expect","raw":"'expect'"},{"type":"Literal","start":364,"end":370,"loc":{"start":{"line":18,"column":4},"end":{"line":18,"column":10}},"value":"host","raw":"'host'"},{"type":"Literal","start":376,"end":388,"loc":{"start":{"line":19,"column":4},"end":{"line":19,"column":16}},"value":"keep-alive","raw":"'keep-alive'"},{"type":"Literal","start":394,"end":402,"loc":{"start":{"line":20,"column":4},"end":{"line":20,"column":12}},"value":"origin","raw":"'origin'"},{"type":"Literal","start":408,"end":417,"loc":{"start":{"line":21,"column":4},"end":{"line":21,"column":13}},"value":"referer","raw":"'referer'"},{"type":"Literal","start":423,"end":427,"loc":{"start":{"line":22,"column":4},"end":{"line":22,"column":8}},"value":"te","raw":"'te'"},{"type":"Literal","start":433,"end":442,"loc":{"start":{"line":23,"column":4},"end":{"line":23,"column":13}},"value":"trailer","raw":"'trailer'"},{"type":"Literal","start":448,"end":467,"loc":{"start":{"line":24,"column":4},"end":{"line":24,"column":23}},"value":"transfer-encoding","raw":"'transfer-encoding'"},{"type":"Literal","start":473,"end":482,"loc":{"start":{"line":25,"column":4},"end":{"line":25,"column":13}},"value":"upgrade","raw":"'upgrade'"},{"type":"Literal","start":488,"end":493,"loc":{"start":{"line":26,"column":4},"end":{"line":26,"column":9}},"value":"via","raw":"'via'"}]}}],"kind":"const","comments":[{"type":"Block","value":"*\n * Forbidden header names.\n ","start":74,"end":108,"loc":{"start":{"line":3,"column":0},"end":{"line":5,"column":3}}}]},{"type":"VariableDeclaration","start":533,"end":583,"loc":{"start":{"line":31,"column":0},"end":{"line":31,"column":50}},"declarations":[{"type":"VariableDeclarator","start":539,"end":582,"loc":{"start":{"line":31,"column":6},"end":{"line":31,"column":49}},"id":{"type":"Identifier","start":539,"end":553,"loc":{"start":{"line":31,"column":6},"end":{"line":31,"column":20}},"name":"forbiddenRegex"},"init":{"type":"ArrayExpression","start":556,"end":582,"loc":{"start":{"line":31,"column":23},"end":{"line":31,"column":49}},"elements":[{"type":"Literal","start":557,"end":569,"loc":{"start":{"line":31,"column":24},"end":{"line":31,"column":36}},"value":{},"raw":"/^proxy-.*$/","regex":{"pattern":"^proxy-.*$","flags":""}},{"type":"Literal","start":571,"end":581,"loc":{"start":{"line":31,"column":38},"end":{"line":31,"column":48}},"value":{},"raw":"/^sec-.*$/","regex":{"pattern":"^sec-.*$","flags":""}}]}}],"kind":"const","comments":[{"type":"Block","value":"*\n * Forbidden header regexs.\n ","start":497,"end":532,"loc":{"start":{"line":28,"column":0},"end":{"line":30,"column":3}}}]},{"type":"VariableDeclaration","start":750,"end":1100,"loc":{"start":{"line":37,"column":0},"end":{"line":45,"column":2}},"declarations":[{"type":"VariableDeclarator","start":756,"end":1099,"loc":{"start":{"line":37,"column":6},"end":{"line":45,"column":1}},"id":{"type":"Identifier","start":756,"end":773,"loc":{"start":{"line":37,"column":6},"end":{"line":37,"column":23}},"name":"isForbiddenHeader"},"init":{"type":"ArrowFunctionExpression","start":776,"end":1099,"loc":{"start":{"line":37,"column":26},"end":{"line":45,"column":1}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":777,"end":783,"loc":{"start":{"line":37,"column":27},"end":{"line":37,"column":33}},"name":"header"}],"body":{"type":"BlockStatement","start":788,"end":1099,"loc":{"start":{"line":37,"column":38},"end":{"line":45,"column":1}},"body":[{"type":"VariableDeclaration","start":794,"end":835,"loc":{"start":{"line":38,"column":4},"end":{"line":38,"column":45}},"declarations":[{"type":"VariableDeclarator","start":800,"end":834,"loc":{"start":{"line":38,"column":10},"end":{"line":38,"column":44}},"id":{"type":"Identifier","start":800,"end":811,"loc":{"start":{"line":38,"column":10},"end":{"line":38,"column":21}},"name":"headerLower"},"init":{"type":"CallExpression","start":814,"end":834,"loc":{"start":{"line":38,"column":24},"end":{"line":38,"column":44}},"callee":{"type":"MemberExpression","start":814,"end":832,"loc":{"start":{"line":38,"column":24},"end":{"line":38,"column":42}},"object":{"type":"Identifier","start":814,"end":820,"loc":{"start":{"line":38,"column":24},"end":{"line":38,"column":30}},"name":"header"},"property":{"type":"Identifier","start":821,"end":832,"loc":{"start":{"line":38,"column":31},"end":{"line":38,"column":42}},"name":"toLowerCase"},"computed":false},"arguments":[]}}],"kind":"const"},{"type":"VariableDeclaration","start":840,"end":976,"loc":{"start":{"line":39,"column":4},"end":{"line":40,"column":74}},"declarations":[{"type":"VariableDeclarator","start":846,"end":975,"loc":{"start":{"line":39,"column":10},"end":{"line":40,"column":73}},"id":{"type":"Identifier","start":846,"end":855,"loc":{"start":{"line":39,"column":10},"end":{"line":39,"column":19}},"name":"forbidden"},"init":{"type":"LogicalExpression","start":858,"end":975,"loc":{"start":{"line":39,"column":22},"end":{"line":40,"column":73}},"left":{"type":"BinaryExpression","start":858,"end":898,"loc":{"start":{"line":39,"column":22},"end":{"line":39,"column":62}},"left":{"type":"CallExpression","start":858,"end":893,"loc":{"start":{"line":39,"column":22},"end":{"line":39,"column":57}},"callee":{"type":"MemberExpression","start":858,"end":880,"loc":{"start":{"line":39,"column":22},"end":{"line":39,"column":44}},"object":{"type":"Identifier","start":858,"end":872,"loc":{"start":{"line":39,"column":22},"end":{"line":39,"column":36}},"name":"forbiddenNames"},"property":{"type":"Identifier","start":873,"end":880,"loc":{"start":{"line":39,"column":37},"end":{"line":39,"column":44}},"name":"indexOf"},"computed":false},"arguments":[{"type":"Identifier","start":881,"end":892,"loc":{"start":{"line":39,"column":45},"end":{"line":39,"column":56}},"name":"headerLower"}]},"operator":">=","right":{"type":"Literal","start":897,"end":898,"loc":{"start":{"line":39,"column":61},"end":{"line":39,"column":62}},"value":0,"raw":"0"}},"operator":"||","right":{"type":"BinaryExpression","start":910,"end":975,"loc":{"start":{"line":40,"column":8},"end":{"line":40,"column":73}},"left":{"type":"CallExpression","start":910,"end":970,"loc":{"start":{"line":40,"column":8},"end":{"line":40,"column":68}},"callee":{"type":"MemberExpression","start":910,"end":934,"loc":{"start":{"line":40,"column":8},"end":{"line":40,"column":32}},"object":{"type":"Identifier","start":910,"end":924,"loc":{"start":{"line":40,"column":8},"end":{"line":40,"column":22}},"name":"forbiddenRegex"},"property":{"type":"Identifier","start":925,"end":934,"loc":{"start":{"line":40,"column":23},"end":{"line":40,"column":32}},"name":"findIndex"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":935,"end":969,"loc":{"start":{"line":40,"column":33},"end":{"line":40,"column":67}},"id":null,"expression":true,"generator":false,"async":false,"params":[{"type":"Identifier","start":936,"end":941,"loc":{"start":{"line":40,"column":34},"end":{"line":40,"column":39}},"name":"regex"}],"body":{"type":"CallExpression","start":946,"end":969,"loc":{"start":{"line":40,"column":44},"end":{"line":40,"column":67}},"callee":{"type":"MemberExpression","start":946,"end":956,"loc":{"start":{"line":40,"column":44},"end":{"line":40,"column":54}},"object":{"type":"Identifier","start":946,"end":951,"loc":{"start":{"line":40,"column":44},"end":{"line":40,"column":49}},"name":"regex"},"property":{"type":"Identifier","start":952,"end":956,"loc":{"start":{"line":40,"column":50},"end":{"line":40,"column":54}},"name":"test"},"computed":false},"arguments":[{"type":"Identifier","start":957,"end":968,"loc":{"start":{"line":40,"column":55},"end":{"line":40,"column":66}},"name":"headerLower"}]}}]},"operator":">=","right":{"type":"Literal","start":974,"end":975,"loc":{"start":{"line":40,"column":72},"end":{"line":40,"column":73}},"value":0,"raw":"0"}}}}],"kind":"const"},{"type":"IfStatement","start":981,"end":1075,"loc":{"start":{"line":41,"column":4},"end":{"line":43,"column":5}},"test":{"type":"Identifier","start":985,"end":994,"loc":{"start":{"line":41,"column":8},"end":{"line":41,"column":17}},"name":"forbidden"},"consequent":{"type":"BlockStatement","start":996,"end":1075,"loc":{"start":{"line":41,"column":19},"end":{"line":43,"column":5}},"body":[{"type":"ExpressionStatement","start":1006,"end":1069,"loc":{"start":{"line":42,"column":8},"end":{"line":42,"column":71}},"expression":{"type":"CallExpression","start":1006,"end":1068,"loc":{"start":{"line":42,"column":8},"end":{"line":42,"column":70}},"callee":{"type":"MemberExpression","start":1006,"end":1017,"loc":{"start":{"line":42,"column":8},"end":{"line":42,"column":19}},"object":{"type":"Identifier","start":1006,"end":1012,"loc":{"start":{"line":42,"column":8},"end":{"line":42,"column":14}},"name":"logger"},"property":{"type":"Identifier","start":1013,"end":1017,"loc":{"start":{"line":42,"column":15},"end":{"line":42,"column":19}},"name":"warn"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":1018,"end":1047,"loc":{"start":{"line":42,"column":20},"end":{"line":42,"column":49}},"expressions":[{"type":"Identifier","start":1039,"end":1045,"loc":{"start":{"line":42,"column":41},"end":{"line":42,"column":47}},"name":"header"}],"quasis":[{"type":"TemplateElement","start":1019,"end":1037,"loc":{"start":{"line":42,"column":21},"end":{"line":42,"column":39}},"value":{"raw":"Header forbidden: ","cooked":"Header forbidden: "},"tail":false},{"type":"TemplateElement","start":1046,"end":1046,"loc":{"start":{"line":42,"column":48},"end":{"line":42,"column":48}},"value":{"raw":"","cooked":""},"tail":true}]},{"type":"Literal","start":1049,"end":1067,"loc":{"start":{"line":42,"column":51},"end":{"line":42,"column":69}},"value":"header.forbidden","raw":"'header.forbidden'"}]}}]},"alternate":null},{"type":"ReturnStatement","start":1080,"end":1097,"loc":{"start":{"line":44,"column":4},"end":{"line":44,"column":21}},"argument":{"type":"Identifier","start":1087,"end":1096,"loc":{"start":{"line":44,"column":11},"end":{"line":44,"column":20}},"name":"forbidden"}}]}}}],"kind":"const","comments":[{"type":"Block","value":"*\n * Check if the header in parameter is a forbidden header.\n * @param {string} header Header to check\n * @return True if header is forbidden, false otherwise.\n ","start":584,"end":749,"loc":{"start":{"line":32,"column":0},"end":{"line":36,"column":3}}}]},{"type":"ExpressionStatement","start":1101,"end":1424,"loc":{"start":{"line":46,"column":0},"end":{"line":57,"column":2}},"expression":{"type":"AssignmentExpression","start":1101,"end":1423,"loc":{"start":{"line":46,"column":0},"end":{"line":57,"column":1}},"operator":"=","left":{"type":"MemberExpression","start":1101,"end":1115,"loc":{"start":{"line":46,"column":0},"end":{"line":46,"column":14}},"object":{"type":"Identifier","start":1101,"end":1107,"loc":{"start":{"line":46,"column":0},"end":{"line":46,"column":6}},"name":"module"},"property":{"type":"Identifier","start":1108,"end":1115,"loc":{"start":{"line":46,"column":7},"end":{"line":46,"column":14}},"name":"exports"},"computed":false},"right":{"type":"ArrowFunctionExpression","start":1118,"end":1423,"loc":{"start":{"line":46,"column":17},"end":{"line":57,"column":1}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":1119,"end":1126,"loc":{"start":{"line":46,"column":18},"end":{"line":46,"column":25}},"name":"headers"}],"body":{"type":"BlockStatement","start":1131,"end":1423,"loc":{"start":{"line":46,"column":30},"end":{"line":57,"column":1}},"body":[{"type":"IfStatement","start":1137,"end":1187,"loc":{"start":{"line":47,"column":4},"end":{"line":49,"column":5}},"test":{"type":"UnaryExpression","start":1141,"end":1159,"loc":{"start":{"line":47,"column":8},"end":{"line":47,"column":26}},"operator":"!","prefix":true,"argument":{"type":"CallExpression","start":1142,"end":1159,"loc":{"start":{"line":47,"column":9},"end":{"line":47,"column":26}},"callee":{"type":"Identifier","start":1142,"end":1150,"loc":{"start":{"line":47,"column":9},"end":{"line":47,"column":17}},"name":"isObject"},"arguments":[{"type":"Identifier","start":1151,"end":1158,"loc":{"start":{"line":47,"column":18},"end":{"line":47,"column":25}},"name":"headers"}]}},"consequent":{"type":"BlockStatement","start":1161,"end":1187,"loc":{"start":{"line":47,"column":28},"end":{"line":49,"column":5}},"body":[{"type":"ReturnStatement","start":1171,"end":1181,"loc":{"start":{"line":48,"column":8},"end":{"line":48,"column":18}},"argument":{"type":"ObjectExpression","start":1178,"end":1180,"loc":{"start":{"line":48,"column":15},"end":{"line":48,"column":17}},"properties":[]}}]},"alternate":null},{"type":"VariableDeclaration","start":1192,"end":1241,"loc":{"start":{"line":50,"column":4},"end":{"line":50,"column":53}},"declarations":[{"type":"VariableDeclarator","start":1198,"end":1240,"loc":{"start":{"line":50,"column":10},"end":{"line":50,"column":52}},"id":{"type":"Identifier","start":1198,"end":1211,"loc":{"start":{"line":50,"column":10},"end":{"line":50,"column":23}},"name":"headersCloned"},"init":{"type":"CallExpression","start":1214,"end":1240,"loc":{"start":{"line":50,"column":26},"end":{"line":50,"column":52}},"callee":{"type":"MemberExpression","start":1214,"end":1227,"loc":{"start":{"line":50,"column":26},"end":{"line":50,"column":39}},"object":{"type":"Identifier","start":1214,"end":1220,"loc":{"start":{"line":50,"column":26},"end":{"line":50,"column":32}},"name":"Object"},"property":{"type":"Identifier","start":1221,"end":1227,"loc":{"start":{"line":50,"column":33},"end":{"line":50,"column":39}},"name":"assign"},"computed":false},"arguments":[{"type":"ObjectExpression","start":1228,"end":1230,"loc":{"start":{"line":50,"column":40},"end":{"line":50,"column":42}},"properties":[]},{"type":"Identifier","start":1232,"end":1239,"loc":{"start":{"line":50,"column":44},"end":{"line":50,"column":51}},"name":"headers"}]}}],"kind":"const"},{"type":"ExpressionStatement","start":1246,"end":1395,"loc":{"start":{"line":51,"column":4},"end":{"line":55,"column":7}},"expression":{"type":"CallExpression","start":1246,"end":1394,"loc":{"start":{"line":51,"column":4},"end":{"line":55,"column":6}},"callee":{"type":"MemberExpression","start":1246,"end":1280,"loc":{"start":{"line":51,"column":4},"end":{"line":51,"column":38}},"object":{"type":"CallExpression","start":1246,"end":1272,"loc":{"start":{"line":51,"column":4},"end":{"line":51,"column":30}},"callee":{"type":"MemberExpression","start":1246,"end":1257,"loc":{"start":{"line":51,"column":4},"end":{"line":51,"column":15}},"object":{"type":"Identifier","start":1246,"end":1252,"loc":{"start":{"line":51,"column":4},"end":{"line":51,"column":10}},"name":"Object"},"property":{"type":"Identifier","start":1253,"end":1257,"loc":{"start":{"line":51,"column":11},"end":{"line":51,"column":15}},"name":"keys"},"computed":false},"arguments":[{"type":"Identifier","start":1258,"end":1271,"loc":{"start":{"line":51,"column":16},"end":{"line":51,"column":29}},"name":"headersCloned"}]},"property":{"type":"Identifier","start":1273,"end":1280,"loc":{"start":{"line":51,"column":31},"end":{"line":51,"column":38}},"name":"forEach"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":1281,"end":1393,"loc":{"start":{"line":51,"column":39},"end":{"line":55,"column":5}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":1282,"end":1288,"loc":{"start":{"line":51,"column":40},"end":{"line":51,"column":46}},"name":"header"}],"body":{"type":"BlockStatement","start":1293,"end":1393,"loc":{"start":{"line":51,"column":51},"end":{"line":55,"column":5}},"body":[{"type":"IfStatement","start":1303,"end":1387,"loc":{"start":{"line":52,"column":8},"end":{"line":54,"column":9}},"test":{"type":"CallExpression","start":1307,"end":1332,"loc":{"start":{"line":52,"column":12},"end":{"line":52,"column":37}},"callee":{"type":"Identifier","start":1307,"end":1324,"loc":{"start":{"line":52,"column":12},"end":{"line":52,"column":29}},"name":"isForbiddenHeader"},"arguments":[{"type":"Identifier","start":1325,"end":1331,"loc":{"start":{"line":52,"column":30},"end":{"line":52,"column":36}},"name":"header"}]},"consequent":{"type":"BlockStatement","start":1334,"end":1387,"loc":{"start":{"line":52,"column":39},"end":{"line":54,"column":9}},"body":[{"type":"ExpressionStatement","start":1348,"end":1377,"loc":{"start":{"line":53,"column":12},"end":{"line":53,"column":41}},"expression":{"type":"UnaryExpression","start":1348,"end":1376,"loc":{"start":{"line":53,"column":12},"end":{"line":53,"column":40}},"operator":"delete","prefix":true,"argument":{"type":"MemberExpression","start":1355,"end":1376,"loc":{"start":{"line":53,"column":19},"end":{"line":53,"column":40}},"object":{"type":"Identifier","start":1355,"end":1368,"loc":{"start":{"line":53,"column":19},"end":{"line":53,"column":32}},"name":"headersCloned"},"property":{"type":"Identifier","start":1369,"end":1375,"loc":{"start":{"line":53,"column":33},"end":{"line":53,"column":39}},"name":"header"},"computed":true}}}]},"alternate":null}]}}]}},{"type":"ReturnStatement","start":1400,"end":1421,"loc":{"start":{"line":56,"column":4},"end":{"line":56,"column":25}},"argument":{"type":"Identifier","start":1407,"end":1420,"loc":{"start":{"line":56,"column":11},"end":{"line":56,"column":24}},"name":"headersCloned"}}]}}}}],"sourceType":"script"}