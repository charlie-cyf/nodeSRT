{"type":"Program","start":0,"end":1425,"body":[{"type":"VariableDeclaration","start":0,"end":37,"declarations":[{"type":"VariableDeclarator","start":6,"end":36,"id":{"type":"Identifier","start":6,"end":14,"name":"isObject"},"init":{"type":"CallExpression","start":17,"end":36,"callee":{"type":"Identifier","start":17,"end":24,"name":"require"},"arguments":[{"type":"Literal","start":25,"end":35,"value":"isobject","raw":"'isobject'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":38,"end":73,"declarations":[{"type":"VariableDeclarator","start":44,"end":72,"id":{"type":"Identifier","start":44,"end":50,"name":"logger"},"init":{"type":"CallExpression","start":53,"end":72,"callee":{"type":"Identifier","start":53,"end":60,"name":"require"},"arguments":[{"type":"Literal","start":61,"end":71,"value":"./logger","raw":"'./logger'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":109,"end":496,"declarations":[{"type":"VariableDeclarator","start":115,"end":495,"id":{"type":"Identifier","start":115,"end":129,"name":"forbiddenNames"},"init":{"type":"ArrayExpression","start":132,"end":495,"elements":[{"type":"Literal","start":138,"end":154,"value":"accept-charset","raw":"'accept-charset'"},{"type":"Literal","start":160,"end":177,"value":"accept-encoding","raw":"'accept-encoding'"},{"type":"Literal","start":183,"end":215,"value":"access-control-request-headers","raw":"'access-control-request-headers'"},{"type":"Literal","start":221,"end":252,"value":"access-control-request-method","raw":"'access-control-request-method'"},{"type":"Literal","start":258,"end":270,"value":"connection","raw":"'connection'"},{"type":"Literal","start":276,"end":292,"value":"content-length","raw":"'content-length'"},{"type":"Literal","start":298,"end":306,"value":"cookie","raw":"'cookie'"},{"type":"Literal","start":312,"end":321,"value":"cookie2","raw":"'cookie2'"},{"type":"Literal","start":327,"end":333,"value":"date","raw":"'date'"},{"type":"Literal","start":339,"end":344,"value":"dnt","raw":"'dnt'"},{"type":"Literal","start":350,"end":358,"value":"expect","raw":"'expect'"},{"type":"Literal","start":364,"end":370,"value":"host","raw":"'host'"},{"type":"Literal","start":376,"end":388,"value":"keep-alive","raw":"'keep-alive'"},{"type":"Literal","start":394,"end":402,"value":"origin","raw":"'origin'"},{"type":"Literal","start":408,"end":417,"value":"referer","raw":"'referer'"},{"type":"Literal","start":423,"end":427,"value":"te","raw":"'te'"},{"type":"Literal","start":433,"end":442,"value":"trailer","raw":"'trailer'"},{"type":"Literal","start":448,"end":467,"value":"transfer-encoding","raw":"'transfer-encoding'"},{"type":"Literal","start":473,"end":482,"value":"upgrade","raw":"'upgrade'"},{"type":"Literal","start":488,"end":493,"value":"via","raw":"'via'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":533,"end":583,"declarations":[{"type":"VariableDeclarator","start":539,"end":582,"id":{"type":"Identifier","start":539,"end":553,"name":"forbiddenRegex"},"init":{"type":"ArrayExpression","start":556,"end":582,"elements":[{"type":"Literal","start":557,"end":569,"value":{},"raw":"/^proxy-.*$/","regex":{"pattern":"^proxy-.*$","flags":""}},{"type":"Literal","start":571,"end":581,"value":{},"raw":"/^sec-.*$/","regex":{"pattern":"^sec-.*$","flags":""}}]}}],"kind":"const"},{"type":"VariableDeclaration","start":750,"end":1100,"declarations":[{"type":"VariableDeclarator","start":756,"end":1099,"id":{"type":"Identifier","start":756,"end":773,"name":"isForbiddenHeader"},"init":{"type":"ArrowFunctionExpression","start":776,"end":1099,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":777,"end":783,"name":"header"}],"body":{"type":"BlockStatement","start":788,"end":1099,"body":[{"type":"VariableDeclaration","start":794,"end":835,"declarations":[{"type":"VariableDeclarator","start":800,"end":834,"id":{"type":"Identifier","start":800,"end":811,"name":"headerLower"},"init":{"type":"CallExpression","start":814,"end":834,"callee":{"type":"MemberExpression","start":814,"end":832,"object":{"type":"Identifier","start":814,"end":820,"name":"header"},"property":{"type":"Identifier","start":821,"end":832,"name":"toLowerCase"},"computed":false},"arguments":[]}}],"kind":"const"},{"type":"VariableDeclaration","start":840,"end":976,"declarations":[{"type":"VariableDeclarator","start":846,"end":975,"id":{"type":"Identifier","start":846,"end":855,"name":"forbidden"},"init":{"type":"LogicalExpression","start":858,"end":975,"left":{"type":"BinaryExpression","start":858,"end":898,"left":{"type":"CallExpression","start":858,"end":893,"callee":{"type":"MemberExpression","start":858,"end":880,"object":{"type":"Identifier","start":858,"end":872,"name":"forbiddenNames"},"property":{"type":"Identifier","start":873,"end":880,"name":"indexOf"},"computed":false},"arguments":[{"type":"Identifier","start":881,"end":892,"name":"headerLower"}]},"operator":">=","right":{"type":"Literal","start":897,"end":898,"value":0,"raw":"0"}},"operator":"||","right":{"type":"BinaryExpression","start":910,"end":975,"left":{"type":"CallExpression","start":910,"end":970,"callee":{"type":"MemberExpression","start":910,"end":934,"object":{"type":"Identifier","start":910,"end":924,"name":"forbiddenRegex"},"property":{"type":"Identifier","start":925,"end":934,"name":"findIndex"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":935,"end":969,"id":null,"expression":true,"generator":false,"async":false,"params":[{"type":"Identifier","start":936,"end":941,"name":"regex"}],"body":{"type":"CallExpression","start":946,"end":969,"callee":{"type":"MemberExpression","start":946,"end":956,"object":{"type":"Identifier","start":946,"end":951,"name":"regex"},"property":{"type":"Identifier","start":952,"end":956,"name":"test"},"computed":false},"arguments":[{"type":"Identifier","start":957,"end":968,"name":"headerLower"}]}}]},"operator":">=","right":{"type":"Literal","start":974,"end":975,"value":0,"raw":"0"}}}}],"kind":"const"},{"type":"IfStatement","start":981,"end":1075,"test":{"type":"Identifier","start":985,"end":994,"name":"forbidden"},"consequent":{"type":"BlockStatement","start":996,"end":1075,"body":[{"type":"ExpressionStatement","start":1006,"end":1069,"expression":{"type":"CallExpression","start":1006,"end":1068,"callee":{"type":"MemberExpression","start":1006,"end":1017,"object":{"type":"Identifier","start":1006,"end":1012,"name":"logger"},"property":{"type":"Identifier","start":1013,"end":1017,"name":"warn"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":1018,"end":1047,"expressions":[{"type":"Identifier","start":1039,"end":1045,"name":"header"}],"quasis":[{"type":"TemplateElement","start":1019,"end":1037,"value":{"raw":"Header forbidden: ","cooked":"Header forbidden: "},"tail":false},{"type":"TemplateElement","start":1046,"end":1046,"value":{"raw":"","cooked":""},"tail":true}]},{"type":"Literal","start":1049,"end":1067,"value":"header.forbidden","raw":"'header.forbidden'"}]}}]},"alternate":null},{"type":"ReturnStatement","start":1080,"end":1097,"argument":{"type":"Identifier","start":1087,"end":1096,"name":"forbidden"}}]}}}],"kind":"const"},{"type":"ExpressionStatement","start":1101,"end":1424,"expression":{"type":"AssignmentExpression","start":1101,"end":1423,"operator":"=","left":{"type":"MemberExpression","start":1101,"end":1115,"object":{"type":"Identifier","start":1101,"end":1107,"name":"module"},"property":{"type":"Identifier","start":1108,"end":1115,"name":"exports"},"computed":false},"right":{"type":"ArrowFunctionExpression","start":1118,"end":1423,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":1119,"end":1126,"name":"headers"}],"body":{"type":"BlockStatement","start":1131,"end":1423,"body":[{"type":"IfStatement","start":1137,"end":1187,"test":{"type":"UnaryExpression","start":1141,"end":1159,"operator":"!","prefix":true,"argument":{"type":"CallExpression","start":1142,"end":1159,"callee":{"type":"Identifier","start":1142,"end":1150,"name":"isObject"},"arguments":[{"type":"Identifier","start":1151,"end":1158,"name":"headers"}]}},"consequent":{"type":"BlockStatement","start":1161,"end":1187,"body":[{"type":"ReturnStatement","start":1171,"end":1181,"argument":{"type":"ObjectExpression","start":1178,"end":1180,"properties":[]}}]},"alternate":null},{"type":"VariableDeclaration","start":1192,"end":1241,"declarations":[{"type":"VariableDeclarator","start":1198,"end":1240,"id":{"type":"Identifier","start":1198,"end":1211,"name":"headersCloned"},"init":{"type":"CallExpression","start":1214,"end":1240,"callee":{"type":"MemberExpression","start":1214,"end":1227,"object":{"type":"Identifier","start":1214,"end":1220,"name":"Object"},"property":{"type":"Identifier","start":1221,"end":1227,"name":"assign"},"computed":false},"arguments":[{"type":"ObjectExpression","start":1228,"end":1230,"properties":[]},{"type":"Identifier","start":1232,"end":1239,"name":"headers"}]}}],"kind":"const"},{"type":"ExpressionStatement","start":1246,"end":1395,"expression":{"type":"CallExpression","start":1246,"end":1394,"callee":{"type":"MemberExpression","start":1246,"end":1280,"object":{"type":"CallExpression","start":1246,"end":1272,"callee":{"type":"MemberExpression","start":1246,"end":1257,"object":{"type":"Identifier","start":1246,"end":1252,"name":"Object"},"property":{"type":"Identifier","start":1253,"end":1257,"name":"keys"},"computed":false},"arguments":[{"type":"Identifier","start":1258,"end":1271,"name":"headersCloned"}]},"property":{"type":"Identifier","start":1273,"end":1280,"name":"forEach"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":1281,"end":1393,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":1282,"end":1288,"name":"header"}],"body":{"type":"BlockStatement","start":1293,"end":1393,"body":[{"type":"IfStatement","start":1303,"end":1387,"test":{"type":"CallExpression","start":1307,"end":1332,"callee":{"type":"Identifier","start":1307,"end":1324,"name":"isForbiddenHeader"},"arguments":[{"type":"Identifier","start":1325,"end":1331,"name":"header"}]},"consequent":{"type":"BlockStatement","start":1334,"end":1387,"body":[{"type":"ExpressionStatement","start":1348,"end":1377,"expression":{"type":"UnaryExpression","start":1348,"end":1376,"operator":"delete","prefix":true,"argument":{"type":"MemberExpression","start":1355,"end":1376,"object":{"type":"Identifier","start":1355,"end":1368,"name":"headersCloned"},"property":{"type":"Identifier","start":1369,"end":1375,"name":"header"},"computed":true}}}]},"alternate":null}]}}]}},{"type":"ReturnStatement","start":1400,"end":1421,"argument":{"type":"Identifier","start":1407,"end":1420,"name":"headersCloned"}}]}}}}],"sourceType":"script"}