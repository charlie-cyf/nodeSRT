{"type":"Program","start":0,"end":989,"body":[{"type":"VariableDeclaration","start":0,"end":53,"declarations":[{"type":"VariableDeclarator","start":6,"end":52,"id":{"type":"Identifier","start":6,"end":16,"name":"oAuthState"},"init":{"type":"CallExpression","start":19,"end":52,"callee":{"type":"Identifier","start":19,"end":26,"name":"require"},"arguments":[{"type":"Literal","start":27,"end":51,"value":"../helpers/oauth-state","raw":"'../helpers/oauth-state'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":68,"end":97,"declarations":[{"type":"VariableDeclarator","start":74,"end":96,"id":{"type":"Identifier","start":74,"end":78,"name":"atob"},"init":{"type":"CallExpression","start":81,"end":96,"callee":{"type":"Identifier","start":81,"end":88,"name":"require"},"arguments":[{"type":"Literal","start":89,"end":95,"value":"atob","raw":"'atob'"}]}}],"kind":"const"},{"type":"ExpressionStatement","start":201,"end":988,"expression":{"type":"AssignmentExpression","start":201,"end":987,"operator":"=","left":{"type":"MemberExpression","start":201,"end":215,"object":{"type":"Identifier","start":201,"end":207,"name":"module"},"property":{"type":"Identifier","start":208,"end":215,"name":"exports"},"computed":false},"right":{"type":"FunctionExpression","start":218,"end":987,"id":{"type":"Identifier","start":227,"end":234,"name":"connect"},"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":235,"end":238,"name":"req"},{"type":"Identifier","start":240,"end":243,"name":"res"}],"body":{"type":"BlockStatement","start":245,"end":987,"body":[{"type":"VariableDeclaration","start":251,"end":295,"declarations":[{"type":"VariableDeclarator","start":257,"end":294,"id":{"type":"Identifier","start":257,"end":263,"name":"secret"},"init":{"type":"MemberExpression","start":266,"end":294,"object":{"type":"MemberExpression","start":266,"end":287,"object":{"type":"MemberExpression","start":266,"end":279,"object":{"type":"Identifier","start":266,"end":269,"name":"req"},"property":{"type":"Identifier","start":270,"end":279,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":280,"end":287,"name":"options"},"computed":false},"property":{"type":"Identifier","start":288,"end":294,"name":"secret"},"computed":false}}],"kind":"const"},{"type":"VariableDeclaration","start":300,"end":345,"declarations":[{"type":"VariableDeclarator","start":304,"end":344,"id":{"type":"Identifier","start":304,"end":309,"name":"state"},"init":{"type":"CallExpression","start":312,"end":344,"callee":{"type":"MemberExpression","start":312,"end":336,"object":{"type":"Identifier","start":312,"end":322,"name":"oAuthState"},"property":{"type":"Identifier","start":323,"end":336,"name":"generateState"},"computed":false},"arguments":[{"type":"Identifier","start":337,"end":343,"name":"secret"}]}}],"kind":"let"},{"type":"IfStatement","start":350,"end":555,"test":{"type":"MemberExpression","start":354,"end":369,"object":{"type":"MemberExpression","start":354,"end":363,"object":{"type":"Identifier","start":354,"end":357,"name":"req"},"property":{"type":"Identifier","start":358,"end":363,"name":"query"},"computed":false},"property":{"type":"Identifier","start":364,"end":369,"name":"state"},"computed":false},"consequent":{"type":"BlockStatement","start":371,"end":555,"body":[{"type":"VariableDeclaration","start":438,"end":487,"declarations":[{"type":"VariableDeclarator","start":444,"end":486,"id":{"type":"Identifier","start":444,"end":450,"name":"origin"},"init":{"type":"CallExpression","start":453,"end":486,"callee":{"type":"MemberExpression","start":453,"end":463,"object":{"type":"Identifier","start":453,"end":457,"name":"JSON"},"property":{"type":"Identifier","start":458,"end":463,"name":"parse"},"computed":false},"arguments":[{"type":"CallExpression","start":464,"end":485,"callee":{"type":"Identifier","start":464,"end":468,"name":"atob"},"arguments":[{"type":"MemberExpression","start":469,"end":484,"object":{"type":"MemberExpression","start":469,"end":478,"object":{"type":"Identifier","start":469,"end":472,"name":"req"},"property":{"type":"Identifier","start":473,"end":478,"name":"query"},"computed":false},"property":{"type":"Identifier","start":479,"end":484,"name":"state"},"computed":false}]}]}}],"kind":"const"},{"type":"ExpressionStatement","start":496,"end":549,"expression":{"type":"AssignmentExpression","start":496,"end":548,"operator":"=","left":{"type":"Identifier","start":496,"end":501,"name":"state"},"right":{"type":"CallExpression","start":504,"end":548,"callee":{"type":"MemberExpression","start":504,"end":525,"object":{"type":"Identifier","start":504,"end":514,"name":"oAuthState"},"property":{"type":"Identifier","start":515,"end":525,"name":"addToState"},"computed":false},"arguments":[{"type":"Identifier","start":526,"end":531,"name":"state"},{"type":"Identifier","start":533,"end":539,"name":"origin"},{"type":"Identifier","start":541,"end":547,"name":"secret"}]}}}]},"alternate":null},{"type":"IfStatement","start":560,"end":724,"test":{"type":"MemberExpression","start":564,"end":604,"object":{"type":"MemberExpression","start":564,"end":592,"object":{"type":"MemberExpression","start":564,"end":585,"object":{"type":"MemberExpression","start":564,"end":577,"object":{"type":"Identifier","start":564,"end":567,"name":"req"},"property":{"type":"Identifier","start":568,"end":577,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":578,"end":585,"name":"options"},"computed":false},"property":{"type":"Identifier","start":586,"end":592,"name":"server"},"computed":false},"property":{"type":"Identifier","start":593,"end":604,"name":"oauthDomain"},"computed":false},"consequent":{"type":"BlockStatement","start":606,"end":724,"body":[{"type":"ExpressionStatement","start":616,"end":718,"expression":{"type":"AssignmentExpression","start":616,"end":717,"operator":"=","left":{"type":"Identifier","start":616,"end":621,"name":"state"},"right":{"type":"CallExpression","start":624,"end":717,"callee":{"type":"MemberExpression","start":624,"end":645,"object":{"type":"Identifier","start":624,"end":634,"name":"oAuthState"},"property":{"type":"Identifier","start":635,"end":645,"name":"addToState"},"computed":false},"arguments":[{"type":"Identifier","start":646,"end":651,"name":"state"},{"type":"ObjectExpression","start":653,"end":708,"properties":[{"type":"Property","start":655,"end":706,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":655,"end":672,"name":"companionInstance"},"value":{"type":"CallExpression","start":674,"end":706,"callee":{"type":"MemberExpression","start":674,"end":696,"object":{"type":"MemberExpression","start":674,"end":687,"object":{"type":"Identifier","start":674,"end":677,"name":"req"},"property":{"type":"Identifier","start":678,"end":687,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":688,"end":696,"name":"buildURL"},"computed":false},"arguments":[{"type":"Literal","start":697,"end":699,"value":"","raw":"''"},{"type":"Literal","start":701,"end":705,"value":true,"raw":"true"}]},"kind":"init"}]},{"type":"Identifier","start":710,"end":716,"name":"secret"}]}}}]},"alternate":null},{"type":"IfStatement","start":729,"end":871,"test":{"type":"MemberExpression","start":733,"end":760,"object":{"type":"MemberExpression","start":733,"end":746,"object":{"type":"Identifier","start":733,"end":736,"name":"req"},"property":{"type":"Identifier","start":737,"end":746,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":747,"end":760,"name":"clientVersion"},"computed":false},"consequent":{"type":"BlockStatement","start":762,"end":871,"body":[{"type":"ExpressionStatement","start":772,"end":865,"expression":{"type":"AssignmentExpression","start":772,"end":864,"operator":"=","left":{"type":"Identifier","start":772,"end":777,"name":"state"},"right":{"type":"CallExpression","start":780,"end":864,"callee":{"type":"MemberExpression","start":780,"end":801,"object":{"type":"Identifier","start":780,"end":790,"name":"oAuthState"},"property":{"type":"Identifier","start":791,"end":801,"name":"addToState"},"computed":false},"arguments":[{"type":"Identifier","start":802,"end":807,"name":"state"},{"type":"ObjectExpression","start":809,"end":855,"properties":[{"type":"Property","start":811,"end":853,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":811,"end":824,"name":"clientVersion"},"value":{"type":"MemberExpression","start":826,"end":853,"object":{"type":"MemberExpression","start":826,"end":839,"object":{"type":"Identifier","start":826,"end":829,"name":"req"},"property":{"type":"Identifier","start":830,"end":839,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":840,"end":853,"name":"clientVersion"},"computed":false},"kind":"init"}]},{"type":"Identifier","start":857,"end":863,"name":"secret"}]}}}]},"alternate":null},{"type":"ExpressionStatement","start":876,"end":985,"expression":{"type":"CallExpression","start":876,"end":984,"callee":{"type":"MemberExpression","start":876,"end":888,"object":{"type":"Identifier","start":876,"end":879,"name":"res"},"property":{"type":"Identifier","start":880,"end":888,"name":"redirect"},"computed":false},"arguments":[{"type":"CallExpression","start":889,"end":983,"callee":{"type":"MemberExpression","start":889,"end":911,"object":{"type":"MemberExpression","start":889,"end":902,"object":{"type":"Identifier","start":889,"end":892,"name":"req"},"property":{"type":"Identifier","start":893,"end":902,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":903,"end":911,"name":"buildURL"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":912,"end":976,"expressions":[{"type":"MemberExpression","start":924,"end":959,"object":{"type":"MemberExpression","start":924,"end":946,"object":{"type":"MemberExpression","start":924,"end":937,"object":{"type":"Identifier","start":924,"end":927,"name":"req"},"property":{"type":"Identifier","start":928,"end":937,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":938,"end":946,"name":"provider"},"computed":false},"property":{"type":"Identifier","start":947,"end":959,"name":"authProvider"},"computed":false},{"type":"Identifier","start":969,"end":974,"name":"state"}],"quasis":[{"type":"TemplateElement","start":913,"end":922,"value":{"raw":"/connect/","cooked":"/connect/"},"tail":false},{"type":"TemplateElement","start":960,"end":967,"value":{"raw":"?state=","cooked":"?state="},"tail":false},{"type":"TemplateElement","start":975,"end":975,"value":{"raw":"","cooked":""},"tail":true}]},{"type":"Literal","start":978,"end":982,"value":true,"raw":"true"}]}]}}]}}}}],"sourceType":"script"}