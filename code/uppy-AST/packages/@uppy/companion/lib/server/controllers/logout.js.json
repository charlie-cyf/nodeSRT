{"type":"Program","start":0,"end":1260,"body":[{"type":"VariableDeclaration","start":0,"end":47,"declarations":[{"type":"VariableDeclarator","start":6,"end":46,"id":{"type":"Identifier","start":6,"end":18,"name":"tokenService"},"init":{"type":"CallExpression","start":21,"end":46,"callee":{"type":"Identifier","start":21,"end":28,"name":"require"},"arguments":[{"type":"Literal","start":29,"end":45,"value":"../helpers/jwt","raw":"'../helpers/jwt'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":48,"end":105,"declarations":[{"type":"VariableDeclarator","start":54,"end":104,"id":{"type":"ObjectPattern","start":54,"end":73,"properties":[{"type":"Property","start":56,"end":71,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":56,"end":71,"name":"errorToResponse"},"kind":"init","value":{"type":"Identifier","start":56,"end":71,"name":"errorToResponse"}}]},"init":{"type":"CallExpression","start":76,"end":104,"callee":{"type":"Identifier","start":76,"end":83,"name":"require"},"arguments":[{"type":"Literal","start":84,"end":103,"value":"../provider/error","raw":"'../provider/error'"}]}}],"kind":"const"},{"type":"FunctionDeclaration","start":163,"end":1234,"id":{"type":"Identifier","start":172,"end":178,"name":"logout"},"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":179,"end":182,"name":"req"},{"type":"Identifier","start":184,"end":187,"name":"res"},{"type":"Identifier","start":189,"end":193,"name":"next"}],"body":{"type":"BlockStatement","start":195,"end":1234,"body":[{"type":"VariableDeclaration","start":201,"end":369,"declarations":[{"type":"VariableDeclarator","start":207,"end":368,"id":{"type":"Identifier","start":207,"end":219,"name":"cleanSession"},"init":{"type":"ArrowFunctionExpression","start":222,"end":368,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":228,"end":368,"body":[{"type":"IfStatement","start":238,"end":362,"test":{"type":"MemberExpression","start":242,"end":259,"object":{"type":"MemberExpression","start":242,"end":253,"object":{"type":"Identifier","start":242,"end":245,"name":"req"},"property":{"type":"Identifier","start":246,"end":253,"name":"session"},"computed":false},"property":{"type":"Identifier","start":254,"end":259,"name":"grant"},"computed":false},"consequent":{"type":"BlockStatement","start":261,"end":362,"body":[{"type":"ExpressionStatement","start":275,"end":306,"expression":{"type":"AssignmentExpression","start":275,"end":305,"operator":"=","left":{"type":"MemberExpression","start":275,"end":298,"object":{"type":"MemberExpression","start":275,"end":292,"object":{"type":"MemberExpression","start":275,"end":286,"object":{"type":"Identifier","start":275,"end":278,"name":"req"},"property":{"type":"Identifier","start":279,"end":286,"name":"session"},"computed":false},"property":{"type":"Identifier","start":287,"end":292,"name":"grant"},"computed":false},"property":{"type":"Identifier","start":293,"end":298,"name":"state"},"computed":false},"right":{"type":"Literal","start":301,"end":305,"value":null,"raw":"null"}}},{"type":"ExpressionStatement","start":319,"end":352,"expression":{"type":"AssignmentExpression","start":319,"end":351,"operator":"=","left":{"type":"MemberExpression","start":319,"end":344,"object":{"type":"MemberExpression","start":319,"end":336,"object":{"type":"MemberExpression","start":319,"end":330,"object":{"type":"Identifier","start":319,"end":322,"name":"req"},"property":{"type":"Identifier","start":323,"end":330,"name":"session"},"computed":false},"property":{"type":"Identifier","start":331,"end":336,"name":"grant"},"computed":false},"property":{"type":"Identifier","start":337,"end":344,"name":"dynamic"},"computed":false},"right":{"type":"Literal","start":347,"end":351,"value":null,"raw":"null"}}}]},"alternate":null}]}}}],"kind":"const"},{"type":"VariableDeclaration","start":374,"end":419,"declarations":[{"type":"VariableDeclarator","start":380,"end":418,"id":{"type":"Identifier","start":380,"end":392,"name":"providerName"},"init":{"type":"MemberExpression","start":395,"end":418,"object":{"type":"MemberExpression","start":395,"end":405,"object":{"type":"Identifier","start":395,"end":398,"name":"req"},"property":{"type":"Identifier","start":399,"end":405,"name":"params"},"computed":false},"property":{"type":"Identifier","start":406,"end":418,"name":"providerName"},"computed":false}}],"kind":"const"},{"type":"VariableDeclaration","start":424,"end":519,"declarations":[{"type":"VariableDeclarator","start":430,"end":518,"id":{"type":"Identifier","start":430,"end":435,"name":"token"},"init":{"type":"ConditionalExpression","start":438,"end":518,"test":{"type":"MemberExpression","start":438,"end":466,"object":{"type":"MemberExpression","start":438,"end":451,"object":{"type":"Identifier","start":438,"end":441,"name":"req"},"property":{"type":"Identifier","start":442,"end":451,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":452,"end":466,"name":"providerTokens"},"computed":false},"consequent":{"type":"MemberExpression","start":469,"end":511,"object":{"type":"MemberExpression","start":469,"end":497,"object":{"type":"MemberExpression","start":469,"end":482,"object":{"type":"Identifier","start":469,"end":472,"name":"req"},"property":{"type":"Identifier","start":473,"end":482,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":483,"end":497,"name":"providerTokens"},"computed":false},"property":{"type":"Identifier","start":498,"end":510,"name":"providerName"},"computed":true},"alternate":{"type":"Literal","start":514,"end":518,"value":null,"raw":"null"}}}],"kind":"const"},{"type":"IfStatement","start":524,"end":1232,"test":{"type":"Identifier","start":528,"end":533,"name":"token"},"consequent":{"type":"BlockStatement","start":535,"end":1143,"body":[{"type":"ExpressionStatement","start":545,"end":1137,"expression":{"type":"CallExpression","start":545,"end":1136,"callee":{"type":"MemberExpression","start":545,"end":574,"object":{"type":"MemberExpression","start":545,"end":567,"object":{"type":"MemberExpression","start":545,"end":558,"object":{"type":"Identifier","start":545,"end":548,"name":"req"},"property":{"type":"Identifier","start":549,"end":558,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":559,"end":567,"name":"provider"},"computed":false},"property":{"type":"Identifier","start":568,"end":574,"name":"logout"},"computed":false},"arguments":[{"type":"ObjectExpression","start":575,"end":584,"properties":[{"type":"Property","start":577,"end":582,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":577,"end":582,"name":"token"},"kind":"init","value":{"type":"Identifier","start":577,"end":582,"name":"token"}}]},{"type":"ArrowFunctionExpression","start":586,"end":1135,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":587,"end":590,"name":"err"},{"type":"Identifier","start":592,"end":596,"name":"data"}],"body":{"type":"BlockStatement","start":601,"end":1135,"body":[{"type":"IfStatement","start":615,"end":864,"test":{"type":"Identifier","start":619,"end":622,"name":"err"},"consequent":{"type":"BlockStatement","start":624,"end":864,"body":[{"type":"VariableDeclaration","start":642,"end":679,"declarations":[{"type":"VariableDeclarator","start":648,"end":678,"id":{"type":"Identifier","start":648,"end":655,"name":"errResp"},"init":{"type":"CallExpression","start":658,"end":678,"callee":{"type":"Identifier","start":658,"end":673,"name":"errorToResponse"},"arguments":[{"type":"Identifier","start":674,"end":677,"name":"err"}]}}],"kind":"const"},{"type":"IfStatement","start":696,"end":816,"test":{"type":"Identifier","start":700,"end":707,"name":"errResp"},"consequent":{"type":"BlockStatement","start":709,"end":816,"body":[{"type":"ReturnStatement","start":731,"end":798,"argument":{"type":"CallExpression","start":738,"end":797,"callee":{"type":"MemberExpression","start":738,"end":767,"object":{"type":"CallExpression","start":738,"end":762,"callee":{"type":"MemberExpression","start":738,"end":748,"object":{"type":"Identifier","start":738,"end":741,"name":"res"},"property":{"type":"Identifier","start":742,"end":748,"name":"status"},"computed":false},"arguments":[{"type":"MemberExpression","start":749,"end":761,"object":{"type":"Identifier","start":749,"end":756,"name":"errResp"},"property":{"type":"Identifier","start":757,"end":761,"name":"code"},"computed":false}]},"property":{"type":"Identifier","start":763,"end":767,"name":"json"},"computed":false},"arguments":[{"type":"ObjectExpression","start":768,"end":796,"properties":[{"type":"Property","start":770,"end":794,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":770,"end":777,"name":"message"},"value":{"type":"MemberExpression","start":779,"end":794,"object":{"type":"Identifier","start":779,"end":786,"name":"errResp"},"property":{"type":"Identifier","start":787,"end":794,"name":"message"},"computed":false},"kind":"init"}]}]}}]},"alternate":null},{"type":"ReturnStatement","start":833,"end":850,"argument":{"type":"CallExpression","start":840,"end":849,"callee":{"type":"Identifier","start":840,"end":844,"name":"next"},"arguments":[{"type":"Identifier","start":845,"end":848,"name":"err"}]}}]},"alternate":null},{"type":"ExpressionStatement","start":877,"end":927,"expression":{"type":"UnaryExpression","start":877,"end":926,"operator":"delete","prefix":true,"argument":{"type":"MemberExpression","start":884,"end":926,"object":{"type":"MemberExpression","start":884,"end":912,"object":{"type":"MemberExpression","start":884,"end":897,"object":{"type":"Identifier","start":884,"end":887,"name":"req"},"property":{"type":"Identifier","start":888,"end":897,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":898,"end":912,"name":"providerTokens"},"computed":false},"property":{"type":"Identifier","start":913,"end":925,"name":"providerName"},"computed":true}}},{"type":"ExpressionStatement","start":940,"end":1040,"expression":{"type":"CallExpression","start":940,"end":1039,"callee":{"type":"MemberExpression","start":940,"end":970,"object":{"type":"Identifier","start":940,"end":952,"name":"tokenService"},"property":{"type":"Identifier","start":953,"end":970,"name":"removeFromCookies"},"computed":false},"arguments":[{"type":"Identifier","start":971,"end":974,"name":"res"},{"type":"MemberExpression","start":976,"end":997,"object":{"type":"MemberExpression","start":976,"end":989,"object":{"type":"Identifier","start":976,"end":979,"name":"req"},"property":{"type":"Identifier","start":980,"end":989,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":990,"end":997,"name":"options"},"computed":false},{"type":"MemberExpression","start":999,"end":1038,"object":{"type":"MemberExpression","start":999,"end":1021,"object":{"type":"MemberExpression","start":999,"end":1012,"object":{"type":"Identifier","start":999,"end":1002,"name":"req"},"property":{"type":"Identifier","start":1003,"end":1012,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":1013,"end":1021,"name":"provider"},"computed":false},"property":{"type":"Identifier","start":1022,"end":1038,"name":"authProviderName"},"computed":false}]}},{"type":"ExpressionStatement","start":1053,"end":1068,"expression":{"type":"CallExpression","start":1053,"end":1067,"callee":{"type":"Identifier","start":1053,"end":1065,"name":"cleanSession"},"arguments":[]}},{"type":"ExpressionStatement","start":1081,"end":1125,"expression":{"type":"CallExpression","start":1081,"end":1124,"callee":{"type":"MemberExpression","start":1081,"end":1089,"object":{"type":"Identifier","start":1081,"end":1084,"name":"res"},"property":{"type":"Identifier","start":1085,"end":1089,"name":"json"},"computed":false},"arguments":[{"type":"CallExpression","start":1090,"end":1123,"callee":{"type":"MemberExpression","start":1090,"end":1103,"object":{"type":"Identifier","start":1090,"end":1096,"name":"Object"},"property":{"type":"Identifier","start":1097,"end":1103,"name":"assign"},"computed":false},"arguments":[{"type":"ObjectExpression","start":1104,"end":1116,"properties":[{"type":"Property","start":1106,"end":1114,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1106,"end":1108,"name":"ok"},"value":{"type":"Literal","start":1110,"end":1114,"value":true,"raw":"true"},"kind":"init"}]},{"type":"Identifier","start":1118,"end":1122,"name":"data"}]}]}}]}}]}}]},"alternate":{"type":"BlockStatement","start":1153,"end":1232,"body":[{"type":"ExpressionStatement","start":1163,"end":1178,"expression":{"type":"CallExpression","start":1163,"end":1177,"callee":{"type":"Identifier","start":1163,"end":1175,"name":"cleanSession"},"arguments":[]}},{"type":"ExpressionStatement","start":1187,"end":1226,"expression":{"type":"CallExpression","start":1187,"end":1225,"callee":{"type":"MemberExpression","start":1187,"end":1195,"object":{"type":"Identifier","start":1187,"end":1190,"name":"res"},"property":{"type":"Identifier","start":1191,"end":1195,"name":"json"},"computed":false},"arguments":[{"type":"ObjectExpression","start":1196,"end":1224,"properties":[{"type":"Property","start":1198,"end":1206,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1198,"end":1200,"name":"ok"},"value":{"type":"Literal","start":1202,"end":1206,"value":true,"raw":"true"},"kind":"init"},{"type":"Property","start":1208,"end":1222,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1208,"end":1215,"name":"revoked"},"value":{"type":"Literal","start":1217,"end":1222,"value":false,"raw":"false"},"kind":"init"}]}]}}]}}]}},{"type":"ExpressionStatement","start":1235,"end":1259,"expression":{"type":"AssignmentExpression","start":1235,"end":1258,"operator":"=","left":{"type":"MemberExpression","start":1235,"end":1249,"object":{"type":"Identifier","start":1235,"end":1241,"name":"module"},"property":{"type":"Identifier","start":1242,"end":1249,"name":"exports"},"computed":false},"right":{"type":"Identifier","start":1252,"end":1258,"name":"logout"}}}],"sourceType":"script"}