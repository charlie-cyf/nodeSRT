{"type":"Program","start":0,"end":1920,"body":[{"type":"VariableDeclaration","start":0,"end":40,"declarations":[{"type":"VariableDeclarator","start":6,"end":39,"id":{"type":"Identifier","start":6,"end":14,"name":"Uploader"},"init":{"type":"CallExpression","start":17,"end":39,"callee":{"type":"Identifier","start":17,"end":24,"name":"require"},"arguments":[{"type":"Literal","start":25,"end":38,"value":"../Uploader","raw":"'../Uploader'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":41,"end":77,"declarations":[{"type":"VariableDeclarator","start":47,"end":76,"id":{"type":"Identifier","start":47,"end":53,"name":"logger"},"init":{"type":"CallExpression","start":56,"end":76,"callee":{"type":"Identifier","start":56,"end":63,"name":"require"},"arguments":[{"type":"Literal","start":64,"end":75,"value":"../logger","raw":"'../logger'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":78,"end":135,"declarations":[{"type":"VariableDeclarator","start":84,"end":134,"id":{"type":"ObjectPattern","start":84,"end":103,"properties":[{"type":"Property","start":86,"end":101,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":86,"end":101,"name":"errorToResponse"},"kind":"init","value":{"type":"Identifier","start":86,"end":101,"name":"errorToResponse"}}]},"init":{"type":"CallExpression","start":106,"end":134,"callee":{"type":"Identifier","start":106,"end":113,"name":"require"},"arguments":[{"type":"Literal","start":114,"end":133,"value":"../provider/error","raw":"'../provider/error'"}]}}],"kind":"const"},{"type":"FunctionDeclaration","start":136,"end":1897,"id":{"type":"Identifier","start":145,"end":148,"name":"get"},"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":149,"end":152,"name":"req"},{"type":"Identifier","start":154,"end":157,"name":"res"},{"type":"Identifier","start":159,"end":163,"name":"next"}],"body":{"type":"BlockStatement","start":165,"end":1897,"body":[{"type":"VariableDeclaration","start":171,"end":216,"declarations":[{"type":"VariableDeclarator","start":177,"end":215,"id":{"type":"Identifier","start":177,"end":189,"name":"providerName"},"init":{"type":"MemberExpression","start":192,"end":215,"object":{"type":"MemberExpression","start":192,"end":202,"object":{"type":"Identifier","start":192,"end":195,"name":"req"},"property":{"type":"Identifier","start":196,"end":202,"name":"params"},"computed":false},"property":{"type":"Identifier","start":203,"end":215,"name":"providerName"},"computed":false}}],"kind":"const"},{"type":"VariableDeclaration","start":221,"end":246,"declarations":[{"type":"VariableDeclarator","start":227,"end":245,"id":{"type":"Identifier","start":227,"end":229,"name":"id"},"init":{"type":"MemberExpression","start":232,"end":245,"object":{"type":"MemberExpression","start":232,"end":242,"object":{"type":"Identifier","start":232,"end":235,"name":"req"},"property":{"type":"Identifier","start":236,"end":242,"name":"params"},"computed":false},"property":{"type":"Identifier","start":243,"end":245,"name":"id"},"computed":false}}],"kind":"const"},{"type":"VariableDeclaration","start":251,"end":308,"declarations":[{"type":"VariableDeclarator","start":257,"end":307,"id":{"type":"Identifier","start":257,"end":262,"name":"token"},"init":{"type":"MemberExpression","start":265,"end":307,"object":{"type":"MemberExpression","start":265,"end":293,"object":{"type":"MemberExpression","start":265,"end":278,"object":{"type":"Identifier","start":265,"end":268,"name":"req"},"property":{"type":"Identifier","start":269,"end":278,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":279,"end":293,"name":"providerTokens"},"computed":false},"property":{"type":"Identifier","start":294,"end":306,"name":"providerName"},"computed":true}}],"kind":"const"},{"type":"VariableDeclaration","start":313,"end":353,"declarations":[{"type":"VariableDeclarator","start":319,"end":352,"id":{"type":"Identifier","start":319,"end":327,"name":"provider"},"init":{"type":"MemberExpression","start":330,"end":352,"object":{"type":"MemberExpression","start":330,"end":343,"object":{"type":"Identifier","start":330,"end":333,"name":"req"},"property":{"type":"Identifier","start":334,"end":343,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":344,"end":352,"name":"provider"},"computed":false}}],"kind":"const"},{"type":"ExpressionStatement","start":401,"end":1895,"expression":{"type":"CallExpression","start":401,"end":1894,"callee":{"type":"MemberExpression","start":401,"end":414,"object":{"type":"Identifier","start":401,"end":409,"name":"provider"},"property":{"type":"Identifier","start":410,"end":414,"name":"size"},"computed":false},"arguments":[{"type":"ObjectExpression","start":415,"end":446,"properties":[{"type":"Property","start":417,"end":419,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":417,"end":419,"name":"id"},"kind":"init","value":{"type":"Identifier","start":417,"end":419,"name":"id"}},{"type":"Property","start":421,"end":426,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":421,"end":426,"name":"token"},"kind":"init","value":{"type":"Identifier","start":421,"end":426,"name":"token"}},{"type":"Property","start":428,"end":444,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":428,"end":433,"name":"query"},"value":{"type":"MemberExpression","start":435,"end":444,"object":{"type":"Identifier","start":435,"end":438,"name":"req"},"property":{"type":"Identifier","start":439,"end":444,"name":"query"},"computed":false},"kind":"init"}]},{"type":"ArrowFunctionExpression","start":448,"end":1893,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":449,"end":452,"name":"err"},{"type":"Identifier","start":454,"end":458,"name":"size"}],"body":{"type":"BlockStatement","start":463,"end":1893,"body":[{"type":"IfStatement","start":473,"end":698,"test":{"type":"Identifier","start":477,"end":480,"name":"err"},"consequent":{"type":"BlockStatement","start":482,"end":698,"body":[{"type":"VariableDeclaration","start":496,"end":533,"declarations":[{"type":"VariableDeclarator","start":502,"end":532,"id":{"type":"Identifier","start":502,"end":509,"name":"errResp"},"init":{"type":"CallExpression","start":512,"end":532,"callee":{"type":"Identifier","start":512,"end":527,"name":"errorToResponse"},"arguments":[{"type":"Identifier","start":528,"end":531,"name":"err"}]}}],"kind":"const"},{"type":"IfStatement","start":546,"end":658,"test":{"type":"Identifier","start":550,"end":557,"name":"errResp"},"consequent":{"type":"BlockStatement","start":559,"end":658,"body":[{"type":"ReturnStatement","start":577,"end":644,"argument":{"type":"CallExpression","start":584,"end":643,"callee":{"type":"MemberExpression","start":584,"end":613,"object":{"type":"CallExpression","start":584,"end":608,"callee":{"type":"MemberExpression","start":584,"end":594,"object":{"type":"Identifier","start":584,"end":587,"name":"res"},"property":{"type":"Identifier","start":588,"end":594,"name":"status"},"computed":false},"arguments":[{"type":"MemberExpression","start":595,"end":607,"object":{"type":"Identifier","start":595,"end":602,"name":"errResp"},"property":{"type":"Identifier","start":603,"end":607,"name":"code"},"computed":false}]},"property":{"type":"Identifier","start":609,"end":613,"name":"json"},"computed":false},"arguments":[{"type":"ObjectExpression","start":614,"end":642,"properties":[{"type":"Property","start":616,"end":640,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":616,"end":623,"name":"message"},"value":{"type":"MemberExpression","start":625,"end":640,"object":{"type":"Identifier","start":625,"end":632,"name":"errResp"},"property":{"type":"Identifier","start":633,"end":640,"name":"message"},"computed":false},"kind":"init"}]}]}}]},"alternate":null},{"type":"ReturnStatement","start":671,"end":688,"argument":{"type":"CallExpression","start":678,"end":687,"callee":{"type":"Identifier","start":678,"end":682,"name":"next"},"arguments":[{"type":"Identifier","start":683,"end":686,"name":"err"}]}}]},"alternate":null},{"type":"IfStatement","start":707,"end":915,"test":{"type":"UnaryExpression","start":711,"end":716,"operator":"!","prefix":true,"argument":{"type":"Identifier","start":712,"end":716,"name":"size"}},"consequent":{"type":"BlockStatement","start":718,"end":915,"body":[{"type":"ExpressionStatement","start":732,"end":818,"expression":{"type":"CallExpression","start":732,"end":817,"callee":{"type":"MemberExpression","start":732,"end":744,"object":{"type":"Identifier","start":732,"end":738,"name":"logger"},"property":{"type":"Identifier","start":739,"end":744,"name":"error"},"computed":false},"arguments":[{"type":"Literal","start":745,"end":776,"value":"unable to determine file size","raw":"'unable to determine file size'"},{"type":"Literal","start":778,"end":808,"value":"controller.get.provider.size","raw":"'controller.get.provider.size'"},{"type":"MemberExpression","start":810,"end":816,"object":{"type":"Identifier","start":810,"end":813,"name":"req"},"property":{"type":"Identifier","start":814,"end":816,"name":"id"},"computed":false}]}},{"type":"ReturnStatement","start":831,"end":905,"argument":{"type":"CallExpression","start":838,"end":904,"callee":{"type":"MemberExpression","start":838,"end":858,"object":{"type":"CallExpression","start":838,"end":853,"callee":{"type":"MemberExpression","start":838,"end":848,"object":{"type":"Identifier","start":838,"end":841,"name":"res"},"property":{"type":"Identifier","start":842,"end":848,"name":"status"},"computed":false},"arguments":[{"type":"Literal","start":849,"end":852,"value":400,"raw":"400"}]},"property":{"type":"Identifier","start":854,"end":858,"name":"json"},"computed":false},"arguments":[{"type":"ObjectExpression","start":859,"end":903,"properties":[{"type":"Property","start":861,"end":901,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":861,"end":868,"name":"message"},"value":{"type":"Literal","start":870,"end":901,"value":"unable to determine file size","raw":"'unable to determine file size'"},"kind":"init"}]}]}}]},"alternate":null},{"type":"ExpressionStatement","start":924,"end":978,"expression":{"type":"CallExpression","start":924,"end":977,"callee":{"type":"MemberExpression","start":924,"end":936,"object":{"type":"Identifier","start":924,"end":930,"name":"logger"},"property":{"type":"Identifier","start":931,"end":936,"name":"debug"},"computed":false},"arguments":[{"type":"Literal","start":937,"end":962,"value":"Instantiating uploader.","raw":"'Instantiating uploader.'"},{"type":"Literal","start":964,"end":968,"value":null,"raw":"null"},{"type":"MemberExpression","start":970,"end":976,"object":{"type":"Identifier","start":970,"end":973,"name":"req"},"property":{"type":"Identifier","start":974,"end":976,"name":"id"},"computed":false}]}},{"type":"VariableDeclaration","start":987,"end":1051,"declarations":[{"type":"VariableDeclarator","start":993,"end":1050,"id":{"type":"Identifier","start":993,"end":1001,"name":"uploader"},"init":{"type":"NewExpression","start":1004,"end":1050,"callee":{"type":"Identifier","start":1008,"end":1016,"name":"Uploader"},"arguments":[{"type":"CallExpression","start":1017,"end":1049,"callee":{"type":"MemberExpression","start":1017,"end":1038,"object":{"type":"Identifier","start":1017,"end":1025,"name":"Uploader"},"property":{"type":"Identifier","start":1026,"end":1038,"name":"reqToOptions"},"computed":false},"arguments":[{"type":"Identifier","start":1039,"end":1042,"name":"req"},{"type":"Identifier","start":1044,"end":1048,"name":"size"}]}]}}],"kind":"const"},{"type":"IfStatement","start":1060,"end":1230,"test":{"type":"CallExpression","start":1064,"end":1083,"callee":{"type":"MemberExpression","start":1064,"end":1081,"object":{"type":"Identifier","start":1064,"end":1072,"name":"uploader"},"property":{"type":"Identifier","start":1073,"end":1081,"name":"hasError"},"computed":false},"arguments":[]},"consequent":{"type":"BlockStatement","start":1085,"end":1230,"body":[{"type":"VariableDeclaration","start":1099,"end":1139,"declarations":[{"type":"VariableDeclarator","start":1105,"end":1138,"id":{"type":"Identifier","start":1105,"end":1113,"name":"response"},"init":{"type":"CallExpression","start":1116,"end":1138,"callee":{"type":"MemberExpression","start":1116,"end":1136,"object":{"type":"Identifier","start":1116,"end":1124,"name":"uploader"},"property":{"type":"Identifier","start":1125,"end":1136,"name":"getResponse"},"computed":false},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","start":1152,"end":1200,"expression":{"type":"CallExpression","start":1152,"end":1199,"callee":{"type":"MemberExpression","start":1152,"end":1184,"object":{"type":"CallExpression","start":1152,"end":1179,"callee":{"type":"MemberExpression","start":1152,"end":1162,"object":{"type":"Identifier","start":1152,"end":1155,"name":"res"},"property":{"type":"Identifier","start":1156,"end":1162,"name":"status"},"computed":false},"arguments":[{"type":"MemberExpression","start":1163,"end":1178,"object":{"type":"Identifier","start":1163,"end":1171,"name":"response"},"property":{"type":"Identifier","start":1172,"end":1178,"name":"status"},"computed":false}]},"property":{"type":"Identifier","start":1180,"end":1184,"name":"json"},"computed":false},"arguments":[{"type":"MemberExpression","start":1185,"end":1198,"object":{"type":"Identifier","start":1185,"end":1193,"name":"response"},"property":{"type":"Identifier","start":1194,"end":1198,"name":"body"},"computed":false}]}},{"type":"ReturnStatement","start":1213,"end":1220,"argument":null}]},"alternate":null},{"type":"ExpressionStatement","start":1402,"end":1496,"expression":{"type":"CallExpression","start":1402,"end":1495,"callee":{"type":"MemberExpression","start":1402,"end":1414,"object":{"type":"Identifier","start":1402,"end":1408,"name":"logger"},"property":{"type":"Identifier","start":1409,"end":1414,"name":"debug"},"computed":false},"arguments":[{"type":"Literal","start":1415,"end":1480,"value":"Waiting for socket connection before beginning remote download.","raw":"'Waiting for socket connection before beginning remote download.'"},{"type":"Literal","start":1482,"end":1486,"value":null,"raw":"null"},{"type":"MemberExpression","start":1488,"end":1494,"object":{"type":"Identifier","start":1488,"end":1491,"name":"req"},"property":{"type":"Identifier","start":1492,"end":1494,"name":"id"},"computed":false}]}},{"type":"ExpressionStatement","start":1541,"end":1781,"expression":{"type":"CallExpression","start":1541,"end":1780,"callee":{"type":"MemberExpression","start":1541,"end":1563,"object":{"type":"Identifier","start":1541,"end":1549,"name":"uploader"},"property":{"type":"Identifier","start":1550,"end":1563,"name":"onSocketReady"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":1564,"end":1779,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":1570,"end":1779,"body":[{"type":"ExpressionStatement","start":1584,"end":1668,"expression":{"type":"CallExpression","start":1584,"end":1667,"callee":{"type":"MemberExpression","start":1584,"end":1596,"object":{"type":"Identifier","start":1584,"end":1590,"name":"logger"},"property":{"type":"Identifier","start":1591,"end":1596,"name":"debug"},"computed":false},"arguments":[{"type":"Literal","start":1597,"end":1652,"value":"Socket connection received. Starting remote download.","raw":"'Socket connection received. Starting remote download.'"},{"type":"Literal","start":1654,"end":1658,"value":null,"raw":"null"},{"type":"MemberExpression","start":1660,"end":1666,"object":{"type":"Identifier","start":1660,"end":1663,"name":"req"},"property":{"type":"Identifier","start":1664,"end":1666,"name":"id"},"computed":false}]}},{"type":"ExpressionStatement","start":1681,"end":1769,"expression":{"type":"CallExpression","start":1681,"end":1768,"callee":{"type":"MemberExpression","start":1681,"end":1698,"object":{"type":"Identifier","start":1681,"end":1689,"name":"provider"},"property":{"type":"Identifier","start":1690,"end":1698,"name":"download"},"computed":false},"arguments":[{"type":"ObjectExpression","start":1699,"end":1730,"properties":[{"type":"Property","start":1701,"end":1703,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":1701,"end":1703,"name":"id"},"kind":"init","value":{"type":"Identifier","start":1701,"end":1703,"name":"id"}},{"type":"Property","start":1705,"end":1710,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":1705,"end":1710,"name":"token"},"kind":"init","value":{"type":"Identifier","start":1705,"end":1710,"name":"token"}},{"type":"Property","start":1712,"end":1728,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1712,"end":1717,"name":"query"},"value":{"type":"MemberExpression","start":1719,"end":1728,"object":{"type":"Identifier","start":1719,"end":1722,"name":"req"},"property":{"type":"Identifier","start":1723,"end":1728,"name":"query"},"computed":false},"kind":"init"}]},{"type":"CallExpression","start":1732,"end":1767,"callee":{"type":"MemberExpression","start":1732,"end":1757,"object":{"type":"MemberExpression","start":1732,"end":1752,"object":{"type":"Identifier","start":1732,"end":1740,"name":"uploader"},"property":{"type":"Identifier","start":1741,"end":1752,"name":"handleChunk"},"computed":false},"property":{"type":"Identifier","start":1753,"end":1757,"name":"bind"},"computed":false},"arguments":[{"type":"Identifier","start":1758,"end":1766,"name":"uploader"}]}]}}]}}]}},{"type":"VariableDeclaration","start":1790,"end":1830,"declarations":[{"type":"VariableDeclarator","start":1796,"end":1829,"id":{"type":"Identifier","start":1796,"end":1804,"name":"response"},"init":{"type":"CallExpression","start":1807,"end":1829,"callee":{"type":"MemberExpression","start":1807,"end":1827,"object":{"type":"Identifier","start":1807,"end":1815,"name":"uploader"},"property":{"type":"Identifier","start":1816,"end":1827,"name":"getResponse"},"computed":false},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","start":1839,"end":1887,"expression":{"type":"CallExpression","start":1839,"end":1886,"callee":{"type":"MemberExpression","start":1839,"end":1871,"object":{"type":"CallExpression","start":1839,"end":1866,"callee":{"type":"MemberExpression","start":1839,"end":1849,"object":{"type":"Identifier","start":1839,"end":1842,"name":"res"},"property":{"type":"Identifier","start":1843,"end":1849,"name":"status"},"computed":false},"arguments":[{"type":"MemberExpression","start":1850,"end":1865,"object":{"type":"Identifier","start":1850,"end":1858,"name":"response"},"property":{"type":"Identifier","start":1859,"end":1865,"name":"status"},"computed":false}]},"property":{"type":"Identifier","start":1867,"end":1871,"name":"json"},"computed":false},"arguments":[{"type":"MemberExpression","start":1872,"end":1885,"object":{"type":"Identifier","start":1872,"end":1880,"name":"response"},"property":{"type":"Identifier","start":1881,"end":1885,"name":"body"},"computed":false}]}}]}}]}}]}},{"type":"ExpressionStatement","start":1898,"end":1919,"expression":{"type":"AssignmentExpression","start":1898,"end":1918,"operator":"=","left":{"type":"MemberExpression","start":1898,"end":1912,"object":{"type":"Identifier","start":1898,"end":1904,"name":"module"},"property":{"type":"Identifier","start":1905,"end":1912,"name":"exports"},"computed":false},"right":{"type":"Identifier","start":1915,"end":1918,"name":"get"}}}],"sourceType":"script"}