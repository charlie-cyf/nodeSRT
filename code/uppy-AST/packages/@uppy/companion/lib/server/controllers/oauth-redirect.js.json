{"type":"Program","start":0,"end":1038,"body":[{"type":"VariableDeclaration","start":0,"end":34,"declarations":[{"type":"VariableDeclarator","start":6,"end":33,"id":{"type":"Identifier","start":6,"end":8,"name":"qs"},"init":{"type":"CallExpression","start":11,"end":33,"callee":{"type":"Identifier","start":11,"end":18,"name":"require"},"arguments":[{"type":"Literal","start":19,"end":32,"value":"querystring","raw":"'querystring'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":35,"end":73,"declarations":[{"type":"VariableDeclarator","start":41,"end":72,"id":{"type":"Identifier","start":41,"end":49,"name":"parseUrl"},"init":{"type":"MemberExpression","start":52,"end":72,"object":{"type":"CallExpression","start":52,"end":66,"callee":{"type":"Identifier","start":52,"end":59,"name":"require"},"arguments":[{"type":"Literal","start":60,"end":65,"value":"url","raw":"'url'"}]},"property":{"type":"Identifier","start":67,"end":72,"name":"parse"},"computed":false}}],"kind":"const"},{"type":"VariableDeclaration","start":120,"end":169,"declarations":[{"type":"VariableDeclarator","start":126,"end":168,"id":{"type":"ObjectPattern","start":126,"end":138,"properties":[{"type":"Property","start":128,"end":136,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":128,"end":136,"name":"hasMatch"},"kind":"init","value":{"type":"Identifier","start":128,"end":136,"name":"hasMatch"}}]},"init":{"type":"CallExpression","start":141,"end":168,"callee":{"type":"Identifier","start":141,"end":148,"name":"require"},"arguments":[{"type":"Literal","start":149,"end":167,"value":"../helpers/utils","raw":"'../helpers/utils'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":170,"end":223,"declarations":[{"type":"VariableDeclarator","start":176,"end":222,"id":{"type":"Identifier","start":176,"end":186,"name":"oAuthState"},"init":{"type":"CallExpression","start":189,"end":222,"callee":{"type":"Identifier","start":189,"end":196,"name":"require"},"arguments":[{"type":"Literal","start":197,"end":221,"value":"../helpers/oauth-state","raw":"'../helpers/oauth-state'"}]}}],"kind":"const"},{"type":"ExpressionStatement","start":281,"end":1037,"expression":{"type":"AssignmentExpression","start":281,"end":1036,"operator":"=","left":{"type":"MemberExpression","start":281,"end":295,"object":{"type":"Identifier","start":281,"end":287,"name":"module"},"property":{"type":"Identifier","start":288,"end":295,"name":"exports"},"computed":false},"right":{"type":"FunctionExpression","start":298,"end":1036,"id":{"type":"Identifier","start":307,"end":320,"name":"oauthRedirect"},"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":321,"end":324,"name":"req"},{"type":"Identifier","start":326,"end":329,"name":"res"}],"body":{"type":"BlockStatement","start":331,"end":1036,"body":[{"type":"VariableDeclaration","start":337,"end":393,"declarations":[{"type":"VariableDeclarator","start":343,"end":392,"id":{"type":"Identifier","start":343,"end":350,"name":"dynamic"},"init":{"type":"LogicalExpression","start":353,"end":392,"left":{"type":"MemberExpression","start":353,"end":386,"object":{"type":"LogicalExpression","start":354,"end":377,"left":{"type":"MemberExpression","start":354,"end":371,"object":{"type":"MemberExpression","start":354,"end":365,"object":{"type":"Identifier","start":354,"end":357,"name":"req"},"property":{"type":"Identifier","start":358,"end":365,"name":"session"},"computed":false},"property":{"type":"Identifier","start":366,"end":371,"name":"grant"},"computed":false},"operator":"||","right":{"type":"ObjectExpression","start":375,"end":377,"properties":[]}},"property":{"type":"Identifier","start":379,"end":386,"name":"dynamic"},"computed":false},"operator":"||","right":{"type":"ObjectExpression","start":390,"end":392,"properties":[]}}}],"kind":"const"},{"type":"VariableDeclaration","start":398,"end":426,"declarations":[{"type":"VariableDeclarator","start":404,"end":425,"id":{"type":"Identifier","start":404,"end":409,"name":"state"},"init":{"type":"MemberExpression","start":412,"end":425,"object":{"type":"Identifier","start":412,"end":419,"name":"dynamic"},"property":{"type":"Identifier","start":420,"end":425,"name":"state"},"computed":false}}],"kind":"const"},{"type":"IfStatement","start":431,"end":519,"test":{"type":"UnaryExpression","start":435,"end":441,"operator":"!","prefix":true,"argument":{"type":"Identifier","start":436,"end":441,"name":"state"}},"consequent":{"type":"BlockStatement","start":443,"end":519,"body":[{"type":"ReturnStatement","start":453,"end":513,"argument":{"type":"CallExpression","start":460,"end":512,"callee":{"type":"MemberExpression","start":460,"end":480,"object":{"type":"CallExpression","start":460,"end":475,"callee":{"type":"MemberExpression","start":460,"end":470,"object":{"type":"Identifier","start":460,"end":463,"name":"res"},"property":{"type":"Identifier","start":464,"end":470,"name":"status"},"computed":false},"arguments":[{"type":"Literal","start":471,"end":474,"value":400,"raw":"400"}]},"property":{"type":"Identifier","start":476,"end":480,"name":"send"},"computed":false},"arguments":[{"type":"Literal","start":481,"end":511,"value":"Cannot find state in session","raw":"'Cannot find state in session'"}]}}]},"alternate":null},{"type":"VariableDeclaration","start":524,"end":622,"declarations":[{"type":"VariableDeclarator","start":530,"end":621,"id":{"type":"Identifier","start":530,"end":537,"name":"handler"},"init":{"type":"CallExpression","start":540,"end":621,"callee":{"type":"MemberExpression","start":540,"end":563,"object":{"type":"Identifier","start":540,"end":550,"name":"oAuthState"},"property":{"type":"Identifier","start":551,"end":563,"name":"getFromState"},"computed":false},"arguments":[{"type":"Identifier","start":564,"end":569,"name":"state"},{"type":"Literal","start":571,"end":590,"value":"companionInstance","raw":"'companionInstance'"},{"type":"MemberExpression","start":592,"end":620,"object":{"type":"MemberExpression","start":592,"end":613,"object":{"type":"MemberExpression","start":592,"end":605,"object":{"type":"Identifier","start":592,"end":595,"name":"req"},"property":{"type":"Identifier","start":596,"end":605,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":606,"end":613,"name":"options"},"computed":false},"property":{"type":"Identifier","start":614,"end":620,"name":"secret"},"computed":false}]}}],"kind":"const"},{"type":"VariableDeclaration","start":627,"end":674,"declarations":[{"type":"VariableDeclarator","start":633,"end":673,"id":{"type":"Identifier","start":633,"end":648,"name":"handlerHostName"},"init":{"type":"MemberExpression","start":651,"end":673,"object":{"type":"CallExpression","start":651,"end":668,"callee":{"type":"Identifier","start":651,"end":659,"name":"parseUrl"},"arguments":[{"type":"Identifier","start":660,"end":667,"name":"handler"}]},"property":{"type":"Identifier","start":669,"end":673,"name":"host"},"computed":false}}],"kind":"const"},{"type":"IfStatement","start":679,"end":983,"test":{"type":"CallExpression","start":683,"end":749,"callee":{"type":"Identifier","start":683,"end":691,"name":"hasMatch"},"arguments":[{"type":"Identifier","start":692,"end":707,"name":"handlerHostName"},{"type":"MemberExpression","start":709,"end":748,"object":{"type":"MemberExpression","start":709,"end":737,"object":{"type":"MemberExpression","start":709,"end":730,"object":{"type":"MemberExpression","start":709,"end":722,"object":{"type":"Identifier","start":709,"end":712,"name":"req"},"property":{"type":"Identifier","start":713,"end":722,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":723,"end":730,"name":"options"},"computed":false},"property":{"type":"Identifier","start":731,"end":737,"name":"server"},"computed":false},"property":{"type":"Identifier","start":738,"end":748,"name":"validHosts"},"computed":false}]},"consequent":{"type":"BlockStatement","start":751,"end":983,"body":[{"type":"VariableDeclaration","start":761,"end":818,"declarations":[{"type":"VariableDeclarator","start":767,"end":817,"id":{"type":"Identifier","start":767,"end":779,"name":"providerName"},"init":{"type":"MemberExpression","start":782,"end":817,"object":{"type":"MemberExpression","start":782,"end":804,"object":{"type":"MemberExpression","start":782,"end":795,"object":{"type":"Identifier","start":782,"end":785,"name":"req"},"property":{"type":"Identifier","start":786,"end":795,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":796,"end":804,"name":"provider"},"computed":false},"property":{"type":"Identifier","start":805,"end":817,"name":"authProvider"},"computed":false}}],"kind":"const"},{"type":"VariableDeclaration","start":827,"end":866,"declarations":[{"type":"VariableDeclarator","start":833,"end":865,"id":{"type":"Identifier","start":833,"end":839,"name":"params"},"init":{"type":"CallExpression","start":842,"end":865,"callee":{"type":"MemberExpression","start":842,"end":854,"object":{"type":"Identifier","start":842,"end":844,"name":"qs"},"property":{"type":"Identifier","start":845,"end":854,"name":"stringify"},"computed":false},"arguments":[{"type":"MemberExpression","start":855,"end":864,"object":{"type":"Identifier","start":855,"end":858,"name":"req"},"property":{"type":"Identifier","start":859,"end":864,"name":"query"},"computed":false}]}}],"kind":"const"},{"type":"VariableDeclaration","start":875,"end":943,"declarations":[{"type":"VariableDeclarator","start":881,"end":942,"id":{"type":"Identifier","start":881,"end":884,"name":"url"},"init":{"type":"TemplateLiteral","start":887,"end":942,"expressions":[{"type":"Identifier","start":890,"end":897,"name":"handler"},{"type":"Identifier","start":909,"end":921,"name":"providerName"},{"type":"Identifier","start":934,"end":940,"name":"params"}],"quasis":[{"type":"TemplateElement","start":888,"end":888,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":898,"end":907,"value":{"raw":"/connect/","cooked":"/connect/"},"tail":false},{"type":"TemplateElement","start":922,"end":932,"value":{"raw":"/callback?","cooked":"/callback?"},"tail":false},{"type":"TemplateElement","start":941,"end":941,"value":{"raw":"","cooked":""},"tail":true}]}}],"kind":"const"},{"type":"ReturnStatement","start":952,"end":977,"argument":{"type":"CallExpression","start":959,"end":976,"callee":{"type":"MemberExpression","start":959,"end":971,"object":{"type":"Identifier","start":959,"end":962,"name":"res"},"property":{"type":"Identifier","start":963,"end":971,"name":"redirect"},"computed":false},"arguments":[{"type":"Identifier","start":972,"end":975,"name":"url"}]}}]},"alternate":null},{"type":"ExpressionStatement","start":988,"end":1034,"expression":{"type":"CallExpression","start":988,"end":1033,"callee":{"type":"MemberExpression","start":988,"end":1008,"object":{"type":"CallExpression","start":988,"end":1003,"callee":{"type":"MemberExpression","start":988,"end":998,"object":{"type":"Identifier","start":988,"end":991,"name":"res"},"property":{"type":"Identifier","start":992,"end":998,"name":"status"},"computed":false},"arguments":[{"type":"Literal","start":999,"end":1002,"value":400,"raw":"400"}]},"property":{"type":"Identifier","start":1004,"end":1008,"name":"send"},"computed":false},"arguments":[{"type":"Literal","start":1009,"end":1032,"value":"Invalid Host in state","raw":"'Invalid Host in state'"}]}}]}}}}],"sourceType":"script"}