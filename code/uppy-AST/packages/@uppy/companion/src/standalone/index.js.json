{"type":"Program","start":0,"end":7514,"body":[{"type":"VariableDeclaration","start":0,"end":34,"declarations":[{"type":"VariableDeclarator","start":6,"end":34,"id":{"type":"Identifier","start":6,"end":13,"name":"express"},"init":{"type":"CallExpression","start":16,"end":34,"callee":{"type":"Identifier","start":16,"end":23,"name":"require"},"arguments":[{"type":"Literal","start":24,"end":33,"value":"express","raw":"'express'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":35,"end":68,"declarations":[{"type":"VariableDeclarator","start":41,"end":68,"id":{"type":"Identifier","start":41,"end":43,"name":"qs"},"init":{"type":"CallExpression","start":46,"end":68,"callee":{"type":"Identifier","start":46,"end":53,"name":"require"},"arguments":[{"type":"Literal","start":54,"end":67,"value":"querystring","raw":"'querystring'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":69,"end":110,"declarations":[{"type":"VariableDeclarator","start":75,"end":110,"id":{"type":"Identifier","start":75,"end":84,"name":"companion"},"init":{"type":"CallExpression","start":87,"end":110,"callee":{"type":"Identifier","start":87,"end":94,"name":"require"},"arguments":[{"type":"Literal","start":95,"end":109,"value":"../companion","raw":"'../companion'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":111,"end":143,"declarations":[{"type":"VariableDeclarator","start":117,"end":143,"id":{"type":"Identifier","start":117,"end":123,"name":"helmet"},"init":{"type":"CallExpression","start":126,"end":143,"callee":{"type":"Identifier","start":126,"end":133,"name":"require"},"arguments":[{"type":"Literal","start":134,"end":142,"value":"helmet","raw":"'helmet'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":144,"end":176,"declarations":[{"type":"VariableDeclarator","start":150,"end":176,"id":{"type":"Identifier","start":150,"end":156,"name":"morgan"},"init":{"type":"CallExpression","start":159,"end":176,"callee":{"type":"Identifier","start":159,"end":166,"name":"require"},"arguments":[{"type":"Literal","start":167,"end":175,"value":"morgan","raw":"'morgan'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":177,"end":218,"declarations":[{"type":"VariableDeclarator","start":183,"end":218,"id":{"type":"Identifier","start":183,"end":193,"name":"bodyParser"},"init":{"type":"CallExpression","start":196,"end":218,"callee":{"type":"Identifier","start":196,"end":203,"name":"require"},"arguments":[{"type":"Literal","start":204,"end":217,"value":"body-parser","raw":"'body-parser'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":219,"end":259,"declarations":[{"type":"VariableDeclarator","start":225,"end":259,"id":{"type":"Identifier","start":225,"end":230,"name":"redis"},"init":{"type":"CallExpression","start":233,"end":259,"callee":{"type":"Identifier","start":233,"end":240,"name":"require"},"arguments":[{"type":"Literal","start":241,"end":258,"value":"../server/redis","raw":"'../server/redis'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":260,"end":302,"declarations":[{"type":"VariableDeclarator","start":266,"end":302,"id":{"type":"Identifier","start":266,"end":272,"name":"logger"},"init":{"type":"CallExpression","start":275,"end":302,"callee":{"type":"Identifier","start":275,"end":282,"name":"require"},"arguments":[{"type":"Literal","start":283,"end":301,"value":"../server/logger","raw":"'../server/logger'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":303,"end":358,"declarations":[{"type":"VariableDeclarator","start":309,"end":358,"id":{"type":"ObjectPattern","start":309,"end":321,"properties":[{"type":"Property","start":311,"end":319,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":311,"end":319,"name":"parseURL"},"kind":"init","value":{"type":"Identifier","start":311,"end":319,"name":"parseURL"}}]},"init":{"type":"CallExpression","start":324,"end":358,"callee":{"type":"Identifier","start":324,"end":331,"name":"require"},"arguments":[{"type":"Literal","start":332,"end":357,"value":"../server/helpers/utils","raw":"'../server/helpers/utils'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":359,"end":396,"declarations":[{"type":"VariableDeclarator","start":365,"end":396,"id":{"type":"Identifier","start":365,"end":370,"name":"merge"},"init":{"type":"CallExpression","start":373,"end":396,"callee":{"type":"Identifier","start":373,"end":380,"name":"require"},"arguments":[{"type":"Literal","start":381,"end":395,"value":"lodash.merge","raw":"'lodash.merge'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":411,"end":460,"declarations":[{"type":"VariableDeclarator","start":417,"end":460,"id":{"type":"Identifier","start":417,"end":427,"name":"promBundle"},"init":{"type":"CallExpression","start":430,"end":460,"callee":{"type":"Identifier","start":430,"end":437,"name":"require"},"arguments":[{"type":"Literal","start":438,"end":459,"value":"express-prom-bundle","raw":"'express-prom-bundle'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":461,"end":503,"declarations":[{"type":"VariableDeclarator","start":467,"end":503,"id":{"type":"Identifier","start":467,"end":474,"name":"session"},"init":{"type":"CallExpression","start":477,"end":503,"callee":{"type":"Identifier","start":477,"end":484,"name":"require"},"arguments":[{"type":"Literal","start":485,"end":502,"value":"express-session","raw":"'express-session'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":504,"end":556,"declarations":[{"type":"VariableDeclarator","start":510,"end":556,"id":{"type":"Identifier","start":510,"end":522,"name":"addRequestId"},"init":{"type":"CallExpression","start":525,"end":556,"callee":{"type":"CallExpression","start":525,"end":554,"callee":{"type":"Identifier","start":525,"end":532,"name":"require"},"arguments":[{"type":"Literal","start":533,"end":553,"value":"express-request-id","raw":"'express-request-id'"}]},"arguments":[]}}],"kind":"const"},{"type":"VariableDeclaration","start":557,"end":591,"declarations":[{"type":"VariableDeclarator","start":563,"end":591,"id":{"type":"Identifier","start":563,"end":569,"name":"helper"},"init":{"type":"CallExpression","start":572,"end":591,"callee":{"type":"Identifier","start":572,"end":579,"name":"require"},"arguments":[{"type":"Literal","start":580,"end":590,"value":"./helper","raw":"'./helper'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":606,"end":655,"declarations":[{"type":"VariableDeclarator","start":612,"end":655,"id":{"type":"ObjectPattern","start":612,"end":623,"properties":[{"type":"Property","start":614,"end":621,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":614,"end":621,"name":"version"},"kind":"init","value":{"type":"Identifier","start":614,"end":621,"name":"version"}}]},"init":{"type":"CallExpression","start":626,"end":655,"callee":{"type":"Identifier","start":626,"end":633,"name":"require"},"arguments":[{"type":"Literal","start":634,"end":654,"value":"../../package.json","raw":"'../../package.json'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":657,"end":678,"declarations":[{"type":"VariableDeclarator","start":663,"end":678,"id":{"type":"Identifier","start":663,"end":666,"name":"app"},"init":{"type":"CallExpression","start":669,"end":678,"callee":{"type":"Identifier","start":669,"end":676,"name":"express"},"arguments":[]}}],"kind":"const"},{"type":"VariableDeclaration","start":712,"end":773,"declarations":[{"type":"VariableDeclarator","start":718,"end":773,"id":{"type":"Identifier","start":718,"end":735,"name":"metricsMiddleware"},"init":{"type":"CallExpression","start":738,"end":773,"callee":{"type":"Identifier","start":738,"end":748,"name":"promBundle"},"arguments":[{"type":"ObjectExpression","start":749,"end":772,"properties":[{"type":"Property","start":751,"end":770,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":751,"end":764,"name":"includeMethod"},"value":{"type":"Literal","start":766,"end":770,"value":true,"raw":"true"},"kind":"init"}]}]}}],"kind":"const"},{"type":"VariableDeclaration","start":774,"end":821,"declarations":[{"type":"VariableDeclarator","start":780,"end":821,"id":{"type":"Identifier","start":780,"end":790,"name":"promClient"},"init":{"type":"MemberExpression","start":793,"end":821,"object":{"type":"Identifier","start":793,"end":810,"name":"metricsMiddleware"},"property":{"type":"Identifier","start":811,"end":821,"name":"promClient"},"computed":false}}],"kind":"const"},{"type":"VariableDeclaration","start":822,"end":884,"declarations":[{"type":"VariableDeclarator","start":828,"end":884,"id":{"type":"Identifier","start":828,"end":849,"name":"collectDefaultMetrics"},"init":{"type":"MemberExpression","start":852,"end":884,"object":{"type":"Identifier","start":852,"end":862,"name":"promClient"},"property":{"type":"Identifier","start":863,"end":884,"name":"collectDefaultMetrics"},"computed":false}}],"kind":"const"},{"type":"VariableDeclaration","start":885,"end":977,"declarations":[{"type":"VariableDeclarator","start":891,"end":977,"id":{"type":"Identifier","start":891,"end":903,"name":"promInterval"},"init":{"type":"CallExpression","start":906,"end":977,"callee":{"type":"Identifier","start":906,"end":927,"name":"collectDefaultMetrics"},"arguments":[{"type":"ObjectExpression","start":928,"end":976,"properties":[{"type":"Property","start":930,"end":959,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":930,"end":938,"name":"register"},"value":{"type":"MemberExpression","start":940,"end":959,"object":{"type":"Identifier","start":940,"end":950,"name":"promClient"},"property":{"type":"Identifier","start":951,"end":959,"name":"register"},"computed":false},"kind":"init"},{"type":"Property","start":961,"end":974,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":961,"end":968,"name":"timeout"},"value":{"type":"Literal","start":970,"end":974,"value":5000,"raw":"5000"},"kind":"init"}]}]}}],"kind":"const"},{"type":"VariableDeclaration","start":1016,"end":1123,"declarations":[{"type":"VariableDeclarator","start":1022,"end":1123,"id":{"type":"Identifier","start":1022,"end":1034,"name":"versionGauge"},"init":{"type":"NewExpression","start":1037,"end":1123,"callee":{"type":"MemberExpression","start":1041,"end":1057,"object":{"type":"Identifier","start":1041,"end":1051,"name":"promClient"},"property":{"type":"Identifier","start":1052,"end":1057,"name":"Gauge"},"computed":false},"arguments":[{"type":"ObjectExpression","start":1058,"end":1122,"properties":[{"type":"Property","start":1060,"end":1085,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1060,"end":1064,"name":"name"},"value":{"type":"Literal","start":1066,"end":1085,"value":"companion_version","raw":"'companion_version'"},"kind":"init"},{"type":"Property","start":1087,"end":1120,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1087,"end":1091,"name":"help"},"value":{"type":"Literal","start":1093,"end":1120,"value":"npm version as an integer","raw":"'npm version as an integer'"},"kind":"init"}]}]}}],"kind":"const"},{"type":"VariableDeclaration","start":1138,"end":1190,"declarations":[{"type":"VariableDeclarator","start":1144,"end":1190,"id":{"type":"Identifier","start":1144,"end":1157,"name":"numberVersion"},"init":{"type":"BinaryExpression","start":1160,"end":1190,"left":{"type":"CallExpression","start":1160,"end":1186,"callee":{"type":"MemberExpression","start":1160,"end":1175,"object":{"type":"Identifier","start":1160,"end":1167,"name":"version"},"property":{"type":"Identifier","start":1168,"end":1175,"name":"replace"},"computed":false},"arguments":[{"type":"Literal","start":1176,"end":1181,"value":{},"raw":"/\\D/g","regex":{"pattern":"\\D","flags":"g"}},{"type":"Literal","start":1183,"end":1185,"value":"","raw":"''"}]},"operator":"*","right":{"type":"Literal","start":1189,"end":1190,"value":1,"raw":"1"}}}],"kind":"const"},{"type":"ExpressionStatement","start":1191,"end":1222,"expression":{"type":"CallExpression","start":1191,"end":1222,"callee":{"type":"MemberExpression","start":1191,"end":1207,"object":{"type":"Identifier","start":1191,"end":1203,"name":"versionGauge"},"property":{"type":"Identifier","start":1204,"end":1207,"name":"set"},"computed":false},"arguments":[{"type":"Identifier","start":1208,"end":1221,"name":"numberVersion"}]}},{"type":"IfStatement","start":1224,"end":1288,"test":{"type":"BinaryExpression","start":1228,"end":1253,"left":{"type":"CallExpression","start":1228,"end":1242,"callee":{"type":"MemberExpression","start":1228,"end":1235,"object":{"type":"Identifier","start":1228,"end":1231,"name":"app"},"property":{"type":"Identifier","start":1232,"end":1235,"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":1236,"end":1241,"value":"env","raw":"'env'"}]},"operator":"!==","right":{"type":"Literal","start":1247,"end":1253,"value":"test","raw":"'test'"}},"consequent":{"type":"BlockStatement","start":1255,"end":1288,"body":[{"type":"ExpressionStatement","start":1259,"end":1286,"expression":{"type":"CallExpression","start":1259,"end":1286,"callee":{"type":"Identifier","start":1259,"end":1272,"name":"clearInterval"},"arguments":[{"type":"Identifier","start":1273,"end":1285,"name":"promInterval"}]}}]},"alternate":null},{"type":"VariableDeclaration","start":1361,"end":1425,"declarations":[{"type":"VariableDeclarator","start":1367,"end":1425,"id":{"type":"Identifier","start":1367,"end":1380,"name":"sensitiveKeys"},"init":{"type":"NewExpression","start":1383,"end":1425,"callee":{"type":"Identifier","start":1387,"end":1390,"name":"Set"},"arguments":[{"type":"ArrayExpression","start":1391,"end":1424,"elements":[{"type":"Literal","start":1392,"end":1406,"value":"access_token","raw":"'access_token'"},{"type":"Literal","start":1408,"end":1423,"value":"uppyAuthToken","raw":"'uppyAuthToken'"}]}]}}],"kind":"const"},{"type":"FunctionDeclaration","start":1882,"end":2318,"id":{"type":"Identifier","start":1891,"end":1902,"name":"censorQuery"},"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":1904,"end":1912,"name":"rawQuery"}],"body":{"type":"BlockStatement","start":1914,"end":2318,"body":[{"type":"VariableDeclaration","start":1961,"end":1977,"declarations":[{"type":"VariableDeclarator","start":1967,"end":1977,"id":{"type":"Identifier","start":1967,"end":1972,"name":"query"},"init":{"type":"ObjectExpression","start":1975,"end":1977,"properties":[]}}],"kind":"const"},{"type":"VariableDeclaration","start":1980,"end":2000,"declarations":[{"type":"VariableDeclarator","start":1984,"end":2000,"id":{"type":"Identifier","start":1984,"end":1992,"name":"censored"},"init":{"type":"Literal","start":1995,"end":2000,"value":false,"raw":"false"}}],"kind":"let"},{"type":"ExpressionStatement","start":2003,"end":2287,"expression":{"type":"CallExpression","start":2003,"end":2287,"callee":{"type":"MemberExpression","start":2003,"end":2032,"object":{"type":"CallExpression","start":2003,"end":2024,"callee":{"type":"MemberExpression","start":2003,"end":2014,"object":{"type":"Identifier","start":2003,"end":2009,"name":"Object"},"property":{"type":"Identifier","start":2010,"end":2014,"name":"keys"},"computed":false},"arguments":[{"type":"Identifier","start":2015,"end":2023,"name":"rawQuery"}]},"property":{"type":"Identifier","start":2025,"end":2032,"name":"forEach"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":2033,"end":2286,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":2034,"end":2037,"name":"key"}],"body":{"type":"BlockStatement","start":2042,"end":2286,"body":[{"type":"IfStatement","start":2048,"end":2107,"test":{"type":"BinaryExpression","start":2052,"end":2085,"left":{"type":"UnaryExpression","start":2052,"end":2072,"operator":"typeof","prefix":true,"argument":{"type":"MemberExpression","start":2059,"end":2072,"object":{"type":"Identifier","start":2059,"end":2067,"name":"rawQuery"},"property":{"type":"Identifier","start":2068,"end":2071,"name":"key"},"computed":true}},"operator":"!==","right":{"type":"Literal","start":2077,"end":2085,"value":"string","raw":"'string'"}},"consequent":{"type":"BlockStatement","start":2087,"end":2107,"body":[{"type":"ReturnStatement","start":2095,"end":2101,"argument":null}]},"alternate":null},{"type":"IfStatement","start":2112,"end":2282,"test":{"type":"CallExpression","start":2116,"end":2138,"callee":{"type":"MemberExpression","start":2116,"end":2133,"object":{"type":"Identifier","start":2116,"end":2129,"name":"sensitiveKeys"},"property":{"type":"Identifier","start":2130,"end":2133,"name":"has"},"computed":false},"arguments":[{"type":"Identifier","start":2134,"end":2137,"name":"key"}]},"consequent":{"type":"BlockStatement","start":2140,"end":2236,"body":[{"type":"ExpressionStatement","start":2185,"end":2208,"expression":{"type":"AssignmentExpression","start":2185,"end":2208,"operator":"=","left":{"type":"MemberExpression","start":2185,"end":2195,"object":{"type":"Identifier","start":2185,"end":2190,"name":"query"},"property":{"type":"Identifier","start":2191,"end":2194,"name":"key"},"computed":true},"right":{"type":"Literal","start":2198,"end":2208,"value":"********","raw":"'********'"}}},{"type":"ExpressionStatement","start":2215,"end":2230,"expression":{"type":"AssignmentExpression","start":2215,"end":2230,"operator":"=","left":{"type":"Identifier","start":2215,"end":2223,"name":"censored"},"right":{"type":"Literal","start":2226,"end":2230,"value":true,"raw":"true"}}}]},"alternate":{"type":"BlockStatement","start":2242,"end":2282,"body":[{"type":"ExpressionStatement","start":2250,"end":2276,"expression":{"type":"AssignmentExpression","start":2250,"end":2276,"operator":"=","left":{"type":"MemberExpression","start":2250,"end":2260,"object":{"type":"Identifier","start":2250,"end":2255,"name":"query"},"property":{"type":"Identifier","start":2256,"end":2259,"name":"key"},"computed":true},"right":{"type":"MemberExpression","start":2263,"end":2276,"object":{"type":"Identifier","start":2263,"end":2271,"name":"rawQuery"},"property":{"type":"Identifier","start":2272,"end":2275,"name":"key"},"computed":true}}}]}}]}}]}},{"type":"ReturnStatement","start":2290,"end":2316,"argument":{"type":"ObjectExpression","start":2297,"end":2316,"properties":[{"type":"Property","start":2299,"end":2304,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":2299,"end":2304,"name":"query"},"kind":"init","value":{"type":"Identifier","start":2299,"end":2304,"name":"query"}},{"type":"Property","start":2306,"end":2314,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":2306,"end":2314,"name":"censored"},"kind":"init","value":{"type":"Identifier","start":2306,"end":2314,"name":"censored"}}]}}]}},{"type":"ExpressionStatement","start":2320,"end":2341,"expression":{"type":"CallExpression","start":2320,"end":2341,"callee":{"type":"MemberExpression","start":2320,"end":2327,"object":{"type":"Identifier","start":2320,"end":2323,"name":"app"},"property":{"type":"Identifier","start":2324,"end":2327,"name":"use"},"computed":false},"arguments":[{"type":"Identifier","start":2328,"end":2340,"name":"addRequestId"}]}},{"type":"ExpressionStatement","start":2366,"end":2393,"expression":{"type":"CallExpression","start":2366,"end":2393,"callee":{"type":"MemberExpression","start":2366,"end":2373,"object":{"type":"Identifier","start":2366,"end":2369,"name":"app"},"property":{"type":"Identifier","start":2370,"end":2373,"name":"use"},"computed":false},"arguments":[{"type":"CallExpression","start":2374,"end":2392,"callee":{"type":"Identifier","start":2374,"end":2380,"name":"morgan"},"arguments":[{"type":"Literal","start":2381,"end":2391,"value":"combined","raw":"'combined'"}]}]}},{"type":"ExpressionStatement","start":2394,"end":2571,"expression":{"type":"CallExpression","start":2394,"end":2571,"callee":{"type":"MemberExpression","start":2394,"end":2406,"object":{"type":"Identifier","start":2394,"end":2400,"name":"morgan"},"property":{"type":"Identifier","start":2401,"end":2406,"name":"token"},"computed":false},"arguments":[{"type":"Literal","start":2407,"end":2412,"value":"url","raw":"'url'"},{"type":"ArrowFunctionExpression","start":2414,"end":2570,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":2415,"end":2418,"name":"req"},{"type":"Identifier","start":2420,"end":2423,"name":"res"}],"body":{"type":"BlockStatement","start":2428,"end":2570,"body":[{"type":"VariableDeclaration","start":2432,"end":2482,"declarations":[{"type":"VariableDeclarator","start":2438,"end":2482,"id":{"type":"ObjectPattern","start":2438,"end":2457,"properties":[{"type":"Property","start":2440,"end":2445,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":2440,"end":2445,"name":"query"},"kind":"init","value":{"type":"Identifier","start":2440,"end":2445,"name":"query"}},{"type":"Property","start":2447,"end":2455,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":2447,"end":2455,"name":"censored"},"kind":"init","value":{"type":"Identifier","start":2447,"end":2455,"name":"censored"}}]},"init":{"type":"CallExpression","start":2460,"end":2482,"callee":{"type":"Identifier","start":2460,"end":2471,"name":"censorQuery"},"arguments":[{"type":"MemberExpression","start":2472,"end":2481,"object":{"type":"Identifier","start":2472,"end":2475,"name":"req"},"property":{"type":"Identifier","start":2476,"end":2481,"name":"query"},"computed":false}]}}],"kind":"const"},{"type":"ReturnStatement","start":2485,"end":2568,"argument":{"type":"ConditionalExpression","start":2492,"end":2568,"test":{"type":"Identifier","start":2492,"end":2500,"name":"censored"},"consequent":{"type":"TemplateLiteral","start":2503,"end":2539,"expressions":[{"type":"MemberExpression","start":2506,"end":2514,"object":{"type":"Identifier","start":2506,"end":2509,"name":"req"},"property":{"type":"Identifier","start":2510,"end":2514,"name":"path"},"computed":false},{"type":"CallExpression","start":2518,"end":2537,"callee":{"type":"MemberExpression","start":2518,"end":2530,"object":{"type":"Identifier","start":2518,"end":2520,"name":"qs"},"property":{"type":"Identifier","start":2521,"end":2530,"name":"stringify"},"computed":false},"arguments":[{"type":"Identifier","start":2531,"end":2536,"name":"query"}]}],"quasis":[{"type":"TemplateElement","start":2504,"end":2504,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":2515,"end":2516,"value":{"raw":"?","cooked":"?"},"tail":false},{"type":"TemplateElement","start":2538,"end":2538,"value":{"raw":"","cooked":""},"tail":true}]},"alternate":{"type":"LogicalExpression","start":2542,"end":2568,"left":{"type":"MemberExpression","start":2542,"end":2557,"object":{"type":"Identifier","start":2542,"end":2545,"name":"req"},"property":{"type":"Identifier","start":2546,"end":2557,"name":"originalUrl"},"computed":false},"operator":"||","right":{"type":"MemberExpression","start":2561,"end":2568,"object":{"type":"Identifier","start":2561,"end":2564,"name":"req"},"property":{"type":"Identifier","start":2565,"end":2568,"name":"url"},"computed":false}}}}]}}]}},{"type":"ExpressionStatement","start":2573,"end":2950,"expression":{"type":"CallExpression","start":2573,"end":2950,"callee":{"type":"MemberExpression","start":2573,"end":2585,"object":{"type":"Identifier","start":2573,"end":2579,"name":"morgan"},"property":{"type":"Identifier","start":2580,"end":2585,"name":"token"},"computed":false},"arguments":[{"type":"Literal","start":2586,"end":2596,"value":"referrer","raw":"'referrer'"},{"type":"ArrowFunctionExpression","start":2598,"end":2949,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":2599,"end":2602,"name":"req"},{"type":"Identifier","start":2604,"end":2607,"name":"res"}],"body":{"type":"BlockStatement","start":2612,"end":2949,"body":[{"type":"VariableDeclaration","start":2616,"end":2671,"declarations":[{"type":"VariableDeclarator","start":2622,"end":2671,"id":{"type":"Identifier","start":2622,"end":2625,"name":"ref"},"init":{"type":"LogicalExpression","start":2628,"end":2671,"left":{"type":"MemberExpression","start":2628,"end":2647,"object":{"type":"MemberExpression","start":2628,"end":2639,"object":{"type":"Identifier","start":2628,"end":2631,"name":"req"},"property":{"type":"Identifier","start":2632,"end":2639,"name":"headers"},"computed":false},"property":{"type":"Identifier","start":2640,"end":2647,"name":"referer"},"computed":false},"operator":"||","right":{"type":"MemberExpression","start":2651,"end":2671,"object":{"type":"MemberExpression","start":2651,"end":2662,"object":{"type":"Identifier","start":2651,"end":2654,"name":"req"},"property":{"type":"Identifier","start":2655,"end":2662,"name":"headers"},"computed":false},"property":{"type":"Identifier","start":2663,"end":2671,"name":"referrer"},"computed":false}}}],"kind":"const"},{"type":"IfStatement","start":2674,"end":2947,"test":{"type":"BinaryExpression","start":2678,"end":2701,"left":{"type":"UnaryExpression","start":2678,"end":2688,"operator":"typeof","prefix":true,"argument":{"type":"Identifier","start":2685,"end":2688,"name":"ref"}},"operator":"===","right":{"type":"Literal","start":2693,"end":2701,"value":"string","raw":"'string'"}},"consequent":{"type":"BlockStatement","start":2703,"end":2947,"body":[{"type":"VariableDeclaration","start":2709,"end":2737,"declarations":[{"type":"VariableDeclarator","start":2715,"end":2737,"id":{"type":"Identifier","start":2715,"end":2721,"name":"parsed"},"init":{"type":"CallExpression","start":2724,"end":2737,"callee":{"type":"Identifier","start":2724,"end":2732,"name":"parseURL"},"arguments":[{"type":"Identifier","start":2733,"end":2736,"name":"ref"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":2742,"end":2799,"declarations":[{"type":"VariableDeclarator","start":2748,"end":2799,"id":{"type":"Identifier","start":2748,"end":2756,"name":"rawQuery"},"init":{"type":"CallExpression","start":2759,"end":2799,"callee":{"type":"MemberExpression","start":2759,"end":2767,"object":{"type":"Identifier","start":2759,"end":2761,"name":"qs"},"property":{"type":"Identifier","start":2762,"end":2767,"name":"parse"},"computed":false},"arguments":[{"type":"CallExpression","start":2768,"end":2798,"callee":{"type":"MemberExpression","start":2768,"end":2789,"object":{"type":"MemberExpression","start":2768,"end":2781,"object":{"type":"Identifier","start":2768,"end":2774,"name":"parsed"},"property":{"type":"Identifier","start":2775,"end":2781,"name":"search"},"computed":false},"property":{"type":"Identifier","start":2782,"end":2789,"name":"replace"},"computed":false},"arguments":[{"type":"Literal","start":2790,"end":2793,"value":"?","raw":"'?'"},{"type":"Literal","start":2795,"end":2797,"value":"","raw":"''"}]}]}}],"kind":"const"},{"type":"VariableDeclaration","start":2804,"end":2853,"declarations":[{"type":"VariableDeclarator","start":2810,"end":2853,"id":{"type":"ObjectPattern","start":2810,"end":2829,"properties":[{"type":"Property","start":2812,"end":2817,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":2812,"end":2817,"name":"query"},"kind":"init","value":{"type":"Identifier","start":2812,"end":2817,"name":"query"}},{"type":"Property","start":2819,"end":2827,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":2819,"end":2827,"name":"censored"},"kind":"init","value":{"type":"Identifier","start":2819,"end":2827,"name":"censored"}}]},"init":{"type":"CallExpression","start":2832,"end":2853,"callee":{"type":"Identifier","start":2832,"end":2843,"name":"censorQuery"},"arguments":[{"type":"Identifier","start":2844,"end":2852,"name":"rawQuery"}]}}],"kind":"const"},{"type":"ReturnStatement","start":2858,"end":2943,"argument":{"type":"ConditionalExpression","start":2865,"end":2943,"test":{"type":"Identifier","start":2865,"end":2873,"name":"censored"},"consequent":{"type":"TemplateLiteral","start":2876,"end":2929,"expressions":[{"type":"MemberExpression","start":2879,"end":2904,"object":{"type":"CallExpression","start":2879,"end":2901,"callee":{"type":"MemberExpression","start":2879,"end":2896,"object":{"type":"MemberExpression","start":2879,"end":2890,"object":{"type":"Identifier","start":2879,"end":2885,"name":"parsed"},"property":{"type":"Identifier","start":2886,"end":2890,"name":"href"},"computed":false},"property":{"type":"Identifier","start":2891,"end":2896,"name":"split"},"computed":false},"arguments":[{"type":"Literal","start":2897,"end":2900,"value":"?","raw":"'?'"}]},"property":{"type":"Literal","start":2902,"end":2903,"value":0,"raw":"0"},"computed":true},{"type":"CallExpression","start":2908,"end":2927,"callee":{"type":"MemberExpression","start":2908,"end":2920,"object":{"type":"Identifier","start":2908,"end":2910,"name":"qs"},"property":{"type":"Identifier","start":2911,"end":2920,"name":"stringify"},"computed":false},"arguments":[{"type":"Identifier","start":2921,"end":2926,"name":"query"}]}],"quasis":[{"type":"TemplateElement","start":2877,"end":2877,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":2905,"end":2906,"value":{"raw":"?","cooked":"?"},"tail":false},{"type":"TemplateElement","start":2928,"end":2928,"value":{"raw":"","cooked":""},"tail":true}]},"alternate":{"type":"MemberExpression","start":2932,"end":2943,"object":{"type":"Identifier","start":2932,"end":2938,"name":"parsed"},"property":{"type":"Identifier","start":2939,"end":2943,"name":"href"},"computed":false}}}]},"alternate":null}]}}]}},{"type":"ExpressionStatement","start":2997,"end":3023,"expression":{"type":"CallExpression","start":2997,"end":3023,"callee":{"type":"MemberExpression","start":2997,"end":3004,"object":{"type":"Identifier","start":2997,"end":3000,"name":"app"},"property":{"type":"Identifier","start":3001,"end":3004,"name":"use"},"computed":false},"arguments":[{"type":"Identifier","start":3005,"end":3022,"name":"metricsMiddleware"}]}},{"type":"ExpressionStatement","start":3025,"end":3051,"expression":{"type":"CallExpression","start":3025,"end":3051,"callee":{"type":"MemberExpression","start":3025,"end":3032,"object":{"type":"Identifier","start":3025,"end":3028,"name":"app"},"property":{"type":"Identifier","start":3029,"end":3032,"name":"use"},"computed":false},"arguments":[{"type":"CallExpression","start":3033,"end":3050,"callee":{"type":"MemberExpression","start":3033,"end":3048,"object":{"type":"Identifier","start":3033,"end":3043,"name":"bodyParser"},"property":{"type":"Identifier","start":3044,"end":3048,"name":"json"},"computed":false},"arguments":[]}]}},{"type":"ExpressionStatement","start":3052,"end":3103,"expression":{"type":"CallExpression","start":3052,"end":3103,"callee":{"type":"MemberExpression","start":3052,"end":3059,"object":{"type":"Identifier","start":3052,"end":3055,"name":"app"},"property":{"type":"Identifier","start":3056,"end":3059,"name":"use"},"computed":false},"arguments":[{"type":"CallExpression","start":3060,"end":3102,"callee":{"type":"MemberExpression","start":3060,"end":3081,"object":{"type":"Identifier","start":3060,"end":3070,"name":"bodyParser"},"property":{"type":"Identifier","start":3071,"end":3081,"name":"urlencoded"},"computed":false},"arguments":[{"type":"ObjectExpression","start":3082,"end":3101,"properties":[{"type":"Property","start":3084,"end":3099,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3084,"end":3092,"name":"extended"},"value":{"type":"Literal","start":3094,"end":3099,"value":false,"raw":"false"},"kind":"init"}]}]}]}},{"type":"ExpressionStatement","start":3145,"end":3173,"expression":{"type":"CallExpression","start":3145,"end":3173,"callee":{"type":"MemberExpression","start":3145,"end":3152,"object":{"type":"Identifier","start":3145,"end":3148,"name":"app"},"property":{"type":"Identifier","start":3149,"end":3152,"name":"use"},"computed":false},"arguments":[{"type":"CallExpression","start":3153,"end":3172,"callee":{"type":"MemberExpression","start":3153,"end":3170,"object":{"type":"Identifier","start":3153,"end":3159,"name":"helmet"},"property":{"type":"Identifier","start":3160,"end":3170,"name":"frameguard"},"computed":false},"arguments":[]}]}},{"type":"ExpressionStatement","start":3174,"end":3201,"expression":{"type":"CallExpression","start":3174,"end":3201,"callee":{"type":"MemberExpression","start":3174,"end":3181,"object":{"type":"Identifier","start":3174,"end":3177,"name":"app"},"property":{"type":"Identifier","start":3178,"end":3181,"name":"use"},"computed":false},"arguments":[{"type":"CallExpression","start":3182,"end":3200,"callee":{"type":"MemberExpression","start":3182,"end":3198,"object":{"type":"Identifier","start":3182,"end":3188,"name":"helmet"},"property":{"type":"Identifier","start":3189,"end":3198,"name":"xssFilter"},"computed":false},"arguments":[]}]}},{"type":"ExpressionStatement","start":3202,"end":3227,"expression":{"type":"CallExpression","start":3202,"end":3227,"callee":{"type":"MemberExpression","start":3202,"end":3209,"object":{"type":"Identifier","start":3202,"end":3205,"name":"app"},"property":{"type":"Identifier","start":3206,"end":3209,"name":"use"},"computed":false},"arguments":[{"type":"CallExpression","start":3210,"end":3226,"callee":{"type":"MemberExpression","start":3210,"end":3224,"object":{"type":"Identifier","start":3210,"end":3216,"name":"helmet"},"property":{"type":"Identifier","start":3217,"end":3224,"name":"noSniff"},"computed":false},"arguments":[]}]}},{"type":"ExpressionStatement","start":3228,"end":3254,"expression":{"type":"CallExpression","start":3228,"end":3254,"callee":{"type":"MemberExpression","start":3228,"end":3235,"object":{"type":"Identifier","start":3228,"end":3231,"name":"app"},"property":{"type":"Identifier","start":3232,"end":3235,"name":"use"},"computed":false},"arguments":[{"type":"CallExpression","start":3236,"end":3253,"callee":{"type":"MemberExpression","start":3236,"end":3251,"object":{"type":"Identifier","start":3236,"end":3242,"name":"helmet"},"property":{"type":"Identifier","start":3243,"end":3251,"name":"ieNoOpen"},"computed":false},"arguments":[]}]}},{"type":"ExpressionStatement","start":3255,"end":3282,"expression":{"type":"CallExpression","start":3255,"end":3282,"callee":{"type":"MemberExpression","start":3255,"end":3266,"object":{"type":"Identifier","start":3255,"end":3258,"name":"app"},"property":{"type":"Identifier","start":3259,"end":3266,"name":"disable"},"computed":false},"arguments":[{"type":"Literal","start":3267,"end":3281,"value":"x-powered-by","raw":"'x-powered-by'"}]}},{"type":"VariableDeclaration","start":3284,"end":3337,"declarations":[{"type":"VariableDeclarator","start":3290,"end":3337,"id":{"type":"Identifier","start":3290,"end":3306,"name":"companionOptions"},"init":{"type":"CallExpression","start":3309,"end":3337,"callee":{"type":"MemberExpression","start":3309,"end":3335,"object":{"type":"Identifier","start":3309,"end":3315,"name":"helper"},"property":{"type":"Identifier","start":3316,"end":3335,"name":"getCompanionOptions"},"computed":false},"arguments":[]}}],"kind":"const"},{"type":"VariableDeclaration","start":3338,"end":3441,"declarations":[{"type":"VariableDeclarator","start":3344,"end":3441,"id":{"type":"Identifier","start":3344,"end":3358,"name":"sessionOptions"},"init":{"type":"ObjectExpression","start":3361,"end":3441,"properties":[{"type":"Property","start":3365,"end":3396,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3365,"end":3371,"name":"secret"},"value":{"type":"MemberExpression","start":3373,"end":3396,"object":{"type":"Identifier","start":3373,"end":3389,"name":"companionOptions"},"property":{"type":"Identifier","start":3390,"end":3396,"name":"secret"},"computed":false},"kind":"init"},{"type":"Property","start":3400,"end":3412,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3400,"end":3406,"name":"resave"},"value":{"type":"Literal","start":3408,"end":3412,"value":true,"raw":"true"},"kind":"init"},{"type":"Property","start":3416,"end":3439,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3416,"end":3433,"name":"saveUninitialized"},"value":{"type":"Literal","start":3435,"end":3439,"value":true,"raw":"true"},"kind":"init"}]}}],"kind":"const"},{"type":"IfStatement","start":3443,"end":3714,"test":{"type":"MemberExpression","start":3447,"end":3472,"object":{"type":"Identifier","start":3447,"end":3463,"name":"companionOptions"},"property":{"type":"Identifier","start":3464,"end":3472,"name":"redisUrl"},"computed":false},"consequent":{"type":"BlockStatement","start":3474,"end":3714,"body":[{"type":"VariableDeclaration","start":3478,"end":3530,"declarations":[{"type":"VariableDeclarator","start":3484,"end":3530,"id":{"type":"Identifier","start":3484,"end":3494,"name":"RedisStore"},"init":{"type":"CallExpression","start":3497,"end":3530,"callee":{"type":"CallExpression","start":3497,"end":3521,"callee":{"type":"Identifier","start":3497,"end":3504,"name":"require"},"arguments":[{"type":"Literal","start":3505,"end":3520,"value":"connect-redis","raw":"'connect-redis'"}]},"arguments":[{"type":"Identifier","start":3522,"end":3529,"name":"session"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":3533,"end":3647,"declarations":[{"type":"VariableDeclarator","start":3539,"end":3647,"id":{"type":"Identifier","start":3539,"end":3550,"name":"redisClient"},"init":{"type":"CallExpression","start":3553,"end":3647,"callee":{"type":"MemberExpression","start":3553,"end":3565,"object":{"type":"Identifier","start":3553,"end":3558,"name":"redis"},"property":{"type":"Identifier","start":3559,"end":3565,"name":"client"},"computed":false},"arguments":[{"type":"CallExpression","start":3571,"end":3643,"callee":{"type":"Identifier","start":3571,"end":3576,"name":"merge"},"arguments":[{"type":"ObjectExpression","start":3577,"end":3611,"properties":[{"type":"Property","start":3579,"end":3609,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3579,"end":3582,"name":"url"},"value":{"type":"MemberExpression","start":3584,"end":3609,"object":{"type":"Identifier","start":3584,"end":3600,"name":"companionOptions"},"property":{"type":"Identifier","start":3601,"end":3609,"name":"redisUrl"},"computed":false},"kind":"init"}]},{"type":"MemberExpression","start":3613,"end":3642,"object":{"type":"Identifier","start":3613,"end":3629,"name":"companionOptions"},"property":{"type":"Identifier","start":3630,"end":3642,"name":"redisOptions"},"computed":false}]}]}}],"kind":"const"},{"type":"ExpressionStatement","start":3650,"end":3712,"expression":{"type":"AssignmentExpression","start":3650,"end":3712,"operator":"=","left":{"type":"MemberExpression","start":3650,"end":3670,"object":{"type":"Identifier","start":3650,"end":3664,"name":"sessionOptions"},"property":{"type":"Identifier","start":3665,"end":3670,"name":"store"},"computed":false},"right":{"type":"NewExpression","start":3673,"end":3712,"callee":{"type":"Identifier","start":3677,"end":3687,"name":"RedisStore"},"arguments":[{"type":"ObjectExpression","start":3688,"end":3711,"properties":[{"type":"Property","start":3690,"end":3709,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3690,"end":3696,"name":"client"},"value":{"type":"Identifier","start":3698,"end":3709,"name":"redisClient"},"kind":"init"}]}]}}}]},"alternate":null},{"type":"IfStatement","start":3716,"end":3882,"test":{"type":"MemberExpression","start":3720,"end":3755,"object":{"type":"MemberExpression","start":3720,"end":3731,"object":{"type":"Identifier","start":3720,"end":3727,"name":"process"},"property":{"type":"Identifier","start":3728,"end":3731,"name":"env"},"computed":false},"property":{"type":"Identifier","start":3732,"end":3755,"name":"COMPANION_COOKIE_DOMAIN"},"computed":false},"consequent":{"type":"BlockStatement","start":3757,"end":3882,"body":[{"type":"ExpressionStatement","start":3761,"end":3880,"expression":{"type":"AssignmentExpression","start":3761,"end":3880,"operator":"=","left":{"type":"MemberExpression","start":3761,"end":3782,"object":{"type":"Identifier","start":3761,"end":3775,"name":"sessionOptions"},"property":{"type":"Identifier","start":3776,"end":3782,"name":"cookie"},"computed":false},"right":{"type":"ObjectExpression","start":3785,"end":3880,"properties":[{"type":"Property","start":3791,"end":3834,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3791,"end":3797,"name":"domain"},"value":{"type":"MemberExpression","start":3799,"end":3834,"object":{"type":"MemberExpression","start":3799,"end":3810,"object":{"type":"Identifier","start":3799,"end":3806,"name":"process"},"property":{"type":"Identifier","start":3807,"end":3810,"name":"env"},"computed":false},"property":{"type":"Identifier","start":3811,"end":3834,"name":"COMPANION_COOKIE_DOMAIN"},"computed":false},"kind":"init"},{"type":"Property","start":3840,"end":3867,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3840,"end":3846,"name":"maxAge"},"value":{"type":"BinaryExpression","start":3848,"end":3867,"left":{"type":"BinaryExpression","start":3848,"end":3860,"left":{"type":"BinaryExpression","start":3848,"end":3855,"left":{"type":"Literal","start":3848,"end":3850,"value":24,"raw":"24"},"operator":"*","right":{"type":"Literal","start":3853,"end":3855,"value":60,"raw":"60"}},"operator":"*","right":{"type":"Literal","start":3858,"end":3860,"value":60,"raw":"60"}},"operator":"*","right":{"type":"Literal","start":3863,"end":3867,"value":1000,"raw":"1000"}},"kind":"init"}]}}}]},"alternate":null},{"type":"ExpressionStatement","start":3884,"end":3916,"expression":{"type":"CallExpression","start":3884,"end":3916,"callee":{"type":"MemberExpression","start":3884,"end":3891,"object":{"type":"Identifier","start":3884,"end":3887,"name":"app"},"property":{"type":"Identifier","start":3888,"end":3891,"name":"use"},"computed":false},"arguments":[{"type":"CallExpression","start":3892,"end":3915,"callee":{"type":"Identifier","start":3892,"end":3899,"name":"session"},"arguments":[{"type":"Identifier","start":3900,"end":3914,"name":"sessionOptions"}]}]}},{"type":"ExpressionStatement","start":3918,"end":5027,"expression":{"type":"CallExpression","start":3918,"end":5027,"callee":{"type":"MemberExpression","start":3918,"end":3925,"object":{"type":"Identifier","start":3918,"end":3921,"name":"app"},"property":{"type":"Identifier","start":3922,"end":3925,"name":"use"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":3926,"end":5026,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":3927,"end":3930,"name":"req"},{"type":"Identifier","start":3932,"end":3935,"name":"res"},{"type":"Identifier","start":3937,"end":3941,"name":"next"}],"body":{"type":"BlockStatement","start":3946,"end":5026,"body":[{"type":"VariableDeclaration","start":3950,"end":4007,"declarations":[{"type":"VariableDeclarator","start":3956,"end":4007,"id":{"type":"Identifier","start":3956,"end":3964,"name":"protocol"},"init":{"type":"LogicalExpression","start":3967,"end":4007,"left":{"type":"MemberExpression","start":3967,"end":3997,"object":{"type":"MemberExpression","start":3967,"end":3978,"object":{"type":"Identifier","start":3967,"end":3974,"name":"process"},"property":{"type":"Identifier","start":3975,"end":3978,"name":"env"},"computed":false},"property":{"type":"Identifier","start":3979,"end":3997,"name":"COMPANION_PROTOCOL"},"computed":false},"operator":"||","right":{"type":"Literal","start":4001,"end":4007,"value":"http","raw":"'http'"}}}],"kind":"const"},{"type":"IfStatement","start":4223,"end":4805,"test":{"type":"MemberExpression","start":4227,"end":4263,"object":{"type":"MemberExpression","start":4227,"end":4238,"object":{"type":"Identifier","start":4227,"end":4234,"name":"process"},"property":{"type":"Identifier","start":4235,"end":4238,"name":"env"},"computed":false},"property":{"type":"Identifier","start":4239,"end":4263,"name":"COMPANION_CLIENT_ORIGINS"},"computed":false},"consequent":{"type":"BlockStatement","start":4265,"end":4718,"body":[{"type":"VariableDeclaration","start":4271,"end":4419,"declarations":[{"type":"VariableDeclarator","start":4277,"end":4419,"id":{"type":"Identifier","start":4277,"end":4286,"name":"whitelist"},"init":{"type":"CallExpression","start":4289,"end":4419,"callee":{"type":"MemberExpression","start":4289,"end":4354,"object":{"type":"CallExpression","start":4289,"end":4343,"callee":{"type":"MemberExpression","start":4289,"end":4338,"object":{"type":"MemberExpression","start":4289,"end":4325,"object":{"type":"MemberExpression","start":4289,"end":4300,"object":{"type":"Identifier","start":4289,"end":4296,"name":"process"},"property":{"type":"Identifier","start":4297,"end":4300,"name":"env"},"computed":false},"property":{"type":"Identifier","start":4301,"end":4325,"name":"COMPANION_CLIENT_ORIGINS"},"computed":false},"property":{"type":"Identifier","start":4333,"end":4338,"name":"split"},"computed":false},"arguments":[{"type":"Literal","start":4339,"end":4342,"value":",","raw":"','"}]},"property":{"type":"Identifier","start":4351,"end":4354,"name":"map"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":4355,"end":4418,"id":null,"expression":true,"generator":false,"async":false,"params":[{"type":"Identifier","start":4356,"end":4359,"name":"url"}],"body":{"type":"ConditionalExpression","start":4364,"end":4418,"test":{"type":"CallExpression","start":4364,"end":4387,"callee":{"type":"MemberExpression","start":4364,"end":4382,"object":{"type":"Identifier","start":4364,"end":4370,"name":"helper"},"property":{"type":"Identifier","start":4371,"end":4382,"name":"hasProtocol"},"computed":false},"arguments":[{"type":"Identifier","start":4383,"end":4386,"name":"url"}]},"consequent":{"type":"Identifier","start":4390,"end":4393,"name":"url"},"alternate":{"type":"TemplateLiteral","start":4396,"end":4418,"expressions":[{"type":"Identifier","start":4399,"end":4407,"name":"protocol"},{"type":"Identifier","start":4413,"end":4416,"name":"url"}],"quasis":[{"type":"TemplateElement","start":4397,"end":4397,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":4408,"end":4411,"value":{"raw":"://","cooked":"://"},"tail":false},{"type":"TemplateElement","start":4417,"end":4417,"value":{"raw":"","cooked":""},"tail":true}]}}}]}}],"kind":"const"},{"type":"IfStatement","start":4443,"end":4714,"test":{"type":"LogicalExpression","start":4447,"end":4511,"left":{"type":"MemberExpression","start":4447,"end":4465,"object":{"type":"MemberExpression","start":4447,"end":4458,"object":{"type":"Identifier","start":4447,"end":4450,"name":"req"},"property":{"type":"Identifier","start":4451,"end":4458,"name":"headers"},"computed":false},"property":{"type":"Identifier","start":4459,"end":4465,"name":"origin"},"computed":false},"operator":"&&","right":{"type":"BinaryExpression","start":4469,"end":4511,"left":{"type":"CallExpression","start":4469,"end":4506,"callee":{"type":"MemberExpression","start":4469,"end":4486,"object":{"type":"Identifier","start":4469,"end":4478,"name":"whitelist"},"property":{"type":"Identifier","start":4479,"end":4486,"name":"indexOf"},"computed":false},"arguments":[{"type":"MemberExpression","start":4487,"end":4505,"object":{"type":"MemberExpression","start":4487,"end":4498,"object":{"type":"Identifier","start":4487,"end":4490,"name":"req"},"property":{"type":"Identifier","start":4491,"end":4498,"name":"headers"},"computed":false},"property":{"type":"Identifier","start":4499,"end":4505,"name":"origin"},"computed":false}]},"operator":">","right":{"type":"UnaryExpression","start":4509,"end":4511,"operator":"-","prefix":true,"argument":{"type":"Literal","start":4510,"end":4511,"value":1,"raw":"1"}}}},"consequent":{"type":"BlockStatement","start":4513,"end":4714,"body":[{"type":"ExpressionStatement","start":4521,"end":4585,"expression":{"type":"CallExpression","start":4521,"end":4585,"callee":{"type":"MemberExpression","start":4521,"end":4534,"object":{"type":"Identifier","start":4521,"end":4524,"name":"res"},"property":{"type":"Identifier","start":4525,"end":4534,"name":"setHeader"},"computed":false},"arguments":[{"type":"Literal","start":4535,"end":4564,"value":"Access-Control-Allow-Origin","raw":"'Access-Control-Allow-Origin'"},{"type":"MemberExpression","start":4566,"end":4584,"object":{"type":"MemberExpression","start":4566,"end":4577,"object":{"type":"Identifier","start":4566,"end":4569,"name":"req"},"property":{"type":"Identifier","start":4570,"end":4577,"name":"headers"},"computed":false},"property":{"type":"Identifier","start":4578,"end":4584,"name":"origin"},"computed":false}]}},{"type":"ExpressionStatement","start":4651,"end":4708,"expression":{"type":"CallExpression","start":4651,"end":4708,"callee":{"type":"MemberExpression","start":4651,"end":4664,"object":{"type":"Identifier","start":4651,"end":4654,"name":"res"},"property":{"type":"Identifier","start":4655,"end":4664,"name":"setHeader"},"computed":false},"arguments":[{"type":"Literal","start":4665,"end":4699,"value":"Access-Control-Allow-Credentials","raw":"'Access-Control-Allow-Credentials'"},{"type":"Literal","start":4701,"end":4707,"value":"true","raw":"'true'"}]}}]},"alternate":null}]},"alternate":{"type":"BlockStatement","start":4724,"end":4805,"body":[{"type":"ExpressionStatement","start":4730,"end":4801,"expression":{"type":"CallExpression","start":4730,"end":4801,"callee":{"type":"MemberExpression","start":4730,"end":4743,"object":{"type":"Identifier","start":4730,"end":4733,"name":"res"},"property":{"type":"Identifier","start":4734,"end":4743,"name":"setHeader"},"computed":false},"arguments":[{"type":"Literal","start":4744,"end":4773,"value":"Access-Control-Allow-Origin","raw":"'Access-Control-Allow-Origin'"},{"type":"LogicalExpression","start":4775,"end":4800,"left":{"type":"MemberExpression","start":4775,"end":4793,"object":{"type":"MemberExpression","start":4775,"end":4786,"object":{"type":"Identifier","start":4775,"end":4778,"name":"req"},"property":{"type":"Identifier","start":4779,"end":4786,"name":"headers"},"computed":false},"property":{"type":"Identifier","start":4787,"end":4793,"name":"origin"},"computed":false},"operator":"||","right":{"type":"Literal","start":4797,"end":4800,"value":"*","raw":"'*'"}}]}}]}},{"type":"ExpressionStatement","start":4809,"end":4908,"expression":{"type":"CallExpression","start":4809,"end":4908,"callee":{"type":"MemberExpression","start":4809,"end":4822,"object":{"type":"Identifier","start":4809,"end":4812,"name":"res"},"property":{"type":"Identifier","start":4813,"end":4822,"name":"setHeader"},"computed":false},"arguments":[{"type":"Literal","start":4828,"end":4858,"value":"Access-Control-Allow-Methods","raw":"'Access-Control-Allow-Methods'"},{"type":"Literal","start":4864,"end":4904,"value":"GET, POST, OPTIONS, PUT, PATCH, DELETE","raw":"'GET, POST, OPTIONS, PUT, PATCH, DELETE'"}]}},{"type":"ExpressionStatement","start":4911,"end":5015,"expression":{"type":"CallExpression","start":4911,"end":5015,"callee":{"type":"MemberExpression","start":4911,"end":4924,"object":{"type":"Identifier","start":4911,"end":4914,"name":"res"},"property":{"type":"Identifier","start":4915,"end":4924,"name":"setHeader"},"computed":false},"arguments":[{"type":"Literal","start":4930,"end":4960,"value":"Access-Control-Allow-Headers","raw":"'Access-Control-Allow-Headers'"},{"type":"Literal","start":4966,"end":5011,"value":"Authorization, Origin, Content-Type, Accept","raw":"'Authorization, Origin, Content-Type, Accept'"}]}},{"type":"ExpressionStatement","start":5018,"end":5024,"expression":{"type":"CallExpression","start":5018,"end":5024,"callee":{"type":"Identifier","start":5018,"end":5022,"name":"next"},"arguments":[]}}]}}]}},{"type":"ExpressionStatement","start":5039,"end":5180,"expression":{"type":"CallExpression","start":5039,"end":5180,"callee":{"type":"MemberExpression","start":5039,"end":5046,"object":{"type":"Identifier","start":5039,"end":5042,"name":"app"},"property":{"type":"Identifier","start":5043,"end":5046,"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":5047,"end":5050,"value":"/","raw":"'/'"},{"type":"ArrowFunctionExpression","start":5052,"end":5179,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":5053,"end":5056,"name":"req"},{"type":"Identifier","start":5058,"end":5061,"name":"res"}],"body":{"type":"BlockStatement","start":5066,"end":5179,"body":[{"type":"ExpressionStatement","start":5070,"end":5113,"expression":{"type":"CallExpression","start":5070,"end":5113,"callee":{"type":"MemberExpression","start":5070,"end":5083,"object":{"type":"Identifier","start":5070,"end":5073,"name":"res"},"property":{"type":"Identifier","start":5074,"end":5083,"name":"setHeader"},"computed":false},"arguments":[{"type":"Literal","start":5084,"end":5098,"value":"Content-Type","raw":"'Content-Type'"},{"type":"Literal","start":5100,"end":5112,"value":"text/plain","raw":"'text/plain'"}]}},{"type":"ExpressionStatement","start":5116,"end":5177,"expression":{"type":"CallExpression","start":5116,"end":5177,"callee":{"type":"MemberExpression","start":5116,"end":5124,"object":{"type":"Identifier","start":5116,"end":5119,"name":"res"},"property":{"type":"Identifier","start":5120,"end":5124,"name":"send"},"computed":false},"arguments":[{"type":"CallExpression","start":5125,"end":5176,"callee":{"type":"MemberExpression","start":5125,"end":5158,"object":{"type":"Identifier","start":5125,"end":5131,"name":"helper"},"property":{"type":"Identifier","start":5132,"end":5158,"name":"buildHelpfulStartupMessage"},"computed":false},"arguments":[{"type":"Identifier","start":5159,"end":5175,"name":"companionOptions"}]}]}}]}}]}},{"type":"VariableDeclaration","start":5182,"end":5198,"declarations":[{"type":"VariableDeclarator","start":5186,"end":5198,"id":{"type":"Identifier","start":5186,"end":5198,"name":"companionApp"},"init":null}],"kind":"let"},{"type":"TryStatement","start":5199,"end":5371,"block":{"type":"BlockStatement","start":5203,"end":5281,"body":[{"type":"ExpressionStatement","start":5233,"end":5279,"expression":{"type":"AssignmentExpression","start":5233,"end":5279,"operator":"=","left":{"type":"Identifier","start":5233,"end":5245,"name":"companionApp"},"right":{"type":"CallExpression","start":5248,"end":5279,"callee":{"type":"MemberExpression","start":5248,"end":5261,"object":{"type":"Identifier","start":5248,"end":5257,"name":"companion"},"property":{"type":"Identifier","start":5258,"end":5261,"name":"app"},"computed":false},"arguments":[{"type":"Identifier","start":5262,"end":5278,"name":"companionOptions"}]}}}]},"handler":{"type":"CatchClause","start":5282,"end":5371,"param":{"type":"Identifier","start":5289,"end":5294,"name":"error"},"body":{"type":"BlockStatement","start":5296,"end":5371,"body":[{"type":"ExpressionStatement","start":5300,"end":5351,"expression":{"type":"CallExpression","start":5300,"end":5351,"callee":{"type":"MemberExpression","start":5300,"end":5313,"object":{"type":"Identifier","start":5300,"end":5307,"name":"console"},"property":{"type":"Identifier","start":5308,"end":5313,"name":"error"},"computed":false},"arguments":[{"type":"Literal","start":5314,"end":5324,"value":"\u001b[31m","raw":"'\\x1b[31m'"},{"type":"MemberExpression","start":5326,"end":5339,"object":{"type":"Identifier","start":5326,"end":5331,"name":"error"},"property":{"type":"Identifier","start":5332,"end":5339,"name":"message"},"computed":false},{"type":"Literal","start":5341,"end":5350,"value":"\u001b[0m","raw":"'\\x1b[0m'"}]}},{"type":"ExpressionStatement","start":5354,"end":5369,"expression":{"type":"CallExpression","start":5354,"end":5369,"callee":{"type":"MemberExpression","start":5354,"end":5366,"object":{"type":"Identifier","start":5354,"end":5361,"name":"process"},"property":{"type":"Identifier","start":5362,"end":5366,"name":"exit"},"computed":false},"arguments":[{"type":"Literal","start":5367,"end":5368,"value":1,"raw":"1"}]}}]}},"finalizer":null},{"type":"IfStatement","start":5411,"end":5531,"test":{"type":"MemberExpression","start":5415,"end":5441,"object":{"type":"MemberExpression","start":5415,"end":5426,"object":{"type":"Identifier","start":5415,"end":5422,"name":"process"},"property":{"type":"Identifier","start":5423,"end":5426,"name":"env"},"computed":false},"property":{"type":"Identifier","start":5427,"end":5441,"name":"COMPANION_PATH"},"computed":false},"consequent":{"type":"BlockStatement","start":5443,"end":5498,"body":[{"type":"ExpressionStatement","start":5447,"end":5496,"expression":{"type":"CallExpression","start":5447,"end":5496,"callee":{"type":"MemberExpression","start":5447,"end":5454,"object":{"type":"Identifier","start":5447,"end":5450,"name":"app"},"property":{"type":"Identifier","start":5451,"end":5454,"name":"use"},"computed":false},"arguments":[{"type":"MemberExpression","start":5455,"end":5481,"object":{"type":"MemberExpression","start":5455,"end":5466,"object":{"type":"Identifier","start":5455,"end":5462,"name":"process"},"property":{"type":"Identifier","start":5463,"end":5466,"name":"env"},"computed":false},"property":{"type":"Identifier","start":5467,"end":5481,"name":"COMPANION_PATH"},"computed":false},{"type":"Identifier","start":5483,"end":5495,"name":"companionApp"}]}}]},"alternate":{"type":"BlockStatement","start":5504,"end":5531,"body":[{"type":"ExpressionStatement","start":5508,"end":5529,"expression":{"type":"CallExpression","start":5508,"end":5529,"callee":{"type":"MemberExpression","start":5508,"end":5515,"object":{"type":"Identifier","start":5508,"end":5511,"name":"app"},"property":{"type":"Identifier","start":5512,"end":5515,"name":"use"},"computed":false},"arguments":[{"type":"Identifier","start":5516,"end":5528,"name":"companionApp"}]}}]}},{"type":"IfStatement","start":5969,"end":6672,"test":{"type":"LogicalExpression","start":5973,"end":6070,"left":{"type":"BinaryExpression","start":5973,"end":6032,"left":{"type":"MemberExpression","start":5973,"end":6021,"object":{"type":"MemberExpression","start":5973,"end":5984,"object":{"type":"Identifier","start":5973,"end":5980,"name":"process"},"property":{"type":"Identifier","start":5981,"end":5984,"name":"env"},"computed":false},"property":{"type":"Identifier","start":5985,"end":6021,"name":"COMPANION_ONEDRIVE_DOMAIN_VALIDATION"},"computed":false},"operator":"===","right":{"type":"Literal","start":6026,"end":6032,"value":"true","raw":"'true'"}},"operator":"&&","right":{"type":"MemberExpression","start":6036,"end":6070,"object":{"type":"MemberExpression","start":6036,"end":6047,"object":{"type":"Identifier","start":6036,"end":6043,"name":"process"},"property":{"type":"Identifier","start":6044,"end":6047,"name":"env"},"computed":false},"property":{"type":"Identifier","start":6048,"end":6070,"name":"COMPANION_ONEDRIVE_KEY"},"computed":false}},"consequent":{"type":"BlockStatement","start":6072,"end":6672,"body":[{"type":"ExpressionStatement","start":6076,"end":6670,"expression":{"type":"CallExpression","start":6076,"end":6670,"callee":{"type":"MemberExpression","start":6076,"end":6083,"object":{"type":"Identifier","start":6076,"end":6079,"name":"app"},"property":{"type":"Identifier","start":6080,"end":6083,"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":6084,"end":6134,"value":"/.well-known/microsoft-identity-association.json","raw":"'/.well-known/microsoft-identity-association.json'"},{"type":"ArrowFunctionExpression","start":6136,"end":6669,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":6137,"end":6140,"name":"req"},{"type":"Identifier","start":6142,"end":6145,"name":"res"}],"body":{"type":"BlockStatement","start":6150,"end":6669,"body":[{"type":"VariableDeclaration","start":6156,"end":6297,"declarations":[{"type":"VariableDeclarator","start":6162,"end":6297,"id":{"type":"Identifier","start":6162,"end":6169,"name":"content"},"init":{"type":"CallExpression","start":6172,"end":6297,"callee":{"type":"MemberExpression","start":6172,"end":6186,"object":{"type":"Identifier","start":6172,"end":6176,"name":"JSON"},"property":{"type":"Identifier","start":6177,"end":6186,"name":"stringify"},"computed":false},"arguments":[{"type":"ObjectExpression","start":6187,"end":6296,"properties":[{"type":"Property","start":6195,"end":6290,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6195,"end":6217,"name":"associatedApplications"},"value":{"type":"ArrayExpression","start":6219,"end":6290,"elements":[{"type":"ObjectExpression","start":6229,"end":6282,"properties":[{"type":"Property","start":6231,"end":6280,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6231,"end":6244,"name":"applicationId"},"value":{"type":"MemberExpression","start":6246,"end":6280,"object":{"type":"MemberExpression","start":6246,"end":6257,"object":{"type":"Identifier","start":6246,"end":6253,"name":"process"},"property":{"type":"Identifier","start":6254,"end":6257,"name":"env"},"computed":false},"property":{"type":"Identifier","start":6258,"end":6280,"name":"COMPANION_ONEDRIVE_KEY"},"computed":false},"kind":"init"}]}]},"kind":"init"}]}]}}],"kind":"const"},{"type":"ExpressionStatement","start":6302,"end":6371,"expression":{"type":"CallExpression","start":6302,"end":6371,"callee":{"type":"MemberExpression","start":6302,"end":6312,"object":{"type":"Identifier","start":6302,"end":6305,"name":"res"},"property":{"type":"Identifier","start":6306,"end":6312,"name":"header"},"computed":false},"arguments":[{"type":"Literal","start":6313,"end":6329,"value":"Content-Length","raw":"'Content-Length'"},{"type":"TemplateLiteral","start":6331,"end":6370,"expressions":[{"type":"CallExpression","start":6334,"end":6368,"callee":{"type":"MemberExpression","start":6334,"end":6351,"object":{"type":"Identifier","start":6334,"end":6340,"name":"Buffer"},"property":{"type":"Identifier","start":6341,"end":6351,"name":"byteLength"},"computed":false},"arguments":[{"type":"Identifier","start":6352,"end":6359,"name":"content"},{"type":"Literal","start":6361,"end":6367,"value":"utf8","raw":"'utf8'"}]}],"quasis":[{"type":"TemplateElement","start":6332,"end":6332,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":6369,"end":6369,"value":{"raw":"","cooked":""},"tail":true}]}]}},{"type":"ExpressionStatement","start":6570,"end":6628,"expression":{"type":"CallExpression","start":6570,"end":6628,"callee":{"type":"MemberExpression","start":6570,"end":6583,"object":{"type":"Identifier","start":6570,"end":6573,"name":"res"},"property":{"type":"Identifier","start":6574,"end":6583,"name":"writeHead"},"computed":false},"arguments":[{"type":"Literal","start":6584,"end":6587,"value":200,"raw":"200"},{"type":"ObjectExpression","start":6589,"end":6627,"properties":[{"type":"Property","start":6591,"end":6625,"method":false,"shorthand":false,"computed":false,"key":{"type":"Literal","start":6591,"end":6605,"value":"Content-Type","raw":"'Content-Type'"},"value":{"type":"Literal","start":6607,"end":6625,"value":"application/json","raw":"'application/json'"},"kind":"init"}]}]}},{"type":"ExpressionStatement","start":6633,"end":6651,"expression":{"type":"CallExpression","start":6633,"end":6651,"callee":{"type":"MemberExpression","start":6633,"end":6642,"object":{"type":"Identifier","start":6633,"end":6636,"name":"res"},"property":{"type":"Identifier","start":6637,"end":6642,"name":"write"},"computed":false},"arguments":[{"type":"Identifier","start":6643,"end":6650,"name":"content"}]}},{"type":"ExpressionStatement","start":6656,"end":6665,"expression":{"type":"CallExpression","start":6656,"end":6665,"callee":{"type":"MemberExpression","start":6656,"end":6663,"object":{"type":"Identifier","start":6656,"end":6659,"name":"res"},"property":{"type":"Identifier","start":6660,"end":6663,"name":"end"},"computed":false},"arguments":[]}}]}}]}}]},"alternate":null},{"type":"ExpressionStatement","start":6674,"end":6762,"expression":{"type":"CallExpression","start":6674,"end":6762,"callee":{"type":"MemberExpression","start":6674,"end":6681,"object":{"type":"Identifier","start":6674,"end":6677,"name":"app"},"property":{"type":"Identifier","start":6678,"end":6681,"name":"use"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":6682,"end":6761,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":6683,"end":6686,"name":"req"},{"type":"Identifier","start":6688,"end":6691,"name":"res"},{"type":"Identifier","start":6693,"end":6697,"name":"next"}],"body":{"type":"BlockStatement","start":6702,"end":6761,"body":[{"type":"ReturnStatement","start":6706,"end":6759,"argument":{"type":"CallExpression","start":6713,"end":6759,"callee":{"type":"MemberExpression","start":6713,"end":6733,"object":{"type":"CallExpression","start":6713,"end":6728,"callee":{"type":"MemberExpression","start":6713,"end":6723,"object":{"type":"Identifier","start":6713,"end":6716,"name":"res"},"property":{"type":"Identifier","start":6717,"end":6723,"name":"status"},"computed":false},"arguments":[{"type":"Literal","start":6724,"end":6727,"value":404,"raw":"404"}]},"property":{"type":"Identifier","start":6729,"end":6733,"name":"json"},"computed":false},"arguments":[{"type":"ObjectExpression","start":6734,"end":6758,"properties":[{"type":"Property","start":6736,"end":6756,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6736,"end":6743,"name":"message"},"value":{"type":"Literal","start":6745,"end":6756,"value":"Not Found","raw":"'Not Found'"},"kind":"init"}]}]}}]}}]}},{"type":"ExpressionStatement","start":6778,"end":7469,"expression":{"type":"CallExpression","start":6778,"end":7469,"callee":{"type":"MemberExpression","start":6778,"end":6785,"object":{"type":"Identifier","start":6778,"end":6781,"name":"app"},"property":{"type":"Identifier","start":6782,"end":6785,"name":"use"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":6786,"end":7468,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":6787,"end":6790,"name":"err"},{"type":"Identifier","start":6792,"end":6795,"name":"req"},{"type":"Identifier","start":6797,"end":6800,"name":"res"},{"type":"Identifier","start":6802,"end":6806,"name":"next"}],"body":{"type":"BlockStatement","start":6811,"end":7468,"body":[{"type":"VariableDeclaration","start":6815,"end":6841,"declarations":[{"type":"VariableDeclarator","start":6821,"end":6841,"id":{"type":"Identifier","start":6821,"end":6834,"name":"logStackTrace"},"init":{"type":"Literal","start":6837,"end":6841,"value":true,"raw":"true"}}],"kind":"const"},{"type":"IfStatement","start":6844,"end":7466,"test":{"type":"BinaryExpression","start":6848,"end":6879,"left":{"type":"CallExpression","start":6848,"end":6862,"callee":{"type":"MemberExpression","start":6848,"end":6855,"object":{"type":"Identifier","start":6848,"end":6851,"name":"app"},"property":{"type":"Identifier","start":6852,"end":6855,"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":6856,"end":6861,"value":"env","raw":"'env'"}]},"operator":"===","right":{"type":"Literal","start":6867,"end":6879,"value":"production","raw":"'production'"}},"consequent":{"type":"BlockStatement","start":6881,"end":7300,"body":[{"type":"IfStatement","start":7015,"end":7201,"test":{"type":"LogicalExpression","start":7019,"end":7064,"left":{"type":"BinaryExpression","start":7019,"end":7037,"left":{"type":"MemberExpression","start":7019,"end":7029,"object":{"type":"Identifier","start":7019,"end":7022,"name":"err"},"property":{"type":"Identifier","start":7023,"end":7029,"name":"status"},"computed":false},"operator":"===","right":{"type":"Literal","start":7034,"end":7037,"value":400,"raw":"400"}},"operator":"&&","right":{"type":"BinaryExpression","start":7041,"end":7064,"left":{"type":"Identifier","start":7041,"end":7044,"name":"err"},"operator":"instanceof","right":{"type":"Identifier","start":7056,"end":7064,"name":"URIError"}}},"consequent":{"type":"BlockStatement","start":7066,"end":7127,"body":[{"type":"ExpressionStatement","start":7074,"end":7121,"expression":{"type":"CallExpression","start":7074,"end":7121,"callee":{"type":"MemberExpression","start":7074,"end":7086,"object":{"type":"Identifier","start":7074,"end":7080,"name":"logger"},"property":{"type":"Identifier","start":7081,"end":7086,"name":"error"},"computed":false},"arguments":[{"type":"MemberExpression","start":7087,"end":7098,"object":{"type":"Identifier","start":7087,"end":7090,"name":"err"},"property":{"type":"Identifier","start":7091,"end":7098,"name":"message"},"computed":false},{"type":"Literal","start":7100,"end":7112,"value":"root.error","raw":"'root.error'"},{"type":"MemberExpression","start":7114,"end":7120,"object":{"type":"Identifier","start":7114,"end":7117,"name":"req"},"property":{"type":"Identifier","start":7118,"end":7120,"name":"id"},"computed":false}]}}]},"alternate":{"type":"BlockStatement","start":7133,"end":7201,"body":[{"type":"ExpressionStatement","start":7141,"end":7195,"expression":{"type":"CallExpression","start":7141,"end":7195,"callee":{"type":"MemberExpression","start":7141,"end":7153,"object":{"type":"Identifier","start":7141,"end":7147,"name":"logger"},"property":{"type":"Identifier","start":7148,"end":7153,"name":"error"},"computed":false},"arguments":[{"type":"Identifier","start":7154,"end":7157,"name":"err"},{"type":"Literal","start":7159,"end":7171,"value":"root.error","raw":"'root.error'"},{"type":"MemberExpression","start":7173,"end":7179,"object":{"type":"Identifier","start":7173,"end":7176,"name":"req"},"property":{"type":"Identifier","start":7177,"end":7179,"name":"id"},"computed":false},{"type":"Identifier","start":7181,"end":7194,"name":"logStackTrace"}]}}]}},{"type":"ExpressionStatement","start":7206,"end":7296,"expression":{"type":"CallExpression","start":7206,"end":7296,"callee":{"type":"MemberExpression","start":7206,"end":7240,"object":{"type":"CallExpression","start":7206,"end":7235,"callee":{"type":"MemberExpression","start":7206,"end":7216,"object":{"type":"Identifier","start":7206,"end":7209,"name":"res"},"property":{"type":"Identifier","start":7210,"end":7216,"name":"status"},"computed":false},"arguments":[{"type":"LogicalExpression","start":7217,"end":7234,"left":{"type":"MemberExpression","start":7217,"end":7227,"object":{"type":"Identifier","start":7217,"end":7220,"name":"err"},"property":{"type":"Identifier","start":7221,"end":7227,"name":"status"},"computed":false},"operator":"||","right":{"type":"Literal","start":7231,"end":7234,"value":500,"raw":"500"}}]},"property":{"type":"Identifier","start":7236,"end":7240,"name":"json"},"computed":false},"arguments":[{"type":"ObjectExpression","start":7241,"end":7295,"properties":[{"type":"Property","start":7243,"end":7274,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7243,"end":7250,"name":"message"},"value":{"type":"Literal","start":7252,"end":7274,"value":"Something went wrong","raw":"'Something went wrong'"},"kind":"init"},{"type":"Property","start":7276,"end":7293,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7276,"end":7285,"name":"requestId"},"value":{"type":"MemberExpression","start":7287,"end":7293,"object":{"type":"Identifier","start":7287,"end":7290,"name":"req"},"property":{"type":"Identifier","start":7291,"end":7293,"name":"id"},"computed":false},"kind":"init"}]}]}}]},"alternate":{"type":"BlockStatement","start":7306,"end":7466,"body":[{"type":"ExpressionStatement","start":7312,"end":7366,"expression":{"type":"CallExpression","start":7312,"end":7366,"callee":{"type":"MemberExpression","start":7312,"end":7324,"object":{"type":"Identifier","start":7312,"end":7318,"name":"logger"},"property":{"type":"Identifier","start":7319,"end":7324,"name":"error"},"computed":false},"arguments":[{"type":"Identifier","start":7325,"end":7328,"name":"err"},{"type":"Literal","start":7330,"end":7342,"value":"root.error","raw":"'root.error'"},{"type":"MemberExpression","start":7344,"end":7350,"object":{"type":"Identifier","start":7344,"end":7347,"name":"req"},"property":{"type":"Identifier","start":7348,"end":7350,"name":"id"},"computed":false},{"type":"Identifier","start":7352,"end":7365,"name":"logStackTrace"}]}},{"type":"ExpressionStatement","start":7371,"end":7462,"expression":{"type":"CallExpression","start":7371,"end":7462,"callee":{"type":"MemberExpression","start":7371,"end":7405,"object":{"type":"CallExpression","start":7371,"end":7400,"callee":{"type":"MemberExpression","start":7371,"end":7381,"object":{"type":"Identifier","start":7371,"end":7374,"name":"res"},"property":{"type":"Identifier","start":7375,"end":7381,"name":"status"},"computed":false},"arguments":[{"type":"LogicalExpression","start":7382,"end":7399,"left":{"type":"MemberExpression","start":7382,"end":7392,"object":{"type":"Identifier","start":7382,"end":7385,"name":"err"},"property":{"type":"Identifier","start":7386,"end":7392,"name":"status"},"computed":false},"operator":"||","right":{"type":"Literal","start":7396,"end":7399,"value":500,"raw":"500"}}]},"property":{"type":"Identifier","start":7401,"end":7405,"name":"json"},"computed":false},"arguments":[{"type":"ObjectExpression","start":7406,"end":7461,"properties":[{"type":"Property","start":7408,"end":7428,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7408,"end":7415,"name":"message"},"value":{"type":"MemberExpression","start":7417,"end":7428,"object":{"type":"Identifier","start":7417,"end":7420,"name":"err"},"property":{"type":"Identifier","start":7421,"end":7428,"name":"message"},"computed":false},"kind":"init"},{"type":"Property","start":7430,"end":7440,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7430,"end":7435,"name":"error"},"value":{"type":"Identifier","start":7437,"end":7440,"name":"err"},"kind":"init"},{"type":"Property","start":7442,"end":7459,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7442,"end":7451,"name":"requestId"},"value":{"type":"MemberExpression","start":7453,"end":7459,"object":{"type":"Identifier","start":7453,"end":7456,"name":"req"},"property":{"type":"Identifier","start":7457,"end":7459,"name":"id"},"computed":false},"kind":"init"}]}]}}]}}]}}]}},{"type":"ExpressionStatement","start":7471,"end":7513,"expression":{"type":"AssignmentExpression","start":7471,"end":7513,"operator":"=","left":{"type":"MemberExpression","start":7471,"end":7485,"object":{"type":"Identifier","start":7471,"end":7477,"name":"module"},"property":{"type":"Identifier","start":7478,"end":7485,"name":"exports"},"computed":false},"right":{"type":"ObjectExpression","start":7488,"end":7513,"properties":[{"type":"Property","start":7490,"end":7493,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":7490,"end":7493,"name":"app"},"kind":"init","value":{"type":"Identifier","start":7490,"end":7493,"name":"app"}},{"type":"Property","start":7495,"end":7511,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":7495,"end":7511,"name":"companionOptions"},"kind":"init","value":{"type":"Identifier","start":7495,"end":7511,"name":"companionOptions"}}]}}}],"sourceType":"script"}