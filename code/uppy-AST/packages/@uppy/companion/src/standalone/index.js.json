{"type":"Program","start":0,"end":7514,"loc":{"start":{"line":1,"column":0},"end":{"line":225,"column":0}},"body":[{"type":"VariableDeclaration","start":0,"end":34,"loc":{"start":{"line":1,"column":0},"end":{"line":1,"column":34}},"declarations":[{"type":"VariableDeclarator","start":6,"end":34,"loc":{"start":{"line":1,"column":6},"end":{"line":1,"column":34}},"id":{"type":"Identifier","start":6,"end":13,"loc":{"start":{"line":1,"column":6},"end":{"line":1,"column":13}},"name":"express"},"init":{"type":"CallExpression","start":16,"end":34,"loc":{"start":{"line":1,"column":16},"end":{"line":1,"column":34}},"callee":{"type":"Identifier","start":16,"end":23,"loc":{"start":{"line":1,"column":16},"end":{"line":1,"column":23}},"name":"require"},"arguments":[{"type":"Literal","start":24,"end":33,"loc":{"start":{"line":1,"column":24},"end":{"line":1,"column":33}},"value":"express","raw":"'express'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":35,"end":68,"loc":{"start":{"line":2,"column":0},"end":{"line":2,"column":33}},"declarations":[{"type":"VariableDeclarator","start":41,"end":68,"loc":{"start":{"line":2,"column":6},"end":{"line":2,"column":33}},"id":{"type":"Identifier","start":41,"end":43,"loc":{"start":{"line":2,"column":6},"end":{"line":2,"column":8}},"name":"qs"},"init":{"type":"CallExpression","start":46,"end":68,"loc":{"start":{"line":2,"column":11},"end":{"line":2,"column":33}},"callee":{"type":"Identifier","start":46,"end":53,"loc":{"start":{"line":2,"column":11},"end":{"line":2,"column":18}},"name":"require"},"arguments":[{"type":"Literal","start":54,"end":67,"loc":{"start":{"line":2,"column":19},"end":{"line":2,"column":32}},"value":"querystring","raw":"'querystring'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":69,"end":110,"loc":{"start":{"line":3,"column":0},"end":{"line":3,"column":41}},"declarations":[{"type":"VariableDeclarator","start":75,"end":110,"loc":{"start":{"line":3,"column":6},"end":{"line":3,"column":41}},"id":{"type":"Identifier","start":75,"end":84,"loc":{"start":{"line":3,"column":6},"end":{"line":3,"column":15}},"name":"companion"},"init":{"type":"CallExpression","start":87,"end":110,"loc":{"start":{"line":3,"column":18},"end":{"line":3,"column":41}},"callee":{"type":"Identifier","start":87,"end":94,"loc":{"start":{"line":3,"column":18},"end":{"line":3,"column":25}},"name":"require"},"arguments":[{"type":"Literal","start":95,"end":109,"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":40}},"value":"../companion","raw":"'../companion'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":111,"end":143,"loc":{"start":{"line":4,"column":0},"end":{"line":4,"column":32}},"declarations":[{"type":"VariableDeclarator","start":117,"end":143,"loc":{"start":{"line":4,"column":6},"end":{"line":4,"column":32}},"id":{"type":"Identifier","start":117,"end":123,"loc":{"start":{"line":4,"column":6},"end":{"line":4,"column":12}},"name":"helmet"},"init":{"type":"CallExpression","start":126,"end":143,"loc":{"start":{"line":4,"column":15},"end":{"line":4,"column":32}},"callee":{"type":"Identifier","start":126,"end":133,"loc":{"start":{"line":4,"column":15},"end":{"line":4,"column":22}},"name":"require"},"arguments":[{"type":"Literal","start":134,"end":142,"loc":{"start":{"line":4,"column":23},"end":{"line":4,"column":31}},"value":"helmet","raw":"'helmet'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":144,"end":176,"loc":{"start":{"line":5,"column":0},"end":{"line":5,"column":32}},"declarations":[{"type":"VariableDeclarator","start":150,"end":176,"loc":{"start":{"line":5,"column":6},"end":{"line":5,"column":32}},"id":{"type":"Identifier","start":150,"end":156,"loc":{"start":{"line":5,"column":6},"end":{"line":5,"column":12}},"name":"morgan"},"init":{"type":"CallExpression","start":159,"end":176,"loc":{"start":{"line":5,"column":15},"end":{"line":5,"column":32}},"callee":{"type":"Identifier","start":159,"end":166,"loc":{"start":{"line":5,"column":15},"end":{"line":5,"column":22}},"name":"require"},"arguments":[{"type":"Literal","start":167,"end":175,"loc":{"start":{"line":5,"column":23},"end":{"line":5,"column":31}},"value":"morgan","raw":"'morgan'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":177,"end":218,"loc":{"start":{"line":6,"column":0},"end":{"line":6,"column":41}},"declarations":[{"type":"VariableDeclarator","start":183,"end":218,"loc":{"start":{"line":6,"column":6},"end":{"line":6,"column":41}},"id":{"type":"Identifier","start":183,"end":193,"loc":{"start":{"line":6,"column":6},"end":{"line":6,"column":16}},"name":"bodyParser"},"init":{"type":"CallExpression","start":196,"end":218,"loc":{"start":{"line":6,"column":19},"end":{"line":6,"column":41}},"callee":{"type":"Identifier","start":196,"end":203,"loc":{"start":{"line":6,"column":19},"end":{"line":6,"column":26}},"name":"require"},"arguments":[{"type":"Literal","start":204,"end":217,"loc":{"start":{"line":6,"column":27},"end":{"line":6,"column":40}},"value":"body-parser","raw":"'body-parser'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":219,"end":259,"loc":{"start":{"line":7,"column":0},"end":{"line":7,"column":40}},"declarations":[{"type":"VariableDeclarator","start":225,"end":259,"loc":{"start":{"line":7,"column":6},"end":{"line":7,"column":40}},"id":{"type":"Identifier","start":225,"end":230,"loc":{"start":{"line":7,"column":6},"end":{"line":7,"column":11}},"name":"redis"},"init":{"type":"CallExpression","start":233,"end":259,"loc":{"start":{"line":7,"column":14},"end":{"line":7,"column":40}},"callee":{"type":"Identifier","start":233,"end":240,"loc":{"start":{"line":7,"column":14},"end":{"line":7,"column":21}},"name":"require"},"arguments":[{"type":"Literal","start":241,"end":258,"loc":{"start":{"line":7,"column":22},"end":{"line":7,"column":39}},"value":"../server/redis","raw":"'../server/redis'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":260,"end":302,"loc":{"start":{"line":8,"column":0},"end":{"line":8,"column":42}},"declarations":[{"type":"VariableDeclarator","start":266,"end":302,"loc":{"start":{"line":8,"column":6},"end":{"line":8,"column":42}},"id":{"type":"Identifier","start":266,"end":272,"loc":{"start":{"line":8,"column":6},"end":{"line":8,"column":12}},"name":"logger"},"init":{"type":"CallExpression","start":275,"end":302,"loc":{"start":{"line":8,"column":15},"end":{"line":8,"column":42}},"callee":{"type":"Identifier","start":275,"end":282,"loc":{"start":{"line":8,"column":15},"end":{"line":8,"column":22}},"name":"require"},"arguments":[{"type":"Literal","start":283,"end":301,"loc":{"start":{"line":8,"column":23},"end":{"line":8,"column":41}},"value":"../server/logger","raw":"'../server/logger'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":303,"end":358,"loc":{"start":{"line":9,"column":0},"end":{"line":9,"column":55}},"declarations":[{"type":"VariableDeclarator","start":309,"end":358,"loc":{"start":{"line":9,"column":6},"end":{"line":9,"column":55}},"id":{"type":"ObjectPattern","start":309,"end":321,"loc":{"start":{"line":9,"column":6},"end":{"line":9,"column":18}},"properties":[{"type":"Property","start":311,"end":319,"loc":{"start":{"line":9,"column":8},"end":{"line":9,"column":16}},"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":311,"end":319,"loc":{"start":{"line":9,"column":8},"end":{"line":9,"column":16}},"name":"parseURL"},"kind":"init","value":{"type":"Identifier","start":311,"end":319,"loc":{"start":{"line":9,"column":8},"end":{"line":9,"column":16}},"name":"parseURL"}}]},"init":{"type":"CallExpression","start":324,"end":358,"loc":{"start":{"line":9,"column":21},"end":{"line":9,"column":55}},"callee":{"type":"Identifier","start":324,"end":331,"loc":{"start":{"line":9,"column":21},"end":{"line":9,"column":28}},"name":"require"},"arguments":[{"type":"Literal","start":332,"end":357,"loc":{"start":{"line":9,"column":29},"end":{"line":9,"column":54}},"value":"../server/helpers/utils","raw":"'../server/helpers/utils'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":359,"end":396,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":37}},"declarations":[{"type":"VariableDeclarator","start":365,"end":396,"loc":{"start":{"line":10,"column":6},"end":{"line":10,"column":37}},"id":{"type":"Identifier","start":365,"end":370,"loc":{"start":{"line":10,"column":6},"end":{"line":10,"column":11}},"name":"merge"},"init":{"type":"CallExpression","start":373,"end":396,"loc":{"start":{"line":10,"column":14},"end":{"line":10,"column":37}},"callee":{"type":"Identifier","start":373,"end":380,"loc":{"start":{"line":10,"column":14},"end":{"line":10,"column":21}},"name":"require"},"arguments":[{"type":"Literal","start":381,"end":395,"loc":{"start":{"line":10,"column":22},"end":{"line":10,"column":36}},"value":"lodash.merge","raw":"'lodash.merge'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":411,"end":460,"loc":{"start":{"line":12,"column":0},"end":{"line":12,"column":49}},"declarations":[{"type":"VariableDeclarator","start":417,"end":460,"loc":{"start":{"line":12,"column":6},"end":{"line":12,"column":49}},"id":{"type":"Identifier","start":417,"end":427,"loc":{"start":{"line":12,"column":6},"end":{"line":12,"column":16}},"name":"promBundle"},"init":{"type":"CallExpression","start":430,"end":460,"loc":{"start":{"line":12,"column":19},"end":{"line":12,"column":49}},"callee":{"type":"Identifier","start":430,"end":437,"loc":{"start":{"line":12,"column":19},"end":{"line":12,"column":26}},"name":"require"},"arguments":[{"type":"Literal","start":438,"end":459,"loc":{"start":{"line":12,"column":27},"end":{"line":12,"column":48}},"value":"express-prom-bundle","raw":"'express-prom-bundle'"}]}}],"kind":"const","comments":[{"type":"Line","value":" @ts-ignore","start":397,"end":410,"loc":{"start":{"line":11,"column":0},"end":{"line":11,"column":13}}}]},{"type":"VariableDeclaration","start":461,"end":503,"loc":{"start":{"line":13,"column":0},"end":{"line":13,"column":42}},"declarations":[{"type":"VariableDeclarator","start":467,"end":503,"loc":{"start":{"line":13,"column":6},"end":{"line":13,"column":42}},"id":{"type":"Identifier","start":467,"end":474,"loc":{"start":{"line":13,"column":6},"end":{"line":13,"column":13}},"name":"session"},"init":{"type":"CallExpression","start":477,"end":503,"loc":{"start":{"line":13,"column":16},"end":{"line":13,"column":42}},"callee":{"type":"Identifier","start":477,"end":484,"loc":{"start":{"line":13,"column":16},"end":{"line":13,"column":23}},"name":"require"},"arguments":[{"type":"Literal","start":485,"end":502,"loc":{"start":{"line":13,"column":24},"end":{"line":13,"column":41}},"value":"express-session","raw":"'express-session'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":504,"end":556,"loc":{"start":{"line":14,"column":0},"end":{"line":14,"column":52}},"declarations":[{"type":"VariableDeclarator","start":510,"end":556,"loc":{"start":{"line":14,"column":6},"end":{"line":14,"column":52}},"id":{"type":"Identifier","start":510,"end":522,"loc":{"start":{"line":14,"column":6},"end":{"line":14,"column":18}},"name":"addRequestId"},"init":{"type":"CallExpression","start":525,"end":556,"loc":{"start":{"line":14,"column":21},"end":{"line":14,"column":52}},"callee":{"type":"CallExpression","start":525,"end":554,"loc":{"start":{"line":14,"column":21},"end":{"line":14,"column":50}},"callee":{"type":"Identifier","start":525,"end":532,"loc":{"start":{"line":14,"column":21},"end":{"line":14,"column":28}},"name":"require"},"arguments":[{"type":"Literal","start":533,"end":553,"loc":{"start":{"line":14,"column":29},"end":{"line":14,"column":49}},"value":"express-request-id","raw":"'express-request-id'"}]},"arguments":[]}}],"kind":"const"},{"type":"VariableDeclaration","start":557,"end":591,"loc":{"start":{"line":15,"column":0},"end":{"line":15,"column":34}},"declarations":[{"type":"VariableDeclarator","start":563,"end":591,"loc":{"start":{"line":15,"column":6},"end":{"line":15,"column":34}},"id":{"type":"Identifier","start":563,"end":569,"loc":{"start":{"line":15,"column":6},"end":{"line":15,"column":12}},"name":"helper"},"init":{"type":"CallExpression","start":572,"end":591,"loc":{"start":{"line":15,"column":15},"end":{"line":15,"column":34}},"callee":{"type":"Identifier","start":572,"end":579,"loc":{"start":{"line":15,"column":15},"end":{"line":15,"column":22}},"name":"require"},"arguments":[{"type":"Literal","start":580,"end":590,"loc":{"start":{"line":15,"column":23},"end":{"line":15,"column":33}},"value":"./helper","raw":"'./helper'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":606,"end":655,"loc":{"start":{"line":17,"column":0},"end":{"line":17,"column":49}},"declarations":[{"type":"VariableDeclarator","start":612,"end":655,"loc":{"start":{"line":17,"column":6},"end":{"line":17,"column":49}},"id":{"type":"ObjectPattern","start":612,"end":623,"loc":{"start":{"line":17,"column":6},"end":{"line":17,"column":17}},"properties":[{"type":"Property","start":614,"end":621,"loc":{"start":{"line":17,"column":8},"end":{"line":17,"column":15}},"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":614,"end":621,"loc":{"start":{"line":17,"column":8},"end":{"line":17,"column":15}},"name":"version"},"kind":"init","value":{"type":"Identifier","start":614,"end":621,"loc":{"start":{"line":17,"column":8},"end":{"line":17,"column":15}},"name":"version"}}]},"init":{"type":"CallExpression","start":626,"end":655,"loc":{"start":{"line":17,"column":20},"end":{"line":17,"column":49}},"callee":{"type":"Identifier","start":626,"end":633,"loc":{"start":{"line":17,"column":20},"end":{"line":17,"column":27}},"name":"require"},"arguments":[{"type":"Literal","start":634,"end":654,"loc":{"start":{"line":17,"column":28},"end":{"line":17,"column":48}},"value":"../../package.json","raw":"'../../package.json'"}]}}],"kind":"const","comments":[{"type":"Line","value":" @ts-ignore","start":592,"end":605,"loc":{"start":{"line":16,"column":0},"end":{"line":16,"column":13}}}]},{"type":"VariableDeclaration","start":657,"end":678,"loc":{"start":{"line":19,"column":0},"end":{"line":19,"column":21}},"declarations":[{"type":"VariableDeclarator","start":663,"end":678,"loc":{"start":{"line":19,"column":6},"end":{"line":19,"column":21}},"id":{"type":"Identifier","start":663,"end":666,"loc":{"start":{"line":19,"column":6},"end":{"line":19,"column":9}},"name":"app"},"init":{"type":"CallExpression","start":669,"end":678,"loc":{"start":{"line":19,"column":12},"end":{"line":19,"column":21}},"callee":{"type":"Identifier","start":669,"end":676,"loc":{"start":{"line":19,"column":12},"end":{"line":19,"column":19}},"name":"express"},"arguments":[]}}],"kind":"const"},{"type":"VariableDeclaration","start":712,"end":773,"loc":{"start":{"line":22,"column":0},"end":{"line":22,"column":61}},"declarations":[{"type":"VariableDeclarator","start":718,"end":773,"loc":{"start":{"line":22,"column":6},"end":{"line":22,"column":61}},"id":{"type":"Identifier","start":718,"end":735,"loc":{"start":{"line":22,"column":6},"end":{"line":22,"column":23}},"name":"metricsMiddleware"},"init":{"type":"CallExpression","start":738,"end":773,"loc":{"start":{"line":22,"column":26},"end":{"line":22,"column":61}},"callee":{"type":"Identifier","start":738,"end":748,"loc":{"start":{"line":22,"column":26},"end":{"line":22,"column":36}},"name":"promBundle"},"arguments":[{"type":"ObjectExpression","start":749,"end":772,"loc":{"start":{"line":22,"column":37},"end":{"line":22,"column":60}},"properties":[{"type":"Property","start":751,"end":770,"loc":{"start":{"line":22,"column":39},"end":{"line":22,"column":58}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":751,"end":764,"loc":{"start":{"line":22,"column":39},"end":{"line":22,"column":52}},"name":"includeMethod"},"value":{"type":"Literal","start":766,"end":770,"loc":{"start":{"line":22,"column":54},"end":{"line":22,"column":58}},"value":true,"raw":"true"},"kind":"init"}]}]}}],"kind":"const","comments":[{"type":"Line","value":" for server metrics tracking.","start":680,"end":711,"loc":{"start":{"line":21,"column":0},"end":{"line":21,"column":31}}}]},{"type":"VariableDeclaration","start":774,"end":821,"loc":{"start":{"line":23,"column":0},"end":{"line":23,"column":47}},"declarations":[{"type":"VariableDeclarator","start":780,"end":821,"loc":{"start":{"line":23,"column":6},"end":{"line":23,"column":47}},"id":{"type":"Identifier","start":780,"end":790,"loc":{"start":{"line":23,"column":6},"end":{"line":23,"column":16}},"name":"promClient"},"init":{"type":"MemberExpression","start":793,"end":821,"loc":{"start":{"line":23,"column":19},"end":{"line":23,"column":47}},"object":{"type":"Identifier","start":793,"end":810,"loc":{"start":{"line":23,"column":19},"end":{"line":23,"column":36}},"name":"metricsMiddleware"},"property":{"type":"Identifier","start":811,"end":821,"loc":{"start":{"line":23,"column":37},"end":{"line":23,"column":47}},"name":"promClient"},"computed":false}}],"kind":"const"},{"type":"VariableDeclaration","start":822,"end":884,"loc":{"start":{"line":24,"column":0},"end":{"line":24,"column":62}},"declarations":[{"type":"VariableDeclarator","start":828,"end":884,"loc":{"start":{"line":24,"column":6},"end":{"line":24,"column":62}},"id":{"type":"Identifier","start":828,"end":849,"loc":{"start":{"line":24,"column":6},"end":{"line":24,"column":27}},"name":"collectDefaultMetrics"},"init":{"type":"MemberExpression","start":852,"end":884,"loc":{"start":{"line":24,"column":30},"end":{"line":24,"column":62}},"object":{"type":"Identifier","start":852,"end":862,"loc":{"start":{"line":24,"column":30},"end":{"line":24,"column":40}},"name":"promClient"},"property":{"type":"Identifier","start":863,"end":884,"loc":{"start":{"line":24,"column":41},"end":{"line":24,"column":62}},"name":"collectDefaultMetrics"},"computed":false}}],"kind":"const"},{"type":"VariableDeclaration","start":885,"end":977,"loc":{"start":{"line":25,"column":0},"end":{"line":25,"column":92}},"declarations":[{"type":"VariableDeclarator","start":891,"end":977,"loc":{"start":{"line":25,"column":6},"end":{"line":25,"column":92}},"id":{"type":"Identifier","start":891,"end":903,"loc":{"start":{"line":25,"column":6},"end":{"line":25,"column":18}},"name":"promInterval"},"init":{"type":"CallExpression","start":906,"end":977,"loc":{"start":{"line":25,"column":21},"end":{"line":25,"column":92}},"callee":{"type":"Identifier","start":906,"end":927,"loc":{"start":{"line":25,"column":21},"end":{"line":25,"column":42}},"name":"collectDefaultMetrics"},"arguments":[{"type":"ObjectExpression","start":928,"end":976,"loc":{"start":{"line":25,"column":43},"end":{"line":25,"column":91}},"properties":[{"type":"Property","start":930,"end":959,"loc":{"start":{"line":25,"column":45},"end":{"line":25,"column":74}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":930,"end":938,"loc":{"start":{"line":25,"column":45},"end":{"line":25,"column":53}},"name":"register"},"value":{"type":"MemberExpression","start":940,"end":959,"loc":{"start":{"line":25,"column":55},"end":{"line":25,"column":74}},"object":{"type":"Identifier","start":940,"end":950,"loc":{"start":{"line":25,"column":55},"end":{"line":25,"column":65}},"name":"promClient"},"property":{"type":"Identifier","start":951,"end":959,"loc":{"start":{"line":25,"column":66},"end":{"line":25,"column":74}},"name":"register"},"computed":false},"kind":"init"},{"type":"Property","start":961,"end":974,"loc":{"start":{"line":25,"column":76},"end":{"line":25,"column":89}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":961,"end":968,"loc":{"start":{"line":25,"column":76},"end":{"line":25,"column":83}},"name":"timeout"},"value":{"type":"Literal","start":970,"end":974,"loc":{"start":{"line":25,"column":85},"end":{"line":25,"column":89}},"value":5000,"raw":"5000"},"kind":"init"}]}]}}],"kind":"const"},{"type":"VariableDeclaration","start":1016,"end":1123,"loc":{"start":{"line":28,"column":0},"end":{"line":28,"column":107}},"declarations":[{"type":"VariableDeclarator","start":1022,"end":1123,"loc":{"start":{"line":28,"column":6},"end":{"line":28,"column":107}},"id":{"type":"Identifier","start":1022,"end":1034,"loc":{"start":{"line":28,"column":6},"end":{"line":28,"column":18}},"name":"versionGauge"},"init":{"type":"NewExpression","start":1037,"end":1123,"loc":{"start":{"line":28,"column":21},"end":{"line":28,"column":107}},"callee":{"type":"MemberExpression","start":1041,"end":1057,"loc":{"start":{"line":28,"column":25},"end":{"line":28,"column":41}},"object":{"type":"Identifier","start":1041,"end":1051,"loc":{"start":{"line":28,"column":25},"end":{"line":28,"column":35}},"name":"promClient"},"property":{"type":"Identifier","start":1052,"end":1057,"loc":{"start":{"line":28,"column":36},"end":{"line":28,"column":41}},"name":"Gauge"},"computed":false},"arguments":[{"type":"ObjectExpression","start":1058,"end":1122,"loc":{"start":{"line":28,"column":42},"end":{"line":28,"column":106}},"properties":[{"type":"Property","start":1060,"end":1085,"loc":{"start":{"line":28,"column":44},"end":{"line":28,"column":69}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1060,"end":1064,"loc":{"start":{"line":28,"column":44},"end":{"line":28,"column":48}},"name":"name"},"value":{"type":"Literal","start":1066,"end":1085,"loc":{"start":{"line":28,"column":50},"end":{"line":28,"column":69}},"value":"companion_version","raw":"'companion_version'"},"kind":"init"},{"type":"Property","start":1087,"end":1120,"loc":{"start":{"line":28,"column":71},"end":{"line":28,"column":104}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1087,"end":1091,"loc":{"start":{"line":28,"column":71},"end":{"line":28,"column":75}},"name":"help"},"value":{"type":"Literal","start":1093,"end":1120,"loc":{"start":{"line":28,"column":77},"end":{"line":28,"column":104}},"value":"npm version as an integer","raw":"'npm version as an integer'"},"kind":"init"}]}]}}],"kind":"const","comments":[{"type":"Line","value":" Add version as a prometheus gauge","start":979,"end":1015,"loc":{"start":{"line":27,"column":0},"end":{"line":27,"column":36}}}]},{"type":"VariableDeclaration","start":1138,"end":1190,"loc":{"start":{"line":30,"column":0},"end":{"line":30,"column":52}},"declarations":[{"type":"VariableDeclarator","start":1144,"end":1190,"loc":{"start":{"line":30,"column":6},"end":{"line":30,"column":52}},"id":{"type":"Identifier","start":1144,"end":1157,"loc":{"start":{"line":30,"column":6},"end":{"line":30,"column":19}},"name":"numberVersion"},"init":{"type":"BinaryExpression","start":1160,"end":1190,"loc":{"start":{"line":30,"column":22},"end":{"line":30,"column":52}},"left":{"type":"CallExpression","start":1160,"end":1186,"loc":{"start":{"line":30,"column":22},"end":{"line":30,"column":48}},"callee":{"type":"MemberExpression","start":1160,"end":1175,"loc":{"start":{"line":30,"column":22},"end":{"line":30,"column":37}},"object":{"type":"Identifier","start":1160,"end":1167,"loc":{"start":{"line":30,"column":22},"end":{"line":30,"column":29}},"name":"version"},"property":{"type":"Identifier","start":1168,"end":1175,"loc":{"start":{"line":30,"column":30},"end":{"line":30,"column":37}},"name":"replace"},"computed":false},"arguments":[{"type":"Literal","start":1176,"end":1181,"loc":{"start":{"line":30,"column":38},"end":{"line":30,"column":43}},"value":{},"raw":"/\\D/g","regex":{"pattern":"\\D","flags":"g"}},{"type":"Literal","start":1183,"end":1185,"loc":{"start":{"line":30,"column":45},"end":{"line":30,"column":47}},"value":"","raw":"''"}]},"operator":"*","right":{"type":"Literal","start":1189,"end":1190,"loc":{"start":{"line":30,"column":51},"end":{"line":30,"column":52}},"value":1,"raw":"1"}}}],"kind":"const","comments":[{"type":"Line","value":" @ts-ignore","start":1124,"end":1137,"loc":{"start":{"line":29,"column":0},"end":{"line":29,"column":13}}}]},{"type":"ExpressionStatement","start":1191,"end":1222,"loc":{"start":{"line":31,"column":0},"end":{"line":31,"column":31}},"expression":{"type":"CallExpression","start":1191,"end":1222,"loc":{"start":{"line":31,"column":0},"end":{"line":31,"column":31}},"callee":{"type":"MemberExpression","start":1191,"end":1207,"loc":{"start":{"line":31,"column":0},"end":{"line":31,"column":16}},"object":{"type":"Identifier","start":1191,"end":1203,"loc":{"start":{"line":31,"column":0},"end":{"line":31,"column":12}},"name":"versionGauge"},"property":{"type":"Identifier","start":1204,"end":1207,"loc":{"start":{"line":31,"column":13},"end":{"line":31,"column":16}},"name":"set"},"computed":false},"arguments":[{"type":"Identifier","start":1208,"end":1221,"loc":{"start":{"line":31,"column":17},"end":{"line":31,"column":30}},"name":"numberVersion"}]}},{"type":"IfStatement","start":1224,"end":1288,"loc":{"start":{"line":33,"column":0},"end":{"line":35,"column":1}},"test":{"type":"BinaryExpression","start":1228,"end":1253,"loc":{"start":{"line":33,"column":4},"end":{"line":33,"column":29}},"left":{"type":"CallExpression","start":1228,"end":1242,"loc":{"start":{"line":33,"column":4},"end":{"line":33,"column":18}},"callee":{"type":"MemberExpression","start":1228,"end":1235,"loc":{"start":{"line":33,"column":4},"end":{"line":33,"column":11}},"object":{"type":"Identifier","start":1228,"end":1231,"loc":{"start":{"line":33,"column":4},"end":{"line":33,"column":7}},"name":"app"},"property":{"type":"Identifier","start":1232,"end":1235,"loc":{"start":{"line":33,"column":8},"end":{"line":33,"column":11}},"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":1236,"end":1241,"loc":{"start":{"line":33,"column":12},"end":{"line":33,"column":17}},"value":"env","raw":"'env'"}]},"operator":"!==","right":{"type":"Literal","start":1247,"end":1253,"loc":{"start":{"line":33,"column":23},"end":{"line":33,"column":29}},"value":"test","raw":"'test'"}},"consequent":{"type":"BlockStatement","start":1255,"end":1288,"loc":{"start":{"line":33,"column":31},"end":{"line":35,"column":1}},"body":[{"type":"ExpressionStatement","start":1259,"end":1286,"loc":{"start":{"line":34,"column":2},"end":{"line":34,"column":29}},"expression":{"type":"CallExpression","start":1259,"end":1286,"loc":{"start":{"line":34,"column":2},"end":{"line":34,"column":29}},"callee":{"type":"Identifier","start":1259,"end":1272,"loc":{"start":{"line":34,"column":2},"end":{"line":34,"column":15}},"name":"clearInterval"},"arguments":[{"type":"Identifier","start":1273,"end":1285,"loc":{"start":{"line":34,"column":16},"end":{"line":34,"column":28}},"name":"promInterval"}]}}]},"alternate":null},{"type":"VariableDeclaration","start":1361,"end":1425,"loc":{"start":{"line":38,"column":0},"end":{"line":38,"column":64}},"declarations":[{"type":"VariableDeclarator","start":1367,"end":1425,"loc":{"start":{"line":38,"column":6},"end":{"line":38,"column":64}},"id":{"type":"Identifier","start":1367,"end":1380,"loc":{"start":{"line":38,"column":6},"end":{"line":38,"column":19}},"name":"sensitiveKeys"},"init":{"type":"NewExpression","start":1383,"end":1425,"loc":{"start":{"line":38,"column":22},"end":{"line":38,"column":64}},"callee":{"type":"Identifier","start":1387,"end":1390,"loc":{"start":{"line":38,"column":26},"end":{"line":38,"column":29}},"name":"Set"},"arguments":[{"type":"ArrayExpression","start":1391,"end":1424,"loc":{"start":{"line":38,"column":30},"end":{"line":38,"column":63}},"elements":[{"type":"Literal","start":1392,"end":1406,"loc":{"start":{"line":38,"column":31},"end":{"line":38,"column":45}},"value":"access_token","raw":"'access_token'"},{"type":"Literal","start":1408,"end":1423,"loc":{"start":{"line":38,"column":47},"end":{"line":38,"column":62}},"value":"uppyAuthToken","raw":"'uppyAuthToken'"}]}]}}],"kind":"const","comments":[{"type":"Line","value":" Query string keys whose values should not end up in logging output.","start":1290,"end":1360,"loc":{"start":{"line":37,"column":0},"end":{"line":37,"column":70}}}]},{"type":"FunctionDeclaration","start":1882,"end":2318,"loc":{"start":{"line":53,"column":0},"end":{"line":70,"column":1}},"id":{"type":"Identifier","start":1891,"end":1902,"loc":{"start":{"line":53,"column":9},"end":{"line":53,"column":20}},"name":"censorQuery"},"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":1904,"end":1912,"loc":{"start":{"line":53,"column":22},"end":{"line":53,"column":30}},"name":"rawQuery"}],"body":{"type":"BlockStatement","start":1914,"end":2318,"loc":{"start":{"line":53,"column":32},"end":{"line":70,"column":1}},"body":[{"type":"VariableDeclaration","start":1961,"end":1977,"loc":{"start":{"line":55,"column":2},"end":{"line":55,"column":18}},"declarations":[{"type":"VariableDeclarator","start":1967,"end":1977,"loc":{"start":{"line":55,"column":8},"end":{"line":55,"column":18}},"id":{"type":"Identifier","start":1967,"end":1972,"loc":{"start":{"line":55,"column":8},"end":{"line":55,"column":13}},"name":"query"},"init":{"type":"ObjectExpression","start":1975,"end":1977,"loc":{"start":{"line":55,"column":16},"end":{"line":55,"column":18}},"properties":[]}}],"kind":"const"},{"type":"VariableDeclaration","start":1980,"end":2000,"loc":{"start":{"line":56,"column":2},"end":{"line":56,"column":22}},"declarations":[{"type":"VariableDeclarator","start":1984,"end":2000,"loc":{"start":{"line":56,"column":6},"end":{"line":56,"column":22}},"id":{"type":"Identifier","start":1984,"end":1992,"loc":{"start":{"line":56,"column":6},"end":{"line":56,"column":14}},"name":"censored"},"init":{"type":"Literal","start":1995,"end":2000,"loc":{"start":{"line":56,"column":17},"end":{"line":56,"column":22}},"value":false,"raw":"false"}}],"kind":"let"},{"type":"ExpressionStatement","start":2003,"end":2287,"loc":{"start":{"line":57,"column":2},"end":{"line":68,"column":4}},"expression":{"type":"CallExpression","start":2003,"end":2287,"loc":{"start":{"line":57,"column":2},"end":{"line":68,"column":4}},"callee":{"type":"MemberExpression","start":2003,"end":2032,"loc":{"start":{"line":57,"column":2},"end":{"line":57,"column":31}},"object":{"type":"CallExpression","start":2003,"end":2024,"loc":{"start":{"line":57,"column":2},"end":{"line":57,"column":23}},"callee":{"type":"MemberExpression","start":2003,"end":2014,"loc":{"start":{"line":57,"column":2},"end":{"line":57,"column":13}},"object":{"type":"Identifier","start":2003,"end":2009,"loc":{"start":{"line":57,"column":2},"end":{"line":57,"column":8}},"name":"Object"},"property":{"type":"Identifier","start":2010,"end":2014,"loc":{"start":{"line":57,"column":9},"end":{"line":57,"column":13}},"name":"keys"},"computed":false},"arguments":[{"type":"Identifier","start":2015,"end":2023,"loc":{"start":{"line":57,"column":14},"end":{"line":57,"column":22}},"name":"rawQuery"}]},"property":{"type":"Identifier","start":2025,"end":2032,"loc":{"start":{"line":57,"column":24},"end":{"line":57,"column":31}},"name":"forEach"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":2033,"end":2286,"loc":{"start":{"line":57,"column":32},"end":{"line":68,"column":3}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":2034,"end":2037,"loc":{"start":{"line":57,"column":33},"end":{"line":57,"column":36}},"name":"key"}],"body":{"type":"BlockStatement","start":2042,"end":2286,"loc":{"start":{"line":57,"column":41},"end":{"line":68,"column":3}},"body":[{"type":"IfStatement","start":2048,"end":2107,"loc":{"start":{"line":58,"column":4},"end":{"line":60,"column":5}},"test":{"type":"BinaryExpression","start":2052,"end":2085,"loc":{"start":{"line":58,"column":8},"end":{"line":58,"column":41}},"left":{"type":"UnaryExpression","start":2052,"end":2072,"loc":{"start":{"line":58,"column":8},"end":{"line":58,"column":28}},"operator":"typeof","prefix":true,"argument":{"type":"MemberExpression","start":2059,"end":2072,"loc":{"start":{"line":58,"column":15},"end":{"line":58,"column":28}},"object":{"type":"Identifier","start":2059,"end":2067,"loc":{"start":{"line":58,"column":15},"end":{"line":58,"column":23}},"name":"rawQuery"},"property":{"type":"Identifier","start":2068,"end":2071,"loc":{"start":{"line":58,"column":24},"end":{"line":58,"column":27}},"name":"key"},"computed":true}},"operator":"!==","right":{"type":"Literal","start":2077,"end":2085,"loc":{"start":{"line":58,"column":33},"end":{"line":58,"column":41}},"value":"string","raw":"'string'"}},"consequent":{"type":"BlockStatement","start":2087,"end":2107,"loc":{"start":{"line":58,"column":43},"end":{"line":60,"column":5}},"body":[{"type":"ReturnStatement","start":2095,"end":2101,"loc":{"start":{"line":59,"column":6},"end":{"line":59,"column":12}},"argument":null}]},"alternate":null},{"type":"IfStatement","start":2112,"end":2282,"loc":{"start":{"line":61,"column":4},"end":{"line":67,"column":5}},"test":{"type":"CallExpression","start":2116,"end":2138,"loc":{"start":{"line":61,"column":8},"end":{"line":61,"column":30}},"callee":{"type":"MemberExpression","start":2116,"end":2133,"loc":{"start":{"line":61,"column":8},"end":{"line":61,"column":25}},"object":{"type":"Identifier","start":2116,"end":2129,"loc":{"start":{"line":61,"column":8},"end":{"line":61,"column":21}},"name":"sensitiveKeys"},"property":{"type":"Identifier","start":2130,"end":2133,"loc":{"start":{"line":61,"column":22},"end":{"line":61,"column":25}},"name":"has"},"computed":false},"arguments":[{"type":"Identifier","start":2134,"end":2137,"loc":{"start":{"line":61,"column":26},"end":{"line":61,"column":29}},"name":"key"}]},"consequent":{"type":"BlockStatement","start":2140,"end":2236,"loc":{"start":{"line":61,"column":32},"end":{"line":65,"column":5}},"body":[{"type":"ExpressionStatement","start":2185,"end":2208,"loc":{"start":{"line":63,"column":6},"end":{"line":63,"column":29}},"expression":{"type":"AssignmentExpression","start":2185,"end":2208,"loc":{"start":{"line":63,"column":6},"end":{"line":63,"column":29}},"operator":"=","left":{"type":"MemberExpression","start":2185,"end":2195,"loc":{"start":{"line":63,"column":6},"end":{"line":63,"column":16}},"object":{"type":"Identifier","start":2185,"end":2190,"loc":{"start":{"line":63,"column":6},"end":{"line":63,"column":11}},"name":"query"},"property":{"type":"Identifier","start":2191,"end":2194,"loc":{"start":{"line":63,"column":12},"end":{"line":63,"column":15}},"name":"key"},"computed":true},"right":{"type":"Literal","start":2198,"end":2208,"loc":{"start":{"line":63,"column":19},"end":{"line":63,"column":29}},"value":"********","raw":"'********'"}},"comments":[{"type":"Line","value":" replace logged access token","start":2148,"end":2178,"loc":{"start":{"line":62,"column":6},"end":{"line":62,"column":36}}}]},{"type":"ExpressionStatement","start":2215,"end":2230,"loc":{"start":{"line":64,"column":6},"end":{"line":64,"column":21}},"expression":{"type":"AssignmentExpression","start":2215,"end":2230,"loc":{"start":{"line":64,"column":6},"end":{"line":64,"column":21}},"operator":"=","left":{"type":"Identifier","start":2215,"end":2223,"loc":{"start":{"line":64,"column":6},"end":{"line":64,"column":14}},"name":"censored"},"right":{"type":"Literal","start":2226,"end":2230,"loc":{"start":{"line":64,"column":17},"end":{"line":64,"column":21}},"value":true,"raw":"true"}}}]},"alternate":{"type":"BlockStatement","start":2242,"end":2282,"loc":{"start":{"line":65,"column":11},"end":{"line":67,"column":5}},"body":[{"type":"ExpressionStatement","start":2250,"end":2276,"loc":{"start":{"line":66,"column":6},"end":{"line":66,"column":32}},"expression":{"type":"AssignmentExpression","start":2250,"end":2276,"loc":{"start":{"line":66,"column":6},"end":{"line":66,"column":32}},"operator":"=","left":{"type":"MemberExpression","start":2250,"end":2260,"loc":{"start":{"line":66,"column":6},"end":{"line":66,"column":16}},"object":{"type":"Identifier","start":2250,"end":2255,"loc":{"start":{"line":66,"column":6},"end":{"line":66,"column":11}},"name":"query"},"property":{"type":"Identifier","start":2256,"end":2259,"loc":{"start":{"line":66,"column":12},"end":{"line":66,"column":15}},"name":"key"},"computed":true},"right":{"type":"MemberExpression","start":2263,"end":2276,"loc":{"start":{"line":66,"column":19},"end":{"line":66,"column":32}},"object":{"type":"Identifier","start":2263,"end":2271,"loc":{"start":{"line":66,"column":19},"end":{"line":66,"column":27}},"name":"rawQuery"},"property":{"type":"Identifier","start":2272,"end":2275,"loc":{"start":{"line":66,"column":28},"end":{"line":66,"column":31}},"name":"key"},"computed":true}}}]}}]}}]}},{"type":"ReturnStatement","start":2290,"end":2316,"loc":{"start":{"line":69,"column":2},"end":{"line":69,"column":28}},"argument":{"type":"ObjectExpression","start":2297,"end":2316,"loc":{"start":{"line":69,"column":9},"end":{"line":69,"column":28}},"properties":[{"type":"Property","start":2299,"end":2304,"loc":{"start":{"line":69,"column":11},"end":{"line":69,"column":16}},"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":2299,"end":2304,"loc":{"start":{"line":69,"column":11},"end":{"line":69,"column":16}},"name":"query"},"kind":"init","value":{"type":"Identifier","start":2299,"end":2304,"loc":{"start":{"line":69,"column":11},"end":{"line":69,"column":16}},"name":"query"}},{"type":"Property","start":2306,"end":2314,"loc":{"start":{"line":69,"column":18},"end":{"line":69,"column":26}},"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":2306,"end":2314,"loc":{"start":{"line":69,"column":18},"end":{"line":69,"column":26}},"name":"censored"},"kind":"init","value":{"type":"Identifier","start":2306,"end":2314,"loc":{"start":{"line":69,"column":18},"end":{"line":69,"column":26}},"name":"censored"}}]}}],"comments":[{"type":"Block","value":"* @type {{ [key: string]: string }} ","start":1918,"end":1958,"loc":{"start":{"line":54,"column":2},"end":{"line":54,"column":42}}}]},"comments":[{"type":"Block","value":"*\n * Obscure the contents of query string keys listed in `sensitiveKeys`.\n *\n * Returns a copy of the object with unknown types removed and sensitive values replaced by ***.\n *\n * The input type is more broad that it needs to be, this way typescript can help us guarantee that we're dealing with all possible inputs :)\n *\n * @param {{ [key: string]: any }} rawQuery\n * @returns {{\n *   query: { [key: string]: string },\n *   censored: boolean\n * }}\n ","start":1427,"end":1881,"loc":{"start":{"line":40,"column":0},"end":{"line":52,"column":3}}}]},{"type":"ExpressionStatement","start":2320,"end":2341,"loc":{"start":{"line":72,"column":0},"end":{"line":72,"column":21}},"expression":{"type":"CallExpression","start":2320,"end":2341,"loc":{"start":{"line":72,"column":0},"end":{"line":72,"column":21}},"callee":{"type":"MemberExpression","start":2320,"end":2327,"loc":{"start":{"line":72,"column":0},"end":{"line":72,"column":7}},"object":{"type":"Identifier","start":2320,"end":2323,"loc":{"start":{"line":72,"column":0},"end":{"line":72,"column":3}},"name":"app"},"property":{"type":"Identifier","start":2324,"end":2327,"loc":{"start":{"line":72,"column":4},"end":{"line":72,"column":7}},"name":"use"},"computed":false},"arguments":[{"type":"Identifier","start":2328,"end":2340,"loc":{"start":{"line":72,"column":8},"end":{"line":72,"column":20}},"name":"addRequestId"}]}},{"type":"ExpressionStatement","start":2366,"end":2393,"loc":{"start":{"line":74,"column":0},"end":{"line":74,"column":27}},"expression":{"type":"CallExpression","start":2366,"end":2393,"loc":{"start":{"line":74,"column":0},"end":{"line":74,"column":27}},"callee":{"type":"MemberExpression","start":2366,"end":2373,"loc":{"start":{"line":74,"column":0},"end":{"line":74,"column":7}},"object":{"type":"Identifier","start":2366,"end":2369,"loc":{"start":{"line":74,"column":0},"end":{"line":74,"column":3}},"name":"app"},"property":{"type":"Identifier","start":2370,"end":2373,"loc":{"start":{"line":74,"column":4},"end":{"line":74,"column":7}},"name":"use"},"computed":false},"arguments":[{"type":"CallExpression","start":2374,"end":2392,"loc":{"start":{"line":74,"column":8},"end":{"line":74,"column":26}},"callee":{"type":"Identifier","start":2374,"end":2380,"loc":{"start":{"line":74,"column":8},"end":{"line":74,"column":14}},"name":"morgan"},"arguments":[{"type":"Literal","start":2381,"end":2391,"loc":{"start":{"line":74,"column":15},"end":{"line":74,"column":25}},"value":"combined","raw":"'combined'"}]}]},"comments":[{"type":"Line","value":" log server requests.","start":2342,"end":2365,"loc":{"start":{"line":73,"column":0},"end":{"line":73,"column":23}}}]},{"type":"ExpressionStatement","start":2394,"end":2571,"loc":{"start":{"line":75,"column":0},"end":{"line":78,"column":2}},"expression":{"type":"CallExpression","start":2394,"end":2571,"loc":{"start":{"line":75,"column":0},"end":{"line":78,"column":2}},"callee":{"type":"MemberExpression","start":2394,"end":2406,"loc":{"start":{"line":75,"column":0},"end":{"line":75,"column":12}},"object":{"type":"Identifier","start":2394,"end":2400,"loc":{"start":{"line":75,"column":0},"end":{"line":75,"column":6}},"name":"morgan"},"property":{"type":"Identifier","start":2401,"end":2406,"loc":{"start":{"line":75,"column":7},"end":{"line":75,"column":12}},"name":"token"},"computed":false},"arguments":[{"type":"Literal","start":2407,"end":2412,"loc":{"start":{"line":75,"column":13},"end":{"line":75,"column":18}},"value":"url","raw":"'url'"},{"type":"ArrowFunctionExpression","start":2414,"end":2570,"loc":{"start":{"line":75,"column":20},"end":{"line":78,"column":1}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":2415,"end":2418,"loc":{"start":{"line":75,"column":21},"end":{"line":75,"column":24}},"name":"req"},{"type":"Identifier","start":2420,"end":2423,"loc":{"start":{"line":75,"column":26},"end":{"line":75,"column":29}},"name":"res"}],"body":{"type":"BlockStatement","start":2428,"end":2570,"loc":{"start":{"line":75,"column":34},"end":{"line":78,"column":1}},"body":[{"type":"VariableDeclaration","start":2432,"end":2482,"loc":{"start":{"line":76,"column":2},"end":{"line":76,"column":52}},"declarations":[{"type":"VariableDeclarator","start":2438,"end":2482,"loc":{"start":{"line":76,"column":8},"end":{"line":76,"column":52}},"id":{"type":"ObjectPattern","start":2438,"end":2457,"loc":{"start":{"line":76,"column":8},"end":{"line":76,"column":27}},"properties":[{"type":"Property","start":2440,"end":2445,"loc":{"start":{"line":76,"column":10},"end":{"line":76,"column":15}},"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":2440,"end":2445,"loc":{"start":{"line":76,"column":10},"end":{"line":76,"column":15}},"name":"query"},"kind":"init","value":{"type":"Identifier","start":2440,"end":2445,"loc":{"start":{"line":76,"column":10},"end":{"line":76,"column":15}},"name":"query"}},{"type":"Property","start":2447,"end":2455,"loc":{"start":{"line":76,"column":17},"end":{"line":76,"column":25}},"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":2447,"end":2455,"loc":{"start":{"line":76,"column":17},"end":{"line":76,"column":25}},"name":"censored"},"kind":"init","value":{"type":"Identifier","start":2447,"end":2455,"loc":{"start":{"line":76,"column":17},"end":{"line":76,"column":25}},"name":"censored"}}]},"init":{"type":"CallExpression","start":2460,"end":2482,"loc":{"start":{"line":76,"column":30},"end":{"line":76,"column":52}},"callee":{"type":"Identifier","start":2460,"end":2471,"loc":{"start":{"line":76,"column":30},"end":{"line":76,"column":41}},"name":"censorQuery"},"arguments":[{"type":"MemberExpression","start":2472,"end":2481,"loc":{"start":{"line":76,"column":42},"end":{"line":76,"column":51}},"object":{"type":"Identifier","start":2472,"end":2475,"loc":{"start":{"line":76,"column":42},"end":{"line":76,"column":45}},"name":"req"},"property":{"type":"Identifier","start":2476,"end":2481,"loc":{"start":{"line":76,"column":46},"end":{"line":76,"column":51}},"name":"query"},"computed":false}]}}],"kind":"const"},{"type":"ReturnStatement","start":2485,"end":2568,"loc":{"start":{"line":77,"column":2},"end":{"line":77,"column":85}},"argument":{"type":"ConditionalExpression","start":2492,"end":2568,"loc":{"start":{"line":77,"column":9},"end":{"line":77,"column":85}},"test":{"type":"Identifier","start":2492,"end":2500,"loc":{"start":{"line":77,"column":9},"end":{"line":77,"column":17}},"name":"censored"},"consequent":{"type":"TemplateLiteral","start":2503,"end":2539,"loc":{"start":{"line":77,"column":20},"end":{"line":77,"column":56}},"expressions":[{"type":"MemberExpression","start":2506,"end":2514,"loc":{"start":{"line":77,"column":23},"end":{"line":77,"column":31}},"object":{"type":"Identifier","start":2506,"end":2509,"loc":{"start":{"line":77,"column":23},"end":{"line":77,"column":26}},"name":"req"},"property":{"type":"Identifier","start":2510,"end":2514,"loc":{"start":{"line":77,"column":27},"end":{"line":77,"column":31}},"name":"path"},"computed":false},{"type":"CallExpression","start":2518,"end":2537,"loc":{"start":{"line":77,"column":35},"end":{"line":77,"column":54}},"callee":{"type":"MemberExpression","start":2518,"end":2530,"loc":{"start":{"line":77,"column":35},"end":{"line":77,"column":47}},"object":{"type":"Identifier","start":2518,"end":2520,"loc":{"start":{"line":77,"column":35},"end":{"line":77,"column":37}},"name":"qs"},"property":{"type":"Identifier","start":2521,"end":2530,"loc":{"start":{"line":77,"column":38},"end":{"line":77,"column":47}},"name":"stringify"},"computed":false},"arguments":[{"type":"Identifier","start":2531,"end":2536,"loc":{"start":{"line":77,"column":48},"end":{"line":77,"column":53}},"name":"query"}]}],"quasis":[{"type":"TemplateElement","start":2504,"end":2504,"loc":{"start":{"line":77,"column":21},"end":{"line":77,"column":21}},"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":2515,"end":2516,"loc":{"start":{"line":77,"column":32},"end":{"line":77,"column":33}},"value":{"raw":"?","cooked":"?"},"tail":false},{"type":"TemplateElement","start":2538,"end":2538,"loc":{"start":{"line":77,"column":55},"end":{"line":77,"column":55}},"value":{"raw":"","cooked":""},"tail":true}]},"alternate":{"type":"LogicalExpression","start":2542,"end":2568,"loc":{"start":{"line":77,"column":59},"end":{"line":77,"column":85}},"left":{"type":"MemberExpression","start":2542,"end":2557,"loc":{"start":{"line":77,"column":59},"end":{"line":77,"column":74}},"object":{"type":"Identifier","start":2542,"end":2545,"loc":{"start":{"line":77,"column":59},"end":{"line":77,"column":62}},"name":"req"},"property":{"type":"Identifier","start":2546,"end":2557,"loc":{"start":{"line":77,"column":63},"end":{"line":77,"column":74}},"name":"originalUrl"},"computed":false},"operator":"||","right":{"type":"MemberExpression","start":2561,"end":2568,"loc":{"start":{"line":77,"column":78},"end":{"line":77,"column":85}},"object":{"type":"Identifier","start":2561,"end":2564,"loc":{"start":{"line":77,"column":78},"end":{"line":77,"column":81}},"name":"req"},"property":{"type":"Identifier","start":2565,"end":2568,"loc":{"start":{"line":77,"column":82},"end":{"line":77,"column":85}},"name":"url"},"computed":false}}}}]}}]}},{"type":"ExpressionStatement","start":2573,"end":2950,"loc":{"start":{"line":80,"column":0},"end":{"line":88,"column":2}},"expression":{"type":"CallExpression","start":2573,"end":2950,"loc":{"start":{"line":80,"column":0},"end":{"line":88,"column":2}},"callee":{"type":"MemberExpression","start":2573,"end":2585,"loc":{"start":{"line":80,"column":0},"end":{"line":80,"column":12}},"object":{"type":"Identifier","start":2573,"end":2579,"loc":{"start":{"line":80,"column":0},"end":{"line":80,"column":6}},"name":"morgan"},"property":{"type":"Identifier","start":2580,"end":2585,"loc":{"start":{"line":80,"column":7},"end":{"line":80,"column":12}},"name":"token"},"computed":false},"arguments":[{"type":"Literal","start":2586,"end":2596,"loc":{"start":{"line":80,"column":13},"end":{"line":80,"column":23}},"value":"referrer","raw":"'referrer'"},{"type":"ArrowFunctionExpression","start":2598,"end":2949,"loc":{"start":{"line":80,"column":25},"end":{"line":88,"column":1}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":2599,"end":2602,"loc":{"start":{"line":80,"column":26},"end":{"line":80,"column":29}},"name":"req"},{"type":"Identifier","start":2604,"end":2607,"loc":{"start":{"line":80,"column":31},"end":{"line":80,"column":34}},"name":"res"}],"body":{"type":"BlockStatement","start":2612,"end":2949,"loc":{"start":{"line":80,"column":39},"end":{"line":88,"column":1}},"body":[{"type":"VariableDeclaration","start":2616,"end":2671,"loc":{"start":{"line":81,"column":2},"end":{"line":81,"column":57}},"declarations":[{"type":"VariableDeclarator","start":2622,"end":2671,"loc":{"start":{"line":81,"column":8},"end":{"line":81,"column":57}},"id":{"type":"Identifier","start":2622,"end":2625,"loc":{"start":{"line":81,"column":8},"end":{"line":81,"column":11}},"name":"ref"},"init":{"type":"LogicalExpression","start":2628,"end":2671,"loc":{"start":{"line":81,"column":14},"end":{"line":81,"column":57}},"left":{"type":"MemberExpression","start":2628,"end":2647,"loc":{"start":{"line":81,"column":14},"end":{"line":81,"column":33}},"object":{"type":"MemberExpression","start":2628,"end":2639,"loc":{"start":{"line":81,"column":14},"end":{"line":81,"column":25}},"object":{"type":"Identifier","start":2628,"end":2631,"loc":{"start":{"line":81,"column":14},"end":{"line":81,"column":17}},"name":"req"},"property":{"type":"Identifier","start":2632,"end":2639,"loc":{"start":{"line":81,"column":18},"end":{"line":81,"column":25}},"name":"headers"},"computed":false},"property":{"type":"Identifier","start":2640,"end":2647,"loc":{"start":{"line":81,"column":26},"end":{"line":81,"column":33}},"name":"referer"},"computed":false},"operator":"||","right":{"type":"MemberExpression","start":2651,"end":2671,"loc":{"start":{"line":81,"column":37},"end":{"line":81,"column":57}},"object":{"type":"MemberExpression","start":2651,"end":2662,"loc":{"start":{"line":81,"column":37},"end":{"line":81,"column":48}},"object":{"type":"Identifier","start":2651,"end":2654,"loc":{"start":{"line":81,"column":37},"end":{"line":81,"column":40}},"name":"req"},"property":{"type":"Identifier","start":2655,"end":2662,"loc":{"start":{"line":81,"column":41},"end":{"line":81,"column":48}},"name":"headers"},"computed":false},"property":{"type":"Identifier","start":2663,"end":2671,"loc":{"start":{"line":81,"column":49},"end":{"line":81,"column":57}},"name":"referrer"},"computed":false}}}],"kind":"const"},{"type":"IfStatement","start":2674,"end":2947,"loc":{"start":{"line":82,"column":2},"end":{"line":87,"column":3}},"test":{"type":"BinaryExpression","start":2678,"end":2701,"loc":{"start":{"line":82,"column":6},"end":{"line":82,"column":29}},"left":{"type":"UnaryExpression","start":2678,"end":2688,"loc":{"start":{"line":82,"column":6},"end":{"line":82,"column":16}},"operator":"typeof","prefix":true,"argument":{"type":"Identifier","start":2685,"end":2688,"loc":{"start":{"line":82,"column":13},"end":{"line":82,"column":16}},"name":"ref"}},"operator":"===","right":{"type":"Literal","start":2693,"end":2701,"loc":{"start":{"line":82,"column":21},"end":{"line":82,"column":29}},"value":"string","raw":"'string'"}},"consequent":{"type":"BlockStatement","start":2703,"end":2947,"loc":{"start":{"line":82,"column":31},"end":{"line":87,"column":3}},"body":[{"type":"VariableDeclaration","start":2709,"end":2737,"loc":{"start":{"line":83,"column":4},"end":{"line":83,"column":32}},"declarations":[{"type":"VariableDeclarator","start":2715,"end":2737,"loc":{"start":{"line":83,"column":10},"end":{"line":83,"column":32}},"id":{"type":"Identifier","start":2715,"end":2721,"loc":{"start":{"line":83,"column":10},"end":{"line":83,"column":16}},"name":"parsed"},"init":{"type":"CallExpression","start":2724,"end":2737,"loc":{"start":{"line":83,"column":19},"end":{"line":83,"column":32}},"callee":{"type":"Identifier","start":2724,"end":2732,"loc":{"start":{"line":83,"column":19},"end":{"line":83,"column":27}},"name":"parseURL"},"arguments":[{"type":"Identifier","start":2733,"end":2736,"loc":{"start":{"line":83,"column":28},"end":{"line":83,"column":31}},"name":"ref"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":2742,"end":2799,"loc":{"start":{"line":84,"column":4},"end":{"line":84,"column":61}},"declarations":[{"type":"VariableDeclarator","start":2748,"end":2799,"loc":{"start":{"line":84,"column":10},"end":{"line":84,"column":61}},"id":{"type":"Identifier","start":2748,"end":2756,"loc":{"start":{"line":84,"column":10},"end":{"line":84,"column":18}},"name":"rawQuery"},"init":{"type":"CallExpression","start":2759,"end":2799,"loc":{"start":{"line":84,"column":21},"end":{"line":84,"column":61}},"callee":{"type":"MemberExpression","start":2759,"end":2767,"loc":{"start":{"line":84,"column":21},"end":{"line":84,"column":29}},"object":{"type":"Identifier","start":2759,"end":2761,"loc":{"start":{"line":84,"column":21},"end":{"line":84,"column":23}},"name":"qs"},"property":{"type":"Identifier","start":2762,"end":2767,"loc":{"start":{"line":84,"column":24},"end":{"line":84,"column":29}},"name":"parse"},"computed":false},"arguments":[{"type":"CallExpression","start":2768,"end":2798,"loc":{"start":{"line":84,"column":30},"end":{"line":84,"column":60}},"callee":{"type":"MemberExpression","start":2768,"end":2789,"loc":{"start":{"line":84,"column":30},"end":{"line":84,"column":51}},"object":{"type":"MemberExpression","start":2768,"end":2781,"loc":{"start":{"line":84,"column":30},"end":{"line":84,"column":43}},"object":{"type":"Identifier","start":2768,"end":2774,"loc":{"start":{"line":84,"column":30},"end":{"line":84,"column":36}},"name":"parsed"},"property":{"type":"Identifier","start":2775,"end":2781,"loc":{"start":{"line":84,"column":37},"end":{"line":84,"column":43}},"name":"search"},"computed":false},"property":{"type":"Identifier","start":2782,"end":2789,"loc":{"start":{"line":84,"column":44},"end":{"line":84,"column":51}},"name":"replace"},"computed":false},"arguments":[{"type":"Literal","start":2790,"end":2793,"loc":{"start":{"line":84,"column":52},"end":{"line":84,"column":55}},"value":"?","raw":"'?'"},{"type":"Literal","start":2795,"end":2797,"loc":{"start":{"line":84,"column":57},"end":{"line":84,"column":59}},"value":"","raw":"''"}]}]}}],"kind":"const"},{"type":"VariableDeclaration","start":2804,"end":2853,"loc":{"start":{"line":85,"column":4},"end":{"line":85,"column":53}},"declarations":[{"type":"VariableDeclarator","start":2810,"end":2853,"loc":{"start":{"line":85,"column":10},"end":{"line":85,"column":53}},"id":{"type":"ObjectPattern","start":2810,"end":2829,"loc":{"start":{"line":85,"column":10},"end":{"line":85,"column":29}},"properties":[{"type":"Property","start":2812,"end":2817,"loc":{"start":{"line":85,"column":12},"end":{"line":85,"column":17}},"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":2812,"end":2817,"loc":{"start":{"line":85,"column":12},"end":{"line":85,"column":17}},"name":"query"},"kind":"init","value":{"type":"Identifier","start":2812,"end":2817,"loc":{"start":{"line":85,"column":12},"end":{"line":85,"column":17}},"name":"query"}},{"type":"Property","start":2819,"end":2827,"loc":{"start":{"line":85,"column":19},"end":{"line":85,"column":27}},"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":2819,"end":2827,"loc":{"start":{"line":85,"column":19},"end":{"line":85,"column":27}},"name":"censored"},"kind":"init","value":{"type":"Identifier","start":2819,"end":2827,"loc":{"start":{"line":85,"column":19},"end":{"line":85,"column":27}},"name":"censored"}}]},"init":{"type":"CallExpression","start":2832,"end":2853,"loc":{"start":{"line":85,"column":32},"end":{"line":85,"column":53}},"callee":{"type":"Identifier","start":2832,"end":2843,"loc":{"start":{"line":85,"column":32},"end":{"line":85,"column":43}},"name":"censorQuery"},"arguments":[{"type":"Identifier","start":2844,"end":2852,"loc":{"start":{"line":85,"column":44},"end":{"line":85,"column":52}},"name":"rawQuery"}]}}],"kind":"const"},{"type":"ReturnStatement","start":2858,"end":2943,"loc":{"start":{"line":86,"column":4},"end":{"line":86,"column":89}},"argument":{"type":"ConditionalExpression","start":2865,"end":2943,"loc":{"start":{"line":86,"column":11},"end":{"line":86,"column":89}},"test":{"type":"Identifier","start":2865,"end":2873,"loc":{"start":{"line":86,"column":11},"end":{"line":86,"column":19}},"name":"censored"},"consequent":{"type":"TemplateLiteral","start":2876,"end":2929,"loc":{"start":{"line":86,"column":22},"end":{"line":86,"column":75}},"expressions":[{"type":"MemberExpression","start":2879,"end":2904,"loc":{"start":{"line":86,"column":25},"end":{"line":86,"column":50}},"object":{"type":"CallExpression","start":2879,"end":2901,"loc":{"start":{"line":86,"column":25},"end":{"line":86,"column":47}},"callee":{"type":"MemberExpression","start":2879,"end":2896,"loc":{"start":{"line":86,"column":25},"end":{"line":86,"column":42}},"object":{"type":"MemberExpression","start":2879,"end":2890,"loc":{"start":{"line":86,"column":25},"end":{"line":86,"column":36}},"object":{"type":"Identifier","start":2879,"end":2885,"loc":{"start":{"line":86,"column":25},"end":{"line":86,"column":31}},"name":"parsed"},"property":{"type":"Identifier","start":2886,"end":2890,"loc":{"start":{"line":86,"column":32},"end":{"line":86,"column":36}},"name":"href"},"computed":false},"property":{"type":"Identifier","start":2891,"end":2896,"loc":{"start":{"line":86,"column":37},"end":{"line":86,"column":42}},"name":"split"},"computed":false},"arguments":[{"type":"Literal","start":2897,"end":2900,"loc":{"start":{"line":86,"column":43},"end":{"line":86,"column":46}},"value":"?","raw":"'?'"}]},"property":{"type":"Literal","start":2902,"end":2903,"loc":{"start":{"line":86,"column":48},"end":{"line":86,"column":49}},"value":0,"raw":"0"},"computed":true},{"type":"CallExpression","start":2908,"end":2927,"loc":{"start":{"line":86,"column":54},"end":{"line":86,"column":73}},"callee":{"type":"MemberExpression","start":2908,"end":2920,"loc":{"start":{"line":86,"column":54},"end":{"line":86,"column":66}},"object":{"type":"Identifier","start":2908,"end":2910,"loc":{"start":{"line":86,"column":54},"end":{"line":86,"column":56}},"name":"qs"},"property":{"type":"Identifier","start":2911,"end":2920,"loc":{"start":{"line":86,"column":57},"end":{"line":86,"column":66}},"name":"stringify"},"computed":false},"arguments":[{"type":"Identifier","start":2921,"end":2926,"loc":{"start":{"line":86,"column":67},"end":{"line":86,"column":72}},"name":"query"}]}],"quasis":[{"type":"TemplateElement","start":2877,"end":2877,"loc":{"start":{"line":86,"column":23},"end":{"line":86,"column":23}},"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":2905,"end":2906,"loc":{"start":{"line":86,"column":51},"end":{"line":86,"column":52}},"value":{"raw":"?","cooked":"?"},"tail":false},{"type":"TemplateElement","start":2928,"end":2928,"loc":{"start":{"line":86,"column":74},"end":{"line":86,"column":74}},"value":{"raw":"","cooked":""},"tail":true}]},"alternate":{"type":"MemberExpression","start":2932,"end":2943,"loc":{"start":{"line":86,"column":78},"end":{"line":86,"column":89}},"object":{"type":"Identifier","start":2932,"end":2938,"loc":{"start":{"line":86,"column":78},"end":{"line":86,"column":84}},"name":"parsed"},"property":{"type":"Identifier","start":2939,"end":2943,"loc":{"start":{"line":86,"column":85},"end":{"line":86,"column":89}},"name":"href"},"computed":false}}}]},"alternate":null}]}}]}},{"type":"ExpressionStatement","start":2997,"end":3023,"loc":{"start":{"line":91,"column":0},"end":{"line":91,"column":26}},"expression":{"type":"CallExpression","start":2997,"end":3023,"loc":{"start":{"line":91,"column":0},"end":{"line":91,"column":26}},"callee":{"type":"MemberExpression","start":2997,"end":3004,"loc":{"start":{"line":91,"column":0},"end":{"line":91,"column":7}},"object":{"type":"Identifier","start":2997,"end":3000,"loc":{"start":{"line":91,"column":0},"end":{"line":91,"column":3}},"name":"app"},"property":{"type":"Identifier","start":3001,"end":3004,"loc":{"start":{"line":91,"column":4},"end":{"line":91,"column":7}},"name":"use"},"computed":false},"arguments":[{"type":"Identifier","start":3005,"end":3022,"loc":{"start":{"line":91,"column":8},"end":{"line":91,"column":25}},"name":"metricsMiddleware"}]},"comments":[{"type":"Line","value":" make app metrics available at '/metrics'.","start":2952,"end":2996,"loc":{"start":{"line":90,"column":0},"end":{"line":90,"column":44}}}]},{"type":"ExpressionStatement","start":3025,"end":3051,"loc":{"start":{"line":93,"column":0},"end":{"line":93,"column":26}},"expression":{"type":"CallExpression","start":3025,"end":3051,"loc":{"start":{"line":93,"column":0},"end":{"line":93,"column":26}},"callee":{"type":"MemberExpression","start":3025,"end":3032,"loc":{"start":{"line":93,"column":0},"end":{"line":93,"column":7}},"object":{"type":"Identifier","start":3025,"end":3028,"loc":{"start":{"line":93,"column":0},"end":{"line":93,"column":3}},"name":"app"},"property":{"type":"Identifier","start":3029,"end":3032,"loc":{"start":{"line":93,"column":4},"end":{"line":93,"column":7}},"name":"use"},"computed":false},"arguments":[{"type":"CallExpression","start":3033,"end":3050,"loc":{"start":{"line":93,"column":8},"end":{"line":93,"column":25}},"callee":{"type":"MemberExpression","start":3033,"end":3048,"loc":{"start":{"line":93,"column":8},"end":{"line":93,"column":23}},"object":{"type":"Identifier","start":3033,"end":3043,"loc":{"start":{"line":93,"column":8},"end":{"line":93,"column":18}},"name":"bodyParser"},"property":{"type":"Identifier","start":3044,"end":3048,"loc":{"start":{"line":93,"column":19},"end":{"line":93,"column":23}},"name":"json"},"computed":false},"arguments":[]}]}},{"type":"ExpressionStatement","start":3052,"end":3103,"loc":{"start":{"line":94,"column":0},"end":{"line":94,"column":51}},"expression":{"type":"CallExpression","start":3052,"end":3103,"loc":{"start":{"line":94,"column":0},"end":{"line":94,"column":51}},"callee":{"type":"MemberExpression","start":3052,"end":3059,"loc":{"start":{"line":94,"column":0},"end":{"line":94,"column":7}},"object":{"type":"Identifier","start":3052,"end":3055,"loc":{"start":{"line":94,"column":0},"end":{"line":94,"column":3}},"name":"app"},"property":{"type":"Identifier","start":3056,"end":3059,"loc":{"start":{"line":94,"column":4},"end":{"line":94,"column":7}},"name":"use"},"computed":false},"arguments":[{"type":"CallExpression","start":3060,"end":3102,"loc":{"start":{"line":94,"column":8},"end":{"line":94,"column":50}},"callee":{"type":"MemberExpression","start":3060,"end":3081,"loc":{"start":{"line":94,"column":8},"end":{"line":94,"column":29}},"object":{"type":"Identifier","start":3060,"end":3070,"loc":{"start":{"line":94,"column":8},"end":{"line":94,"column":18}},"name":"bodyParser"},"property":{"type":"Identifier","start":3071,"end":3081,"loc":{"start":{"line":94,"column":19},"end":{"line":94,"column":29}},"name":"urlencoded"},"computed":false},"arguments":[{"type":"ObjectExpression","start":3082,"end":3101,"loc":{"start":{"line":94,"column":30},"end":{"line":94,"column":49}},"properties":[{"type":"Property","start":3084,"end":3099,"loc":{"start":{"line":94,"column":32},"end":{"line":94,"column":47}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3084,"end":3092,"loc":{"start":{"line":94,"column":32},"end":{"line":94,"column":40}},"name":"extended"},"value":{"type":"Literal","start":3094,"end":3099,"loc":{"start":{"line":94,"column":42},"end":{"line":94,"column":47}},"value":false,"raw":"false"},"kind":"init"}]}]}]}},{"type":"ExpressionStatement","start":3145,"end":3173,"loc":{"start":{"line":97,"column":0},"end":{"line":97,"column":28}},"expression":{"type":"CallExpression","start":3145,"end":3173,"loc":{"start":{"line":97,"column":0},"end":{"line":97,"column":28}},"callee":{"type":"MemberExpression","start":3145,"end":3152,"loc":{"start":{"line":97,"column":0},"end":{"line":97,"column":7}},"object":{"type":"Identifier","start":3145,"end":3148,"loc":{"start":{"line":97,"column":0},"end":{"line":97,"column":3}},"name":"app"},"property":{"type":"Identifier","start":3149,"end":3152,"loc":{"start":{"line":97,"column":4},"end":{"line":97,"column":7}},"name":"use"},"computed":false},"arguments":[{"type":"CallExpression","start":3153,"end":3172,"loc":{"start":{"line":97,"column":8},"end":{"line":97,"column":27}},"callee":{"type":"MemberExpression","start":3153,"end":3170,"loc":{"start":{"line":97,"column":8},"end":{"line":97,"column":25}},"object":{"type":"Identifier","start":3153,"end":3159,"loc":{"start":{"line":97,"column":8},"end":{"line":97,"column":14}},"name":"helmet"},"property":{"type":"Identifier","start":3160,"end":3170,"loc":{"start":{"line":97,"column":15},"end":{"line":97,"column":25}},"name":"frameguard"},"computed":false},"arguments":[]}]},"comments":[{"type":"Line","value":" Use helmet to secure Express headers","start":3105,"end":3144,"loc":{"start":{"line":96,"column":0},"end":{"line":96,"column":39}}}]},{"type":"ExpressionStatement","start":3174,"end":3201,"loc":{"start":{"line":98,"column":0},"end":{"line":98,"column":27}},"expression":{"type":"CallExpression","start":3174,"end":3201,"loc":{"start":{"line":98,"column":0},"end":{"line":98,"column":27}},"callee":{"type":"MemberExpression","start":3174,"end":3181,"loc":{"start":{"line":98,"column":0},"end":{"line":98,"column":7}},"object":{"type":"Identifier","start":3174,"end":3177,"loc":{"start":{"line":98,"column":0},"end":{"line":98,"column":3}},"name":"app"},"property":{"type":"Identifier","start":3178,"end":3181,"loc":{"start":{"line":98,"column":4},"end":{"line":98,"column":7}},"name":"use"},"computed":false},"arguments":[{"type":"CallExpression","start":3182,"end":3200,"loc":{"start":{"line":98,"column":8},"end":{"line":98,"column":26}},"callee":{"type":"MemberExpression","start":3182,"end":3198,"loc":{"start":{"line":98,"column":8},"end":{"line":98,"column":24}},"object":{"type":"Identifier","start":3182,"end":3188,"loc":{"start":{"line":98,"column":8},"end":{"line":98,"column":14}},"name":"helmet"},"property":{"type":"Identifier","start":3189,"end":3198,"loc":{"start":{"line":98,"column":15},"end":{"line":98,"column":24}},"name":"xssFilter"},"computed":false},"arguments":[]}]}},{"type":"ExpressionStatement","start":3202,"end":3227,"loc":{"start":{"line":99,"column":0},"end":{"line":99,"column":25}},"expression":{"type":"CallExpression","start":3202,"end":3227,"loc":{"start":{"line":99,"column":0},"end":{"line":99,"column":25}},"callee":{"type":"MemberExpression","start":3202,"end":3209,"loc":{"start":{"line":99,"column":0},"end":{"line":99,"column":7}},"object":{"type":"Identifier","start":3202,"end":3205,"loc":{"start":{"line":99,"column":0},"end":{"line":99,"column":3}},"name":"app"},"property":{"type":"Identifier","start":3206,"end":3209,"loc":{"start":{"line":99,"column":4},"end":{"line":99,"column":7}},"name":"use"},"computed":false},"arguments":[{"type":"CallExpression","start":3210,"end":3226,"loc":{"start":{"line":99,"column":8},"end":{"line":99,"column":24}},"callee":{"type":"MemberExpression","start":3210,"end":3224,"loc":{"start":{"line":99,"column":8},"end":{"line":99,"column":22}},"object":{"type":"Identifier","start":3210,"end":3216,"loc":{"start":{"line":99,"column":8},"end":{"line":99,"column":14}},"name":"helmet"},"property":{"type":"Identifier","start":3217,"end":3224,"loc":{"start":{"line":99,"column":15},"end":{"line":99,"column":22}},"name":"noSniff"},"computed":false},"arguments":[]}]}},{"type":"ExpressionStatement","start":3228,"end":3254,"loc":{"start":{"line":100,"column":0},"end":{"line":100,"column":26}},"expression":{"type":"CallExpression","start":3228,"end":3254,"loc":{"start":{"line":100,"column":0},"end":{"line":100,"column":26}},"callee":{"type":"MemberExpression","start":3228,"end":3235,"loc":{"start":{"line":100,"column":0},"end":{"line":100,"column":7}},"object":{"type":"Identifier","start":3228,"end":3231,"loc":{"start":{"line":100,"column":0},"end":{"line":100,"column":3}},"name":"app"},"property":{"type":"Identifier","start":3232,"end":3235,"loc":{"start":{"line":100,"column":4},"end":{"line":100,"column":7}},"name":"use"},"computed":false},"arguments":[{"type":"CallExpression","start":3236,"end":3253,"loc":{"start":{"line":100,"column":8},"end":{"line":100,"column":25}},"callee":{"type":"MemberExpression","start":3236,"end":3251,"loc":{"start":{"line":100,"column":8},"end":{"line":100,"column":23}},"object":{"type":"Identifier","start":3236,"end":3242,"loc":{"start":{"line":100,"column":8},"end":{"line":100,"column":14}},"name":"helmet"},"property":{"type":"Identifier","start":3243,"end":3251,"loc":{"start":{"line":100,"column":15},"end":{"line":100,"column":23}},"name":"ieNoOpen"},"computed":false},"arguments":[]}]}},{"type":"ExpressionStatement","start":3255,"end":3282,"loc":{"start":{"line":101,"column":0},"end":{"line":101,"column":27}},"expression":{"type":"CallExpression","start":3255,"end":3282,"loc":{"start":{"line":101,"column":0},"end":{"line":101,"column":27}},"callee":{"type":"MemberExpression","start":3255,"end":3266,"loc":{"start":{"line":101,"column":0},"end":{"line":101,"column":11}},"object":{"type":"Identifier","start":3255,"end":3258,"loc":{"start":{"line":101,"column":0},"end":{"line":101,"column":3}},"name":"app"},"property":{"type":"Identifier","start":3259,"end":3266,"loc":{"start":{"line":101,"column":4},"end":{"line":101,"column":11}},"name":"disable"},"computed":false},"arguments":[{"type":"Literal","start":3267,"end":3281,"loc":{"start":{"line":101,"column":12},"end":{"line":101,"column":26}},"value":"x-powered-by","raw":"'x-powered-by'"}]}},{"type":"VariableDeclaration","start":3284,"end":3337,"loc":{"start":{"line":103,"column":0},"end":{"line":103,"column":53}},"declarations":[{"type":"VariableDeclarator","start":3290,"end":3337,"loc":{"start":{"line":103,"column":6},"end":{"line":103,"column":53}},"id":{"type":"Identifier","start":3290,"end":3306,"loc":{"start":{"line":103,"column":6},"end":{"line":103,"column":22}},"name":"companionOptions"},"init":{"type":"CallExpression","start":3309,"end":3337,"loc":{"start":{"line":103,"column":25},"end":{"line":103,"column":53}},"callee":{"type":"MemberExpression","start":3309,"end":3335,"loc":{"start":{"line":103,"column":25},"end":{"line":103,"column":51}},"object":{"type":"Identifier","start":3309,"end":3315,"loc":{"start":{"line":103,"column":25},"end":{"line":103,"column":31}},"name":"helper"},"property":{"type":"Identifier","start":3316,"end":3335,"loc":{"start":{"line":103,"column":32},"end":{"line":103,"column":51}},"name":"getCompanionOptions"},"computed":false},"arguments":[]}}],"kind":"const"},{"type":"VariableDeclaration","start":3338,"end":3441,"loc":{"start":{"line":104,"column":0},"end":{"line":108,"column":1}},"declarations":[{"type":"VariableDeclarator","start":3344,"end":3441,"loc":{"start":{"line":104,"column":6},"end":{"line":108,"column":1}},"id":{"type":"Identifier","start":3344,"end":3358,"loc":{"start":{"line":104,"column":6},"end":{"line":104,"column":20}},"name":"sessionOptions"},"init":{"type":"ObjectExpression","start":3361,"end":3441,"loc":{"start":{"line":104,"column":23},"end":{"line":108,"column":1}},"properties":[{"type":"Property","start":3365,"end":3396,"loc":{"start":{"line":105,"column":2},"end":{"line":105,"column":33}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3365,"end":3371,"loc":{"start":{"line":105,"column":2},"end":{"line":105,"column":8}},"name":"secret"},"value":{"type":"MemberExpression","start":3373,"end":3396,"loc":{"start":{"line":105,"column":10},"end":{"line":105,"column":33}},"object":{"type":"Identifier","start":3373,"end":3389,"loc":{"start":{"line":105,"column":10},"end":{"line":105,"column":26}},"name":"companionOptions"},"property":{"type":"Identifier","start":3390,"end":3396,"loc":{"start":{"line":105,"column":27},"end":{"line":105,"column":33}},"name":"secret"},"computed":false},"kind":"init"},{"type":"Property","start":3400,"end":3412,"loc":{"start":{"line":106,"column":2},"end":{"line":106,"column":14}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3400,"end":3406,"loc":{"start":{"line":106,"column":2},"end":{"line":106,"column":8}},"name":"resave"},"value":{"type":"Literal","start":3408,"end":3412,"loc":{"start":{"line":106,"column":10},"end":{"line":106,"column":14}},"value":true,"raw":"true"},"kind":"init"},{"type":"Property","start":3416,"end":3439,"loc":{"start":{"line":107,"column":2},"end":{"line":107,"column":25}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3416,"end":3433,"loc":{"start":{"line":107,"column":2},"end":{"line":107,"column":19}},"name":"saveUninitialized"},"value":{"type":"Literal","start":3435,"end":3439,"loc":{"start":{"line":107,"column":21},"end":{"line":107,"column":25}},"value":true,"raw":"true"},"kind":"init"}]}}],"kind":"const"},{"type":"IfStatement","start":3443,"end":3714,"loc":{"start":{"line":110,"column":0},"end":{"line":116,"column":1}},"test":{"type":"MemberExpression","start":3447,"end":3472,"loc":{"start":{"line":110,"column":4},"end":{"line":110,"column":29}},"object":{"type":"Identifier","start":3447,"end":3463,"loc":{"start":{"line":110,"column":4},"end":{"line":110,"column":20}},"name":"companionOptions"},"property":{"type":"Identifier","start":3464,"end":3472,"loc":{"start":{"line":110,"column":21},"end":{"line":110,"column":29}},"name":"redisUrl"},"computed":false},"consequent":{"type":"BlockStatement","start":3474,"end":3714,"loc":{"start":{"line":110,"column":31},"end":{"line":116,"column":1}},"body":[{"type":"VariableDeclaration","start":3478,"end":3530,"loc":{"start":{"line":111,"column":2},"end":{"line":111,"column":54}},"declarations":[{"type":"VariableDeclarator","start":3484,"end":3530,"loc":{"start":{"line":111,"column":8},"end":{"line":111,"column":54}},"id":{"type":"Identifier","start":3484,"end":3494,"loc":{"start":{"line":111,"column":8},"end":{"line":111,"column":18}},"name":"RedisStore"},"init":{"type":"CallExpression","start":3497,"end":3530,"loc":{"start":{"line":111,"column":21},"end":{"line":111,"column":54}},"callee":{"type":"CallExpression","start":3497,"end":3521,"loc":{"start":{"line":111,"column":21},"end":{"line":111,"column":45}},"callee":{"type":"Identifier","start":3497,"end":3504,"loc":{"start":{"line":111,"column":21},"end":{"line":111,"column":28}},"name":"require"},"arguments":[{"type":"Literal","start":3505,"end":3520,"loc":{"start":{"line":111,"column":29},"end":{"line":111,"column":44}},"value":"connect-redis","raw":"'connect-redis'"}]},"arguments":[{"type":"Identifier","start":3522,"end":3529,"loc":{"start":{"line":111,"column":46},"end":{"line":111,"column":53}},"name":"session"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":3533,"end":3647,"loc":{"start":{"line":112,"column":2},"end":{"line":114,"column":3}},"declarations":[{"type":"VariableDeclarator","start":3539,"end":3647,"loc":{"start":{"line":112,"column":8},"end":{"line":114,"column":3}},"id":{"type":"Identifier","start":3539,"end":3550,"loc":{"start":{"line":112,"column":8},"end":{"line":112,"column":19}},"name":"redisClient"},"init":{"type":"CallExpression","start":3553,"end":3647,"loc":{"start":{"line":112,"column":22},"end":{"line":114,"column":3}},"callee":{"type":"MemberExpression","start":3553,"end":3565,"loc":{"start":{"line":112,"column":22},"end":{"line":112,"column":34}},"object":{"type":"Identifier","start":3553,"end":3558,"loc":{"start":{"line":112,"column":22},"end":{"line":112,"column":27}},"name":"redis"},"property":{"type":"Identifier","start":3559,"end":3565,"loc":{"start":{"line":112,"column":28},"end":{"line":112,"column":34}},"name":"client"},"computed":false},"arguments":[{"type":"CallExpression","start":3571,"end":3643,"loc":{"start":{"line":113,"column":4},"end":{"line":113,"column":76}},"callee":{"type":"Identifier","start":3571,"end":3576,"loc":{"start":{"line":113,"column":4},"end":{"line":113,"column":9}},"name":"merge"},"arguments":[{"type":"ObjectExpression","start":3577,"end":3611,"loc":{"start":{"line":113,"column":10},"end":{"line":113,"column":44}},"properties":[{"type":"Property","start":3579,"end":3609,"loc":{"start":{"line":113,"column":12},"end":{"line":113,"column":42}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3579,"end":3582,"loc":{"start":{"line":113,"column":12},"end":{"line":113,"column":15}},"name":"url"},"value":{"type":"MemberExpression","start":3584,"end":3609,"loc":{"start":{"line":113,"column":17},"end":{"line":113,"column":42}},"object":{"type":"Identifier","start":3584,"end":3600,"loc":{"start":{"line":113,"column":17},"end":{"line":113,"column":33}},"name":"companionOptions"},"property":{"type":"Identifier","start":3601,"end":3609,"loc":{"start":{"line":113,"column":34},"end":{"line":113,"column":42}},"name":"redisUrl"},"computed":false},"kind":"init"}]},{"type":"MemberExpression","start":3613,"end":3642,"loc":{"start":{"line":113,"column":46},"end":{"line":113,"column":75}},"object":{"type":"Identifier","start":3613,"end":3629,"loc":{"start":{"line":113,"column":46},"end":{"line":113,"column":62}},"name":"companionOptions"},"property":{"type":"Identifier","start":3630,"end":3642,"loc":{"start":{"line":113,"column":63},"end":{"line":113,"column":75}},"name":"redisOptions"},"computed":false}]}]}}],"kind":"const"},{"type":"ExpressionStatement","start":3650,"end":3712,"loc":{"start":{"line":115,"column":2},"end":{"line":115,"column":64}},"expression":{"type":"AssignmentExpression","start":3650,"end":3712,"loc":{"start":{"line":115,"column":2},"end":{"line":115,"column":64}},"operator":"=","left":{"type":"MemberExpression","start":3650,"end":3670,"loc":{"start":{"line":115,"column":2},"end":{"line":115,"column":22}},"object":{"type":"Identifier","start":3650,"end":3664,"loc":{"start":{"line":115,"column":2},"end":{"line":115,"column":16}},"name":"sessionOptions"},"property":{"type":"Identifier","start":3665,"end":3670,"loc":{"start":{"line":115,"column":17},"end":{"line":115,"column":22}},"name":"store"},"computed":false},"right":{"type":"NewExpression","start":3673,"end":3712,"loc":{"start":{"line":115,"column":25},"end":{"line":115,"column":64}},"callee":{"type":"Identifier","start":3677,"end":3687,"loc":{"start":{"line":115,"column":29},"end":{"line":115,"column":39}},"name":"RedisStore"},"arguments":[{"type":"ObjectExpression","start":3688,"end":3711,"loc":{"start":{"line":115,"column":40},"end":{"line":115,"column":63}},"properties":[{"type":"Property","start":3690,"end":3709,"loc":{"start":{"line":115,"column":42},"end":{"line":115,"column":61}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3690,"end":3696,"loc":{"start":{"line":115,"column":42},"end":{"line":115,"column":48}},"name":"client"},"value":{"type":"Identifier","start":3698,"end":3709,"loc":{"start":{"line":115,"column":50},"end":{"line":115,"column":61}},"name":"redisClient"},"kind":"init"}]}]}}}]},"alternate":null},{"type":"IfStatement","start":3716,"end":3882,"loc":{"start":{"line":118,"column":0},"end":{"line":123,"column":1}},"test":{"type":"MemberExpression","start":3720,"end":3755,"loc":{"start":{"line":118,"column":4},"end":{"line":118,"column":39}},"object":{"type":"MemberExpression","start":3720,"end":3731,"loc":{"start":{"line":118,"column":4},"end":{"line":118,"column":15}},"object":{"type":"Identifier","start":3720,"end":3727,"loc":{"start":{"line":118,"column":4},"end":{"line":118,"column":11}},"name":"process"},"property":{"type":"Identifier","start":3728,"end":3731,"loc":{"start":{"line":118,"column":12},"end":{"line":118,"column":15}},"name":"env"},"computed":false},"property":{"type":"Identifier","start":3732,"end":3755,"loc":{"start":{"line":118,"column":16},"end":{"line":118,"column":39}},"name":"COMPANION_COOKIE_DOMAIN"},"computed":false},"consequent":{"type":"BlockStatement","start":3757,"end":3882,"loc":{"start":{"line":118,"column":41},"end":{"line":123,"column":1}},"body":[{"type":"ExpressionStatement","start":3761,"end":3880,"loc":{"start":{"line":119,"column":2},"end":{"line":122,"column":3}},"expression":{"type":"AssignmentExpression","start":3761,"end":3880,"loc":{"start":{"line":119,"column":2},"end":{"line":122,"column":3}},"operator":"=","left":{"type":"MemberExpression","start":3761,"end":3782,"loc":{"start":{"line":119,"column":2},"end":{"line":119,"column":23}},"object":{"type":"Identifier","start":3761,"end":3775,"loc":{"start":{"line":119,"column":2},"end":{"line":119,"column":16}},"name":"sessionOptions"},"property":{"type":"Identifier","start":3776,"end":3782,"loc":{"start":{"line":119,"column":17},"end":{"line":119,"column":23}},"name":"cookie"},"computed":false},"right":{"type":"ObjectExpression","start":3785,"end":3880,"loc":{"start":{"line":119,"column":26},"end":{"line":122,"column":3}},"properties":[{"type":"Property","start":3791,"end":3834,"loc":{"start":{"line":120,"column":4},"end":{"line":120,"column":47}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3791,"end":3797,"loc":{"start":{"line":120,"column":4},"end":{"line":120,"column":10}},"name":"domain"},"value":{"type":"MemberExpression","start":3799,"end":3834,"loc":{"start":{"line":120,"column":12},"end":{"line":120,"column":47}},"object":{"type":"MemberExpression","start":3799,"end":3810,"loc":{"start":{"line":120,"column":12},"end":{"line":120,"column":23}},"object":{"type":"Identifier","start":3799,"end":3806,"loc":{"start":{"line":120,"column":12},"end":{"line":120,"column":19}},"name":"process"},"property":{"type":"Identifier","start":3807,"end":3810,"loc":{"start":{"line":120,"column":20},"end":{"line":120,"column":23}},"name":"env"},"computed":false},"property":{"type":"Identifier","start":3811,"end":3834,"loc":{"start":{"line":120,"column":24},"end":{"line":120,"column":47}},"name":"COMPANION_COOKIE_DOMAIN"},"computed":false},"kind":"init"},{"type":"Property","start":3840,"end":3867,"loc":{"start":{"line":121,"column":4},"end":{"line":121,"column":31}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3840,"end":3846,"loc":{"start":{"line":121,"column":4},"end":{"line":121,"column":10}},"name":"maxAge"},"value":{"type":"BinaryExpression","start":3848,"end":3867,"loc":{"start":{"line":121,"column":12},"end":{"line":121,"column":31}},"left":{"type":"BinaryExpression","start":3848,"end":3860,"loc":{"start":{"line":121,"column":12},"end":{"line":121,"column":24}},"left":{"type":"BinaryExpression","start":3848,"end":3855,"loc":{"start":{"line":121,"column":12},"end":{"line":121,"column":19}},"left":{"type":"Literal","start":3848,"end":3850,"loc":{"start":{"line":121,"column":12},"end":{"line":121,"column":14}},"value":24,"raw":"24"},"operator":"*","right":{"type":"Literal","start":3853,"end":3855,"loc":{"start":{"line":121,"column":17},"end":{"line":121,"column":19}},"value":60,"raw":"60"}},"operator":"*","right":{"type":"Literal","start":3858,"end":3860,"loc":{"start":{"line":121,"column":22},"end":{"line":121,"column":24}},"value":60,"raw":"60"}},"operator":"*","right":{"type":"Literal","start":3863,"end":3867,"loc":{"start":{"line":121,"column":27},"end":{"line":121,"column":31}},"value":1000,"raw":"1000"}},"kind":"init","comments":[{"type":"Line","value":" 1 day","start":3868,"end":3876,"loc":{"start":{"line":121,"column":32},"end":{"line":121,"column":40}}}]}]}}}]},"alternate":null},{"type":"ExpressionStatement","start":3884,"end":3916,"loc":{"start":{"line":125,"column":0},"end":{"line":125,"column":32}},"expression":{"type":"CallExpression","start":3884,"end":3916,"loc":{"start":{"line":125,"column":0},"end":{"line":125,"column":32}},"callee":{"type":"MemberExpression","start":3884,"end":3891,"loc":{"start":{"line":125,"column":0},"end":{"line":125,"column":7}},"object":{"type":"Identifier","start":3884,"end":3887,"loc":{"start":{"line":125,"column":0},"end":{"line":125,"column":3}},"name":"app"},"property":{"type":"Identifier","start":3888,"end":3891,"loc":{"start":{"line":125,"column":4},"end":{"line":125,"column":7}},"name":"use"},"computed":false},"arguments":[{"type":"CallExpression","start":3892,"end":3915,"loc":{"start":{"line":125,"column":8},"end":{"line":125,"column":31}},"callee":{"type":"Identifier","start":3892,"end":3899,"loc":{"start":{"line":125,"column":8},"end":{"line":125,"column":15}},"name":"session"},"arguments":[{"type":"Identifier","start":3900,"end":3914,"loc":{"start":{"line":125,"column":16},"end":{"line":125,"column":30}},"name":"sessionOptions"}]}]}},{"type":"ExpressionStatement","start":3918,"end":5027,"loc":{"start":{"line":127,"column":0},"end":{"line":157,"column":2}},"expression":{"type":"CallExpression","start":3918,"end":5027,"loc":{"start":{"line":127,"column":0},"end":{"line":157,"column":2}},"callee":{"type":"MemberExpression","start":3918,"end":3925,"loc":{"start":{"line":127,"column":0},"end":{"line":127,"column":7}},"object":{"type":"Identifier","start":3918,"end":3921,"loc":{"start":{"line":127,"column":0},"end":{"line":127,"column":3}},"name":"app"},"property":{"type":"Identifier","start":3922,"end":3925,"loc":{"start":{"line":127,"column":4},"end":{"line":127,"column":7}},"name":"use"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":3926,"end":5026,"loc":{"start":{"line":127,"column":8},"end":{"line":157,"column":1}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":3927,"end":3930,"loc":{"start":{"line":127,"column":9},"end":{"line":127,"column":12}},"name":"req"},{"type":"Identifier","start":3932,"end":3935,"loc":{"start":{"line":127,"column":14},"end":{"line":127,"column":17}},"name":"res"},{"type":"Identifier","start":3937,"end":3941,"loc":{"start":{"line":127,"column":19},"end":{"line":127,"column":23}},"name":"next"}],"body":{"type":"BlockStatement","start":3946,"end":5026,"loc":{"start":{"line":127,"column":28},"end":{"line":157,"column":1}},"body":[{"type":"VariableDeclaration","start":3950,"end":4007,"loc":{"start":{"line":128,"column":2},"end":{"line":128,"column":59}},"declarations":[{"type":"VariableDeclarator","start":3956,"end":4007,"loc":{"start":{"line":128,"column":8},"end":{"line":128,"column":59}},"id":{"type":"Identifier","start":3956,"end":3964,"loc":{"start":{"line":128,"column":8},"end":{"line":128,"column":16}},"name":"protocol"},"init":{"type":"LogicalExpression","start":3967,"end":4007,"loc":{"start":{"line":128,"column":19},"end":{"line":128,"column":59}},"left":{"type":"MemberExpression","start":3967,"end":3997,"loc":{"start":{"line":128,"column":19},"end":{"line":128,"column":49}},"object":{"type":"MemberExpression","start":3967,"end":3978,"loc":{"start":{"line":128,"column":19},"end":{"line":128,"column":30}},"object":{"type":"Identifier","start":3967,"end":3974,"loc":{"start":{"line":128,"column":19},"end":{"line":128,"column":26}},"name":"process"},"property":{"type":"Identifier","start":3975,"end":3978,"loc":{"start":{"line":128,"column":27},"end":{"line":128,"column":30}},"name":"env"},"computed":false},"property":{"type":"Identifier","start":3979,"end":3997,"loc":{"start":{"line":128,"column":31},"end":{"line":128,"column":49}},"name":"COMPANION_PROTOCOL"},"computed":false},"operator":"||","right":{"type":"Literal","start":4001,"end":4007,"loc":{"start":{"line":128,"column":53},"end":{"line":128,"column":59}},"value":"http","raw":"'http'"}}}],"kind":"const"},{"type":"IfStatement","start":4223,"end":4805,"loc":{"start":{"line":133,"column":2},"end":{"line":146,"column":3}},"test":{"type":"MemberExpression","start":4227,"end":4263,"loc":{"start":{"line":133,"column":6},"end":{"line":133,"column":42}},"object":{"type":"MemberExpression","start":4227,"end":4238,"loc":{"start":{"line":133,"column":6},"end":{"line":133,"column":17}},"object":{"type":"Identifier","start":4227,"end":4234,"loc":{"start":{"line":133,"column":6},"end":{"line":133,"column":13}},"name":"process"},"property":{"type":"Identifier","start":4235,"end":4238,"loc":{"start":{"line":133,"column":14},"end":{"line":133,"column":17}},"name":"env"},"computed":false},"property":{"type":"Identifier","start":4239,"end":4263,"loc":{"start":{"line":133,"column":18},"end":{"line":133,"column":42}},"name":"COMPANION_CLIENT_ORIGINS"},"computed":false},"consequent":{"type":"BlockStatement","start":4265,"end":4718,"loc":{"start":{"line":133,"column":44},"end":{"line":144,"column":3}},"body":[{"type":"VariableDeclaration","start":4271,"end":4419,"loc":{"start":{"line":134,"column":4},"end":{"line":136,"column":75}},"declarations":[{"type":"VariableDeclarator","start":4277,"end":4419,"loc":{"start":{"line":134,"column":10},"end":{"line":136,"column":75}},"id":{"type":"Identifier","start":4277,"end":4286,"loc":{"start":{"line":134,"column":10},"end":{"line":134,"column":19}},"name":"whitelist"},"init":{"type":"CallExpression","start":4289,"end":4419,"loc":{"start":{"line":134,"column":22},"end":{"line":136,"column":75}},"callee":{"type":"MemberExpression","start":4289,"end":4354,"loc":{"start":{"line":134,"column":22},"end":{"line":136,"column":10}},"object":{"type":"CallExpression","start":4289,"end":4343,"loc":{"start":{"line":134,"column":22},"end":{"line":135,"column":17}},"callee":{"type":"MemberExpression","start":4289,"end":4338,"loc":{"start":{"line":134,"column":22},"end":{"line":135,"column":12}},"object":{"type":"MemberExpression","start":4289,"end":4325,"loc":{"start":{"line":134,"column":22},"end":{"line":134,"column":58}},"object":{"type":"MemberExpression","start":4289,"end":4300,"loc":{"start":{"line":134,"column":22},"end":{"line":134,"column":33}},"object":{"type":"Identifier","start":4289,"end":4296,"loc":{"start":{"line":134,"column":22},"end":{"line":134,"column":29}},"name":"process"},"property":{"type":"Identifier","start":4297,"end":4300,"loc":{"start":{"line":134,"column":30},"end":{"line":134,"column":33}},"name":"env"},"computed":false},"property":{"type":"Identifier","start":4301,"end":4325,"loc":{"start":{"line":134,"column":34},"end":{"line":134,"column":58}},"name":"COMPANION_CLIENT_ORIGINS"},"computed":false},"property":{"type":"Identifier","start":4333,"end":4338,"loc":{"start":{"line":135,"column":7},"end":{"line":135,"column":12}},"name":"split"},"computed":false},"arguments":[{"type":"Literal","start":4339,"end":4342,"loc":{"start":{"line":135,"column":13},"end":{"line":135,"column":16}},"value":",","raw":"','"}]},"property":{"type":"Identifier","start":4351,"end":4354,"loc":{"start":{"line":136,"column":7},"end":{"line":136,"column":10}},"name":"map"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":4355,"end":4418,"loc":{"start":{"line":136,"column":11},"end":{"line":136,"column":74}},"id":null,"expression":true,"generator":false,"async":false,"params":[{"type":"Identifier","start":4356,"end":4359,"loc":{"start":{"line":136,"column":12},"end":{"line":136,"column":15}},"name":"url"}],"body":{"type":"ConditionalExpression","start":4364,"end":4418,"loc":{"start":{"line":136,"column":20},"end":{"line":136,"column":74}},"test":{"type":"CallExpression","start":4364,"end":4387,"loc":{"start":{"line":136,"column":20},"end":{"line":136,"column":43}},"callee":{"type":"MemberExpression","start":4364,"end":4382,"loc":{"start":{"line":136,"column":20},"end":{"line":136,"column":38}},"object":{"type":"Identifier","start":4364,"end":4370,"loc":{"start":{"line":136,"column":20},"end":{"line":136,"column":26}},"name":"helper"},"property":{"type":"Identifier","start":4371,"end":4382,"loc":{"start":{"line":136,"column":27},"end":{"line":136,"column":38}},"name":"hasProtocol"},"computed":false},"arguments":[{"type":"Identifier","start":4383,"end":4386,"loc":{"start":{"line":136,"column":39},"end":{"line":136,"column":42}},"name":"url"}]},"consequent":{"type":"Identifier","start":4390,"end":4393,"loc":{"start":{"line":136,"column":46},"end":{"line":136,"column":49}},"name":"url"},"alternate":{"type":"TemplateLiteral","start":4396,"end":4418,"loc":{"start":{"line":136,"column":52},"end":{"line":136,"column":74}},"expressions":[{"type":"Identifier","start":4399,"end":4407,"loc":{"start":{"line":136,"column":55},"end":{"line":136,"column":63}},"name":"protocol"},{"type":"Identifier","start":4413,"end":4416,"loc":{"start":{"line":136,"column":69},"end":{"line":136,"column":72}},"name":"url"}],"quasis":[{"type":"TemplateElement","start":4397,"end":4397,"loc":{"start":{"line":136,"column":53},"end":{"line":136,"column":53}},"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":4408,"end":4411,"loc":{"start":{"line":136,"column":64},"end":{"line":136,"column":67}},"value":{"raw":"://","cooked":"://"},"tail":false},{"type":"TemplateElement","start":4417,"end":4417,"loc":{"start":{"line":136,"column":73},"end":{"line":136,"column":73}},"value":{"raw":"","cooked":""},"tail":true}]}}}]}}],"kind":"const"},{"type":"IfStatement","start":4443,"end":4714,"loc":{"start":{"line":139,"column":4},"end":{"line":143,"column":5}},"test":{"type":"LogicalExpression","start":4447,"end":4511,"loc":{"start":{"line":139,"column":8},"end":{"line":139,"column":72}},"left":{"type":"MemberExpression","start":4447,"end":4465,"loc":{"start":{"line":139,"column":8},"end":{"line":139,"column":26}},"object":{"type":"MemberExpression","start":4447,"end":4458,"loc":{"start":{"line":139,"column":8},"end":{"line":139,"column":19}},"object":{"type":"Identifier","start":4447,"end":4450,"loc":{"start":{"line":139,"column":8},"end":{"line":139,"column":11}},"name":"req"},"property":{"type":"Identifier","start":4451,"end":4458,"loc":{"start":{"line":139,"column":12},"end":{"line":139,"column":19}},"name":"headers"},"computed":false},"property":{"type":"Identifier","start":4459,"end":4465,"loc":{"start":{"line":139,"column":20},"end":{"line":139,"column":26}},"name":"origin"},"computed":false},"operator":"&&","right":{"type":"BinaryExpression","start":4469,"end":4511,"loc":{"start":{"line":139,"column":30},"end":{"line":139,"column":72}},"left":{"type":"CallExpression","start":4469,"end":4506,"loc":{"start":{"line":139,"column":30},"end":{"line":139,"column":67}},"callee":{"type":"MemberExpression","start":4469,"end":4486,"loc":{"start":{"line":139,"column":30},"end":{"line":139,"column":47}},"object":{"type":"Identifier","start":4469,"end":4478,"loc":{"start":{"line":139,"column":30},"end":{"line":139,"column":39}},"name":"whitelist"},"property":{"type":"Identifier","start":4479,"end":4486,"loc":{"start":{"line":139,"column":40},"end":{"line":139,"column":47}},"name":"indexOf"},"computed":false},"arguments":[{"type":"MemberExpression","start":4487,"end":4505,"loc":{"start":{"line":139,"column":48},"end":{"line":139,"column":66}},"object":{"type":"MemberExpression","start":4487,"end":4498,"loc":{"start":{"line":139,"column":48},"end":{"line":139,"column":59}},"object":{"type":"Identifier","start":4487,"end":4490,"loc":{"start":{"line":139,"column":48},"end":{"line":139,"column":51}},"name":"req"},"property":{"type":"Identifier","start":4491,"end":4498,"loc":{"start":{"line":139,"column":52},"end":{"line":139,"column":59}},"name":"headers"},"computed":false},"property":{"type":"Identifier","start":4499,"end":4505,"loc":{"start":{"line":139,"column":60},"end":{"line":139,"column":66}},"name":"origin"},"computed":false}]},"operator":">","right":{"type":"UnaryExpression","start":4509,"end":4511,"loc":{"start":{"line":139,"column":70},"end":{"line":139,"column":72}},"operator":"-","prefix":true,"argument":{"type":"Literal","start":4510,"end":4511,"loc":{"start":{"line":139,"column":71},"end":{"line":139,"column":72}},"value":1,"raw":"1"}}}},"consequent":{"type":"BlockStatement","start":4513,"end":4714,"loc":{"start":{"line":139,"column":74},"end":{"line":143,"column":5}},"body":[{"type":"ExpressionStatement","start":4521,"end":4585,"loc":{"start":{"line":140,"column":6},"end":{"line":140,"column":70}},"expression":{"type":"CallExpression","start":4521,"end":4585,"loc":{"start":{"line":140,"column":6},"end":{"line":140,"column":70}},"callee":{"type":"MemberExpression","start":4521,"end":4534,"loc":{"start":{"line":140,"column":6},"end":{"line":140,"column":19}},"object":{"type":"Identifier","start":4521,"end":4524,"loc":{"start":{"line":140,"column":6},"end":{"line":140,"column":9}},"name":"res"},"property":{"type":"Identifier","start":4525,"end":4534,"loc":{"start":{"line":140,"column":10},"end":{"line":140,"column":19}},"name":"setHeader"},"computed":false},"arguments":[{"type":"Literal","start":4535,"end":4564,"loc":{"start":{"line":140,"column":20},"end":{"line":140,"column":49}},"value":"Access-Control-Allow-Origin","raw":"'Access-Control-Allow-Origin'"},{"type":"MemberExpression","start":4566,"end":4584,"loc":{"start":{"line":140,"column":51},"end":{"line":140,"column":69}},"object":{"type":"MemberExpression","start":4566,"end":4577,"loc":{"start":{"line":140,"column":51},"end":{"line":140,"column":62}},"object":{"type":"Identifier","start":4566,"end":4569,"loc":{"start":{"line":140,"column":51},"end":{"line":140,"column":54}},"name":"req"},"property":{"type":"Identifier","start":4570,"end":4577,"loc":{"start":{"line":140,"column":55},"end":{"line":140,"column":62}},"name":"headers"},"computed":false},"property":{"type":"Identifier","start":4578,"end":4584,"loc":{"start":{"line":140,"column":63},"end":{"line":140,"column":69}},"name":"origin"},"computed":false}]}},{"type":"ExpressionStatement","start":4651,"end":4708,"loc":{"start":{"line":142,"column":6},"end":{"line":142,"column":63}},"expression":{"type":"CallExpression","start":4651,"end":4708,"loc":{"start":{"line":142,"column":6},"end":{"line":142,"column":63}},"callee":{"type":"MemberExpression","start":4651,"end":4664,"loc":{"start":{"line":142,"column":6},"end":{"line":142,"column":19}},"object":{"type":"Identifier","start":4651,"end":4654,"loc":{"start":{"line":142,"column":6},"end":{"line":142,"column":9}},"name":"res"},"property":{"type":"Identifier","start":4655,"end":4664,"loc":{"start":{"line":142,"column":10},"end":{"line":142,"column":19}},"name":"setHeader"},"computed":false},"arguments":[{"type":"Literal","start":4665,"end":4699,"loc":{"start":{"line":142,"column":20},"end":{"line":142,"column":54}},"value":"Access-Control-Allow-Credentials","raw":"'Access-Control-Allow-Credentials'"},{"type":"Literal","start":4701,"end":4707,"loc":{"start":{"line":142,"column":56},"end":{"line":142,"column":62}},"value":"true","raw":"'true'"}]},"comments":[{"type":"Line","value":" only allow credentials when origin is whitelisted","start":4592,"end":4644,"loc":{"start":{"line":141,"column":6},"end":{"line":141,"column":58}}}]}]},"alternate":null,"comments":[{"type":"Line","value":" @ts-ignore","start":4425,"end":4438,"loc":{"start":{"line":138,"column":4},"end":{"line":138,"column":17}}}]}]},"alternate":{"type":"BlockStatement","start":4724,"end":4805,"loc":{"start":{"line":144,"column":9},"end":{"line":146,"column":3}},"body":[{"type":"ExpressionStatement","start":4730,"end":4801,"loc":{"start":{"line":145,"column":4},"end":{"line":145,"column":75}},"expression":{"type":"CallExpression","start":4730,"end":4801,"loc":{"start":{"line":145,"column":4},"end":{"line":145,"column":75}},"callee":{"type":"MemberExpression","start":4730,"end":4743,"loc":{"start":{"line":145,"column":4},"end":{"line":145,"column":17}},"object":{"type":"Identifier","start":4730,"end":4733,"loc":{"start":{"line":145,"column":4},"end":{"line":145,"column":7}},"name":"res"},"property":{"type":"Identifier","start":4734,"end":4743,"loc":{"start":{"line":145,"column":8},"end":{"line":145,"column":17}},"name":"setHeader"},"computed":false},"arguments":[{"type":"Literal","start":4744,"end":4773,"loc":{"start":{"line":145,"column":18},"end":{"line":145,"column":47}},"value":"Access-Control-Allow-Origin","raw":"'Access-Control-Allow-Origin'"},{"type":"LogicalExpression","start":4775,"end":4800,"loc":{"start":{"line":145,"column":49},"end":{"line":145,"column":74}},"left":{"type":"MemberExpression","start":4775,"end":4793,"loc":{"start":{"line":145,"column":49},"end":{"line":145,"column":67}},"object":{"type":"MemberExpression","start":4775,"end":4786,"loc":{"start":{"line":145,"column":49},"end":{"line":145,"column":60}},"object":{"type":"Identifier","start":4775,"end":4778,"loc":{"start":{"line":145,"column":49},"end":{"line":145,"column":52}},"name":"req"},"property":{"type":"Identifier","start":4779,"end":4786,"loc":{"start":{"line":145,"column":53},"end":{"line":145,"column":60}},"name":"headers"},"computed":false},"property":{"type":"Identifier","start":4787,"end":4793,"loc":{"start":{"line":145,"column":61},"end":{"line":145,"column":67}},"name":"origin"},"computed":false},"operator":"||","right":{"type":"Literal","start":4797,"end":4800,"loc":{"start":{"line":145,"column":71},"end":{"line":145,"column":74}},"value":"*","raw":"'*'"}}]}}]},"comments":[{"type":"Line","value":" if endpoint urls are specified, then we only allow those endpoints","start":4011,"end":4080,"loc":{"start":{"line":130,"column":2},"end":{"line":130,"column":71}}},{"type":"Line","value":" otherwise, we allow any client url to access companion.","start":4083,"end":4141,"loc":{"start":{"line":131,"column":2},"end":{"line":131,"column":60}}},{"type":"Line","value":" here we also enforce that only the protocol allowed by companion is used.","start":4144,"end":4220,"loc":{"start":{"line":132,"column":2},"end":{"line":132,"column":78}}}]},{"type":"ExpressionStatement","start":4809,"end":4908,"loc":{"start":{"line":148,"column":2},"end":{"line":151,"column":3}},"expression":{"type":"CallExpression","start":4809,"end":4908,"loc":{"start":{"line":148,"column":2},"end":{"line":151,"column":3}},"callee":{"type":"MemberExpression","start":4809,"end":4822,"loc":{"start":{"line":148,"column":2},"end":{"line":148,"column":15}},"object":{"type":"Identifier","start":4809,"end":4812,"loc":{"start":{"line":148,"column":2},"end":{"line":148,"column":5}},"name":"res"},"property":{"type":"Identifier","start":4813,"end":4822,"loc":{"start":{"line":148,"column":6},"end":{"line":148,"column":15}},"name":"setHeader"},"computed":false},"arguments":[{"type":"Literal","start":4828,"end":4858,"loc":{"start":{"line":149,"column":4},"end":{"line":149,"column":34}},"value":"Access-Control-Allow-Methods","raw":"'Access-Control-Allow-Methods'"},{"type":"Literal","start":4864,"end":4904,"loc":{"start":{"line":150,"column":4},"end":{"line":150,"column":44}},"value":"GET, POST, OPTIONS, PUT, PATCH, DELETE","raw":"'GET, POST, OPTIONS, PUT, PATCH, DELETE'"}]}},{"type":"ExpressionStatement","start":4911,"end":5015,"loc":{"start":{"line":152,"column":2},"end":{"line":155,"column":3}},"expression":{"type":"CallExpression","start":4911,"end":5015,"loc":{"start":{"line":152,"column":2},"end":{"line":155,"column":3}},"callee":{"type":"MemberExpression","start":4911,"end":4924,"loc":{"start":{"line":152,"column":2},"end":{"line":152,"column":15}},"object":{"type":"Identifier","start":4911,"end":4914,"loc":{"start":{"line":152,"column":2},"end":{"line":152,"column":5}},"name":"res"},"property":{"type":"Identifier","start":4915,"end":4924,"loc":{"start":{"line":152,"column":6},"end":{"line":152,"column":15}},"name":"setHeader"},"computed":false},"arguments":[{"type":"Literal","start":4930,"end":4960,"loc":{"start":{"line":153,"column":4},"end":{"line":153,"column":34}},"value":"Access-Control-Allow-Headers","raw":"'Access-Control-Allow-Headers'"},{"type":"Literal","start":4966,"end":5011,"loc":{"start":{"line":154,"column":4},"end":{"line":154,"column":49}},"value":"Authorization, Origin, Content-Type, Accept","raw":"'Authorization, Origin, Content-Type, Accept'"}]}},{"type":"ExpressionStatement","start":5018,"end":5024,"loc":{"start":{"line":156,"column":2},"end":{"line":156,"column":8}},"expression":{"type":"CallExpression","start":5018,"end":5024,"loc":{"start":{"line":156,"column":2},"end":{"line":156,"column":8}},"callee":{"type":"Identifier","start":5018,"end":5022,"loc":{"start":{"line":156,"column":2},"end":{"line":156,"column":6}},"name":"next"},"arguments":[]}}]}}]}},{"type":"ExpressionStatement","start":5039,"end":5180,"loc":{"start":{"line":160,"column":0},"end":{"line":163,"column":2}},"expression":{"type":"CallExpression","start":5039,"end":5180,"loc":{"start":{"line":160,"column":0},"end":{"line":163,"column":2}},"callee":{"type":"MemberExpression","start":5039,"end":5046,"loc":{"start":{"line":160,"column":0},"end":{"line":160,"column":7}},"object":{"type":"Identifier","start":5039,"end":5042,"loc":{"start":{"line":160,"column":0},"end":{"line":160,"column":3}},"name":"app"},"property":{"type":"Identifier","start":5043,"end":5046,"loc":{"start":{"line":160,"column":4},"end":{"line":160,"column":7}},"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":5047,"end":5050,"loc":{"start":{"line":160,"column":8},"end":{"line":160,"column":11}},"value":"/","raw":"'/'"},{"type":"ArrowFunctionExpression","start":5052,"end":5179,"loc":{"start":{"line":160,"column":13},"end":{"line":163,"column":1}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":5053,"end":5056,"loc":{"start":{"line":160,"column":14},"end":{"line":160,"column":17}},"name":"req"},{"type":"Identifier","start":5058,"end":5061,"loc":{"start":{"line":160,"column":19},"end":{"line":160,"column":22}},"name":"res"}],"body":{"type":"BlockStatement","start":5066,"end":5179,"loc":{"start":{"line":160,"column":27},"end":{"line":163,"column":1}},"body":[{"type":"ExpressionStatement","start":5070,"end":5113,"loc":{"start":{"line":161,"column":2},"end":{"line":161,"column":45}},"expression":{"type":"CallExpression","start":5070,"end":5113,"loc":{"start":{"line":161,"column":2},"end":{"line":161,"column":45}},"callee":{"type":"MemberExpression","start":5070,"end":5083,"loc":{"start":{"line":161,"column":2},"end":{"line":161,"column":15}},"object":{"type":"Identifier","start":5070,"end":5073,"loc":{"start":{"line":161,"column":2},"end":{"line":161,"column":5}},"name":"res"},"property":{"type":"Identifier","start":5074,"end":5083,"loc":{"start":{"line":161,"column":6},"end":{"line":161,"column":15}},"name":"setHeader"},"computed":false},"arguments":[{"type":"Literal","start":5084,"end":5098,"loc":{"start":{"line":161,"column":16},"end":{"line":161,"column":30}},"value":"Content-Type","raw":"'Content-Type'"},{"type":"Literal","start":5100,"end":5112,"loc":{"start":{"line":161,"column":32},"end":{"line":161,"column":44}},"value":"text/plain","raw":"'text/plain'"}]}},{"type":"ExpressionStatement","start":5116,"end":5177,"loc":{"start":{"line":162,"column":2},"end":{"line":162,"column":63}},"expression":{"type":"CallExpression","start":5116,"end":5177,"loc":{"start":{"line":162,"column":2},"end":{"line":162,"column":63}},"callee":{"type":"MemberExpression","start":5116,"end":5124,"loc":{"start":{"line":162,"column":2},"end":{"line":162,"column":10}},"object":{"type":"Identifier","start":5116,"end":5119,"loc":{"start":{"line":162,"column":2},"end":{"line":162,"column":5}},"name":"res"},"property":{"type":"Identifier","start":5120,"end":5124,"loc":{"start":{"line":162,"column":6},"end":{"line":162,"column":10}},"name":"send"},"computed":false},"arguments":[{"type":"CallExpression","start":5125,"end":5176,"loc":{"start":{"line":162,"column":11},"end":{"line":162,"column":62}},"callee":{"type":"MemberExpression","start":5125,"end":5158,"loc":{"start":{"line":162,"column":11},"end":{"line":162,"column":44}},"object":{"type":"Identifier","start":5125,"end":5131,"loc":{"start":{"line":162,"column":11},"end":{"line":162,"column":17}},"name":"helper"},"property":{"type":"Identifier","start":5132,"end":5158,"loc":{"start":{"line":162,"column":18},"end":{"line":162,"column":44}},"name":"buildHelpfulStartupMessage"},"computed":false},"arguments":[{"type":"Identifier","start":5159,"end":5175,"loc":{"start":{"line":162,"column":45},"end":{"line":162,"column":61}},"name":"companionOptions"}]}]}}]}}]},"comments":[{"type":"Line","value":" Routes","start":5029,"end":5038,"loc":{"start":{"line":159,"column":0},"end":{"line":159,"column":9}}}]},{"type":"VariableDeclaration","start":5182,"end":5198,"loc":{"start":{"line":165,"column":0},"end":{"line":165,"column":16}},"declarations":[{"type":"VariableDeclarator","start":5186,"end":5198,"loc":{"start":{"line":165,"column":4},"end":{"line":165,"column":16}},"id":{"type":"Identifier","start":5186,"end":5198,"loc":{"start":{"line":165,"column":4},"end":{"line":165,"column":16}},"name":"companionApp"},"init":null}],"kind":"let"},{"type":"TryStatement","start":5199,"end":5371,"loc":{"start":{"line":166,"column":0},"end":{"line":172,"column":1}},"block":{"type":"BlockStatement","start":5203,"end":5281,"loc":{"start":{"line":166,"column":4},"end":{"line":169,"column":1}},"body":[{"type":"ExpressionStatement","start":5233,"end":5279,"loc":{"start":{"line":168,"column":2},"end":{"line":168,"column":48}},"expression":{"type":"AssignmentExpression","start":5233,"end":5279,"loc":{"start":{"line":168,"column":2},"end":{"line":168,"column":48}},"operator":"=","left":{"type":"Identifier","start":5233,"end":5245,"loc":{"start":{"line":168,"column":2},"end":{"line":168,"column":14}},"name":"companionApp"},"right":{"type":"CallExpression","start":5248,"end":5279,"loc":{"start":{"line":168,"column":17},"end":{"line":168,"column":48}},"callee":{"type":"MemberExpression","start":5248,"end":5261,"loc":{"start":{"line":168,"column":17},"end":{"line":168,"column":30}},"object":{"type":"Identifier","start":5248,"end":5257,"loc":{"start":{"line":168,"column":17},"end":{"line":168,"column":26}},"name":"companion"},"property":{"type":"Identifier","start":5258,"end":5261,"loc":{"start":{"line":168,"column":27},"end":{"line":168,"column":30}},"name":"app"},"computed":false},"arguments":[{"type":"Identifier","start":5262,"end":5278,"loc":{"start":{"line":168,"column":31},"end":{"line":168,"column":47}},"name":"companionOptions"}]}},"comments":[{"type":"Line","value":" initialize companion","start":5207,"end":5230,"loc":{"start":{"line":167,"column":2},"end":{"line":167,"column":25}}}]}]},"handler":{"type":"CatchClause","start":5282,"end":5371,"loc":{"start":{"line":169,"column":2},"end":{"line":172,"column":1}},"param":{"type":"Identifier","start":5289,"end":5294,"loc":{"start":{"line":169,"column":9},"end":{"line":169,"column":14}},"name":"error"},"body":{"type":"BlockStatement","start":5296,"end":5371,"loc":{"start":{"line":169,"column":16},"end":{"line":172,"column":1}},"body":[{"type":"ExpressionStatement","start":5300,"end":5351,"loc":{"start":{"line":170,"column":2},"end":{"line":170,"column":53}},"expression":{"type":"CallExpression","start":5300,"end":5351,"loc":{"start":{"line":170,"column":2},"end":{"line":170,"column":53}},"callee":{"type":"MemberExpression","start":5300,"end":5313,"loc":{"start":{"line":170,"column":2},"end":{"line":170,"column":15}},"object":{"type":"Identifier","start":5300,"end":5307,"loc":{"start":{"line":170,"column":2},"end":{"line":170,"column":9}},"name":"console"},"property":{"type":"Identifier","start":5308,"end":5313,"loc":{"start":{"line":170,"column":10},"end":{"line":170,"column":15}},"name":"error"},"computed":false},"arguments":[{"type":"Literal","start":5314,"end":5324,"loc":{"start":{"line":170,"column":16},"end":{"line":170,"column":26}},"value":"\u001b[31m","raw":"'\\x1b[31m'"},{"type":"MemberExpression","start":5326,"end":5339,"loc":{"start":{"line":170,"column":28},"end":{"line":170,"column":41}},"object":{"type":"Identifier","start":5326,"end":5331,"loc":{"start":{"line":170,"column":28},"end":{"line":170,"column":33}},"name":"error"},"property":{"type":"Identifier","start":5332,"end":5339,"loc":{"start":{"line":170,"column":34},"end":{"line":170,"column":41}},"name":"message"},"computed":false},{"type":"Literal","start":5341,"end":5350,"loc":{"start":{"line":170,"column":43},"end":{"line":170,"column":52}},"value":"\u001b[0m","raw":"'\\x1b[0m'"}]}},{"type":"ExpressionStatement","start":5354,"end":5369,"loc":{"start":{"line":171,"column":2},"end":{"line":171,"column":17}},"expression":{"type":"CallExpression","start":5354,"end":5369,"loc":{"start":{"line":171,"column":2},"end":{"line":171,"column":17}},"callee":{"type":"MemberExpression","start":5354,"end":5366,"loc":{"start":{"line":171,"column":2},"end":{"line":171,"column":14}},"object":{"type":"Identifier","start":5354,"end":5361,"loc":{"start":{"line":171,"column":2},"end":{"line":171,"column":9}},"name":"process"},"property":{"type":"Identifier","start":5362,"end":5366,"loc":{"start":{"line":171,"column":10},"end":{"line":171,"column":14}},"name":"exit"},"computed":false},"arguments":[{"type":"Literal","start":5367,"end":5368,"loc":{"start":{"line":171,"column":15},"end":{"line":171,"column":16}},"value":1,"raw":"1"}]}}]}},"finalizer":null},{"type":"IfStatement","start":5411,"end":5531,"loc":{"start":{"line":175,"column":0},"end":{"line":179,"column":1}},"test":{"type":"MemberExpression","start":5415,"end":5441,"loc":{"start":{"line":175,"column":4},"end":{"line":175,"column":30}},"object":{"type":"MemberExpression","start":5415,"end":5426,"loc":{"start":{"line":175,"column":4},"end":{"line":175,"column":15}},"object":{"type":"Identifier","start":5415,"end":5422,"loc":{"start":{"line":175,"column":4},"end":{"line":175,"column":11}},"name":"process"},"property":{"type":"Identifier","start":5423,"end":5426,"loc":{"start":{"line":175,"column":12},"end":{"line":175,"column":15}},"name":"env"},"computed":false},"property":{"type":"Identifier","start":5427,"end":5441,"loc":{"start":{"line":175,"column":16},"end":{"line":175,"column":30}},"name":"COMPANION_PATH"},"computed":false},"consequent":{"type":"BlockStatement","start":5443,"end":5498,"loc":{"start":{"line":175,"column":32},"end":{"line":177,"column":1}},"body":[{"type":"ExpressionStatement","start":5447,"end":5496,"loc":{"start":{"line":176,"column":2},"end":{"line":176,"column":51}},"expression":{"type":"CallExpression","start":5447,"end":5496,"loc":{"start":{"line":176,"column":2},"end":{"line":176,"column":51}},"callee":{"type":"MemberExpression","start":5447,"end":5454,"loc":{"start":{"line":176,"column":2},"end":{"line":176,"column":9}},"object":{"type":"Identifier","start":5447,"end":5450,"loc":{"start":{"line":176,"column":2},"end":{"line":176,"column":5}},"name":"app"},"property":{"type":"Identifier","start":5451,"end":5454,"loc":{"start":{"line":176,"column":6},"end":{"line":176,"column":9}},"name":"use"},"computed":false},"arguments":[{"type":"MemberExpression","start":5455,"end":5481,"loc":{"start":{"line":176,"column":10},"end":{"line":176,"column":36}},"object":{"type":"MemberExpression","start":5455,"end":5466,"loc":{"start":{"line":176,"column":10},"end":{"line":176,"column":21}},"object":{"type":"Identifier","start":5455,"end":5462,"loc":{"start":{"line":176,"column":10},"end":{"line":176,"column":17}},"name":"process"},"property":{"type":"Identifier","start":5463,"end":5466,"loc":{"start":{"line":176,"column":18},"end":{"line":176,"column":21}},"name":"env"},"computed":false},"property":{"type":"Identifier","start":5467,"end":5481,"loc":{"start":{"line":176,"column":22},"end":{"line":176,"column":36}},"name":"COMPANION_PATH"},"computed":false},{"type":"Identifier","start":5483,"end":5495,"loc":{"start":{"line":176,"column":38},"end":{"line":176,"column":50}},"name":"companionApp"}]}}]},"alternate":{"type":"BlockStatement","start":5504,"end":5531,"loc":{"start":{"line":177,"column":7},"end":{"line":179,"column":1}},"body":[{"type":"ExpressionStatement","start":5508,"end":5529,"loc":{"start":{"line":178,"column":2},"end":{"line":178,"column":23}},"expression":{"type":"CallExpression","start":5508,"end":5529,"loc":{"start":{"line":178,"column":2},"end":{"line":178,"column":23}},"callee":{"type":"MemberExpression","start":5508,"end":5515,"loc":{"start":{"line":178,"column":2},"end":{"line":178,"column":9}},"object":{"type":"Identifier","start":5508,"end":5511,"loc":{"start":{"line":178,"column":2},"end":{"line":178,"column":5}},"name":"app"},"property":{"type":"Identifier","start":5512,"end":5515,"loc":{"start":{"line":178,"column":6},"end":{"line":178,"column":9}},"name":"use"},"computed":false},"arguments":[{"type":"Identifier","start":5516,"end":5528,"loc":{"start":{"line":178,"column":10},"end":{"line":178,"column":22}},"name":"companionApp"}]}}]},"comments":[{"type":"Line","value":" add companion to server middlewear","start":5373,"end":5410,"loc":{"start":{"line":174,"column":0},"end":{"line":174,"column":37}}}]},{"type":"IfStatement","start":5969,"end":6672,"loc":{"start":{"line":186,"column":0},"end":{"line":200,"column":1}},"test":{"type":"LogicalExpression","start":5973,"end":6070,"loc":{"start":{"line":186,"column":4},"end":{"line":186,"column":101}},"left":{"type":"BinaryExpression","start":5973,"end":6032,"loc":{"start":{"line":186,"column":4},"end":{"line":186,"column":63}},"left":{"type":"MemberExpression","start":5973,"end":6021,"loc":{"start":{"line":186,"column":4},"end":{"line":186,"column":52}},"object":{"type":"MemberExpression","start":5973,"end":5984,"loc":{"start":{"line":186,"column":4},"end":{"line":186,"column":15}},"object":{"type":"Identifier","start":5973,"end":5980,"loc":{"start":{"line":186,"column":4},"end":{"line":186,"column":11}},"name":"process"},"property":{"type":"Identifier","start":5981,"end":5984,"loc":{"start":{"line":186,"column":12},"end":{"line":186,"column":15}},"name":"env"},"computed":false},"property":{"type":"Identifier","start":5985,"end":6021,"loc":{"start":{"line":186,"column":16},"end":{"line":186,"column":52}},"name":"COMPANION_ONEDRIVE_DOMAIN_VALIDATION"},"computed":false},"operator":"===","right":{"type":"Literal","start":6026,"end":6032,"loc":{"start":{"line":186,"column":57},"end":{"line":186,"column":63}},"value":"true","raw":"'true'"}},"operator":"&&","right":{"type":"MemberExpression","start":6036,"end":6070,"loc":{"start":{"line":186,"column":67},"end":{"line":186,"column":101}},"object":{"type":"MemberExpression","start":6036,"end":6047,"loc":{"start":{"line":186,"column":67},"end":{"line":186,"column":78}},"object":{"type":"Identifier","start":6036,"end":6043,"loc":{"start":{"line":186,"column":67},"end":{"line":186,"column":74}},"name":"process"},"property":{"type":"Identifier","start":6044,"end":6047,"loc":{"start":{"line":186,"column":75},"end":{"line":186,"column":78}},"name":"env"},"computed":false},"property":{"type":"Identifier","start":6048,"end":6070,"loc":{"start":{"line":186,"column":79},"end":{"line":186,"column":101}},"name":"COMPANION_ONEDRIVE_KEY"},"computed":false}},"consequent":{"type":"BlockStatement","start":6072,"end":6672,"loc":{"start":{"line":186,"column":103},"end":{"line":200,"column":1}},"body":[{"type":"ExpressionStatement","start":6076,"end":6670,"loc":{"start":{"line":187,"column":2},"end":{"line":199,"column":4}},"expression":{"type":"CallExpression","start":6076,"end":6670,"loc":{"start":{"line":187,"column":2},"end":{"line":199,"column":4}},"callee":{"type":"MemberExpression","start":6076,"end":6083,"loc":{"start":{"line":187,"column":2},"end":{"line":187,"column":9}},"object":{"type":"Identifier","start":6076,"end":6079,"loc":{"start":{"line":187,"column":2},"end":{"line":187,"column":5}},"name":"app"},"property":{"type":"Identifier","start":6080,"end":6083,"loc":{"start":{"line":187,"column":6},"end":{"line":187,"column":9}},"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":6084,"end":6134,"loc":{"start":{"line":187,"column":10},"end":{"line":187,"column":60}},"value":"/.well-known/microsoft-identity-association.json","raw":"'/.well-known/microsoft-identity-association.json'"},{"type":"ArrowFunctionExpression","start":6136,"end":6669,"loc":{"start":{"line":187,"column":62},"end":{"line":199,"column":3}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":6137,"end":6140,"loc":{"start":{"line":187,"column":63},"end":{"line":187,"column":66}},"name":"req"},{"type":"Identifier","start":6142,"end":6145,"loc":{"start":{"line":187,"column":68},"end":{"line":187,"column":71}},"name":"res"}],"body":{"type":"BlockStatement","start":6150,"end":6669,"loc":{"start":{"line":187,"column":76},"end":{"line":199,"column":3}},"body":[{"type":"VariableDeclaration","start":6156,"end":6297,"loc":{"start":{"line":188,"column":4},"end":{"line":192,"column":6}},"declarations":[{"type":"VariableDeclarator","start":6162,"end":6297,"loc":{"start":{"line":188,"column":10},"end":{"line":192,"column":6}},"id":{"type":"Identifier","start":6162,"end":6169,"loc":{"start":{"line":188,"column":10},"end":{"line":188,"column":17}},"name":"content"},"init":{"type":"CallExpression","start":6172,"end":6297,"loc":{"start":{"line":188,"column":20},"end":{"line":192,"column":6}},"callee":{"type":"MemberExpression","start":6172,"end":6186,"loc":{"start":{"line":188,"column":20},"end":{"line":188,"column":34}},"object":{"type":"Identifier","start":6172,"end":6176,"loc":{"start":{"line":188,"column":20},"end":{"line":188,"column":24}},"name":"JSON"},"property":{"type":"Identifier","start":6177,"end":6186,"loc":{"start":{"line":188,"column":25},"end":{"line":188,"column":34}},"name":"stringify"},"computed":false},"arguments":[{"type":"ObjectExpression","start":6187,"end":6296,"loc":{"start":{"line":188,"column":35},"end":{"line":192,"column":5}},"properties":[{"type":"Property","start":6195,"end":6290,"loc":{"start":{"line":189,"column":6},"end":{"line":191,"column":7}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6195,"end":6217,"loc":{"start":{"line":189,"column":6},"end":{"line":189,"column":28}},"name":"associatedApplications"},"value":{"type":"ArrayExpression","start":6219,"end":6290,"loc":{"start":{"line":189,"column":30},"end":{"line":191,"column":7}},"elements":[{"type":"ObjectExpression","start":6229,"end":6282,"loc":{"start":{"line":190,"column":8},"end":{"line":190,"column":61}},"properties":[{"type":"Property","start":6231,"end":6280,"loc":{"start":{"line":190,"column":10},"end":{"line":190,"column":59}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6231,"end":6244,"loc":{"start":{"line":190,"column":10},"end":{"line":190,"column":23}},"name":"applicationId"},"value":{"type":"MemberExpression","start":6246,"end":6280,"loc":{"start":{"line":190,"column":25},"end":{"line":190,"column":59}},"object":{"type":"MemberExpression","start":6246,"end":6257,"loc":{"start":{"line":190,"column":25},"end":{"line":190,"column":36}},"object":{"type":"Identifier","start":6246,"end":6253,"loc":{"start":{"line":190,"column":25},"end":{"line":190,"column":32}},"name":"process"},"property":{"type":"Identifier","start":6254,"end":6257,"loc":{"start":{"line":190,"column":33},"end":{"line":190,"column":36}},"name":"env"},"computed":false},"property":{"type":"Identifier","start":6258,"end":6280,"loc":{"start":{"line":190,"column":37},"end":{"line":190,"column":59}},"name":"COMPANION_ONEDRIVE_KEY"},"computed":false},"kind":"init"}]}]},"kind":"init"}]}]}}],"kind":"const"},{"type":"ExpressionStatement","start":6302,"end":6371,"loc":{"start":{"line":193,"column":4},"end":{"line":193,"column":73}},"expression":{"type":"CallExpression","start":6302,"end":6371,"loc":{"start":{"line":193,"column":4},"end":{"line":193,"column":73}},"callee":{"type":"MemberExpression","start":6302,"end":6312,"loc":{"start":{"line":193,"column":4},"end":{"line":193,"column":14}},"object":{"type":"Identifier","start":6302,"end":6305,"loc":{"start":{"line":193,"column":4},"end":{"line":193,"column":7}},"name":"res"},"property":{"type":"Identifier","start":6306,"end":6312,"loc":{"start":{"line":193,"column":8},"end":{"line":193,"column":14}},"name":"header"},"computed":false},"arguments":[{"type":"Literal","start":6313,"end":6329,"loc":{"start":{"line":193,"column":15},"end":{"line":193,"column":31}},"value":"Content-Length","raw":"'Content-Length'"},{"type":"TemplateLiteral","start":6331,"end":6370,"loc":{"start":{"line":193,"column":33},"end":{"line":193,"column":72}},"expressions":[{"type":"CallExpression","start":6334,"end":6368,"loc":{"start":{"line":193,"column":36},"end":{"line":193,"column":70}},"callee":{"type":"MemberExpression","start":6334,"end":6351,"loc":{"start":{"line":193,"column":36},"end":{"line":193,"column":53}},"object":{"type":"Identifier","start":6334,"end":6340,"loc":{"start":{"line":193,"column":36},"end":{"line":193,"column":42}},"name":"Buffer"},"property":{"type":"Identifier","start":6341,"end":6351,"loc":{"start":{"line":193,"column":43},"end":{"line":193,"column":53}},"name":"byteLength"},"computed":false},"arguments":[{"type":"Identifier","start":6352,"end":6359,"loc":{"start":{"line":193,"column":54},"end":{"line":193,"column":61}},"name":"content"},{"type":"Literal","start":6361,"end":6367,"loc":{"start":{"line":193,"column":63},"end":{"line":193,"column":69}},"value":"utf8","raw":"'utf8'"}]}],"quasis":[{"type":"TemplateElement","start":6332,"end":6332,"loc":{"start":{"line":193,"column":34},"end":{"line":193,"column":34}},"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":6369,"end":6369,"loc":{"start":{"line":193,"column":71},"end":{"line":193,"column":71}},"value":{"raw":"","cooked":""},"tail":true}]}]}},{"type":"ExpressionStatement","start":6570,"end":6628,"loc":{"start":{"line":196,"column":4},"end":{"line":196,"column":62}},"expression":{"type":"CallExpression","start":6570,"end":6628,"loc":{"start":{"line":196,"column":4},"end":{"line":196,"column":62}},"callee":{"type":"MemberExpression","start":6570,"end":6583,"loc":{"start":{"line":196,"column":4},"end":{"line":196,"column":17}},"object":{"type":"Identifier","start":6570,"end":6573,"loc":{"start":{"line":196,"column":4},"end":{"line":196,"column":7}},"name":"res"},"property":{"type":"Identifier","start":6574,"end":6583,"loc":{"start":{"line":196,"column":8},"end":{"line":196,"column":17}},"name":"writeHead"},"computed":false},"arguments":[{"type":"Literal","start":6584,"end":6587,"loc":{"start":{"line":196,"column":18},"end":{"line":196,"column":21}},"value":200,"raw":"200"},{"type":"ObjectExpression","start":6589,"end":6627,"loc":{"start":{"line":196,"column":23},"end":{"line":196,"column":61}},"properties":[{"type":"Property","start":6591,"end":6625,"loc":{"start":{"line":196,"column":25},"end":{"line":196,"column":59}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Literal","start":6591,"end":6605,"loc":{"start":{"line":196,"column":25},"end":{"line":196,"column":39}},"value":"Content-Type","raw":"'Content-Type'"},"value":{"type":"Literal","start":6607,"end":6625,"loc":{"start":{"line":196,"column":41},"end":{"line":196,"column":59}},"value":"application/json","raw":"'application/json'"},"kind":"init"}]}]},"comments":[{"type":"Line","value":" use writeHead to prevent 'charset' from being appended","start":6376,"end":6433,"loc":{"start":{"line":194,"column":4},"end":{"line":194,"column":61}}},{"type":"Line","value":" https://docs.microsoft.com/en-us/azure/active-directory/develop/howto-configure-publisher-domain#to-select-a-verified-domain","start":6438,"end":6565,"loc":{"start":{"line":195,"column":4},"end":{"line":195,"column":131}}}]},{"type":"ExpressionStatement","start":6633,"end":6651,"loc":{"start":{"line":197,"column":4},"end":{"line":197,"column":22}},"expression":{"type":"CallExpression","start":6633,"end":6651,"loc":{"start":{"line":197,"column":4},"end":{"line":197,"column":22}},"callee":{"type":"MemberExpression","start":6633,"end":6642,"loc":{"start":{"line":197,"column":4},"end":{"line":197,"column":13}},"object":{"type":"Identifier","start":6633,"end":6636,"loc":{"start":{"line":197,"column":4},"end":{"line":197,"column":7}},"name":"res"},"property":{"type":"Identifier","start":6637,"end":6642,"loc":{"start":{"line":197,"column":8},"end":{"line":197,"column":13}},"name":"write"},"computed":false},"arguments":[{"type":"Identifier","start":6643,"end":6650,"loc":{"start":{"line":197,"column":14},"end":{"line":197,"column":21}},"name":"content"}]}},{"type":"ExpressionStatement","start":6656,"end":6665,"loc":{"start":{"line":198,"column":4},"end":{"line":198,"column":13}},"expression":{"type":"CallExpression","start":6656,"end":6665,"loc":{"start":{"line":198,"column":4},"end":{"line":198,"column":13}},"callee":{"type":"MemberExpression","start":6656,"end":6663,"loc":{"start":{"line":198,"column":4},"end":{"line":198,"column":11}},"object":{"type":"Identifier","start":6656,"end":6659,"loc":{"start":{"line":198,"column":4},"end":{"line":198,"column":7}},"name":"res"},"property":{"type":"Identifier","start":6660,"end":6663,"loc":{"start":{"line":198,"column":8},"end":{"line":198,"column":11}},"name":"end"},"computed":false},"arguments":[]}}]}}]}}]},"alternate":null,"comments":[{"type":"Line","value":" WARNING: This route is added in order to validate your app with OneDrive.","start":5533,"end":5609,"loc":{"start":{"line":181,"column":0},"end":{"line":181,"column":76}}},{"type":"Line","value":" Only set COMPANION_ONEDRIVE_DOMAIN_VALIDATION if you are sure that you are setting the","start":5610,"end":5699,"loc":{"start":{"line":182,"column":0},"end":{"line":182,"column":89}}},{"type":"Line","value":" correct value for COMPANION_ONEDRIVE_KEY (i.e application ID). If there's a slightest possiblilty","start":5700,"end":5800,"loc":{"start":{"line":183,"column":0},"end":{"line":183,"column":100}}},{"type":"Line","value":" that you might have mixed the values for COMPANION_ONEDRIVE_KEY and COMPANION_ONEDRIVE_SECRET,","start":5801,"end":5898,"loc":{"start":{"line":184,"column":0},"end":{"line":184,"column":97}}},{"type":"Line","value":" please do not set a value for COMPANION_ONEDRIVE_DOMAIN_VALIDATION","start":5899,"end":5968,"loc":{"start":{"line":185,"column":0},"end":{"line":185,"column":69}}}]},{"type":"ExpressionStatement","start":6674,"end":6762,"loc":{"start":{"line":202,"column":0},"end":{"line":204,"column":2}},"expression":{"type":"CallExpression","start":6674,"end":6762,"loc":{"start":{"line":202,"column":0},"end":{"line":204,"column":2}},"callee":{"type":"MemberExpression","start":6674,"end":6681,"loc":{"start":{"line":202,"column":0},"end":{"line":202,"column":7}},"object":{"type":"Identifier","start":6674,"end":6677,"loc":{"start":{"line":202,"column":0},"end":{"line":202,"column":3}},"name":"app"},"property":{"type":"Identifier","start":6678,"end":6681,"loc":{"start":{"line":202,"column":4},"end":{"line":202,"column":7}},"name":"use"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":6682,"end":6761,"loc":{"start":{"line":202,"column":8},"end":{"line":204,"column":1}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":6683,"end":6686,"loc":{"start":{"line":202,"column":9},"end":{"line":202,"column":12}},"name":"req"},{"type":"Identifier","start":6688,"end":6691,"loc":{"start":{"line":202,"column":14},"end":{"line":202,"column":17}},"name":"res"},{"type":"Identifier","start":6693,"end":6697,"loc":{"start":{"line":202,"column":19},"end":{"line":202,"column":23}},"name":"next"}],"body":{"type":"BlockStatement","start":6702,"end":6761,"loc":{"start":{"line":202,"column":28},"end":{"line":204,"column":1}},"body":[{"type":"ReturnStatement","start":6706,"end":6759,"loc":{"start":{"line":203,"column":2},"end":{"line":203,"column":55}},"argument":{"type":"CallExpression","start":6713,"end":6759,"loc":{"start":{"line":203,"column":9},"end":{"line":203,"column":55}},"callee":{"type":"MemberExpression","start":6713,"end":6733,"loc":{"start":{"line":203,"column":9},"end":{"line":203,"column":29}},"object":{"type":"CallExpression","start":6713,"end":6728,"loc":{"start":{"line":203,"column":9},"end":{"line":203,"column":24}},"callee":{"type":"MemberExpression","start":6713,"end":6723,"loc":{"start":{"line":203,"column":9},"end":{"line":203,"column":19}},"object":{"type":"Identifier","start":6713,"end":6716,"loc":{"start":{"line":203,"column":9},"end":{"line":203,"column":12}},"name":"res"},"property":{"type":"Identifier","start":6717,"end":6723,"loc":{"start":{"line":203,"column":13},"end":{"line":203,"column":19}},"name":"status"},"computed":false},"arguments":[{"type":"Literal","start":6724,"end":6727,"loc":{"start":{"line":203,"column":20},"end":{"line":203,"column":23}},"value":404,"raw":"404"}]},"property":{"type":"Identifier","start":6729,"end":6733,"loc":{"start":{"line":203,"column":25},"end":{"line":203,"column":29}},"name":"json"},"computed":false},"arguments":[{"type":"ObjectExpression","start":6734,"end":6758,"loc":{"start":{"line":203,"column":30},"end":{"line":203,"column":54}},"properties":[{"type":"Property","start":6736,"end":6756,"loc":{"start":{"line":203,"column":32},"end":{"line":203,"column":52}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6736,"end":6743,"loc":{"start":{"line":203,"column":32},"end":{"line":203,"column":39}},"name":"message"},"value":{"type":"Literal","start":6745,"end":6756,"loc":{"start":{"line":203,"column":41},"end":{"line":203,"column":52}},"value":"Not Found","raw":"'Not Found'"},"kind":"init"}]}]}}]}}]}},{"type":"ExpressionStatement","start":6778,"end":7469,"loc":{"start":{"line":207,"column":0},"end":{"line":222,"column":2}},"expression":{"type":"CallExpression","start":6778,"end":7469,"loc":{"start":{"line":207,"column":0},"end":{"line":222,"column":2}},"callee":{"type":"MemberExpression","start":6778,"end":6785,"loc":{"start":{"line":207,"column":0},"end":{"line":207,"column":7}},"object":{"type":"Identifier","start":6778,"end":6781,"loc":{"start":{"line":207,"column":0},"end":{"line":207,"column":3}},"name":"app"},"property":{"type":"Identifier","start":6782,"end":6785,"loc":{"start":{"line":207,"column":4},"end":{"line":207,"column":7}},"name":"use"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":6786,"end":7468,"loc":{"start":{"line":207,"column":8},"end":{"line":222,"column":1}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":6787,"end":6790,"loc":{"start":{"line":207,"column":9},"end":{"line":207,"column":12}},"name":"err"},{"type":"Identifier","start":6792,"end":6795,"loc":{"start":{"line":207,"column":14},"end":{"line":207,"column":17}},"name":"req"},{"type":"Identifier","start":6797,"end":6800,"loc":{"start":{"line":207,"column":19},"end":{"line":207,"column":22}},"name":"res"},{"type":"Identifier","start":6802,"end":6806,"loc":{"start":{"line":207,"column":24},"end":{"line":207,"column":28}},"name":"next"}],"body":{"type":"BlockStatement","start":6811,"end":7468,"loc":{"start":{"line":207,"column":33},"end":{"line":222,"column":1}},"body":[{"type":"VariableDeclaration","start":6815,"end":6841,"loc":{"start":{"line":208,"column":2},"end":{"line":208,"column":28}},"declarations":[{"type":"VariableDeclarator","start":6821,"end":6841,"loc":{"start":{"line":208,"column":8},"end":{"line":208,"column":28}},"id":{"type":"Identifier","start":6821,"end":6834,"loc":{"start":{"line":208,"column":8},"end":{"line":208,"column":21}},"name":"logStackTrace"},"init":{"type":"Literal","start":6837,"end":6841,"loc":{"start":{"line":208,"column":24},"end":{"line":208,"column":28}},"value":true,"raw":"true"}}],"kind":"const"},{"type":"IfStatement","start":6844,"end":7466,"loc":{"start":{"line":209,"column":2},"end":{"line":221,"column":3}},"test":{"type":"BinaryExpression","start":6848,"end":6879,"loc":{"start":{"line":209,"column":6},"end":{"line":209,"column":37}},"left":{"type":"CallExpression","start":6848,"end":6862,"loc":{"start":{"line":209,"column":6},"end":{"line":209,"column":20}},"callee":{"type":"MemberExpression","start":6848,"end":6855,"loc":{"start":{"line":209,"column":6},"end":{"line":209,"column":13}},"object":{"type":"Identifier","start":6848,"end":6851,"loc":{"start":{"line":209,"column":6},"end":{"line":209,"column":9}},"name":"app"},"property":{"type":"Identifier","start":6852,"end":6855,"loc":{"start":{"line":209,"column":10},"end":{"line":209,"column":13}},"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":6856,"end":6861,"loc":{"start":{"line":209,"column":14},"end":{"line":209,"column":19}},"value":"env","raw":"'env'"}]},"operator":"===","right":{"type":"Literal","start":6867,"end":6879,"loc":{"start":{"line":209,"column":25},"end":{"line":209,"column":37}},"value":"production","raw":"'production'"}},"consequent":{"type":"BlockStatement","start":6881,"end":7300,"loc":{"start":{"line":209,"column":39},"end":{"line":218,"column":3}},"body":[{"type":"IfStatement","start":7015,"end":7201,"loc":{"start":{"line":212,"column":4},"end":{"line":216,"column":5}},"test":{"type":"LogicalExpression","start":7019,"end":7064,"loc":{"start":{"line":212,"column":8},"end":{"line":212,"column":53}},"left":{"type":"BinaryExpression","start":7019,"end":7037,"loc":{"start":{"line":212,"column":8},"end":{"line":212,"column":26}},"left":{"type":"MemberExpression","start":7019,"end":7029,"loc":{"start":{"line":212,"column":8},"end":{"line":212,"column":18}},"object":{"type":"Identifier","start":7019,"end":7022,"loc":{"start":{"line":212,"column":8},"end":{"line":212,"column":11}},"name":"err"},"property":{"type":"Identifier","start":7023,"end":7029,"loc":{"start":{"line":212,"column":12},"end":{"line":212,"column":18}},"name":"status"},"computed":false},"operator":"===","right":{"type":"Literal","start":7034,"end":7037,"loc":{"start":{"line":212,"column":23},"end":{"line":212,"column":26}},"value":400,"raw":"400"}},"operator":"&&","right":{"type":"BinaryExpression","start":7041,"end":7064,"loc":{"start":{"line":212,"column":30},"end":{"line":212,"column":53}},"left":{"type":"Identifier","start":7041,"end":7044,"loc":{"start":{"line":212,"column":30},"end":{"line":212,"column":33}},"name":"err"},"operator":"instanceof","right":{"type":"Identifier","start":7056,"end":7064,"loc":{"start":{"line":212,"column":45},"end":{"line":212,"column":53}},"name":"URIError"}}},"consequent":{"type":"BlockStatement","start":7066,"end":7127,"loc":{"start":{"line":212,"column":55},"end":{"line":214,"column":5}},"body":[{"type":"ExpressionStatement","start":7074,"end":7121,"loc":{"start":{"line":213,"column":6},"end":{"line":213,"column":53}},"expression":{"type":"CallExpression","start":7074,"end":7121,"loc":{"start":{"line":213,"column":6},"end":{"line":213,"column":53}},"callee":{"type":"MemberExpression","start":7074,"end":7086,"loc":{"start":{"line":213,"column":6},"end":{"line":213,"column":18}},"object":{"type":"Identifier","start":7074,"end":7080,"loc":{"start":{"line":213,"column":6},"end":{"line":213,"column":12}},"name":"logger"},"property":{"type":"Identifier","start":7081,"end":7086,"loc":{"start":{"line":213,"column":13},"end":{"line":213,"column":18}},"name":"error"},"computed":false},"arguments":[{"type":"MemberExpression","start":7087,"end":7098,"loc":{"start":{"line":213,"column":19},"end":{"line":213,"column":30}},"object":{"type":"Identifier","start":7087,"end":7090,"loc":{"start":{"line":213,"column":19},"end":{"line":213,"column":22}},"name":"err"},"property":{"type":"Identifier","start":7091,"end":7098,"loc":{"start":{"line":213,"column":23},"end":{"line":213,"column":30}},"name":"message"},"computed":false},{"type":"Literal","start":7100,"end":7112,"loc":{"start":{"line":213,"column":32},"end":{"line":213,"column":44}},"value":"root.error","raw":"'root.error'"},{"type":"MemberExpression","start":7114,"end":7120,"loc":{"start":{"line":213,"column":46},"end":{"line":213,"column":52}},"object":{"type":"Identifier","start":7114,"end":7117,"loc":{"start":{"line":213,"column":46},"end":{"line":213,"column":49}},"name":"req"},"property":{"type":"Identifier","start":7118,"end":7120,"loc":{"start":{"line":213,"column":50},"end":{"line":213,"column":52}},"name":"id"},"computed":false}]}}]},"alternate":{"type":"BlockStatement","start":7133,"end":7201,"loc":{"start":{"line":214,"column":11},"end":{"line":216,"column":5}},"body":[{"type":"ExpressionStatement","start":7141,"end":7195,"loc":{"start":{"line":215,"column":6},"end":{"line":215,"column":60}},"expression":{"type":"CallExpression","start":7141,"end":7195,"loc":{"start":{"line":215,"column":6},"end":{"line":215,"column":60}},"callee":{"type":"MemberExpression","start":7141,"end":7153,"loc":{"start":{"line":215,"column":6},"end":{"line":215,"column":18}},"object":{"type":"Identifier","start":7141,"end":7147,"loc":{"start":{"line":215,"column":6},"end":{"line":215,"column":12}},"name":"logger"},"property":{"type":"Identifier","start":7148,"end":7153,"loc":{"start":{"line":215,"column":13},"end":{"line":215,"column":18}},"name":"error"},"computed":false},"arguments":[{"type":"Identifier","start":7154,"end":7157,"loc":{"start":{"line":215,"column":19},"end":{"line":215,"column":22}},"name":"err"},{"type":"Literal","start":7159,"end":7171,"loc":{"start":{"line":215,"column":24},"end":{"line":215,"column":36}},"value":"root.error","raw":"'root.error'"},{"type":"MemberExpression","start":7173,"end":7179,"loc":{"start":{"line":215,"column":38},"end":{"line":215,"column":44}},"object":{"type":"Identifier","start":7173,"end":7176,"loc":{"start":{"line":215,"column":38},"end":{"line":215,"column":41}},"name":"req"},"property":{"type":"Identifier","start":7177,"end":7179,"loc":{"start":{"line":215,"column":42},"end":{"line":215,"column":44}},"name":"id"},"computed":false},{"type":"Identifier","start":7181,"end":7194,"loc":{"start":{"line":215,"column":46},"end":{"line":215,"column":59}},"name":"logStackTrace"}]}}]},"comments":[{"type":"Line","value":" if the error is a URIError from the requested URL we only log the error message","start":6887,"end":6969,"loc":{"start":{"line":210,"column":4},"end":{"line":210,"column":86}}},{"type":"Line","value":" to avoid uneccessary error alerts","start":6974,"end":7010,"loc":{"start":{"line":211,"column":4},"end":{"line":211,"column":40}}}]},{"type":"ExpressionStatement","start":7206,"end":7296,"loc":{"start":{"line":217,"column":4},"end":{"line":217,"column":94}},"expression":{"type":"CallExpression","start":7206,"end":7296,"loc":{"start":{"line":217,"column":4},"end":{"line":217,"column":94}},"callee":{"type":"MemberExpression","start":7206,"end":7240,"loc":{"start":{"line":217,"column":4},"end":{"line":217,"column":38}},"object":{"type":"CallExpression","start":7206,"end":7235,"loc":{"start":{"line":217,"column":4},"end":{"line":217,"column":33}},"callee":{"type":"MemberExpression","start":7206,"end":7216,"loc":{"start":{"line":217,"column":4},"end":{"line":217,"column":14}},"object":{"type":"Identifier","start":7206,"end":7209,"loc":{"start":{"line":217,"column":4},"end":{"line":217,"column":7}},"name":"res"},"property":{"type":"Identifier","start":7210,"end":7216,"loc":{"start":{"line":217,"column":8},"end":{"line":217,"column":14}},"name":"status"},"computed":false},"arguments":[{"type":"LogicalExpression","start":7217,"end":7234,"loc":{"start":{"line":217,"column":15},"end":{"line":217,"column":32}},"left":{"type":"MemberExpression","start":7217,"end":7227,"loc":{"start":{"line":217,"column":15},"end":{"line":217,"column":25}},"object":{"type":"Identifier","start":7217,"end":7220,"loc":{"start":{"line":217,"column":15},"end":{"line":217,"column":18}},"name":"err"},"property":{"type":"Identifier","start":7221,"end":7227,"loc":{"start":{"line":217,"column":19},"end":{"line":217,"column":25}},"name":"status"},"computed":false},"operator":"||","right":{"type":"Literal","start":7231,"end":7234,"loc":{"start":{"line":217,"column":29},"end":{"line":217,"column":32}},"value":500,"raw":"500"}}]},"property":{"type":"Identifier","start":7236,"end":7240,"loc":{"start":{"line":217,"column":34},"end":{"line":217,"column":38}},"name":"json"},"computed":false},"arguments":[{"type":"ObjectExpression","start":7241,"end":7295,"loc":{"start":{"line":217,"column":39},"end":{"line":217,"column":93}},"properties":[{"type":"Property","start":7243,"end":7274,"loc":{"start":{"line":217,"column":41},"end":{"line":217,"column":72}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7243,"end":7250,"loc":{"start":{"line":217,"column":41},"end":{"line":217,"column":48}},"name":"message"},"value":{"type":"Literal","start":7252,"end":7274,"loc":{"start":{"line":217,"column":50},"end":{"line":217,"column":72}},"value":"Something went wrong","raw":"'Something went wrong'"},"kind":"init"},{"type":"Property","start":7276,"end":7293,"loc":{"start":{"line":217,"column":74},"end":{"line":217,"column":91}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7276,"end":7285,"loc":{"start":{"line":217,"column":74},"end":{"line":217,"column":83}},"name":"requestId"},"value":{"type":"MemberExpression","start":7287,"end":7293,"loc":{"start":{"line":217,"column":85},"end":{"line":217,"column":91}},"object":{"type":"Identifier","start":7287,"end":7290,"loc":{"start":{"line":217,"column":85},"end":{"line":217,"column":88}},"name":"req"},"property":{"type":"Identifier","start":7291,"end":7293,"loc":{"start":{"line":217,"column":89},"end":{"line":217,"column":91}},"name":"id"},"computed":false},"kind":"init"}]}]}}]},"alternate":{"type":"BlockStatement","start":7306,"end":7466,"loc":{"start":{"line":218,"column":9},"end":{"line":221,"column":3}},"body":[{"type":"ExpressionStatement","start":7312,"end":7366,"loc":{"start":{"line":219,"column":4},"end":{"line":219,"column":58}},"expression":{"type":"CallExpression","start":7312,"end":7366,"loc":{"start":{"line":219,"column":4},"end":{"line":219,"column":58}},"callee":{"type":"MemberExpression","start":7312,"end":7324,"loc":{"start":{"line":219,"column":4},"end":{"line":219,"column":16}},"object":{"type":"Identifier","start":7312,"end":7318,"loc":{"start":{"line":219,"column":4},"end":{"line":219,"column":10}},"name":"logger"},"property":{"type":"Identifier","start":7319,"end":7324,"loc":{"start":{"line":219,"column":11},"end":{"line":219,"column":16}},"name":"error"},"computed":false},"arguments":[{"type":"Identifier","start":7325,"end":7328,"loc":{"start":{"line":219,"column":17},"end":{"line":219,"column":20}},"name":"err"},{"type":"Literal","start":7330,"end":7342,"loc":{"start":{"line":219,"column":22},"end":{"line":219,"column":34}},"value":"root.error","raw":"'root.error'"},{"type":"MemberExpression","start":7344,"end":7350,"loc":{"start":{"line":219,"column":36},"end":{"line":219,"column":42}},"object":{"type":"Identifier","start":7344,"end":7347,"loc":{"start":{"line":219,"column":36},"end":{"line":219,"column":39}},"name":"req"},"property":{"type":"Identifier","start":7348,"end":7350,"loc":{"start":{"line":219,"column":40},"end":{"line":219,"column":42}},"name":"id"},"computed":false},{"type":"Identifier","start":7352,"end":7365,"loc":{"start":{"line":219,"column":44},"end":{"line":219,"column":57}},"name":"logStackTrace"}]}},{"type":"ExpressionStatement","start":7371,"end":7462,"loc":{"start":{"line":220,"column":4},"end":{"line":220,"column":95}},"expression":{"type":"CallExpression","start":7371,"end":7462,"loc":{"start":{"line":220,"column":4},"end":{"line":220,"column":95}},"callee":{"type":"MemberExpression","start":7371,"end":7405,"loc":{"start":{"line":220,"column":4},"end":{"line":220,"column":38}},"object":{"type":"CallExpression","start":7371,"end":7400,"loc":{"start":{"line":220,"column":4},"end":{"line":220,"column":33}},"callee":{"type":"MemberExpression","start":7371,"end":7381,"loc":{"start":{"line":220,"column":4},"end":{"line":220,"column":14}},"object":{"type":"Identifier","start":7371,"end":7374,"loc":{"start":{"line":220,"column":4},"end":{"line":220,"column":7}},"name":"res"},"property":{"type":"Identifier","start":7375,"end":7381,"loc":{"start":{"line":220,"column":8},"end":{"line":220,"column":14}},"name":"status"},"computed":false},"arguments":[{"type":"LogicalExpression","start":7382,"end":7399,"loc":{"start":{"line":220,"column":15},"end":{"line":220,"column":32}},"left":{"type":"MemberExpression","start":7382,"end":7392,"loc":{"start":{"line":220,"column":15},"end":{"line":220,"column":25}},"object":{"type":"Identifier","start":7382,"end":7385,"loc":{"start":{"line":220,"column":15},"end":{"line":220,"column":18}},"name":"err"},"property":{"type":"Identifier","start":7386,"end":7392,"loc":{"start":{"line":220,"column":19},"end":{"line":220,"column":25}},"name":"status"},"computed":false},"operator":"||","right":{"type":"Literal","start":7396,"end":7399,"loc":{"start":{"line":220,"column":29},"end":{"line":220,"column":32}},"value":500,"raw":"500"}}]},"property":{"type":"Identifier","start":7401,"end":7405,"loc":{"start":{"line":220,"column":34},"end":{"line":220,"column":38}},"name":"json"},"computed":false},"arguments":[{"type":"ObjectExpression","start":7406,"end":7461,"loc":{"start":{"line":220,"column":39},"end":{"line":220,"column":94}},"properties":[{"type":"Property","start":7408,"end":7428,"loc":{"start":{"line":220,"column":41},"end":{"line":220,"column":61}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7408,"end":7415,"loc":{"start":{"line":220,"column":41},"end":{"line":220,"column":48}},"name":"message"},"value":{"type":"MemberExpression","start":7417,"end":7428,"loc":{"start":{"line":220,"column":50},"end":{"line":220,"column":61}},"object":{"type":"Identifier","start":7417,"end":7420,"loc":{"start":{"line":220,"column":50},"end":{"line":220,"column":53}},"name":"err"},"property":{"type":"Identifier","start":7421,"end":7428,"loc":{"start":{"line":220,"column":54},"end":{"line":220,"column":61}},"name":"message"},"computed":false},"kind":"init"},{"type":"Property","start":7430,"end":7440,"loc":{"start":{"line":220,"column":63},"end":{"line":220,"column":73}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7430,"end":7435,"loc":{"start":{"line":220,"column":63},"end":{"line":220,"column":68}},"name":"error"},"value":{"type":"Identifier","start":7437,"end":7440,"loc":{"start":{"line":220,"column":70},"end":{"line":220,"column":73}},"name":"err"},"kind":"init"},{"type":"Property","start":7442,"end":7459,"loc":{"start":{"line":220,"column":75},"end":{"line":220,"column":92}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7442,"end":7451,"loc":{"start":{"line":220,"column":75},"end":{"line":220,"column":84}},"name":"requestId"},"value":{"type":"MemberExpression","start":7453,"end":7459,"loc":{"start":{"line":220,"column":86},"end":{"line":220,"column":92}},"object":{"type":"Identifier","start":7453,"end":7456,"loc":{"start":{"line":220,"column":86},"end":{"line":220,"column":89}},"name":"req"},"property":{"type":"Identifier","start":7457,"end":7459,"loc":{"start":{"line":220,"column":90},"end":{"line":220,"column":92}},"name":"id"},"computed":false},"kind":"init"}]}]}}]}}]}}]},"comments":[{"type":"Line","value":" @ts-ignore","start":6764,"end":6777,"loc":{"start":{"line":206,"column":0},"end":{"line":206,"column":13}}}]},{"type":"ExpressionStatement","start":7471,"end":7513,"loc":{"start":{"line":224,"column":0},"end":{"line":224,"column":42}},"expression":{"type":"AssignmentExpression","start":7471,"end":7513,"loc":{"start":{"line":224,"column":0},"end":{"line":224,"column":42}},"operator":"=","left":{"type":"MemberExpression","start":7471,"end":7485,"loc":{"start":{"line":224,"column":0},"end":{"line":224,"column":14}},"object":{"type":"Identifier","start":7471,"end":7477,"loc":{"start":{"line":224,"column":0},"end":{"line":224,"column":6}},"name":"module"},"property":{"type":"Identifier","start":7478,"end":7485,"loc":{"start":{"line":224,"column":7},"end":{"line":224,"column":14}},"name":"exports"},"computed":false},"right":{"type":"ObjectExpression","start":7488,"end":7513,"loc":{"start":{"line":224,"column":17},"end":{"line":224,"column":42}},"properties":[{"type":"Property","start":7490,"end":7493,"loc":{"start":{"line":224,"column":19},"end":{"line":224,"column":22}},"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":7490,"end":7493,"loc":{"start":{"line":224,"column":19},"end":{"line":224,"column":22}},"name":"app"},"kind":"init","value":{"type":"Identifier","start":7490,"end":7493,"loc":{"start":{"line":224,"column":19},"end":{"line":224,"column":22}},"name":"app"}},{"type":"Property","start":7495,"end":7511,"loc":{"start":{"line":224,"column":24},"end":{"line":224,"column":40}},"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":7495,"end":7511,"loc":{"start":{"line":224,"column":24},"end":{"line":224,"column":40}},"name":"companionOptions"},"kind":"init","value":{"type":"Identifier","start":7495,"end":7511,"loc":{"start":{"line":224,"column":24},"end":{"line":224,"column":40}},"name":"companionOptions"}}]}}}],"sourceType":"script"}