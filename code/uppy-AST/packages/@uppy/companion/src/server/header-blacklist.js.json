{"type":"Program","start":0,"end":1332,"loc":{"start":{"line":1,"column":0},"end":{"line":65,"column":0}},"body":[{"type":"VariableDeclaration","start":0,"end":36,"loc":{"start":{"line":1,"column":0},"end":{"line":1,"column":36}},"declarations":[{"type":"VariableDeclarator","start":6,"end":36,"loc":{"start":{"line":1,"column":6},"end":{"line":1,"column":36}},"id":{"type":"Identifier","start":6,"end":14,"loc":{"start":{"line":1,"column":6},"end":{"line":1,"column":14}},"name":"isObject"},"init":{"type":"CallExpression","start":17,"end":36,"loc":{"start":{"line":1,"column":17},"end":{"line":1,"column":36}},"callee":{"type":"Identifier","start":17,"end":24,"loc":{"start":{"line":1,"column":17},"end":{"line":1,"column":24}},"name":"require"},"arguments":[{"type":"Literal","start":25,"end":35,"loc":{"start":{"line":1,"column":25},"end":{"line":1,"column":35}},"value":"isobject","raw":"'isobject'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":37,"end":71,"loc":{"start":{"line":2,"column":0},"end":{"line":2,"column":34}},"declarations":[{"type":"VariableDeclarator","start":43,"end":71,"loc":{"start":{"line":2,"column":6},"end":{"line":2,"column":34}},"id":{"type":"Identifier","start":43,"end":49,"loc":{"start":{"line":2,"column":6},"end":{"line":2,"column":12}},"name":"logger"},"init":{"type":"CallExpression","start":52,"end":71,"loc":{"start":{"line":2,"column":15},"end":{"line":2,"column":34}},"callee":{"type":"Identifier","start":52,"end":59,"loc":{"start":{"line":2,"column":15},"end":{"line":2,"column":22}},"name":"require"},"arguments":[{"type":"Literal","start":60,"end":70,"loc":{"start":{"line":2,"column":23},"end":{"line":2,"column":33}},"value":"./logger","raw":"'./logger'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":108,"end":454,"loc":{"start":{"line":7,"column":0},"end":{"line":28,"column":1}},"declarations":[{"type":"VariableDeclarator","start":114,"end":454,"loc":{"start":{"line":7,"column":6},"end":{"line":28,"column":1}},"id":{"type":"Identifier","start":114,"end":128,"loc":{"start":{"line":7,"column":6},"end":{"line":7,"column":20}},"name":"forbiddenNames"},"init":{"type":"ArrayExpression","start":131,"end":454,"loc":{"start":{"line":7,"column":23},"end":{"line":28,"column":1}},"elements":[{"type":"Literal","start":135,"end":151,"loc":{"start":{"line":8,"column":2},"end":{"line":8,"column":18}},"value":"accept-charset","raw":"'accept-charset'"},{"type":"Literal","start":155,"end":172,"loc":{"start":{"line":9,"column":2},"end":{"line":9,"column":19}},"value":"accept-encoding","raw":"'accept-encoding'"},{"type":"Literal","start":176,"end":208,"loc":{"start":{"line":10,"column":2},"end":{"line":10,"column":34}},"value":"access-control-request-headers","raw":"'access-control-request-headers'"},{"type":"Literal","start":212,"end":243,"loc":{"start":{"line":11,"column":2},"end":{"line":11,"column":33}},"value":"access-control-request-method","raw":"'access-control-request-method'"},{"type":"Literal","start":247,"end":259,"loc":{"start":{"line":12,"column":2},"end":{"line":12,"column":14}},"value":"connection","raw":"'connection'"},{"type":"Literal","start":263,"end":279,"loc":{"start":{"line":13,"column":2},"end":{"line":13,"column":18}},"value":"content-length","raw":"'content-length'"},{"type":"Literal","start":283,"end":291,"loc":{"start":{"line":14,"column":2},"end":{"line":14,"column":10}},"value":"cookie","raw":"'cookie'"},{"type":"Literal","start":295,"end":304,"loc":{"start":{"line":15,"column":2},"end":{"line":15,"column":11}},"value":"cookie2","raw":"'cookie2'"},{"type":"Literal","start":308,"end":314,"loc":{"start":{"line":16,"column":2},"end":{"line":16,"column":8}},"value":"date","raw":"'date'"},{"type":"Literal","start":318,"end":323,"loc":{"start":{"line":17,"column":2},"end":{"line":17,"column":7}},"value":"dnt","raw":"'dnt'"},{"type":"Literal","start":327,"end":335,"loc":{"start":{"line":18,"column":2},"end":{"line":18,"column":10}},"value":"expect","raw":"'expect'"},{"type":"Literal","start":339,"end":345,"loc":{"start":{"line":19,"column":2},"end":{"line":19,"column":8}},"value":"host","raw":"'host'"},{"type":"Literal","start":349,"end":361,"loc":{"start":{"line":20,"column":2},"end":{"line":20,"column":14}},"value":"keep-alive","raw":"'keep-alive'"},{"type":"Literal","start":365,"end":373,"loc":{"start":{"line":21,"column":2},"end":{"line":21,"column":10}},"value":"origin","raw":"'origin'"},{"type":"Literal","start":377,"end":386,"loc":{"start":{"line":22,"column":2},"end":{"line":22,"column":11}},"value":"referer","raw":"'referer'"},{"type":"Literal","start":390,"end":394,"loc":{"start":{"line":23,"column":2},"end":{"line":23,"column":6}},"value":"te","raw":"'te'"},{"type":"Literal","start":398,"end":407,"loc":{"start":{"line":24,"column":2},"end":{"line":24,"column":11}},"value":"trailer","raw":"'trailer'"},{"type":"Literal","start":411,"end":430,"loc":{"start":{"line":25,"column":2},"end":{"line":25,"column":21}},"value":"transfer-encoding","raw":"'transfer-encoding'"},{"type":"Literal","start":434,"end":443,"loc":{"start":{"line":26,"column":2},"end":{"line":26,"column":11}},"value":"upgrade","raw":"'upgrade'"},{"type":"Literal","start":447,"end":452,"loc":{"start":{"line":27,"column":2},"end":{"line":27,"column":7}},"value":"via","raw":"'via'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":492,"end":541,"loc":{"start":{"line":33,"column":0},"end":{"line":33,"column":49}},"declarations":[{"type":"VariableDeclarator","start":498,"end":541,"loc":{"start":{"line":33,"column":6},"end":{"line":33,"column":49}},"id":{"type":"Identifier","start":498,"end":512,"loc":{"start":{"line":33,"column":6},"end":{"line":33,"column":20}},"name":"forbiddenRegex"},"init":{"type":"ArrayExpression","start":515,"end":541,"loc":{"start":{"line":33,"column":23},"end":{"line":33,"column":49}},"elements":[{"type":"Literal","start":516,"end":528,"loc":{"start":{"line":33,"column":24},"end":{"line":33,"column":36}},"value":{},"raw":"/^proxy-.*$/","regex":{"pattern":"^proxy-.*$","flags":""}},{"type":"Literal","start":530,"end":540,"loc":{"start":{"line":33,"column":38},"end":{"line":33,"column":48}},"value":{},"raw":"/^sec-.*$/","regex":{"pattern":"^sec-.*$","flags":""}}]}}],"kind":"const"},{"type":"VariableDeclaration","start":709,"end":1041,"loc":{"start":{"line":40,"column":0},"end":{"line":50,"column":1}},"declarations":[{"type":"VariableDeclarator","start":715,"end":1041,"loc":{"start":{"line":40,"column":6},"end":{"line":50,"column":1}},"id":{"type":"Identifier","start":715,"end":732,"loc":{"start":{"line":40,"column":6},"end":{"line":40,"column":23}},"name":"isForbiddenHeader"},"init":{"type":"ArrowFunctionExpression","start":735,"end":1041,"loc":{"start":{"line":40,"column":26},"end":{"line":50,"column":1}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":736,"end":742,"loc":{"start":{"line":40,"column":27},"end":{"line":40,"column":33}},"name":"header"}],"body":{"type":"BlockStatement","start":747,"end":1041,"loc":{"start":{"line":40,"column":38},"end":{"line":50,"column":1}},"body":[{"type":"VariableDeclaration","start":751,"end":791,"loc":{"start":{"line":41,"column":2},"end":{"line":41,"column":42}},"declarations":[{"type":"VariableDeclarator","start":757,"end":791,"loc":{"start":{"line":41,"column":8},"end":{"line":41,"column":42}},"id":{"type":"Identifier","start":757,"end":768,"loc":{"start":{"line":41,"column":8},"end":{"line":41,"column":19}},"name":"headerLower"},"init":{"type":"CallExpression","start":771,"end":791,"loc":{"start":{"line":41,"column":22},"end":{"line":41,"column":42}},"callee":{"type":"MemberExpression","start":771,"end":789,"loc":{"start":{"line":41,"column":22},"end":{"line":41,"column":40}},"object":{"type":"Identifier","start":771,"end":777,"loc":{"start":{"line":41,"column":22},"end":{"line":41,"column":28}},"name":"header"},"property":{"type":"Identifier","start":778,"end":789,"loc":{"start":{"line":41,"column":29},"end":{"line":41,"column":40}},"name":"toLowerCase"},"computed":false},"arguments":[]}}],"kind":"const"},{"type":"VariableDeclaration","start":794,"end":929,"loc":{"start":{"line":42,"column":2},"end":{"line":44,"column":69}},"declarations":[{"type":"VariableDeclarator","start":800,"end":929,"loc":{"start":{"line":42,"column":8},"end":{"line":44,"column":69}},"id":{"type":"Identifier","start":800,"end":809,"loc":{"start":{"line":42,"column":8},"end":{"line":42,"column":17}},"name":"forbidden"},"init":{"type":"LogicalExpression","start":816,"end":929,"loc":{"start":{"line":43,"column":4},"end":{"line":44,"column":69}},"left":{"type":"BinaryExpression","start":816,"end":856,"loc":{"start":{"line":43,"column":4},"end":{"line":43,"column":44}},"left":{"type":"CallExpression","start":816,"end":851,"loc":{"start":{"line":43,"column":4},"end":{"line":43,"column":39}},"callee":{"type":"MemberExpression","start":816,"end":838,"loc":{"start":{"line":43,"column":4},"end":{"line":43,"column":26}},"object":{"type":"Identifier","start":816,"end":830,"loc":{"start":{"line":43,"column":4},"end":{"line":43,"column":18}},"name":"forbiddenNames"},"property":{"type":"Identifier","start":831,"end":838,"loc":{"start":{"line":43,"column":19},"end":{"line":43,"column":26}},"name":"indexOf"},"computed":false},"arguments":[{"type":"Identifier","start":839,"end":850,"loc":{"start":{"line":43,"column":27},"end":{"line":43,"column":38}},"name":"headerLower"}]},"operator":">=","right":{"type":"Literal","start":855,"end":856,"loc":{"start":{"line":43,"column":43},"end":{"line":43,"column":44}},"value":0,"raw":"0"}},"operator":"||","right":{"type":"BinaryExpression","start":864,"end":929,"loc":{"start":{"line":44,"column":4},"end":{"line":44,"column":69}},"left":{"type":"CallExpression","start":864,"end":924,"loc":{"start":{"line":44,"column":4},"end":{"line":44,"column":64}},"callee":{"type":"MemberExpression","start":864,"end":888,"loc":{"start":{"line":44,"column":4},"end":{"line":44,"column":28}},"object":{"type":"Identifier","start":864,"end":878,"loc":{"start":{"line":44,"column":4},"end":{"line":44,"column":18}},"name":"forbiddenRegex"},"property":{"type":"Identifier","start":879,"end":888,"loc":{"start":{"line":44,"column":19},"end":{"line":44,"column":28}},"name":"findIndex"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":889,"end":923,"loc":{"start":{"line":44,"column":29},"end":{"line":44,"column":63}},"id":null,"expression":true,"generator":false,"async":false,"params":[{"type":"Identifier","start":890,"end":895,"loc":{"start":{"line":44,"column":30},"end":{"line":44,"column":35}},"name":"regex"}],"body":{"type":"CallExpression","start":900,"end":923,"loc":{"start":{"line":44,"column":40},"end":{"line":44,"column":63}},"callee":{"type":"MemberExpression","start":900,"end":910,"loc":{"start":{"line":44,"column":40},"end":{"line":44,"column":50}},"object":{"type":"Identifier","start":900,"end":905,"loc":{"start":{"line":44,"column":40},"end":{"line":44,"column":45}},"name":"regex"},"property":{"type":"Identifier","start":906,"end":910,"loc":{"start":{"line":44,"column":46},"end":{"line":44,"column":50}},"name":"test"},"computed":false},"arguments":[{"type":"Identifier","start":911,"end":922,"loc":{"start":{"line":44,"column":51},"end":{"line":44,"column":62}},"name":"headerLower"}]}}]},"operator":">=","right":{"type":"Literal","start":928,"end":929,"loc":{"start":{"line":44,"column":68},"end":{"line":44,"column":69}},"value":0,"raw":"0"}}}}],"kind":"const"},{"type":"IfStatement","start":933,"end":1020,"loc":{"start":{"line":46,"column":2},"end":{"line":48,"column":3}},"test":{"type":"Identifier","start":937,"end":946,"loc":{"start":{"line":46,"column":6},"end":{"line":46,"column":15}},"name":"forbidden"},"consequent":{"type":"BlockStatement","start":948,"end":1020,"loc":{"start":{"line":46,"column":17},"end":{"line":48,"column":3}},"body":[{"type":"ExpressionStatement","start":954,"end":1016,"loc":{"start":{"line":47,"column":4},"end":{"line":47,"column":66}},"expression":{"type":"CallExpression","start":954,"end":1016,"loc":{"start":{"line":47,"column":4},"end":{"line":47,"column":66}},"callee":{"type":"MemberExpression","start":954,"end":965,"loc":{"start":{"line":47,"column":4},"end":{"line":47,"column":15}},"object":{"type":"Identifier","start":954,"end":960,"loc":{"start":{"line":47,"column":4},"end":{"line":47,"column":10}},"name":"logger"},"property":{"type":"Identifier","start":961,"end":965,"loc":{"start":{"line":47,"column":11},"end":{"line":47,"column":15}},"name":"warn"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":966,"end":995,"loc":{"start":{"line":47,"column":16},"end":{"line":47,"column":45}},"expressions":[{"type":"Identifier","start":987,"end":993,"loc":{"start":{"line":47,"column":37},"end":{"line":47,"column":43}},"name":"header"}],"quasis":[{"type":"TemplateElement","start":967,"end":985,"loc":{"start":{"line":47,"column":17},"end":{"line":47,"column":35}},"value":{"raw":"Header forbidden: ","cooked":"Header forbidden: "},"tail":false},{"type":"TemplateElement","start":994,"end":994,"loc":{"start":{"line":47,"column":44},"end":{"line":47,"column":44}},"value":{"raw":"","cooked":""},"tail":true}]},{"type":"Literal","start":997,"end":1015,"loc":{"start":{"line":47,"column":47},"end":{"line":47,"column":65}},"value":"header.forbidden","raw":"'header.forbidden'"}]}}]},"alternate":null},{"type":"ReturnStatement","start":1023,"end":1039,"loc":{"start":{"line":49,"column":2},"end":{"line":49,"column":18}},"argument":{"type":"Identifier","start":1030,"end":1039,"loc":{"start":{"line":49,"column":9},"end":{"line":49,"column":18}},"name":"forbidden"}}]}}}],"kind":"const"},{"type":"ExpressionStatement","start":1043,"end":1331,"loc":{"start":{"line":52,"column":0},"end":{"line":64,"column":1}},"expression":{"type":"AssignmentExpression","start":1043,"end":1331,"loc":{"start":{"line":52,"column":0},"end":{"line":64,"column":1}},"operator":"=","left":{"type":"MemberExpression","start":1043,"end":1057,"loc":{"start":{"line":52,"column":0},"end":{"line":52,"column":14}},"object":{"type":"Identifier","start":1043,"end":1049,"loc":{"start":{"line":52,"column":0},"end":{"line":52,"column":6}},"name":"module"},"property":{"type":"Identifier","start":1050,"end":1057,"loc":{"start":{"line":52,"column":7},"end":{"line":52,"column":14}},"name":"exports"},"computed":false},"right":{"type":"ArrowFunctionExpression","start":1060,"end":1331,"loc":{"start":{"line":52,"column":17},"end":{"line":64,"column":1}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":1061,"end":1068,"loc":{"start":{"line":52,"column":18},"end":{"line":52,"column":25}},"name":"headers"}],"body":{"type":"BlockStatement","start":1073,"end":1331,"loc":{"start":{"line":52,"column":30},"end":{"line":64,"column":1}},"body":[{"type":"IfStatement","start":1077,"end":1120,"loc":{"start":{"line":53,"column":2},"end":{"line":55,"column":3}},"test":{"type":"UnaryExpression","start":1081,"end":1099,"loc":{"start":{"line":53,"column":6},"end":{"line":53,"column":24}},"operator":"!","prefix":true,"argument":{"type":"CallExpression","start":1082,"end":1099,"loc":{"start":{"line":53,"column":7},"end":{"line":53,"column":24}},"callee":{"type":"Identifier","start":1082,"end":1090,"loc":{"start":{"line":53,"column":7},"end":{"line":53,"column":15}},"name":"isObject"},"arguments":[{"type":"Identifier","start":1091,"end":1098,"loc":{"start":{"line":53,"column":16},"end":{"line":53,"column":23}},"name":"headers"}]}},"consequent":{"type":"BlockStatement","start":1101,"end":1120,"loc":{"start":{"line":53,"column":26},"end":{"line":55,"column":3}},"body":[{"type":"ReturnStatement","start":1107,"end":1116,"loc":{"start":{"line":54,"column":4},"end":{"line":54,"column":13}},"argument":{"type":"ObjectExpression","start":1114,"end":1116,"loc":{"start":{"line":54,"column":11},"end":{"line":54,"column":13}},"properties":[]}}]},"alternate":null},{"type":"VariableDeclaration","start":1124,"end":1172,"loc":{"start":{"line":57,"column":2},"end":{"line":57,"column":50}},"declarations":[{"type":"VariableDeclarator","start":1130,"end":1172,"loc":{"start":{"line":57,"column":8},"end":{"line":57,"column":50}},"id":{"type":"Identifier","start":1130,"end":1143,"loc":{"start":{"line":57,"column":8},"end":{"line":57,"column":21}},"name":"headersCloned"},"init":{"type":"CallExpression","start":1146,"end":1172,"loc":{"start":{"line":57,"column":24},"end":{"line":57,"column":50}},"callee":{"type":"MemberExpression","start":1146,"end":1159,"loc":{"start":{"line":57,"column":24},"end":{"line":57,"column":37}},"object":{"type":"Identifier","start":1146,"end":1152,"loc":{"start":{"line":57,"column":24},"end":{"line":57,"column":30}},"name":"Object"},"property":{"type":"Identifier","start":1153,"end":1159,"loc":{"start":{"line":57,"column":31},"end":{"line":57,"column":37}},"name":"assign"},"computed":false},"arguments":[{"type":"ObjectExpression","start":1160,"end":1162,"loc":{"start":{"line":57,"column":38},"end":{"line":57,"column":40}},"properties":[]},{"type":"Identifier","start":1164,"end":1171,"loc":{"start":{"line":57,"column":42},"end":{"line":57,"column":49}},"name":"headers"}]}}],"kind":"const"},{"type":"ExpressionStatement","start":1175,"end":1306,"loc":{"start":{"line":58,"column":2},"end":{"line":62,"column":4}},"expression":{"type":"CallExpression","start":1175,"end":1306,"loc":{"start":{"line":58,"column":2},"end":{"line":62,"column":4}},"callee":{"type":"MemberExpression","start":1175,"end":1209,"loc":{"start":{"line":58,"column":2},"end":{"line":58,"column":36}},"object":{"type":"CallExpression","start":1175,"end":1201,"loc":{"start":{"line":58,"column":2},"end":{"line":58,"column":28}},"callee":{"type":"MemberExpression","start":1175,"end":1186,"loc":{"start":{"line":58,"column":2},"end":{"line":58,"column":13}},"object":{"type":"Identifier","start":1175,"end":1181,"loc":{"start":{"line":58,"column":2},"end":{"line":58,"column":8}},"name":"Object"},"property":{"type":"Identifier","start":1182,"end":1186,"loc":{"start":{"line":58,"column":9},"end":{"line":58,"column":13}},"name":"keys"},"computed":false},"arguments":[{"type":"Identifier","start":1187,"end":1200,"loc":{"start":{"line":58,"column":14},"end":{"line":58,"column":27}},"name":"headersCloned"}]},"property":{"type":"Identifier","start":1202,"end":1209,"loc":{"start":{"line":58,"column":29},"end":{"line":58,"column":36}},"name":"forEach"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":1210,"end":1305,"loc":{"start":{"line":58,"column":37},"end":{"line":62,"column":3}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":1211,"end":1217,"loc":{"start":{"line":58,"column":38},"end":{"line":58,"column":44}},"name":"header"}],"body":{"type":"BlockStatement","start":1222,"end":1305,"loc":{"start":{"line":58,"column":49},"end":{"line":62,"column":3}},"body":[{"type":"IfStatement","start":1228,"end":1301,"loc":{"start":{"line":59,"column":4},"end":{"line":61,"column":5}},"test":{"type":"CallExpression","start":1232,"end":1257,"loc":{"start":{"line":59,"column":8},"end":{"line":59,"column":33}},"callee":{"type":"Identifier","start":1232,"end":1249,"loc":{"start":{"line":59,"column":8},"end":{"line":59,"column":25}},"name":"isForbiddenHeader"},"arguments":[{"type":"Identifier","start":1250,"end":1256,"loc":{"start":{"line":59,"column":26},"end":{"line":59,"column":32}},"name":"header"}]},"consequent":{"type":"BlockStatement","start":1259,"end":1301,"loc":{"start":{"line":59,"column":35},"end":{"line":61,"column":5}},"body":[{"type":"ExpressionStatement","start":1267,"end":1295,"loc":{"start":{"line":60,"column":6},"end":{"line":60,"column":34}},"expression":{"type":"UnaryExpression","start":1267,"end":1295,"loc":{"start":{"line":60,"column":6},"end":{"line":60,"column":34}},"operator":"delete","prefix":true,"argument":{"type":"MemberExpression","start":1274,"end":1295,"loc":{"start":{"line":60,"column":13},"end":{"line":60,"column":34}},"object":{"type":"Identifier","start":1274,"end":1287,"loc":{"start":{"line":60,"column":13},"end":{"line":60,"column":26}},"name":"headersCloned"},"property":{"type":"Identifier","start":1288,"end":1294,"loc":{"start":{"line":60,"column":27},"end":{"line":60,"column":33}},"name":"header"},"computed":true}}}]},"alternate":null}]}}]}},{"type":"ReturnStatement","start":1309,"end":1329,"loc":{"start":{"line":63,"column":2},"end":{"line":63,"column":22}},"argument":{"type":"Identifier","start":1316,"end":1329,"loc":{"start":{"line":63,"column":9},"end":{"line":63,"column":22}},"name":"headersCloned"}}]}}}}],"sourceType":"module"}