{"type":"Program","start":0,"end":1332,"body":[{"type":"VariableDeclaration","start":0,"end":36,"declarations":[{"type":"VariableDeclarator","start":6,"end":36,"id":{"type":"Identifier","start":6,"end":14,"name":"isObject"},"init":{"type":"CallExpression","start":17,"end":36,"callee":{"type":"Identifier","start":17,"end":24,"name":"require"},"arguments":[{"type":"Literal","start":25,"end":35,"value":"isobject","raw":"'isobject'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":37,"end":71,"declarations":[{"type":"VariableDeclarator","start":43,"end":71,"id":{"type":"Identifier","start":43,"end":49,"name":"logger"},"init":{"type":"CallExpression","start":52,"end":71,"callee":{"type":"Identifier","start":52,"end":59,"name":"require"},"arguments":[{"type":"Literal","start":60,"end":70,"value":"./logger","raw":"'./logger'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":108,"end":454,"declarations":[{"type":"VariableDeclarator","start":114,"end":454,"id":{"type":"Identifier","start":114,"end":128,"name":"forbiddenNames"},"init":{"type":"ArrayExpression","start":131,"end":454,"elements":[{"type":"Literal","start":135,"end":151,"value":"accept-charset","raw":"'accept-charset'"},{"type":"Literal","start":155,"end":172,"value":"accept-encoding","raw":"'accept-encoding'"},{"type":"Literal","start":176,"end":208,"value":"access-control-request-headers","raw":"'access-control-request-headers'"},{"type":"Literal","start":212,"end":243,"value":"access-control-request-method","raw":"'access-control-request-method'"},{"type":"Literal","start":247,"end":259,"value":"connection","raw":"'connection'"},{"type":"Literal","start":263,"end":279,"value":"content-length","raw":"'content-length'"},{"type":"Literal","start":283,"end":291,"value":"cookie","raw":"'cookie'"},{"type":"Literal","start":295,"end":304,"value":"cookie2","raw":"'cookie2'"},{"type":"Literal","start":308,"end":314,"value":"date","raw":"'date'"},{"type":"Literal","start":318,"end":323,"value":"dnt","raw":"'dnt'"},{"type":"Literal","start":327,"end":335,"value":"expect","raw":"'expect'"},{"type":"Literal","start":339,"end":345,"value":"host","raw":"'host'"},{"type":"Literal","start":349,"end":361,"value":"keep-alive","raw":"'keep-alive'"},{"type":"Literal","start":365,"end":373,"value":"origin","raw":"'origin'"},{"type":"Literal","start":377,"end":386,"value":"referer","raw":"'referer'"},{"type":"Literal","start":390,"end":394,"value":"te","raw":"'te'"},{"type":"Literal","start":398,"end":407,"value":"trailer","raw":"'trailer'"},{"type":"Literal","start":411,"end":430,"value":"transfer-encoding","raw":"'transfer-encoding'"},{"type":"Literal","start":434,"end":443,"value":"upgrade","raw":"'upgrade'"},{"type":"Literal","start":447,"end":452,"value":"via","raw":"'via'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":492,"end":541,"declarations":[{"type":"VariableDeclarator","start":498,"end":541,"id":{"type":"Identifier","start":498,"end":512,"name":"forbiddenRegex"},"init":{"type":"ArrayExpression","start":515,"end":541,"elements":[{"type":"Literal","start":516,"end":528,"value":{},"raw":"/^proxy-.*$/","regex":{"pattern":"^proxy-.*$","flags":""}},{"type":"Literal","start":530,"end":540,"value":{},"raw":"/^sec-.*$/","regex":{"pattern":"^sec-.*$","flags":""}}]}}],"kind":"const"},{"type":"VariableDeclaration","start":709,"end":1041,"declarations":[{"type":"VariableDeclarator","start":715,"end":1041,"id":{"type":"Identifier","start":715,"end":732,"name":"isForbiddenHeader"},"init":{"type":"ArrowFunctionExpression","start":735,"end":1041,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":736,"end":742,"name":"header"}],"body":{"type":"BlockStatement","start":747,"end":1041,"body":[{"type":"VariableDeclaration","start":751,"end":791,"declarations":[{"type":"VariableDeclarator","start":757,"end":791,"id":{"type":"Identifier","start":757,"end":768,"name":"headerLower"},"init":{"type":"CallExpression","start":771,"end":791,"callee":{"type":"MemberExpression","start":771,"end":789,"object":{"type":"Identifier","start":771,"end":777,"name":"header"},"property":{"type":"Identifier","start":778,"end":789,"name":"toLowerCase"},"computed":false},"arguments":[]}}],"kind":"const"},{"type":"VariableDeclaration","start":794,"end":929,"declarations":[{"type":"VariableDeclarator","start":800,"end":929,"id":{"type":"Identifier","start":800,"end":809,"name":"forbidden"},"init":{"type":"LogicalExpression","start":816,"end":929,"left":{"type":"BinaryExpression","start":816,"end":856,"left":{"type":"CallExpression","start":816,"end":851,"callee":{"type":"MemberExpression","start":816,"end":838,"object":{"type":"Identifier","start":816,"end":830,"name":"forbiddenNames"},"property":{"type":"Identifier","start":831,"end":838,"name":"indexOf"},"computed":false},"arguments":[{"type":"Identifier","start":839,"end":850,"name":"headerLower"}]},"operator":">=","right":{"type":"Literal","start":855,"end":856,"value":0,"raw":"0"}},"operator":"||","right":{"type":"BinaryExpression","start":864,"end":929,"left":{"type":"CallExpression","start":864,"end":924,"callee":{"type":"MemberExpression","start":864,"end":888,"object":{"type":"Identifier","start":864,"end":878,"name":"forbiddenRegex"},"property":{"type":"Identifier","start":879,"end":888,"name":"findIndex"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":889,"end":923,"id":null,"expression":true,"generator":false,"async":false,"params":[{"type":"Identifier","start":890,"end":895,"name":"regex"}],"body":{"type":"CallExpression","start":900,"end":923,"callee":{"type":"MemberExpression","start":900,"end":910,"object":{"type":"Identifier","start":900,"end":905,"name":"regex"},"property":{"type":"Identifier","start":906,"end":910,"name":"test"},"computed":false},"arguments":[{"type":"Identifier","start":911,"end":922,"name":"headerLower"}]}}]},"operator":">=","right":{"type":"Literal","start":928,"end":929,"value":0,"raw":"0"}}}}],"kind":"const"},{"type":"IfStatement","start":933,"end":1020,"test":{"type":"Identifier","start":937,"end":946,"name":"forbidden"},"consequent":{"type":"BlockStatement","start":948,"end":1020,"body":[{"type":"ExpressionStatement","start":954,"end":1016,"expression":{"type":"CallExpression","start":954,"end":1016,"callee":{"type":"MemberExpression","start":954,"end":965,"object":{"type":"Identifier","start":954,"end":960,"name":"logger"},"property":{"type":"Identifier","start":961,"end":965,"name":"warn"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":966,"end":995,"expressions":[{"type":"Identifier","start":987,"end":993,"name":"header"}],"quasis":[{"type":"TemplateElement","start":967,"end":985,"value":{"raw":"Header forbidden: ","cooked":"Header forbidden: "},"tail":false},{"type":"TemplateElement","start":994,"end":994,"value":{"raw":"","cooked":""},"tail":true}]},{"type":"Literal","start":997,"end":1015,"value":"header.forbidden","raw":"'header.forbidden'"}]}}]},"alternate":null},{"type":"ReturnStatement","start":1023,"end":1039,"argument":{"type":"Identifier","start":1030,"end":1039,"name":"forbidden"}}]}}}],"kind":"const"},{"type":"ExpressionStatement","start":1043,"end":1331,"expression":{"type":"AssignmentExpression","start":1043,"end":1331,"operator":"=","left":{"type":"MemberExpression","start":1043,"end":1057,"object":{"type":"Identifier","start":1043,"end":1049,"name":"module"},"property":{"type":"Identifier","start":1050,"end":1057,"name":"exports"},"computed":false},"right":{"type":"ArrowFunctionExpression","start":1060,"end":1331,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":1061,"end":1068,"name":"headers"}],"body":{"type":"BlockStatement","start":1073,"end":1331,"body":[{"type":"IfStatement","start":1077,"end":1120,"test":{"type":"UnaryExpression","start":1081,"end":1099,"operator":"!","prefix":true,"argument":{"type":"CallExpression","start":1082,"end":1099,"callee":{"type":"Identifier","start":1082,"end":1090,"name":"isObject"},"arguments":[{"type":"Identifier","start":1091,"end":1098,"name":"headers"}]}},"consequent":{"type":"BlockStatement","start":1101,"end":1120,"body":[{"type":"ReturnStatement","start":1107,"end":1116,"argument":{"type":"ObjectExpression","start":1114,"end":1116,"properties":[]}}]},"alternate":null},{"type":"VariableDeclaration","start":1124,"end":1172,"declarations":[{"type":"VariableDeclarator","start":1130,"end":1172,"id":{"type":"Identifier","start":1130,"end":1143,"name":"headersCloned"},"init":{"type":"CallExpression","start":1146,"end":1172,"callee":{"type":"MemberExpression","start":1146,"end":1159,"object":{"type":"Identifier","start":1146,"end":1152,"name":"Object"},"property":{"type":"Identifier","start":1153,"end":1159,"name":"assign"},"computed":false},"arguments":[{"type":"ObjectExpression","start":1160,"end":1162,"properties":[]},{"type":"Identifier","start":1164,"end":1171,"name":"headers"}]}}],"kind":"const"},{"type":"ExpressionStatement","start":1175,"end":1306,"expression":{"type":"CallExpression","start":1175,"end":1306,"callee":{"type":"MemberExpression","start":1175,"end":1209,"object":{"type":"CallExpression","start":1175,"end":1201,"callee":{"type":"MemberExpression","start":1175,"end":1186,"object":{"type":"Identifier","start":1175,"end":1181,"name":"Object"},"property":{"type":"Identifier","start":1182,"end":1186,"name":"keys"},"computed":false},"arguments":[{"type":"Identifier","start":1187,"end":1200,"name":"headersCloned"}]},"property":{"type":"Identifier","start":1202,"end":1209,"name":"forEach"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":1210,"end":1305,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":1211,"end":1217,"name":"header"}],"body":{"type":"BlockStatement","start":1222,"end":1305,"body":[{"type":"IfStatement","start":1228,"end":1301,"test":{"type":"CallExpression","start":1232,"end":1257,"callee":{"type":"Identifier","start":1232,"end":1249,"name":"isForbiddenHeader"},"arguments":[{"type":"Identifier","start":1250,"end":1256,"name":"header"}]},"consequent":{"type":"BlockStatement","start":1259,"end":1301,"body":[{"type":"ExpressionStatement","start":1267,"end":1295,"expression":{"type":"UnaryExpression","start":1267,"end":1295,"operator":"delete","prefix":true,"argument":{"type":"MemberExpression","start":1274,"end":1295,"object":{"type":"Identifier","start":1274,"end":1287,"name":"headersCloned"},"property":{"type":"Identifier","start":1288,"end":1294,"name":"header"},"computed":true}}}]},"alternate":null}]}}]}},{"type":"ReturnStatement","start":1309,"end":1329,"argument":{"type":"Identifier","start":1316,"end":1329,"name":"headersCloned"}}]}}}}],"sourceType":"script"}