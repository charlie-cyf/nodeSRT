{"type":"Program","start":0,"end":4163,"body":[{"type":"VariableDeclaration","start":0,"end":28,"declarations":[{"type":"VariableDeclarator","start":6,"end":28,"id":{"type":"Identifier","start":6,"end":10,"name":"http"},"init":{"type":"CallExpression","start":13,"end":28,"callee":{"type":"Identifier","start":13,"end":20,"name":"require"},"arguments":[{"type":"Literal","start":21,"end":27,"value":"http","raw":"'http'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":29,"end":59,"declarations":[{"type":"VariableDeclarator","start":35,"end":59,"id":{"type":"Identifier","start":35,"end":40,"name":"https"},"init":{"type":"CallExpression","start":43,"end":59,"callee":{"type":"Identifier","start":43,"end":50,"name":"require"},"arguments":[{"type":"Literal","start":51,"end":58,"value":"https","raw":"'https'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":60,"end":86,"declarations":[{"type":"VariableDeclarator","start":66,"end":86,"id":{"type":"Identifier","start":66,"end":69,"name":"dns"},"init":{"type":"CallExpression","start":72,"end":86,"callee":{"type":"Identifier","start":72,"end":79,"name":"require"},"arguments":[{"type":"Literal","start":80,"end":85,"value":"dns","raw":"'dns'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":87,"end":126,"declarations":[{"type":"VariableDeclarator","start":93,"end":126,"id":{"type":"Identifier","start":93,"end":102,"name":"ipAddress"},"init":{"type":"CallExpression","start":105,"end":126,"callee":{"type":"Identifier","start":105,"end":112,"name":"require"},"arguments":[{"type":"Literal","start":113,"end":125,"value":"ip-address","raw":"'ip-address'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":127,"end":178,"declarations":[{"type":"VariableDeclarator","start":133,"end":178,"id":{"type":"Identifier","start":133,"end":153,"name":"FORBIDDEN_IP_ADDRESS"},"init":{"type":"Literal","start":156,"end":178,"value":"Forbidden IP address","raw":"'Forbidden IP address'"}}],"kind":"const"},{"type":"FunctionDeclaration","start":180,"end":378,"id":{"type":"Identifier","start":189,"end":200,"name":"isIPAddress"},"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":202,"end":209,"name":"address"}],"body":{"type":"BlockStatement","start":211,"end":378,"body":[{"type":"VariableDeclaration","start":215,"end":266,"declarations":[{"type":"VariableDeclarator","start":221,"end":266,"id":{"type":"Identifier","start":221,"end":232,"name":"addressAsV6"},"init":{"type":"NewExpression","start":235,"end":266,"callee":{"type":"MemberExpression","start":239,"end":257,"object":{"type":"Identifier","start":239,"end":248,"name":"ipAddress"},"property":{"type":"Identifier","start":249,"end":257,"name":"Address6"},"computed":false},"arguments":[{"type":"Identifier","start":258,"end":265,"name":"address"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":269,"end":320,"declarations":[{"type":"VariableDeclarator","start":275,"end":320,"id":{"type":"Identifier","start":275,"end":286,"name":"addressAsV4"},"init":{"type":"NewExpression","start":289,"end":320,"callee":{"type":"MemberExpression","start":293,"end":311,"object":{"type":"Identifier","start":293,"end":302,"name":"ipAddress"},"property":{"type":"Identifier","start":303,"end":311,"name":"Address4"},"computed":false},"arguments":[{"type":"Identifier","start":312,"end":319,"name":"address"}]}}],"kind":"const"},{"type":"ReturnStatement","start":323,"end":376,"argument":{"type":"LogicalExpression","start":330,"end":376,"left":{"type":"CallExpression","start":330,"end":351,"callee":{"type":"MemberExpression","start":330,"end":349,"object":{"type":"Identifier","start":330,"end":341,"name":"addressAsV6"},"property":{"type":"Identifier","start":342,"end":349,"name":"isValid"},"computed":false},"arguments":[]},"operator":"||","right":{"type":"CallExpression","start":355,"end":376,"callee":{"type":"MemberExpression","start":355,"end":374,"object":{"type":"Identifier","start":355,"end":366,"name":"addressAsV4"},"property":{"type":"Identifier","start":367,"end":374,"name":"isValid"},"computed":false},"arguments":[]}}}]}},{"type":"FunctionDeclaration","start":779,"end":2439,"id":{"type":"Identifier","start":788,"end":799,"name":"isPrivateIP"},"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":801,"end":810,"name":"ipAddress"}],"body":{"type":"BlockStatement","start":812,"end":2439,"body":[{"type":"VariableDeclaration","start":816,"end":837,"declarations":[{"type":"VariableDeclarator","start":820,"end":837,"id":{"type":"Identifier","start":820,"end":829,"name":"isPrivate"},"init":{"type":"Literal","start":832,"end":837,"value":false,"raw":"false"}}],"kind":"let"},{"type":"VariableDeclaration","start":897,"end":916,"declarations":[{"type":"VariableDeclarator","start":903,"end":916,"id":{"type":"Identifier","start":903,"end":911,"name":"ipPrefix"},"init":{"type":"ArrayExpression","start":914,"end":916,"elements":[]}}],"kind":"const"},{"type":"ExpressionStatement","start":958,"end":979,"expression":{"type":"CallExpression","start":958,"end":979,"callee":{"type":"MemberExpression","start":958,"end":971,"object":{"type":"Identifier","start":958,"end":966,"name":"ipPrefix"},"property":{"type":"Identifier","start":967,"end":971,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":972,"end":978,"value":"127.","raw":"'127.'"}]}},{"type":"ExpressionStatement","start":982,"end":1001,"expression":{"type":"CallExpression","start":982,"end":1001,"callee":{"type":"MemberExpression","start":982,"end":995,"object":{"type":"Identifier","start":982,"end":990,"name":"ipPrefix"},"property":{"type":"Identifier","start":991,"end":995,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":996,"end":1000,"value":"0.","raw":"'0.'"}]}},{"type":"ExpressionStatement","start":1103,"end":1123,"expression":{"type":"CallExpression","start":1103,"end":1123,"callee":{"type":"MemberExpression","start":1103,"end":1116,"object":{"type":"Identifier","start":1103,"end":1111,"name":"ipPrefix"},"property":{"type":"Identifier","start":1112,"end":1116,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1117,"end":1122,"value":"10.","raw":"'10.'"}]}},{"type":"ExpressionStatement","start":1126,"end":1150,"expression":{"type":"CallExpression","start":1126,"end":1150,"callee":{"type":"MemberExpression","start":1126,"end":1139,"object":{"type":"Identifier","start":1126,"end":1134,"name":"ipPrefix"},"property":{"type":"Identifier","start":1135,"end":1139,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1140,"end":1149,"value":"172.16.","raw":"'172.16.'"}]}},{"type":"ExpressionStatement","start":1153,"end":1177,"expression":{"type":"CallExpression","start":1153,"end":1177,"callee":{"type":"MemberExpression","start":1153,"end":1166,"object":{"type":"Identifier","start":1153,"end":1161,"name":"ipPrefix"},"property":{"type":"Identifier","start":1162,"end":1166,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1167,"end":1176,"value":"172.17.","raw":"'172.17.'"}]}},{"type":"ExpressionStatement","start":1180,"end":1204,"expression":{"type":"CallExpression","start":1180,"end":1204,"callee":{"type":"MemberExpression","start":1180,"end":1193,"object":{"type":"Identifier","start":1180,"end":1188,"name":"ipPrefix"},"property":{"type":"Identifier","start":1189,"end":1193,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1194,"end":1203,"value":"172.18.","raw":"'172.18.'"}]}},{"type":"ExpressionStatement","start":1207,"end":1231,"expression":{"type":"CallExpression","start":1207,"end":1231,"callee":{"type":"MemberExpression","start":1207,"end":1220,"object":{"type":"Identifier","start":1207,"end":1215,"name":"ipPrefix"},"property":{"type":"Identifier","start":1216,"end":1220,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1221,"end":1230,"value":"172.19.","raw":"'172.19.'"}]}},{"type":"ExpressionStatement","start":1234,"end":1258,"expression":{"type":"CallExpression","start":1234,"end":1258,"callee":{"type":"MemberExpression","start":1234,"end":1247,"object":{"type":"Identifier","start":1234,"end":1242,"name":"ipPrefix"},"property":{"type":"Identifier","start":1243,"end":1247,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1248,"end":1257,"value":"172.20.","raw":"'172.20.'"}]}},{"type":"ExpressionStatement","start":1261,"end":1285,"expression":{"type":"CallExpression","start":1261,"end":1285,"callee":{"type":"MemberExpression","start":1261,"end":1274,"object":{"type":"Identifier","start":1261,"end":1269,"name":"ipPrefix"},"property":{"type":"Identifier","start":1270,"end":1274,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1275,"end":1284,"value":"172.21.","raw":"'172.21.'"}]}},{"type":"ExpressionStatement","start":1288,"end":1312,"expression":{"type":"CallExpression","start":1288,"end":1312,"callee":{"type":"MemberExpression","start":1288,"end":1301,"object":{"type":"Identifier","start":1288,"end":1296,"name":"ipPrefix"},"property":{"type":"Identifier","start":1297,"end":1301,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1302,"end":1311,"value":"172.22.","raw":"'172.22.'"}]}},{"type":"ExpressionStatement","start":1315,"end":1339,"expression":{"type":"CallExpression","start":1315,"end":1339,"callee":{"type":"MemberExpression","start":1315,"end":1328,"object":{"type":"Identifier","start":1315,"end":1323,"name":"ipPrefix"},"property":{"type":"Identifier","start":1324,"end":1328,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1329,"end":1338,"value":"172.23.","raw":"'172.23.'"}]}},{"type":"ExpressionStatement","start":1342,"end":1366,"expression":{"type":"CallExpression","start":1342,"end":1366,"callee":{"type":"MemberExpression","start":1342,"end":1355,"object":{"type":"Identifier","start":1342,"end":1350,"name":"ipPrefix"},"property":{"type":"Identifier","start":1351,"end":1355,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1356,"end":1365,"value":"172.24.","raw":"'172.24.'"}]}},{"type":"ExpressionStatement","start":1369,"end":1393,"expression":{"type":"CallExpression","start":1369,"end":1393,"callee":{"type":"MemberExpression","start":1369,"end":1382,"object":{"type":"Identifier","start":1369,"end":1377,"name":"ipPrefix"},"property":{"type":"Identifier","start":1378,"end":1382,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1383,"end":1392,"value":"172.25.","raw":"'172.25.'"}]}},{"type":"ExpressionStatement","start":1396,"end":1420,"expression":{"type":"CallExpression","start":1396,"end":1420,"callee":{"type":"MemberExpression","start":1396,"end":1409,"object":{"type":"Identifier","start":1396,"end":1404,"name":"ipPrefix"},"property":{"type":"Identifier","start":1405,"end":1409,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1410,"end":1419,"value":"172.26.","raw":"'172.26.'"}]}},{"type":"ExpressionStatement","start":1423,"end":1447,"expression":{"type":"CallExpression","start":1423,"end":1447,"callee":{"type":"MemberExpression","start":1423,"end":1436,"object":{"type":"Identifier","start":1423,"end":1431,"name":"ipPrefix"},"property":{"type":"Identifier","start":1432,"end":1436,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1437,"end":1446,"value":"172.27.","raw":"'172.27.'"}]}},{"type":"ExpressionStatement","start":1450,"end":1474,"expression":{"type":"CallExpression","start":1450,"end":1474,"callee":{"type":"MemberExpression","start":1450,"end":1463,"object":{"type":"Identifier","start":1450,"end":1458,"name":"ipPrefix"},"property":{"type":"Identifier","start":1459,"end":1463,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1464,"end":1473,"value":"172.28.","raw":"'172.28.'"}]}},{"type":"ExpressionStatement","start":1477,"end":1501,"expression":{"type":"CallExpression","start":1477,"end":1501,"callee":{"type":"MemberExpression","start":1477,"end":1490,"object":{"type":"Identifier","start":1477,"end":1485,"name":"ipPrefix"},"property":{"type":"Identifier","start":1486,"end":1490,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1491,"end":1500,"value":"172.29.","raw":"'172.29.'"}]}},{"type":"ExpressionStatement","start":1504,"end":1528,"expression":{"type":"CallExpression","start":1504,"end":1528,"callee":{"type":"MemberExpression","start":1504,"end":1517,"object":{"type":"Identifier","start":1504,"end":1512,"name":"ipPrefix"},"property":{"type":"Identifier","start":1513,"end":1517,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1518,"end":1527,"value":"172.30.","raw":"'172.30.'"}]}},{"type":"ExpressionStatement","start":1531,"end":1555,"expression":{"type":"CallExpression","start":1531,"end":1555,"callee":{"type":"MemberExpression","start":1531,"end":1544,"object":{"type":"Identifier","start":1531,"end":1539,"name":"ipPrefix"},"property":{"type":"Identifier","start":1540,"end":1544,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1545,"end":1554,"value":"172.31.","raw":"'172.31.'"}]}},{"type":"ExpressionStatement","start":1558,"end":1583,"expression":{"type":"CallExpression","start":1558,"end":1583,"callee":{"type":"MemberExpression","start":1558,"end":1571,"object":{"type":"Identifier","start":1558,"end":1566,"name":"ipPrefix"},"property":{"type":"Identifier","start":1567,"end":1571,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1572,"end":1582,"value":"192.168.","raw":"'192.168.'"}]}},{"type":"ExpressionStatement","start":1586,"end":1611,"expression":{"type":"CallExpression","start":1586,"end":1611,"callee":{"type":"MemberExpression","start":1586,"end":1599,"object":{"type":"Identifier","start":1586,"end":1594,"name":"ipPrefix"},"property":{"type":"Identifier","start":1595,"end":1599,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1600,"end":1610,"value":"169.254.","raw":"'169.254.'"}]}},{"type":"ExpressionStatement","start":1817,"end":1836,"expression":{"type":"CallExpression","start":1817,"end":1836,"callee":{"type":"MemberExpression","start":1817,"end":1830,"object":{"type":"Identifier","start":1817,"end":1825,"name":"ipPrefix"},"property":{"type":"Identifier","start":1826,"end":1830,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1831,"end":1835,"value":"fc","raw":"'fc'"}]}},{"type":"ExpressionStatement","start":1839,"end":1858,"expression":{"type":"CallExpression","start":1839,"end":1858,"callee":{"type":"MemberExpression","start":1839,"end":1852,"object":{"type":"Identifier","start":1839,"end":1847,"name":"ipPrefix"},"property":{"type":"Identifier","start":1848,"end":1852,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1853,"end":1857,"value":"fd","raw":"'fd'"}]}},{"type":"ExpressionStatement","start":1861,"end":1880,"expression":{"type":"CallExpression","start":1861,"end":1880,"callee":{"type":"MemberExpression","start":1861,"end":1874,"object":{"type":"Identifier","start":1861,"end":1869,"name":"ipPrefix"},"property":{"type":"Identifier","start":1870,"end":1874,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1875,"end":1879,"value":"fe","raw":"'fe'"}]}},{"type":"ExpressionStatement","start":1883,"end":1902,"expression":{"type":"CallExpression","start":1883,"end":1902,"callee":{"type":"MemberExpression","start":1883,"end":1896,"object":{"type":"Identifier","start":1883,"end":1891,"name":"ipPrefix"},"property":{"type":"Identifier","start":1892,"end":1896,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1897,"end":1901,"value":"ff","raw":"'ff'"}]}},{"type":"ExpressionStatement","start":1905,"end":1925,"expression":{"type":"CallExpression","start":1905,"end":1925,"callee":{"type":"MemberExpression","start":1905,"end":1918,"object":{"type":"Identifier","start":1905,"end":1913,"name":"ipPrefix"},"property":{"type":"Identifier","start":1914,"end":1918,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":1919,"end":1924,"value":"::1","raw":"'::1'"}]}},{"type":"VariableDeclaration","start":2197,"end":2246,"declarations":[{"type":"VariableDeclarator","start":2203,"end":2246,"id":{"type":"Identifier","start":2203,"end":2213,"name":"ipToVerify"},"init":{"type":"CallExpression","start":2216,"end":2246,"callee":{"type":"MemberExpression","start":2216,"end":2244,"object":{"type":"CallExpression","start":2216,"end":2232,"callee":{"type":"MemberExpression","start":2216,"end":2230,"object":{"type":"Identifier","start":2216,"end":2225,"name":"ipAddress"},"property":{"type":"Identifier","start":2226,"end":2230,"name":"trim"},"computed":false},"arguments":[]},"property":{"type":"Identifier","start":2233,"end":2244,"name":"toLowerCase"},"computed":false},"arguments":[]}}],"kind":"const"},{"type":"ForOfStatement","start":2299,"end":2417,"await":false,"left":{"type":"VariableDeclaration","start":2304,"end":2316,"declarations":[{"type":"VariableDeclarator","start":2310,"end":2316,"id":{"type":"Identifier","start":2310,"end":2316,"name":"prefix"},"init":null}],"kind":"const"},"right":{"type":"Identifier","start":2320,"end":2328,"name":"ipPrefix"},"body":{"type":"BlockStatement","start":2330,"end":2417,"body":[{"type":"IfStatement","start":2336,"end":2413,"test":{"type":"CallExpression","start":2340,"end":2369,"callee":{"type":"MemberExpression","start":2340,"end":2361,"object":{"type":"Identifier","start":2340,"end":2350,"name":"ipToVerify"},"property":{"type":"Identifier","start":2351,"end":2361,"name":"startsWith"},"computed":false},"arguments":[{"type":"Identifier","start":2362,"end":2368,"name":"prefix"}]},"consequent":{"type":"BlockStatement","start":2371,"end":2413,"body":[{"type":"ExpressionStatement","start":2379,"end":2395,"expression":{"type":"AssignmentExpression","start":2379,"end":2395,"operator":"=","left":{"type":"Identifier","start":2379,"end":2388,"name":"isPrivate"},"right":{"type":"Literal","start":2391,"end":2395,"value":true,"raw":"true"}}},{"type":"BreakStatement","start":2402,"end":2407,"label":null}]},"alternate":null}]}},{"type":"ReturnStatement","start":2421,"end":2437,"argument":{"type":"Identifier","start":2428,"end":2437,"name":"isPrivate"}}]}},{"type":"ExpressionStatement","start":2441,"end":2499,"expression":{"type":"AssignmentExpression","start":2441,"end":2499,"operator":"=","left":{"type":"MemberExpression","start":2441,"end":2476,"object":{"type":"MemberExpression","start":2441,"end":2455,"object":{"type":"Identifier","start":2441,"end":2447,"name":"module"},"property":{"type":"Identifier","start":2448,"end":2455,"name":"exports"},"computed":false},"property":{"type":"Identifier","start":2456,"end":2476,"name":"FORBIDDEN_IP_ADDRESS"},"computed":false},"right":{"type":"Identifier","start":2479,"end":2499,"name":"FORBIDDEN_IP_ADDRESS"}}},{"type":"ExpressionStatement","start":2769,"end":3002,"expression":{"type":"AssignmentExpression","start":2769,"end":3002,"operator":"=","left":{"type":"MemberExpression","start":2769,"end":2805,"object":{"type":"MemberExpression","start":2769,"end":2783,"object":{"type":"Identifier","start":2769,"end":2775,"name":"module"},"property":{"type":"Identifier","start":2776,"end":2783,"name":"exports"},"computed":false},"property":{"type":"Identifier","start":2784,"end":2805,"name":"getProtectedHttpAgent"},"computed":false},"right":{"type":"ArrowFunctionExpression","start":2808,"end":3002,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":2809,"end":2817,"name":"protocol"},{"type":"Identifier","start":2819,"end":2834,"name":"blockPrivateIPs"}],"body":{"type":"BlockStatement","start":2839,"end":3002,"body":[{"type":"IfStatement","start":2843,"end":2934,"test":{"type":"Identifier","start":2847,"end":2862,"name":"blockPrivateIPs"},"consequent":{"type":"BlockStatement","start":2864,"end":2934,"body":[{"type":"ReturnStatement","start":2870,"end":2930,"argument":{"type":"ConditionalExpression","start":2877,"end":2930,"test":{"type":"CallExpression","start":2877,"end":2905,"callee":{"type":"MemberExpression","start":2877,"end":2896,"object":{"type":"Identifier","start":2877,"end":2885,"name":"protocol"},"property":{"type":"Identifier","start":2886,"end":2896,"name":"startsWith"},"computed":false},"arguments":[{"type":"Literal","start":2897,"end":2904,"value":"https","raw":"'https'"}]},"consequent":{"type":"Identifier","start":2908,"end":2918,"name":"HttpsAgent"},"alternate":{"type":"Identifier","start":2921,"end":2930,"name":"HttpAgent"}}}]},"alternate":null},{"type":"ReturnStatement","start":2938,"end":3000,"argument":{"type":"ConditionalExpression","start":2945,"end":3000,"test":{"type":"CallExpression","start":2945,"end":2973,"callee":{"type":"MemberExpression","start":2945,"end":2964,"object":{"type":"Identifier","start":2945,"end":2953,"name":"protocol"},"property":{"type":"Identifier","start":2954,"end":2964,"name":"startsWith"},"computed":false},"arguments":[{"type":"Literal","start":2965,"end":2972,"value":"https","raw":"'https'"}]},"consequent":{"type":"MemberExpression","start":2976,"end":2987,"object":{"type":"Identifier","start":2976,"end":2981,"name":"https"},"property":{"type":"Identifier","start":2982,"end":2987,"name":"Agent"},"computed":false},"alternate":{"type":"MemberExpression","start":2990,"end":3000,"object":{"type":"Identifier","start":2990,"end":2994,"name":"http"},"property":{"type":"Identifier","start":2995,"end":3000,"name":"Agent"},"computed":false}}}]}}}},{"type":"FunctionDeclaration","start":3004,"end":3520,"id":{"type":"Identifier","start":3013,"end":3022,"name":"dnsLookup"},"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":3024,"end":3032,"name":"hostname"},{"type":"Identifier","start":3034,"end":3041,"name":"options"},{"type":"Identifier","start":3043,"end":3051,"name":"callback"}],"body":{"type":"BlockStatement","start":3053,"end":3520,"body":[{"type":"ExpressionStatement","start":3057,"end":3518,"expression":{"type":"CallExpression","start":3057,"end":3518,"callee":{"type":"MemberExpression","start":3057,"end":3067,"object":{"type":"Identifier","start":3057,"end":3060,"name":"dns"},"property":{"type":"Identifier","start":3061,"end":3067,"name":"lookup"},"computed":false},"arguments":[{"type":"Identifier","start":3068,"end":3076,"name":"hostname"},{"type":"Identifier","start":3078,"end":3085,"name":"options"},{"type":"ArrowFunctionExpression","start":3087,"end":3517,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":3088,"end":3091,"name":"err"},{"type":"Identifier","start":3093,"end":3102,"name":"addresses"},{"type":"Identifier","start":3104,"end":3115,"name":"maybeFamily"}],"body":{"type":"BlockStatement","start":3120,"end":3517,"body":[{"type":"IfStatement","start":3126,"end":3199,"test":{"type":"Identifier","start":3130,"end":3133,"name":"err"},"consequent":{"type":"BlockStatement","start":3135,"end":3199,"body":[{"type":"ExpressionStatement","start":3143,"end":3180,"expression":{"type":"CallExpression","start":3143,"end":3180,"callee":{"type":"Identifier","start":3143,"end":3151,"name":"callback"},"arguments":[{"type":"Identifier","start":3152,"end":3155,"name":"err"},{"type":"Identifier","start":3157,"end":3166,"name":"addresses"},{"type":"Identifier","start":3168,"end":3179,"name":"maybeFamily"}]}},{"type":"ReturnStatement","start":3187,"end":3193,"argument":null}]},"alternate":null},{"type":"VariableDeclaration","start":3205,"end":3287,"declarations":[{"type":"VariableDeclarator","start":3211,"end":3287,"id":{"type":"Identifier","start":3211,"end":3221,"name":"toValidate"},"init":{"type":"ConditionalExpression","start":3224,"end":3287,"test":{"type":"CallExpression","start":3224,"end":3248,"callee":{"type":"MemberExpression","start":3224,"end":3237,"object":{"type":"Identifier","start":3224,"end":3229,"name":"Array"},"property":{"type":"Identifier","start":3230,"end":3237,"name":"isArray"},"computed":false},"arguments":[{"type":"Identifier","start":3238,"end":3247,"name":"addresses"}]},"consequent":{"type":"Identifier","start":3251,"end":3260,"name":"addresses"},"alternate":{"type":"ArrayExpression","start":3263,"end":3287,"elements":[{"type":"ObjectExpression","start":3264,"end":3286,"properties":[{"type":"Property","start":3266,"end":3284,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3266,"end":3273,"name":"address"},"value":{"type":"Identifier","start":3275,"end":3284,"name":"addresses"},"kind":"init"}]}]}}}],"kind":"const"},{"type":"ForOfStatement","start":3292,"end":3470,"await":false,"left":{"type":"VariableDeclaration","start":3297,"end":3309,"declarations":[{"type":"VariableDeclarator","start":3303,"end":3309,"id":{"type":"Identifier","start":3303,"end":3309,"name":"record"},"init":null}],"kind":"const"},"right":{"type":"Identifier","start":3313,"end":3323,"name":"toValidate"},"body":{"type":"BlockStatement","start":3325,"end":3470,"body":[{"type":"IfStatement","start":3333,"end":3464,"test":{"type":"CallExpression","start":3337,"end":3364,"callee":{"type":"Identifier","start":3337,"end":3348,"name":"isPrivateIP"},"arguments":[{"type":"MemberExpression","start":3349,"end":3363,"object":{"type":"Identifier","start":3349,"end":3355,"name":"record"},"property":{"type":"Identifier","start":3356,"end":3363,"name":"address"},"computed":false}]},"consequent":{"type":"BlockStatement","start":3366,"end":3464,"body":[{"type":"ExpressionStatement","start":3376,"end":3441,"expression":{"type":"CallExpression","start":3376,"end":3441,"callee":{"type":"Identifier","start":3376,"end":3384,"name":"callback"},"arguments":[{"type":"NewExpression","start":3385,"end":3416,"callee":{"type":"Identifier","start":3389,"end":3394,"name":"Error"},"arguments":[{"type":"Identifier","start":3395,"end":3415,"name":"FORBIDDEN_IP_ADDRESS"}]},{"type":"Identifier","start":3418,"end":3427,"name":"addresses"},{"type":"Identifier","start":3429,"end":3440,"name":"maybeFamily"}]}},{"type":"ReturnStatement","start":3450,"end":3456,"argument":null}]},"alternate":null}]}},{"type":"ExpressionStatement","start":3476,"end":3513,"expression":{"type":"CallExpression","start":3476,"end":3513,"callee":{"type":"Identifier","start":3476,"end":3484,"name":"callback"},"arguments":[{"type":"Identifier","start":3485,"end":3488,"name":"err"},{"type":"Identifier","start":3490,"end":3499,"name":"addresses"},{"type":"Identifier","start":3501,"end":3512,"name":"maybeFamily"}]}}]}}]}}]}},{"type":"ClassDeclaration","start":3522,"end":3840,"id":{"type":"Identifier","start":3528,"end":3537,"name":"HttpAgent"},"superClass":{"type":"MemberExpression","start":3546,"end":3556,"object":{"type":"Identifier","start":3546,"end":3550,"name":"http"},"property":{"type":"Identifier","start":3551,"end":3556,"name":"Agent"},"computed":false},"body":{"type":"ClassBody","start":3557,"end":3840,"body":[{"type":"MethodDefinition","start":3561,"end":3838,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":3561,"end":3577,"name":"createConnection"},"value":{"type":"FunctionExpression","start":3578,"end":3838,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":3579,"end":3586,"name":"options"},{"type":"Identifier","start":3588,"end":3596,"name":"callback"}],"body":{"type":"BlockStatement","start":3598,"end":3838,"body":[{"type":"ExpressionStatement","start":3604,"end":3630,"expression":{"type":"AssignmentExpression","start":3604,"end":3630,"operator":"=","left":{"type":"MemberExpression","start":3604,"end":3618,"object":{"type":"Identifier","start":3604,"end":3611,"name":"options"},"property":{"type":"Identifier","start":3612,"end":3618,"name":"lookup"},"computed":false},"right":{"type":"Identifier","start":3621,"end":3630,"name":"dnsLookup"}}},{"type":"IfStatement","start":3635,"end":3763,"test":{"type":"LogicalExpression","start":3639,"end":3693,"left":{"type":"CallExpression","start":3639,"end":3664,"callee":{"type":"Identifier","start":3639,"end":3650,"name":"isIPAddress"},"arguments":[{"type":"MemberExpression","start":3651,"end":3663,"object":{"type":"Identifier","start":3651,"end":3658,"name":"options"},"property":{"type":"Identifier","start":3659,"end":3663,"name":"host"},"computed":false}]},"operator":"&&","right":{"type":"CallExpression","start":3668,"end":3693,"callee":{"type":"Identifier","start":3668,"end":3679,"name":"isPrivateIP"},"arguments":[{"type":"MemberExpression","start":3680,"end":3692,"object":{"type":"Identifier","start":3680,"end":3687,"name":"options"},"property":{"type":"Identifier","start":3688,"end":3692,"name":"host"},"computed":false}]}},"consequent":{"type":"BlockStatement","start":3695,"end":3763,"body":[{"type":"ExpressionStatement","start":3703,"end":3744,"expression":{"type":"CallExpression","start":3703,"end":3744,"callee":{"type":"Identifier","start":3703,"end":3711,"name":"callback"},"arguments":[{"type":"NewExpression","start":3712,"end":3743,"callee":{"type":"Identifier","start":3716,"end":3721,"name":"Error"},"arguments":[{"type":"Identifier","start":3722,"end":3742,"name":"FORBIDDEN_IP_ADDRESS"}]}]}},{"type":"ReturnStatement","start":3751,"end":3757,"argument":null}]},"alternate":null},{"type":"ReturnStatement","start":3786,"end":3834,"argument":{"type":"CallExpression","start":3793,"end":3834,"callee":{"type":"MemberExpression","start":3793,"end":3815,"object":{"type":"Super","start":3793,"end":3798},"property":{"type":"Identifier","start":3799,"end":3815,"name":"createConnection"},"computed":false},"arguments":[{"type":"Identifier","start":3816,"end":3823,"name":"options"},{"type":"Identifier","start":3825,"end":3833,"name":"callback"}]}}]}}}]}},{"type":"ClassDeclaration","start":3842,"end":4162,"id":{"type":"Identifier","start":3848,"end":3858,"name":"HttpsAgent"},"superClass":{"type":"MemberExpression","start":3867,"end":3878,"object":{"type":"Identifier","start":3867,"end":3872,"name":"https"},"property":{"type":"Identifier","start":3873,"end":3878,"name":"Agent"},"computed":false},"body":{"type":"ClassBody","start":3879,"end":4162,"body":[{"type":"MethodDefinition","start":3883,"end":4160,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":3883,"end":3899,"name":"createConnection"},"value":{"type":"FunctionExpression","start":3900,"end":4160,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":3901,"end":3908,"name":"options"},{"type":"Identifier","start":3910,"end":3918,"name":"callback"}],"body":{"type":"BlockStatement","start":3920,"end":4160,"body":[{"type":"ExpressionStatement","start":3926,"end":3952,"expression":{"type":"AssignmentExpression","start":3926,"end":3952,"operator":"=","left":{"type":"MemberExpression","start":3926,"end":3940,"object":{"type":"Identifier","start":3926,"end":3933,"name":"options"},"property":{"type":"Identifier","start":3934,"end":3940,"name":"lookup"},"computed":false},"right":{"type":"Identifier","start":3943,"end":3952,"name":"dnsLookup"}}},{"type":"IfStatement","start":3957,"end":4085,"test":{"type":"LogicalExpression","start":3961,"end":4015,"left":{"type":"CallExpression","start":3961,"end":3986,"callee":{"type":"Identifier","start":3961,"end":3972,"name":"isIPAddress"},"arguments":[{"type":"MemberExpression","start":3973,"end":3985,"object":{"type":"Identifier","start":3973,"end":3980,"name":"options"},"property":{"type":"Identifier","start":3981,"end":3985,"name":"host"},"computed":false}]},"operator":"&&","right":{"type":"CallExpression","start":3990,"end":4015,"callee":{"type":"Identifier","start":3990,"end":4001,"name":"isPrivateIP"},"arguments":[{"type":"MemberExpression","start":4002,"end":4014,"object":{"type":"Identifier","start":4002,"end":4009,"name":"options"},"property":{"type":"Identifier","start":4010,"end":4014,"name":"host"},"computed":false}]}},"consequent":{"type":"BlockStatement","start":4017,"end":4085,"body":[{"type":"ExpressionStatement","start":4025,"end":4066,"expression":{"type":"CallExpression","start":4025,"end":4066,"callee":{"type":"Identifier","start":4025,"end":4033,"name":"callback"},"arguments":[{"type":"NewExpression","start":4034,"end":4065,"callee":{"type":"Identifier","start":4038,"end":4043,"name":"Error"},"arguments":[{"type":"Identifier","start":4044,"end":4064,"name":"FORBIDDEN_IP_ADDRESS"}]}]}},{"type":"ReturnStatement","start":4073,"end":4079,"argument":null}]},"alternate":null},{"type":"ReturnStatement","start":4108,"end":4156,"argument":{"type":"CallExpression","start":4115,"end":4156,"callee":{"type":"MemberExpression","start":4115,"end":4137,"object":{"type":"Super","start":4115,"end":4120},"property":{"type":"Identifier","start":4121,"end":4137,"name":"createConnection"},"computed":false},"arguments":[{"type":"Identifier","start":4138,"end":4145,"name":"options"},{"type":"Identifier","start":4147,"end":4155,"name":"callback"}]}}]}}}]}}],"sourceType":"script"}