{"type":"Program","start":0,"end":4767,"loc":{"start":{"line":1,"column":0},"end":{"line":177,"column":0}},"body":[{"type":"VariableDeclaration","start":0,"end":34,"loc":{"start":{"line":1,"column":0},"end":{"line":1,"column":34}},"declarations":[{"type":"VariableDeclarator","start":6,"end":34,"loc":{"start":{"line":1,"column":6},"end":{"line":1,"column":34}},"id":{"type":"Identifier","start":6,"end":13,"loc":{"start":{"line":1,"column":6},"end":{"line":1,"column":13}},"name":"request"},"init":{"type":"CallExpression","start":16,"end":34,"loc":{"start":{"line":1,"column":16},"end":{"line":1,"column":34}},"callee":{"type":"Identifier","start":16,"end":23,"loc":{"start":{"line":1,"column":16},"end":{"line":1,"column":23}},"name":"require"},"arguments":[{"type":"Literal","start":24,"end":33,"loc":{"start":{"line":1,"column":24},"end":{"line":1,"column":33}},"value":"request","raw":"'request'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":35,"end":65,"loc":{"start":{"line":2,"column":0},"end":{"line":2,"column":30}},"declarations":[{"type":"VariableDeclarator","start":41,"end":65,"loc":{"start":{"line":2,"column":6},"end":{"line":2,"column":30}},"id":{"type":"ObjectPattern","start":41,"end":48,"loc":{"start":{"line":2,"column":6},"end":{"line":2,"column":13}},"properties":[{"type":"Property","start":43,"end":46,"loc":{"start":{"line":2,"column":8},"end":{"line":2,"column":11}},"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":43,"end":46,"loc":{"start":{"line":2,"column":8},"end":{"line":2,"column":11}},"name":"URL"},"kind":"init","value":{"type":"Identifier","start":43,"end":46,"loc":{"start":{"line":2,"column":8},"end":{"line":2,"column":11}},"name":"URL"}}]},"init":{"type":"CallExpression","start":51,"end":65,"loc":{"start":{"line":2,"column":16},"end":{"line":2,"column":30}},"callee":{"type":"Identifier","start":51,"end":58,"loc":{"start":{"line":2,"column":16},"end":{"line":2,"column":23}},"name":"require"},"arguments":[{"type":"Literal","start":59,"end":64,"loc":{"start":{"line":2,"column":24},"end":{"line":2,"column":29}},"value":"url","raw":"'url'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":66,"end":98,"loc":{"start":{"line":3,"column":0},"end":{"line":3,"column":32}},"declarations":[{"type":"VariableDeclarator","start":72,"end":98,"loc":{"start":{"line":3,"column":6},"end":{"line":3,"column":32}},"id":{"type":"Identifier","start":72,"end":78,"loc":{"start":{"line":3,"column":6},"end":{"line":3,"column":12}},"name":"crypto"},"init":{"type":"CallExpression","start":81,"end":98,"loc":{"start":{"line":3,"column":15},"end":{"line":3,"column":32}},"callee":{"type":"Identifier","start":81,"end":88,"loc":{"start":{"line":3,"column":15},"end":{"line":3,"column":22}},"name":"require"},"arguments":[{"type":"Literal","start":89,"end":97,"loc":{"start":{"line":3,"column":23},"end":{"line":3,"column":31}},"value":"crypto","raw":"'crypto'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":99,"end":175,"loc":{"start":{"line":4,"column":0},"end":{"line":4,"column":76}},"declarations":[{"type":"VariableDeclarator","start":105,"end":175,"loc":{"start":{"line":4,"column":6},"end":{"line":4,"column":76}},"id":{"type":"ObjectPattern","start":105,"end":152,"loc":{"start":{"line":4,"column":6},"end":{"line":4,"column":53}},"properties":[{"type":"Property","start":107,"end":128,"loc":{"start":{"line":4,"column":8},"end":{"line":4,"column":29}},"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":107,"end":128,"loc":{"start":{"line":4,"column":8},"end":{"line":4,"column":29}},"name":"getProtectedHttpAgent"},"kind":"init","value":{"type":"Identifier","start":107,"end":128,"loc":{"start":{"line":4,"column":8},"end":{"line":4,"column":29}},"name":"getProtectedHttpAgent"}},{"type":"Property","start":130,"end":150,"loc":{"start":{"line":4,"column":31},"end":{"line":4,"column":51}},"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":130,"end":150,"loc":{"start":{"line":4,"column":31},"end":{"line":4,"column":51}},"name":"getRedirectEvaluator"},"kind":"init","value":{"type":"Identifier","start":130,"end":150,"loc":{"start":{"line":4,"column":31},"end":{"line":4,"column":51}},"name":"getRedirectEvaluator"}}]},"init":{"type":"CallExpression","start":155,"end":175,"loc":{"start":{"line":4,"column":56},"end":{"line":4,"column":76}},"callee":{"type":"Identifier","start":155,"end":162,"loc":{"start":{"line":4,"column":56},"end":{"line":4,"column":63}},"name":"require"},"arguments":[{"type":"Literal","start":163,"end":174,"loc":{"start":{"line":4,"column":64},"end":{"line":4,"column":75}},"value":"./request","raw":"'./request'"}]}}],"kind":"const"},{"type":"ExpressionStatement","start":265,"end":399,"loc":{"start":{"line":12,"column":0},"end":{"line":16,"column":1}},"expression":{"type":"AssignmentExpression","start":265,"end":399,"loc":{"start":{"line":12,"column":0},"end":{"line":16,"column":1}},"operator":"=","left":{"type":"MemberExpression","start":265,"end":281,"loc":{"start":{"line":12,"column":0},"end":{"line":12,"column":16}},"object":{"type":"Identifier","start":265,"end":272,"loc":{"start":{"line":12,"column":0},"end":{"line":12,"column":7}},"name":"exports"},"property":{"type":"Identifier","start":273,"end":281,"loc":{"start":{"line":12,"column":8},"end":{"line":12,"column":16}},"name":"hasMatch"},"computed":false},"right":{"type":"ArrowFunctionExpression","start":284,"end":399,"loc":{"start":{"line":12,"column":19},"end":{"line":16,"column":1}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":285,"end":290,"loc":{"start":{"line":12,"column":20},"end":{"line":12,"column":25}},"name":"value"},{"type":"Identifier","start":292,"end":300,"loc":{"start":{"line":12,"column":27},"end":{"line":12,"column":35}},"name":"criteria"}],"body":{"type":"BlockStatement","start":305,"end":399,"loc":{"start":{"line":12,"column":40},"end":{"line":16,"column":1}},"body":[{"type":"ReturnStatement","start":309,"end":397,"loc":{"start":{"line":13,"column":2},"end":{"line":15,"column":4}},"argument":{"type":"CallExpression","start":316,"end":397,"loc":{"start":{"line":13,"column":9},"end":{"line":15,"column":4}},"callee":{"type":"MemberExpression","start":316,"end":329,"loc":{"start":{"line":13,"column":9},"end":{"line":13,"column":22}},"object":{"type":"Identifier","start":316,"end":324,"loc":{"start":{"line":13,"column":9},"end":{"line":13,"column":17}},"name":"criteria"},"property":{"type":"Identifier","start":325,"end":329,"loc":{"start":{"line":13,"column":18},"end":{"line":13,"column":22}},"name":"some"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":330,"end":396,"loc":{"start":{"line":13,"column":23},"end":{"line":15,"column":3}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":331,"end":332,"loc":{"start":{"line":13,"column":24},"end":{"line":13,"column":25}},"name":"i"}],"body":{"type":"BlockStatement","start":337,"end":396,"loc":{"start":{"line":13,"column":30},"end":{"line":15,"column":3}},"body":[{"type":"ReturnStatement","start":343,"end":392,"loc":{"start":{"line":14,"column":4},"end":{"line":14,"column":53}},"argument":{"type":"LogicalExpression","start":350,"end":392,"loc":{"start":{"line":14,"column":11},"end":{"line":14,"column":53}},"left":{"type":"BinaryExpression","start":350,"end":361,"loc":{"start":{"line":14,"column":11},"end":{"line":14,"column":22}},"left":{"type":"Identifier","start":350,"end":355,"loc":{"start":{"line":14,"column":11},"end":{"line":14,"column":16}},"name":"value"},"operator":"===","right":{"type":"Identifier","start":360,"end":361,"loc":{"start":{"line":14,"column":21},"end":{"line":14,"column":22}},"name":"i"}},"operator":"||","right":{"type":"CallExpression","start":365,"end":392,"loc":{"start":{"line":14,"column":26},"end":{"line":14,"column":53}},"callee":{"type":"MemberExpression","start":365,"end":385,"loc":{"start":{"line":14,"column":26},"end":{"line":14,"column":46}},"object":{"type":"NewExpression","start":366,"end":379,"loc":{"start":{"line":14,"column":27},"end":{"line":14,"column":40}},"callee":{"type":"Identifier","start":370,"end":376,"loc":{"start":{"line":14,"column":31},"end":{"line":14,"column":37}},"name":"RegExp"},"arguments":[{"type":"Identifier","start":377,"end":378,"loc":{"start":{"line":14,"column":38},"end":{"line":14,"column":39}},"name":"i"}]},"property":{"type":"Identifier","start":381,"end":385,"loc":{"start":{"line":14,"column":42},"end":{"line":14,"column":46}},"name":"test"},"computed":false},"arguments":[{"type":"Identifier","start":386,"end":391,"loc":{"start":{"line":14,"column":47},"end":{"line":14,"column":52}},"name":"value"}]}}}]}}]}}]}}},"comments":[{"type":"Block","value":"*\n *\n * @param {string} value\n * @param {string[]} criteria\n * @returns {boolean}\n ","start":177,"end":264,"loc":{"start":{"line":6,"column":0},"end":{"line":11,"column":3}}}]},{"type":"ExpressionStatement","start":457,"end":781,"loc":{"start":{"line":23,"column":0},"end":{"line":35,"column":1}},"expression":{"type":"AssignmentExpression","start":457,"end":781,"loc":{"start":{"line":23,"column":0},"end":{"line":35,"column":1}},"operator":"=","left":{"type":"MemberExpression","start":457,"end":478,"loc":{"start":{"line":23,"column":0},"end":{"line":23,"column":21}},"object":{"type":"Identifier","start":457,"end":464,"loc":{"start":{"line":23,"column":0},"end":{"line":23,"column":7}},"name":"exports"},"property":{"type":"Identifier","start":465,"end":478,"loc":{"start":{"line":23,"column":8},"end":{"line":23,"column":21}},"name":"jsonStringify"},"computed":false},"right":{"type":"ArrowFunctionExpression","start":481,"end":781,"loc":{"start":{"line":23,"column":24},"end":{"line":35,"column":1}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":482,"end":486,"loc":{"start":{"line":23,"column":25},"end":{"line":23,"column":29}},"name":"data"}],"body":{"type":"BlockStatement","start":491,"end":781,"loc":{"start":{"line":23,"column":34},"end":{"line":35,"column":1}},"body":[{"type":"VariableDeclaration","start":495,"end":511,"loc":{"start":{"line":24,"column":2},"end":{"line":24,"column":18}},"declarations":[{"type":"VariableDeclarator","start":501,"end":511,"loc":{"start":{"line":24,"column":8},"end":{"line":24,"column":18}},"id":{"type":"Identifier","start":501,"end":506,"loc":{"start":{"line":24,"column":8},"end":{"line":24,"column":13}},"name":"cache"},"init":{"type":"ArrayExpression","start":509,"end":511,"loc":{"start":{"line":24,"column":16},"end":{"line":24,"column":18}},"elements":[]}}],"kind":"const"},{"type":"ReturnStatement","start":514,"end":779,"loc":{"start":{"line":25,"column":2},"end":{"line":34,"column":4}},"argument":{"type":"CallExpression","start":521,"end":779,"loc":{"start":{"line":25,"column":9},"end":{"line":34,"column":4}},"callee":{"type":"MemberExpression","start":521,"end":535,"loc":{"start":{"line":25,"column":9},"end":{"line":25,"column":23}},"object":{"type":"Identifier","start":521,"end":525,"loc":{"start":{"line":25,"column":9},"end":{"line":25,"column":13}},"name":"JSON"},"property":{"type":"Identifier","start":526,"end":535,"loc":{"start":{"line":25,"column":14},"end":{"line":25,"column":23}},"name":"stringify"},"computed":false},"arguments":[{"type":"Identifier","start":536,"end":540,"loc":{"start":{"line":25,"column":24},"end":{"line":25,"column":28}},"name":"data"},{"type":"ArrowFunctionExpression","start":542,"end":778,"loc":{"start":{"line":25,"column":30},"end":{"line":34,"column":3}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":543,"end":546,"loc":{"start":{"line":25,"column":31},"end":{"line":25,"column":34}},"name":"key"},{"type":"Identifier","start":548,"end":553,"loc":{"start":{"line":25,"column":36},"end":{"line":25,"column":41}},"name":"value"}],"body":{"type":"BlockStatement","start":558,"end":778,"loc":{"start":{"line":25,"column":46},"end":{"line":34,"column":3}},"body":[{"type":"IfStatement","start":564,"end":757,"loc":{"start":{"line":26,"column":4},"end":{"line":32,"column":5}},"test":{"type":"LogicalExpression","start":568,"end":611,"loc":{"start":{"line":26,"column":8},"end":{"line":26,"column":51}},"left":{"type":"BinaryExpression","start":568,"end":593,"loc":{"start":{"line":26,"column":8},"end":{"line":26,"column":33}},"left":{"type":"UnaryExpression","start":568,"end":580,"loc":{"start":{"line":26,"column":8},"end":{"line":26,"column":20}},"operator":"typeof","prefix":true,"argument":{"type":"Identifier","start":575,"end":580,"loc":{"start":{"line":26,"column":15},"end":{"line":26,"column":20}},"name":"value"}},"operator":"===","right":{"type":"Literal","start":585,"end":593,"loc":{"start":{"line":26,"column":25},"end":{"line":26,"column":33}},"value":"object","raw":"'object'"}},"operator":"&&","right":{"type":"BinaryExpression","start":597,"end":611,"loc":{"start":{"line":26,"column":37},"end":{"line":26,"column":51}},"left":{"type":"Identifier","start":597,"end":602,"loc":{"start":{"line":26,"column":37},"end":{"line":26,"column":42}},"name":"value"},"operator":"!==","right":{"type":"Literal","start":607,"end":611,"loc":{"start":{"line":26,"column":47},"end":{"line":26,"column":51}},"value":null,"raw":"null"}}},"consequent":{"type":"BlockStatement","start":613,"end":757,"loc":{"start":{"line":26,"column":53},"end":{"line":32,"column":5}},"body":[{"type":"IfStatement","start":621,"end":727,"loc":{"start":{"line":27,"column":6},"end":{"line":30,"column":7}},"test":{"type":"BinaryExpression","start":625,"end":652,"loc":{"start":{"line":27,"column":10},"end":{"line":27,"column":37}},"left":{"type":"CallExpression","start":625,"end":645,"loc":{"start":{"line":27,"column":10},"end":{"line":27,"column":30}},"callee":{"type":"MemberExpression","start":625,"end":638,"loc":{"start":{"line":27,"column":10},"end":{"line":27,"column":23}},"object":{"type":"Identifier","start":625,"end":630,"loc":{"start":{"line":27,"column":10},"end":{"line":27,"column":15}},"name":"cache"},"property":{"type":"Identifier","start":631,"end":638,"loc":{"start":{"line":27,"column":16},"end":{"line":27,"column":23}},"name":"indexOf"},"computed":false},"arguments":[{"type":"Identifier","start":639,"end":644,"loc":{"start":{"line":27,"column":24},"end":{"line":27,"column":29}},"name":"value"}]},"operator":"!==","right":{"type":"UnaryExpression","start":650,"end":652,"loc":{"start":{"line":27,"column":35},"end":{"line":27,"column":37}},"operator":"-","prefix":true,"argument":{"type":"Literal","start":651,"end":652,"loc":{"start":{"line":27,"column":36},"end":{"line":27,"column":37}},"value":1,"raw":"1"}}},"consequent":{"type":"BlockStatement","start":654,"end":727,"loc":{"start":{"line":27,"column":39},"end":{"line":30,"column":7}},"body":[{"type":"ReturnStatement","start":713,"end":719,"loc":{"start":{"line":29,"column":8},"end":{"line":29,"column":14}},"argument":null,"comments":[{"type":"Line","value":" Circular reference found, discard key","start":664,"end":704,"loc":{"start":{"line":28,"column":8},"end":{"line":28,"column":48}}}]}]},"alternate":null},{"type":"ExpressionStatement","start":734,"end":751,"loc":{"start":{"line":31,"column":6},"end":{"line":31,"column":23}},"expression":{"type":"CallExpression","start":734,"end":751,"loc":{"start":{"line":31,"column":6},"end":{"line":31,"column":23}},"callee":{"type":"MemberExpression","start":734,"end":744,"loc":{"start":{"line":31,"column":6},"end":{"line":31,"column":16}},"object":{"type":"Identifier","start":734,"end":739,"loc":{"start":{"line":31,"column":6},"end":{"line":31,"column":11}},"name":"cache"},"property":{"type":"Identifier","start":740,"end":744,"loc":{"start":{"line":31,"column":12},"end":{"line":31,"column":16}},"name":"push"},"computed":false},"arguments":[{"type":"Identifier","start":745,"end":750,"loc":{"start":{"line":31,"column":17},"end":{"line":31,"column":22}},"name":"value"}]}}]},"alternate":null},{"type":"ReturnStatement","start":762,"end":774,"loc":{"start":{"line":33,"column":4},"end":{"line":33,"column":16}},"argument":{"type":"Identifier","start":769,"end":774,"loc":{"start":{"line":33,"column":11},"end":{"line":33,"column":16}},"name":"value"}}]}}]}}]}}},"comments":[{"type":"Block","value":"*\n *\n * @param {object} data\n * @returns {string}\n ","start":401,"end":456,"loc":{"start":{"line":18,"column":0},"end":{"line":22,"column":3}}}]},{"type":"ExpressionStatement","start":873,"end":968,"loc":{"start":{"line":42,"column":0},"end":{"line":44,"column":1}},"expression":{"type":"AssignmentExpression","start":873,"end":968,"loc":{"start":{"line":42,"column":0},"end":{"line":44,"column":1}},"operator":"=","left":{"type":"MemberExpression","start":873,"end":893,"loc":{"start":{"line":42,"column":0},"end":{"line":42,"column":20}},"object":{"type":"Identifier","start":873,"end":880,"loc":{"start":{"line":42,"column":0},"end":{"line":42,"column":7}},"name":"exports"},"property":{"type":"Identifier","start":881,"end":893,"loc":{"start":{"line":42,"column":8},"end":{"line":42,"column":20}},"name":"sanitizeHtml"},"computed":false},"right":{"type":"ArrowFunctionExpression","start":896,"end":968,"loc":{"start":{"line":42,"column":23},"end":{"line":44,"column":1}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":897,"end":901,"loc":{"start":{"line":42,"column":24},"end":{"line":42,"column":28}},"name":"text"}],"body":{"type":"BlockStatement","start":906,"end":968,"loc":{"start":{"line":42,"column":33},"end":{"line":44,"column":1}},"body":[{"type":"ReturnStatement","start":910,"end":966,"loc":{"start":{"line":43,"column":2},"end":{"line":43,"column":58}},"argument":{"type":"ConditionalExpression","start":917,"end":966,"loc":{"start":{"line":43,"column":9},"end":{"line":43,"column":58}},"test":{"type":"Identifier","start":917,"end":921,"loc":{"start":{"line":43,"column":9},"end":{"line":43,"column":13}},"name":"text"},"consequent":{"type":"CallExpression","start":924,"end":959,"loc":{"start":{"line":43,"column":16},"end":{"line":43,"column":51}},"callee":{"type":"MemberExpression","start":924,"end":936,"loc":{"start":{"line":43,"column":16},"end":{"line":43,"column":28}},"object":{"type":"Identifier","start":924,"end":928,"loc":{"start":{"line":43,"column":16},"end":{"line":43,"column":20}},"name":"text"},"property":{"type":"Identifier","start":929,"end":936,"loc":{"start":{"line":43,"column":21},"end":{"line":43,"column":28}},"name":"replace"},"computed":false},"arguments":[{"type":"Literal","start":937,"end":954,"loc":{"start":{"line":43,"column":29},"end":{"line":43,"column":46}},"value":{},"raw":"/<\\/?[^>]+(>|$)/g","regex":{"pattern":"<\\/?[^>]+(>|$)","flags":"g"}},{"type":"Literal","start":956,"end":958,"loc":{"start":{"line":43,"column":48},"end":{"line":43,"column":50}},"value":"","raw":"''"}]},"alternate":{"type":"Identifier","start":962,"end":966,"loc":{"start":{"line":43,"column":54},"end":{"line":43,"column":58}},"name":"text"}}}]}}},"comments":[{"type":"Block","value":"*\n * Does a simple html sanitization on the passed value\n *\n * @param {string} text\n ","start":783,"end":872,"loc":{"start":{"line":37,"column":0},"end":{"line":41,"column":3}}}]},{"type":"ExpressionStatement","start":1113,"end":1926,"loc":{"start":{"line":53,"column":0},"end":{"line":76,"column":1}},"expression":{"type":"AssignmentExpression","start":1113,"end":1926,"loc":{"start":{"line":53,"column":0},"end":{"line":76,"column":1}},"operator":"=","left":{"type":"MemberExpression","start":1113,"end":1131,"loc":{"start":{"line":53,"column":0},"end":{"line":53,"column":18}},"object":{"type":"Identifier","start":1113,"end":1120,"loc":{"start":{"line":53,"column":0},"end":{"line":53,"column":7}},"name":"exports"},"property":{"type":"Identifier","start":1121,"end":1131,"loc":{"start":{"line":53,"column":8},"end":{"line":53,"column":18}},"name":"getURLMeta"},"computed":false},"right":{"type":"ArrowFunctionExpression","start":1134,"end":1926,"loc":{"start":{"line":53,"column":21},"end":{"line":76,"column":1}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":1135,"end":1138,"loc":{"start":{"line":53,"column":22},"end":{"line":53,"column":25}},"name":"url"},{"type":"AssignmentPattern","start":1140,"end":1161,"loc":{"start":{"line":53,"column":27},"end":{"line":53,"column":48}},"left":{"type":"Identifier","start":1140,"end":1153,"loc":{"start":{"line":53,"column":27},"end":{"line":53,"column":40}},"name":"blockLocalIPs"},"right":{"type":"Literal","start":1156,"end":1161,"loc":{"start":{"line":53,"column":43},"end":{"line":53,"column":48}},"value":false,"raw":"false"}}],"body":{"type":"BlockStatement","start":1166,"end":1926,"loc":{"start":{"line":53,"column":53},"end":{"line":76,"column":1}},"body":[{"type":"ReturnStatement","start":1170,"end":1924,"loc":{"start":{"line":54,"column":2},"end":{"line":75,"column":4}},"argument":{"type":"NewExpression","start":1177,"end":1924,"loc":{"start":{"line":54,"column":9},"end":{"line":75,"column":4}},"callee":{"type":"Identifier","start":1181,"end":1188,"loc":{"start":{"line":54,"column":13},"end":{"line":54,"column":20}},"name":"Promise"},"arguments":[{"type":"ArrowFunctionExpression","start":1189,"end":1923,"loc":{"start":{"line":54,"column":21},"end":{"line":75,"column":3}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":1190,"end":1197,"loc":{"start":{"line":54,"column":22},"end":{"line":54,"column":29}},"name":"resolve"},{"type":"Identifier","start":1199,"end":1205,"loc":{"start":{"line":54,"column":31},"end":{"line":54,"column":37}},"name":"reject"}],"body":{"type":"BlockStatement","start":1210,"end":1923,"loc":{"start":{"line":54,"column":42},"end":{"line":75,"column":3}},"body":[{"type":"VariableDeclaration","start":1216,"end":1418,"loc":{"start":{"line":55,"column":4},"end":{"line":60,"column":5}},"declarations":[{"type":"VariableDeclarator","start":1222,"end":1418,"loc":{"start":{"line":55,"column":10},"end":{"line":60,"column":5}},"id":{"type":"Identifier","start":1222,"end":1226,"loc":{"start":{"line":55,"column":10},"end":{"line":55,"column":14}},"name":"opts"},"init":{"type":"ObjectExpression","start":1229,"end":1418,"loc":{"start":{"line":55,"column":17},"end":{"line":60,"column":5}},"properties":[{"type":"Property","start":1237,"end":1245,"loc":{"start":{"line":56,"column":6},"end":{"line":56,"column":14}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1237,"end":1240,"loc":{"start":{"line":56,"column":6},"end":{"line":56,"column":9}},"name":"uri"},"value":{"type":"Identifier","start":1242,"end":1245,"loc":{"start":{"line":56,"column":11},"end":{"line":56,"column":14}},"name":"url"},"kind":"init"},{"type":"Property","start":1253,"end":1267,"loc":{"start":{"line":57,"column":6},"end":{"line":57,"column":20}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1253,"end":1259,"loc":{"start":{"line":57,"column":6},"end":{"line":57,"column":12}},"name":"method"},"value":{"type":"Literal","start":1261,"end":1267,"loc":{"start":{"line":57,"column":14},"end":{"line":57,"column":20}},"value":"HEAD","raw":"'HEAD'"},"kind":"init"},{"type":"Property","start":1275,"end":1331,"loc":{"start":{"line":58,"column":6},"end":{"line":58,"column":62}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1275,"end":1289,"loc":{"start":{"line":58,"column":6},"end":{"line":58,"column":20}},"name":"followRedirect"},"value":{"type":"CallExpression","start":1291,"end":1331,"loc":{"start":{"line":58,"column":22},"end":{"line":58,"column":62}},"callee":{"type":"Identifier","start":1291,"end":1311,"loc":{"start":{"line":58,"column":22},"end":{"line":58,"column":42}},"name":"getRedirectEvaluator"},"arguments":[{"type":"Identifier","start":1312,"end":1315,"loc":{"start":{"line":58,"column":43},"end":{"line":58,"column":46}},"name":"url"},{"type":"Identifier","start":1317,"end":1330,"loc":{"start":{"line":58,"column":48},"end":{"line":58,"column":61}},"name":"blockLocalIPs"}]},"kind":"init"},{"type":"Property","start":1339,"end":1412,"loc":{"start":{"line":59,"column":6},"end":{"line":59,"column":79}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1339,"end":1349,"loc":{"start":{"line":59,"column":6},"end":{"line":59,"column":16}},"name":"agentClass"},"value":{"type":"CallExpression","start":1351,"end":1412,"loc":{"start":{"line":59,"column":18},"end":{"line":59,"column":79}},"callee":{"type":"Identifier","start":1351,"end":1372,"loc":{"start":{"line":59,"column":18},"end":{"line":59,"column":39}},"name":"getProtectedHttpAgent"},"arguments":[{"type":"MemberExpression","start":1373,"end":1396,"loc":{"start":{"line":59,"column":40},"end":{"line":59,"column":63}},"object":{"type":"NewExpression","start":1374,"end":1386,"loc":{"start":{"line":59,"column":41},"end":{"line":59,"column":53}},"callee":{"type":"Identifier","start":1378,"end":1381,"loc":{"start":{"line":59,"column":45},"end":{"line":59,"column":48}},"name":"URL"},"arguments":[{"type":"Identifier","start":1382,"end":1385,"loc":{"start":{"line":59,"column":49},"end":{"line":59,"column":52}},"name":"url"}]},"property":{"type":"Identifier","start":1388,"end":1396,"loc":{"start":{"line":59,"column":55},"end":{"line":59,"column":63}},"name":"protocol"},"computed":false},{"type":"Identifier","start":1398,"end":1411,"loc":{"start":{"line":59,"column":65},"end":{"line":59,"column":78}},"name":"blockLocalIPs"}]},"kind":"init"}]}}],"kind":"const"},{"type":"ExpressionStatement","start":1424,"end":1919,"loc":{"start":{"line":62,"column":4},"end":{"line":74,"column":6}},"expression":{"type":"CallExpression","start":1424,"end":1919,"loc":{"start":{"line":62,"column":4},"end":{"line":74,"column":6}},"callee":{"type":"Identifier","start":1424,"end":1431,"loc":{"start":{"line":62,"column":4},"end":{"line":62,"column":11}},"name":"request"},"arguments":[{"type":"Identifier","start":1432,"end":1436,"loc":{"start":{"line":62,"column":12},"end":{"line":62,"column":16}},"name":"opts"},{"type":"ArrowFunctionExpression","start":1438,"end":1918,"loc":{"start":{"line":62,"column":18},"end":{"line":74,"column":5}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":1439,"end":1442,"loc":{"start":{"line":62,"column":19},"end":{"line":62,"column":22}},"name":"err"},{"type":"Identifier","start":1444,"end":1452,"loc":{"start":{"line":62,"column":24},"end":{"line":62,"column":32}},"name":"response"}],"body":{"type":"BlockStatement","start":1457,"end":1918,"loc":{"start":{"line":62,"column":37},"end":{"line":74,"column":5}},"body":[{"type":"IfStatement","start":1465,"end":1912,"loc":{"start":{"line":63,"column":6},"end":{"line":73,"column":7}},"test":{"type":"LogicalExpression","start":1469,"end":1502,"loc":{"start":{"line":63,"column":10},"end":{"line":63,"column":43}},"left":{"type":"Identifier","start":1469,"end":1472,"loc":{"start":{"line":63,"column":10},"end":{"line":63,"column":13}},"name":"err"},"operator":"||","right":{"type":"BinaryExpression","start":1476,"end":1502,"loc":{"start":{"line":63,"column":17},"end":{"line":63,"column":43}},"left":{"type":"MemberExpression","start":1476,"end":1495,"loc":{"start":{"line":63,"column":17},"end":{"line":63,"column":36}},"object":{"type":"Identifier","start":1476,"end":1484,"loc":{"start":{"line":63,"column":17},"end":{"line":63,"column":25}},"name":"response"},"property":{"type":"Identifier","start":1485,"end":1495,"loc":{"start":{"line":63,"column":26},"end":{"line":63,"column":36}},"name":"statusCode"},"computed":false},"operator":">=","right":{"type":"Literal","start":1499,"end":1502,"loc":{"start":{"line":63,"column":40},"end":{"line":63,"column":43}},"value":300,"raw":"300"}}},"consequent":{"type":"BlockStatement","start":1504,"end":1757,"loc":{"start":{"line":63,"column":45},"end":{"line":68,"column":7}},"body":[{"type":"ExpressionStatement","start":1647,"end":1729,"loc":{"start":{"line":66,"column":8},"end":{"line":66,"column":90}},"expression":{"type":"AssignmentExpression","start":1647,"end":1729,"loc":{"start":{"line":66,"column":8},"end":{"line":66,"column":90}},"operator":"=","left":{"type":"Identifier","start":1647,"end":1650,"loc":{"start":{"line":66,"column":8},"end":{"line":66,"column":11}},"name":"err"},"right":{"type":"LogicalExpression","start":1653,"end":1729,"loc":{"start":{"line":66,"column":14},"end":{"line":66,"column":90}},"left":{"type":"Identifier","start":1653,"end":1656,"loc":{"start":{"line":66,"column":14},"end":{"line":66,"column":17}},"name":"err"},"operator":"||","right":{"type":"NewExpression","start":1660,"end":1729,"loc":{"start":{"line":66,"column":21},"end":{"line":66,"column":90}},"callee":{"type":"Identifier","start":1664,"end":1669,"loc":{"start":{"line":66,"column":25},"end":{"line":66,"column":30}},"name":"Error"},"arguments":[{"type":"TemplateLiteral","start":1670,"end":1728,"loc":{"start":{"line":66,"column":31},"end":{"line":66,"column":89}},"expressions":[{"type":"MemberExpression","start":1707,"end":1726,"loc":{"start":{"line":66,"column":68},"end":{"line":66,"column":87}},"object":{"type":"Identifier","start":1707,"end":1715,"loc":{"start":{"line":66,"column":68},"end":{"line":66,"column":76}},"name":"response"},"property":{"type":"Identifier","start":1716,"end":1726,"loc":{"start":{"line":66,"column":77},"end":{"line":66,"column":87}},"name":"statusCode"},"computed":false}],"quasis":[{"type":"TemplateElement","start":1671,"end":1705,"loc":{"start":{"line":66,"column":32},"end":{"line":66,"column":66}},"value":{"raw":"URL server responded with status: ","cooked":"URL server responded with status: "},"tail":false},{"type":"TemplateElement","start":1727,"end":1727,"loc":{"start":{"line":66,"column":88},"end":{"line":66,"column":88}},"value":{"raw":"","cooked":""},"tail":true}]}]}}},"comments":[{"type":"Line","value":" @todo possibly set a status code in the error object to get a more helpful","start":1514,"end":1591,"loc":{"start":{"line":64,"column":8},"end":{"line":64,"column":85}}},{"type":"Line","value":" hint at what the cause of error is.","start":1600,"end":1638,"loc":{"start":{"line":65,"column":8},"end":{"line":65,"column":46}}}]},{"type":"ExpressionStatement","start":1738,"end":1749,"loc":{"start":{"line":67,"column":8},"end":{"line":67,"column":19}},"expression":{"type":"CallExpression","start":1738,"end":1749,"loc":{"start":{"line":67,"column":8},"end":{"line":67,"column":19}},"callee":{"type":"Identifier","start":1738,"end":1744,"loc":{"start":{"line":67,"column":8},"end":{"line":67,"column":14}},"name":"reject"},"arguments":[{"type":"Identifier","start":1745,"end":1748,"loc":{"start":{"line":67,"column":15},"end":{"line":67,"column":18}},"name":"err"}]}}]},"alternate":{"type":"BlockStatement","start":1763,"end":1912,"loc":{"start":{"line":68,"column":13},"end":{"line":73,"column":7}},"body":[{"type":"ExpressionStatement","start":1773,"end":1904,"loc":{"start":{"line":69,"column":8},"end":{"line":72,"column":10}},"expression":{"type":"CallExpression","start":1773,"end":1904,"loc":{"start":{"line":69,"column":8},"end":{"line":72,"column":10}},"callee":{"type":"Identifier","start":1773,"end":1780,"loc":{"start":{"line":69,"column":8},"end":{"line":69,"column":15}},"name":"resolve"},"arguments":[{"type":"ObjectExpression","start":1781,"end":1903,"loc":{"start":{"line":69,"column":16},"end":{"line":72,"column":9}},"properties":[{"type":"Property","start":1793,"end":1831,"loc":{"start":{"line":70,"column":10},"end":{"line":70,"column":48}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1793,"end":1797,"loc":{"start":{"line":70,"column":10},"end":{"line":70,"column":14}},"name":"type"},"value":{"type":"MemberExpression","start":1799,"end":1831,"loc":{"start":{"line":70,"column":16},"end":{"line":70,"column":48}},"object":{"type":"MemberExpression","start":1799,"end":1815,"loc":{"start":{"line":70,"column":16},"end":{"line":70,"column":32}},"object":{"type":"Identifier","start":1799,"end":1807,"loc":{"start":{"line":70,"column":16},"end":{"line":70,"column":24}},"name":"response"},"property":{"type":"Identifier","start":1808,"end":1815,"loc":{"start":{"line":70,"column":25},"end":{"line":70,"column":32}},"name":"headers"},"computed":false},"property":{"type":"Literal","start":1816,"end":1830,"loc":{"start":{"line":70,"column":33},"end":{"line":70,"column":47}},"value":"content-type","raw":"'content-type'"},"computed":true},"kind":"init"},{"type":"Property","start":1843,"end":1893,"loc":{"start":{"line":71,"column":10},"end":{"line":71,"column":60}},"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1843,"end":1847,"loc":{"start":{"line":71,"column":10},"end":{"line":71,"column":14}},"name":"size"},"value":{"type":"CallExpression","start":1849,"end":1893,"loc":{"start":{"line":71,"column":16},"end":{"line":71,"column":60}},"callee":{"type":"Identifier","start":1849,"end":1857,"loc":{"start":{"line":71,"column":16},"end":{"line":71,"column":24}},"name":"parseInt"},"arguments":[{"type":"MemberExpression","start":1858,"end":1892,"loc":{"start":{"line":71,"column":25},"end":{"line":71,"column":59}},"object":{"type":"MemberExpression","start":1858,"end":1874,"loc":{"start":{"line":71,"column":25},"end":{"line":71,"column":41}},"object":{"type":"Identifier","start":1858,"end":1866,"loc":{"start":{"line":71,"column":25},"end":{"line":71,"column":33}},"name":"response"},"property":{"type":"Identifier","start":1867,"end":1874,"loc":{"start":{"line":71,"column":34},"end":{"line":71,"column":41}},"name":"headers"},"computed":false},"property":{"type":"Literal","start":1875,"end":1891,"loc":{"start":{"line":71,"column":42},"end":{"line":71,"column":58}},"value":"content-length","raw":"'content-length'"},"computed":true}]},"kind":"init"}]}]}}]}}]}}]}}]}}]}}]}}},"comments":[{"type":"Block","value":"*\n * Gets the size and content type of a url's content\n *\n * @param {string} url\n * @param {boolean=} blockLocalIPs\n * @return {Promise}\n ","start":970,"end":1112,"loc":{"start":{"line":46,"column":0},"end":{"line":52,"column":3}}}]},{"type":"ExpressionStatement","start":2054,"end":2754,"loc":{"start":{"line":84,"column":0},"end":{"line":109,"column":1}},"expression":{"type":"AssignmentExpression","start":2054,"end":2754,"loc":{"start":{"line":84,"column":0},"end":{"line":109,"column":1}},"operator":"=","left":{"type":"MemberExpression","start":2054,"end":2082,"loc":{"start":{"line":84,"column":0},"end":{"line":84,"column":28}},"object":{"type":"MemberExpression","start":2054,"end":2068,"loc":{"start":{"line":84,"column":0},"end":{"line":84,"column":14}},"object":{"type":"Identifier","start":2054,"end":2060,"loc":{"start":{"line":84,"column":0},"end":{"line":84,"column":6}},"name":"module"},"property":{"type":"Identifier","start":2061,"end":2068,"loc":{"start":{"line":84,"column":7},"end":{"line":84,"column":14}},"name":"exports"},"computed":false},"property":{"type":"Identifier","start":2069,"end":2082,"loc":{"start":{"line":84,"column":15},"end":{"line":84,"column":28}},"name":"getURLBuilder"},"computed":false},"right":{"type":"ArrowFunctionExpression","start":2085,"end":2754,"loc":{"start":{"line":84,"column":31},"end":{"line":109,"column":1}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":2086,"end":2093,"loc":{"start":{"line":84,"column":32},"end":{"line":84,"column":39}},"name":"options"}],"body":{"type":"BlockStatement","start":2098,"end":2754,"loc":{"start":{"line":84,"column":44},"end":{"line":109,"column":1}},"body":[{"type":"VariableDeclaration","start":2363,"end":2733,"loc":{"start":{"line":92,"column":2},"end":{"line":106,"column":3}},"declarations":[{"type":"VariableDeclarator","start":2369,"end":2733,"loc":{"start":{"line":92,"column":8},"end":{"line":106,"column":3}},"id":{"type":"Identifier","start":2369,"end":2377,"loc":{"start":{"line":92,"column":8},"end":{"line":92,"column":16}},"name":"buildURL"},"init":{"type":"ArrowFunctionExpression","start":2380,"end":2733,"loc":{"start":{"line":92,"column":19},"end":{"line":106,"column":3}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":2381,"end":2385,"loc":{"start":{"line":92,"column":20},"end":{"line":92,"column":24}},"name":"path"},{"type":"Identifier","start":2387,"end":2397,"loc":{"start":{"line":92,"column":26},"end":{"line":92,"column":36}},"name":"isExternal"},{"type":"Identifier","start":2399,"end":2410,"loc":{"start":{"line":92,"column":38},"end":{"line":92,"column":49}},"name":"excludeHost"}],"body":{"type":"BlockStatement","start":2415,"end":2733,"loc":{"start":{"line":92,"column":54},"end":{"line":106,"column":3}},"body":[{"type":"VariableDeclaration","start":2421,"end":2435,"loc":{"start":{"line":93,"column":4},"end":{"line":93,"column":18}},"declarations":[{"type":"VariableDeclarator","start":2425,"end":2435,"loc":{"start":{"line":93,"column":8},"end":{"line":93,"column":18}},"id":{"type":"Identifier","start":2425,"end":2428,"loc":{"start":{"line":93,"column":8},"end":{"line":93,"column":11}},"name":"url"},"init":{"type":"Identifier","start":2431,"end":2435,"loc":{"start":{"line":93,"column":14},"end":{"line":93,"column":18}},"name":"path"}}],"kind":"let"},{"type":"IfStatement","start":2482,"end":2562,"loc":{"start":{"line":95,"column":4},"end":{"line":97,"column":5}},"test":{"type":"Identifier","start":2486,"end":2496,"loc":{"start":{"line":95,"column":8},"end":{"line":95,"column":18}},"name":"isExternal"},"consequent":{"type":"BlockStatement","start":2498,"end":2562,"loc":{"start":{"line":95,"column":20},"end":{"line":97,"column":5}},"body":[{"type":"ExpressionStatement","start":2506,"end":2556,"loc":{"start":{"line":96,"column":6},"end":{"line":96,"column":56}},"expression":{"type":"AssignmentExpression","start":2506,"end":2556,"loc":{"start":{"line":96,"column":6},"end":{"line":96,"column":56}},"operator":"=","left":{"type":"Identifier","start":2506,"end":2509,"loc":{"start":{"line":96,"column":6},"end":{"line":96,"column":9}},"name":"url"},"right":{"type":"TemplateLiteral","start":2512,"end":2556,"loc":{"start":{"line":96,"column":12},"end":{"line":96,"column":56}},"expressions":[{"type":"LogicalExpression","start":2515,"end":2548,"loc":{"start":{"line":96,"column":15},"end":{"line":96,"column":48}},"left":{"type":"MemberExpression","start":2515,"end":2542,"loc":{"start":{"line":96,"column":15},"end":{"line":96,"column":42}},"object":{"type":"MemberExpression","start":2515,"end":2529,"loc":{"start":{"line":96,"column":15},"end":{"line":96,"column":29}},"object":{"type":"Identifier","start":2515,"end":2522,"loc":{"start":{"line":96,"column":15},"end":{"line":96,"column":22}},"name":"options"},"property":{"type":"Identifier","start":2523,"end":2529,"loc":{"start":{"line":96,"column":23},"end":{"line":96,"column":29}},"name":"server"},"computed":false},"property":{"type":"Identifier","start":2530,"end":2542,"loc":{"start":{"line":96,"column":30},"end":{"line":96,"column":42}},"name":"implicitPath"},"computed":false},"operator":"||","right":{"type":"Literal","start":2546,"end":2548,"loc":{"start":{"line":96,"column":46},"end":{"line":96,"column":48}},"value":"","raw":"''"}},{"type":"Identifier","start":2551,"end":2554,"loc":{"start":{"line":96,"column":51},"end":{"line":96,"column":54}},"name":"url"}],"quasis":[{"type":"TemplateElement","start":2513,"end":2513,"loc":{"start":{"line":96,"column":13},"end":{"line":96,"column":13}},"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":2549,"end":2549,"loc":{"start":{"line":96,"column":49},"end":{"line":96,"column":49}},"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":2555,"end":2555,"loc":{"start":{"line":96,"column":55},"end":{"line":96,"column":55}},"value":{"raw":"","cooked":""},"tail":true}]}}}]},"alternate":null,"comments":[{"type":"Line","value":" supports for no path specified too","start":2440,"end":2477,"loc":{"start":{"line":94,"column":4},"end":{"line":94,"column":41}}}]},{"type":"ExpressionStatement","start":2568,"end":2610,"loc":{"start":{"line":99,"column":4},"end":{"line":99,"column":46}},"expression":{"type":"AssignmentExpression","start":2568,"end":2610,"loc":{"start":{"line":99,"column":4},"end":{"line":99,"column":46}},"operator":"=","left":{"type":"Identifier","start":2568,"end":2571,"loc":{"start":{"line":99,"column":4},"end":{"line":99,"column":7}},"name":"url"},"right":{"type":"TemplateLiteral","start":2574,"end":2610,"loc":{"start":{"line":99,"column":10},"end":{"line":99,"column":46}},"expressions":[{"type":"LogicalExpression","start":2577,"end":2602,"loc":{"start":{"line":99,"column":13},"end":{"line":99,"column":38}},"left":{"type":"MemberExpression","start":2577,"end":2596,"loc":{"start":{"line":99,"column":13},"end":{"line":99,"column":32}},"object":{"type":"MemberExpression","start":2577,"end":2591,"loc":{"start":{"line":99,"column":13},"end":{"line":99,"column":27}},"object":{"type":"Identifier","start":2577,"end":2584,"loc":{"start":{"line":99,"column":13},"end":{"line":99,"column":20}},"name":"options"},"property":{"type":"Identifier","start":2585,"end":2591,"loc":{"start":{"line":99,"column":21},"end":{"line":99,"column":27}},"name":"server"},"computed":false},"property":{"type":"Identifier","start":2592,"end":2596,"loc":{"start":{"line":99,"column":28},"end":{"line":99,"column":32}},"name":"path"},"computed":false},"operator":"||","right":{"type":"Literal","start":2600,"end":2602,"loc":{"start":{"line":99,"column":36},"end":{"line":99,"column":38}},"value":"","raw":"''"}},{"type":"Identifier","start":2605,"end":2608,"loc":{"start":{"line":99,"column":41},"end":{"line":99,"column":44}},"name":"url"}],"quasis":[{"type":"TemplateElement","start":2575,"end":2575,"loc":{"start":{"line":99,"column":11},"end":{"line":99,"column":11}},"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":2603,"end":2603,"loc":{"start":{"line":99,"column":39},"end":{"line":99,"column":39}},"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":2609,"end":2609,"loc":{"start":{"line":99,"column":45},"end":{"line":99,"column":45}},"value":{"raw":"","cooked":""},"tail":true}]}}},{"type":"IfStatement","start":2616,"end":2713,"loc":{"start":{"line":101,"column":4},"end":{"line":103,"column":5}},"test":{"type":"UnaryExpression","start":2620,"end":2632,"loc":{"start":{"line":101,"column":8},"end":{"line":101,"column":20}},"operator":"!","prefix":true,"argument":{"type":"Identifier","start":2621,"end":2632,"loc":{"start":{"line":101,"column":9},"end":{"line":101,"column":20}},"name":"excludeHost"}},"consequent":{"type":"BlockStatement","start":2634,"end":2713,"loc":{"start":{"line":101,"column":22},"end":{"line":103,"column":5}},"body":[{"type":"ExpressionStatement","start":2642,"end":2707,"loc":{"start":{"line":102,"column":6},"end":{"line":102,"column":71}},"expression":{"type":"AssignmentExpression","start":2642,"end":2707,"loc":{"start":{"line":102,"column":6},"end":{"line":102,"column":71}},"operator":"=","left":{"type":"Identifier","start":2642,"end":2645,"loc":{"start":{"line":102,"column":6},"end":{"line":102,"column":9}},"name":"url"},"right":{"type":"TemplateLiteral","start":2648,"end":2707,"loc":{"start":{"line":102,"column":12},"end":{"line":102,"column":71}},"expressions":[{"type":"MemberExpression","start":2651,"end":2674,"loc":{"start":{"line":102,"column":15},"end":{"line":102,"column":38}},"object":{"type":"MemberExpression","start":2651,"end":2665,"loc":{"start":{"line":102,"column":15},"end":{"line":102,"column":29}},"object":{"type":"Identifier","start":2651,"end":2658,"loc":{"start":{"line":102,"column":15},"end":{"line":102,"column":22}},"name":"options"},"property":{"type":"Identifier","start":2659,"end":2665,"loc":{"start":{"line":102,"column":23},"end":{"line":102,"column":29}},"name":"server"},"computed":false},"property":{"type":"Identifier","start":2666,"end":2674,"loc":{"start":{"line":102,"column":30},"end":{"line":102,"column":38}},"name":"protocol"},"computed":false},{"type":"MemberExpression","start":2680,"end":2699,"loc":{"start":{"line":102,"column":44},"end":{"line":102,"column":63}},"object":{"type":"MemberExpression","start":2680,"end":2694,"loc":{"start":{"line":102,"column":44},"end":{"line":102,"column":58}},"object":{"type":"Identifier","start":2680,"end":2687,"loc":{"start":{"line":102,"column":44},"end":{"line":102,"column":51}},"name":"options"},"property":{"type":"Identifier","start":2688,"end":2694,"loc":{"start":{"line":102,"column":52},"end":{"line":102,"column":58}},"name":"server"},"computed":false},"property":{"type":"Identifier","start":2695,"end":2699,"loc":{"start":{"line":102,"column":59},"end":{"line":102,"column":63}},"name":"host"},"computed":false},{"type":"Identifier","start":2702,"end":2705,"loc":{"start":{"line":102,"column":66},"end":{"line":102,"column":69}},"name":"url"}],"quasis":[{"type":"TemplateElement","start":2649,"end":2649,"loc":{"start":{"line":102,"column":13},"end":{"line":102,"column":13}},"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":2675,"end":2678,"loc":{"start":{"line":102,"column":39},"end":{"line":102,"column":42}},"value":{"raw":"://","cooked":"://"},"tail":false},{"type":"TemplateElement","start":2700,"end":2700,"loc":{"start":{"line":102,"column":64},"end":{"line":102,"column":64}},"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":2706,"end":2706,"loc":{"start":{"line":102,"column":70},"end":{"line":102,"column":70}},"value":{"raw":"","cooked":""},"tail":true}]}}}]},"alternate":null},{"type":"ReturnStatement","start":2719,"end":2729,"loc":{"start":{"line":105,"column":4},"end":{"line":105,"column":14}},"argument":{"type":"Identifier","start":2726,"end":2729,"loc":{"start":{"line":105,"column":11},"end":{"line":105,"column":14}},"name":"url"}}]}}}],"kind":"const"},{"type":"ReturnStatement","start":2737,"end":2752,"loc":{"start":{"line":108,"column":2},"end":{"line":108,"column":17}},"argument":{"type":"Identifier","start":2744,"end":2752,"loc":{"start":{"line":108,"column":9},"end":{"line":108,"column":17}},"name":"buildURL"}}],"comments":[{"type":"Block","value":"*\n   * Builds companion targeted url\n   *\n   * @param {string} path the tail path of the url\n   * @param {boolean} isExternal if the url is for the external world\n   * @param {boolean=} excludeHost if the server domain and protocol should be included\n   ","start":2102,"end":2360,"loc":{"start":{"line":85,"column":2},"end":{"line":91,"column":5}}}]}}},"comments":[{"type":"Line","value":" all paths are assumed to be '/' prepended","start":1928,"end":1972,"loc":{"start":{"line":78,"column":0},"end":{"line":78,"column":44}}},{"type":"Block","value":"*\n * Returns a url builder\n *\n * @param {object} options companion options\n ","start":1973,"end":2053,"loc":{"start":{"line":79,"column":0},"end":{"line":83,"column":3}}}]},{"type":"FunctionDeclaration","start":2927,"end":3049,"loc":{"start":{"line":117,"column":0},"end":{"line":121,"column":1}},"id":{"type":"Identifier","start":2936,"end":2948,"loc":{"start":{"line":117,"column":9},"end":{"line":117,"column":21}},"name":"createSecret"},"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":2950,"end":2956,"loc":{"start":{"line":117,"column":23},"end":{"line":117,"column":29}},"name":"secret"}],"body":{"type":"BlockStatement","start":2958,"end":3049,"loc":{"start":{"line":117,"column":31},"end":{"line":121,"column":1}},"body":[{"type":"VariableDeclaration","start":2962,"end":3002,"loc":{"start":{"line":118,"column":2},"end":{"line":118,"column":42}},"declarations":[{"type":"VariableDeclarator","start":2968,"end":3002,"loc":{"start":{"line":118,"column":8},"end":{"line":118,"column":42}},"id":{"type":"Identifier","start":2968,"end":2972,"loc":{"start":{"line":118,"column":8},"end":{"line":118,"column":12}},"name":"hash"},"init":{"type":"CallExpression","start":2975,"end":3002,"loc":{"start":{"line":118,"column":15},"end":{"line":118,"column":42}},"callee":{"type":"MemberExpression","start":2975,"end":2992,"loc":{"start":{"line":118,"column":15},"end":{"line":118,"column":32}},"object":{"type":"Identifier","start":2975,"end":2981,"loc":{"start":{"line":118,"column":15},"end":{"line":118,"column":21}},"name":"crypto"},"property":{"type":"Identifier","start":2982,"end":2992,"loc":{"start":{"line":118,"column":22},"end":{"line":118,"column":32}},"name":"createHash"},"computed":false},"arguments":[{"type":"Literal","start":2993,"end":3001,"loc":{"start":{"line":118,"column":33},"end":{"line":118,"column":41}},"value":"sha256","raw":"'sha256'"}]}}],"kind":"const"},{"type":"ExpressionStatement","start":3005,"end":3024,"loc":{"start":{"line":119,"column":2},"end":{"line":119,"column":21}},"expression":{"type":"CallExpression","start":3005,"end":3024,"loc":{"start":{"line":119,"column":2},"end":{"line":119,"column":21}},"callee":{"type":"MemberExpression","start":3005,"end":3016,"loc":{"start":{"line":119,"column":2},"end":{"line":119,"column":13}},"object":{"type":"Identifier","start":3005,"end":3009,"loc":{"start":{"line":119,"column":2},"end":{"line":119,"column":6}},"name":"hash"},"property":{"type":"Identifier","start":3010,"end":3016,"loc":{"start":{"line":119,"column":7},"end":{"line":119,"column":13}},"name":"update"},"computed":false},"arguments":[{"type":"Identifier","start":3017,"end":3023,"loc":{"start":{"line":119,"column":14},"end":{"line":119,"column":20}},"name":"secret"}]}},{"type":"ReturnStatement","start":3027,"end":3047,"loc":{"start":{"line":120,"column":2},"end":{"line":120,"column":22}},"argument":{"type":"CallExpression","start":3034,"end":3047,"loc":{"start":{"line":120,"column":9},"end":{"line":120,"column":22}},"callee":{"type":"MemberExpression","start":3034,"end":3045,"loc":{"start":{"line":120,"column":9},"end":{"line":120,"column":20}},"object":{"type":"Identifier","start":3034,"end":3038,"loc":{"start":{"line":120,"column":9},"end":{"line":120,"column":13}},"name":"hash"},"property":{"type":"Identifier","start":3039,"end":3045,"loc":{"start":{"line":120,"column":14},"end":{"line":120,"column":20}},"name":"digest"},"computed":false},"arguments":[]}}]},"comments":[{"type":"Block","value":"*\n * Ensure that a user-provided `secret` is 32 bytes long (the length required\n * for an AES256 key) by hashing it with SHA256.\n *\n * @param {string|Buffer} secret\n ","start":2756,"end":2926,"loc":{"start":{"line":111,"column":0},"end":{"line":116,"column":3}}}]},{"type":"FunctionDeclaration","start":3129,"end":3185,"loc":{"start":{"line":128,"column":0},"end":{"line":130,"column":1}},"id":{"type":"Identifier","start":3138,"end":3146,"loc":{"start":{"line":128,"column":9},"end":{"line":128,"column":17}},"name":"createIv"},"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":3150,"end":3185,"loc":{"start":{"line":128,"column":21},"end":{"line":130,"column":1}},"body":[{"type":"ReturnStatement","start":3154,"end":3183,"loc":{"start":{"line":129,"column":2},"end":{"line":129,"column":31}},"argument":{"type":"CallExpression","start":3161,"end":3183,"loc":{"start":{"line":129,"column":9},"end":{"line":129,"column":31}},"callee":{"type":"MemberExpression","start":3161,"end":3179,"loc":{"start":{"line":129,"column":9},"end":{"line":129,"column":27}},"object":{"type":"Identifier","start":3161,"end":3167,"loc":{"start":{"line":129,"column":9},"end":{"line":129,"column":15}},"name":"crypto"},"property":{"type":"Identifier","start":3168,"end":3179,"loc":{"start":{"line":129,"column":16},"end":{"line":129,"column":27}},"name":"randomBytes"},"computed":false},"arguments":[{"type":"Literal","start":3180,"end":3182,"loc":{"start":{"line":129,"column":28},"end":{"line":129,"column":30}},"value":16,"raw":"16"}]}}]},"comments":[{"type":"Block","value":"*\n * Create an initialization vector for AES256.\n *\n * @return {Buffer}\n ","start":3051,"end":3128,"loc":{"start":{"line":123,"column":0},"end":{"line":127,"column":3}}}]},{"type":"FunctionDeclaration","start":3187,"end":3299,"loc":{"start":{"line":132,"column":0},"end":{"line":134,"column":1}},"id":{"type":"Identifier","start":3196,"end":3205,"loc":{"start":{"line":132,"column":9},"end":{"line":132,"column":18}},"name":"urlEncode"},"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":3207,"end":3216,"loc":{"start":{"line":132,"column":20},"end":{"line":132,"column":29}},"name":"unencoded"}],"body":{"type":"BlockStatement","start":3218,"end":3299,"loc":{"start":{"line":132,"column":31},"end":{"line":134,"column":1}},"body":[{"type":"ReturnStatement","start":3222,"end":3297,"loc":{"start":{"line":133,"column":2},"end":{"line":133,"column":77}},"argument":{"type":"CallExpression","start":3229,"end":3297,"loc":{"start":{"line":133,"column":9},"end":{"line":133,"column":77}},"callee":{"type":"MemberExpression","start":3229,"end":3286,"loc":{"start":{"line":133,"column":9},"end":{"line":133,"column":66}},"object":{"type":"CallExpression","start":3229,"end":3278,"loc":{"start":{"line":133,"column":9},"end":{"line":133,"column":58}},"callee":{"type":"MemberExpression","start":3229,"end":3266,"loc":{"start":{"line":133,"column":9},"end":{"line":133,"column":46}},"object":{"type":"CallExpression","start":3229,"end":3258,"loc":{"start":{"line":133,"column":9},"end":{"line":133,"column":38}},"callee":{"type":"MemberExpression","start":3229,"end":3246,"loc":{"start":{"line":133,"column":9},"end":{"line":133,"column":26}},"object":{"type":"Identifier","start":3229,"end":3238,"loc":{"start":{"line":133,"column":9},"end":{"line":133,"column":18}},"name":"unencoded"},"property":{"type":"Identifier","start":3239,"end":3246,"loc":{"start":{"line":133,"column":19},"end":{"line":133,"column":26}},"name":"replace"},"computed":false},"arguments":[{"type":"Literal","start":3247,"end":3252,"loc":{"start":{"line":133,"column":27},"end":{"line":133,"column":32}},"value":{},"raw":"/\\+/g","regex":{"pattern":"\\+","flags":"g"}},{"type":"Literal","start":3254,"end":3257,"loc":{"start":{"line":133,"column":34},"end":{"line":133,"column":37}},"value":"-","raw":"'-'"}]},"property":{"type":"Identifier","start":3259,"end":3266,"loc":{"start":{"line":133,"column":39},"end":{"line":133,"column":46}},"name":"replace"},"computed":false},"arguments":[{"type":"Literal","start":3267,"end":3272,"loc":{"start":{"line":133,"column":47},"end":{"line":133,"column":52}},"value":{},"raw":"/\\//g","regex":{"pattern":"\\/","flags":"g"}},{"type":"Literal","start":3274,"end":3277,"loc":{"start":{"line":133,"column":54},"end":{"line":133,"column":57}},"value":"_","raw":"'_'"}]},"property":{"type":"Identifier","start":3279,"end":3286,"loc":{"start":{"line":133,"column":59},"end":{"line":133,"column":66}},"name":"replace"},"computed":false},"arguments":[{"type":"Literal","start":3287,"end":3291,"loc":{"start":{"line":133,"column":67},"end":{"line":133,"column":71}},"value":{},"raw":"/=/g","regex":{"pattern":"=","flags":"g"}},{"type":"Literal","start":3293,"end":3296,"loc":{"start":{"line":133,"column":73},"end":{"line":133,"column":76}},"value":"~","raw":"'~'"}]}}]}},{"type":"FunctionDeclaration","start":3301,"end":3427,"loc":{"start":{"line":136,"column":0},"end":{"line":139,"column":1}},"id":{"type":"Identifier","start":3310,"end":3319,"loc":{"start":{"line":136,"column":9},"end":{"line":136,"column":18}},"name":"urlDecode"},"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":3321,"end":3328,"loc":{"start":{"line":136,"column":20},"end":{"line":136,"column":27}},"name":"encoded"}],"body":{"type":"BlockStatement","start":3330,"end":3427,"loc":{"start":{"line":136,"column":29},"end":{"line":139,"column":1}},"body":[{"type":"ExpressionStatement","start":3334,"end":3408,"loc":{"start":{"line":137,"column":2},"end":{"line":137,"column":76}},"expression":{"type":"AssignmentExpression","start":3334,"end":3408,"loc":{"start":{"line":137,"column":2},"end":{"line":137,"column":76}},"operator":"=","left":{"type":"Identifier","start":3334,"end":3341,"loc":{"start":{"line":137,"column":2},"end":{"line":137,"column":9}},"name":"encoded"},"right":{"type":"CallExpression","start":3344,"end":3408,"loc":{"start":{"line":137,"column":12},"end":{"line":137,"column":76}},"callee":{"type":"MemberExpression","start":3344,"end":3397,"loc":{"start":{"line":137,"column":12},"end":{"line":137,"column":65}},"object":{"type":"CallExpression","start":3344,"end":3389,"loc":{"start":{"line":137,"column":12},"end":{"line":137,"column":57}},"callee":{"type":"MemberExpression","start":3344,"end":3378,"loc":{"start":{"line":137,"column":12},"end":{"line":137,"column":46}},"object":{"type":"CallExpression","start":3344,"end":3370,"loc":{"start":{"line":137,"column":12},"end":{"line":137,"column":38}},"callee":{"type":"MemberExpression","start":3344,"end":3359,"loc":{"start":{"line":137,"column":12},"end":{"line":137,"column":27}},"object":{"type":"Identifier","start":3344,"end":3351,"loc":{"start":{"line":137,"column":12},"end":{"line":137,"column":19}},"name":"encoded"},"property":{"type":"Identifier","start":3352,"end":3359,"loc":{"start":{"line":137,"column":20},"end":{"line":137,"column":27}},"name":"replace"},"computed":false},"arguments":[{"type":"Literal","start":3360,"end":3364,"loc":{"start":{"line":137,"column":28},"end":{"line":137,"column":32}},"value":{},"raw":"/-/g","regex":{"pattern":"-","flags":"g"}},{"type":"Literal","start":3366,"end":3369,"loc":{"start":{"line":137,"column":34},"end":{"line":137,"column":37}},"value":"+","raw":"'+'"}]},"property":{"type":"Identifier","start":3371,"end":3378,"loc":{"start":{"line":137,"column":39},"end":{"line":137,"column":46}},"name":"replace"},"computed":false},"arguments":[{"type":"Literal","start":3379,"end":3383,"loc":{"start":{"line":137,"column":47},"end":{"line":137,"column":51}},"value":{},"raw":"/_/g","regex":{"pattern":"_","flags":"g"}},{"type":"Literal","start":3385,"end":3388,"loc":{"start":{"line":137,"column":53},"end":{"line":137,"column":56}},"value":"/","raw":"'/'"}]},"property":{"type":"Identifier","start":3390,"end":3397,"loc":{"start":{"line":137,"column":58},"end":{"line":137,"column":65}},"name":"replace"},"computed":false},"arguments":[{"type":"Literal","start":3398,"end":3402,"loc":{"start":{"line":137,"column":66},"end":{"line":137,"column":70}},"value":{},"raw":"/~/g","regex":{"pattern":"~","flags":"g"}},{"type":"Literal","start":3404,"end":3407,"loc":{"start":{"line":137,"column":72},"end":{"line":137,"column":75}},"value":"=","raw":"'='"}]}}},{"type":"ReturnStatement","start":3411,"end":3425,"loc":{"start":{"line":138,"column":2},"end":{"line":138,"column":16}},"argument":{"type":"Identifier","start":3418,"end":3425,"loc":{"start":{"line":138,"column":9},"end":{"line":138,"column":16}},"name":"encoded"}}]}},{"type":"ExpressionStatement","start":3656,"end":4002,"loc":{"start":{"line":148,"column":0},"end":{"line":155,"column":1}},"expression":{"type":"AssignmentExpression","start":3656,"end":4002,"loc":{"start":{"line":148,"column":0},"end":{"line":155,"column":1}},"operator":"=","left":{"type":"MemberExpression","start":3656,"end":3678,"loc":{"start":{"line":148,"column":0},"end":{"line":148,"column":22}},"object":{"type":"MemberExpression","start":3656,"end":3670,"loc":{"start":{"line":148,"column":0},"end":{"line":148,"column":14}},"object":{"type":"Identifier","start":3656,"end":3662,"loc":{"start":{"line":148,"column":0},"end":{"line":148,"column":6}},"name":"module"},"property":{"type":"Identifier","start":3663,"end":3670,"loc":{"start":{"line":148,"column":7},"end":{"line":148,"column":14}},"name":"exports"},"computed":false},"property":{"type":"Identifier","start":3671,"end":3678,"loc":{"start":{"line":148,"column":15},"end":{"line":148,"column":22}},"name":"encrypt"},"computed":false},"right":{"type":"ArrowFunctionExpression","start":3681,"end":4002,"loc":{"start":{"line":148,"column":25},"end":{"line":155,"column":1}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":3682,"end":3687,"loc":{"start":{"line":148,"column":26},"end":{"line":148,"column":31}},"name":"input"},{"type":"Identifier","start":3689,"end":3695,"loc":{"start":{"line":148,"column":33},"end":{"line":148,"column":39}},"name":"secret"}],"body":{"type":"BlockStatement","start":3700,"end":4002,"loc":{"start":{"line":148,"column":44},"end":{"line":155,"column":1}},"body":[{"type":"VariableDeclaration","start":3704,"end":3725,"loc":{"start":{"line":149,"column":2},"end":{"line":149,"column":23}},"declarations":[{"type":"VariableDeclarator","start":3710,"end":3725,"loc":{"start":{"line":149,"column":8},"end":{"line":149,"column":23}},"id":{"type":"Identifier","start":3710,"end":3712,"loc":{"start":{"line":149,"column":8},"end":{"line":149,"column":10}},"name":"iv"},"init":{"type":"CallExpression","start":3715,"end":3725,"loc":{"start":{"line":149,"column":13},"end":{"line":149,"column":23}},"callee":{"type":"Identifier","start":3715,"end":3723,"loc":{"start":{"line":149,"column":13},"end":{"line":149,"column":21}},"name":"createIv"},"arguments":[]}}],"kind":"const"},{"type":"VariableDeclaration","start":3728,"end":3800,"loc":{"start":{"line":150,"column":2},"end":{"line":150,"column":74}},"declarations":[{"type":"VariableDeclarator","start":3734,"end":3800,"loc":{"start":{"line":150,"column":8},"end":{"line":150,"column":74}},"id":{"type":"Identifier","start":3734,"end":3740,"loc":{"start":{"line":150,"column":8},"end":{"line":150,"column":14}},"name":"cipher"},"init":{"type":"CallExpression","start":3743,"end":3800,"loc":{"start":{"line":150,"column":17},"end":{"line":150,"column":74}},"callee":{"type":"MemberExpression","start":3743,"end":3764,"loc":{"start":{"line":150,"column":17},"end":{"line":150,"column":38}},"object":{"type":"Identifier","start":3743,"end":3749,"loc":{"start":{"line":150,"column":17},"end":{"line":150,"column":23}},"name":"crypto"},"property":{"type":"Identifier","start":3750,"end":3764,"loc":{"start":{"line":150,"column":24},"end":{"line":150,"column":38}},"name":"createCipheriv"},"computed":false},"arguments":[{"type":"Literal","start":3765,"end":3773,"loc":{"start":{"line":150,"column":39},"end":{"line":150,"column":47}},"value":"aes256","raw":"'aes256'"},{"type":"CallExpression","start":3775,"end":3795,"loc":{"start":{"line":150,"column":49},"end":{"line":150,"column":69}},"callee":{"type":"Identifier","start":3775,"end":3787,"loc":{"start":{"line":150,"column":49},"end":{"line":150,"column":61}},"name":"createSecret"},"arguments":[{"type":"Identifier","start":3788,"end":3794,"loc":{"start":{"line":150,"column":62},"end":{"line":150,"column":68}},"name":"secret"}]},{"type":"Identifier","start":3797,"end":3799,"loc":{"start":{"line":150,"column":71},"end":{"line":150,"column":73}},"name":"iv"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":3803,"end":3857,"loc":{"start":{"line":151,"column":2},"end":{"line":151,"column":56}},"declarations":[{"type":"VariableDeclarator","start":3807,"end":3857,"loc":{"start":{"line":151,"column":6},"end":{"line":151,"column":56}},"id":{"type":"Identifier","start":3807,"end":3816,"loc":{"start":{"line":151,"column":6},"end":{"line":151,"column":15}},"name":"encrypted"},"init":{"type":"CallExpression","start":3819,"end":3857,"loc":{"start":{"line":151,"column":18},"end":{"line":151,"column":56}},"callee":{"type":"MemberExpression","start":3819,"end":3832,"loc":{"start":{"line":151,"column":18},"end":{"line":151,"column":31}},"object":{"type":"Identifier","start":3819,"end":3825,"loc":{"start":{"line":151,"column":18},"end":{"line":151,"column":24}},"name":"cipher"},"property":{"type":"Identifier","start":3826,"end":3832,"loc":{"start":{"line":151,"column":25},"end":{"line":151,"column":31}},"name":"update"},"computed":false},"arguments":[{"type":"Identifier","start":3833,"end":3838,"loc":{"start":{"line":151,"column":32},"end":{"line":151,"column":37}},"name":"input"},{"type":"Literal","start":3840,"end":3846,"loc":{"start":{"line":151,"column":39},"end":{"line":151,"column":45}},"value":"utf8","raw":"'utf8'"},{"type":"Literal","start":3848,"end":3856,"loc":{"start":{"line":151,"column":47},"end":{"line":151,"column":55}},"value":"base64","raw":"'base64'"}]}}],"kind":"let"},{"type":"ExpressionStatement","start":3860,"end":3895,"loc":{"start":{"line":152,"column":2},"end":{"line":152,"column":37}},"expression":{"type":"AssignmentExpression","start":3860,"end":3895,"loc":{"start":{"line":152,"column":2},"end":{"line":152,"column":37}},"operator":"+=","left":{"type":"Identifier","start":3860,"end":3869,"loc":{"start":{"line":152,"column":2},"end":{"line":152,"column":11}},"name":"encrypted"},"right":{"type":"CallExpression","start":3873,"end":3895,"loc":{"start":{"line":152,"column":15},"end":{"line":152,"column":37}},"callee":{"type":"MemberExpression","start":3873,"end":3885,"loc":{"start":{"line":152,"column":15},"end":{"line":152,"column":27}},"object":{"type":"Identifier","start":3873,"end":3879,"loc":{"start":{"line":152,"column":15},"end":{"line":152,"column":21}},"name":"cipher"},"property":{"type":"Identifier","start":3880,"end":3885,"loc":{"start":{"line":152,"column":22},"end":{"line":152,"column":27}},"name":"final"},"computed":false},"arguments":[{"type":"Literal","start":3886,"end":3894,"loc":{"start":{"line":152,"column":28},"end":{"line":152,"column":36}},"value":"base64","raw":"'base64'"}]}}},{"type":"ReturnStatement","start":3952,"end":4000,"loc":{"start":{"line":154,"column":2},"end":{"line":154,"column":50}},"argument":{"type":"BinaryExpression","start":3959,"end":4000,"loc":{"start":{"line":154,"column":9},"end":{"line":154,"column":50}},"left":{"type":"CallExpression","start":3959,"end":3977,"loc":{"start":{"line":154,"column":9},"end":{"line":154,"column":27}},"callee":{"type":"MemberExpression","start":3959,"end":3970,"loc":{"start":{"line":154,"column":9},"end":{"line":154,"column":20}},"object":{"type":"Identifier","start":3959,"end":3961,"loc":{"start":{"line":154,"column":9},"end":{"line":154,"column":11}},"name":"iv"},"property":{"type":"Identifier","start":3962,"end":3970,"loc":{"start":{"line":154,"column":12},"end":{"line":154,"column":20}},"name":"toString"},"computed":false},"arguments":[{"type":"Literal","start":3971,"end":3976,"loc":{"start":{"line":154,"column":21},"end":{"line":154,"column":26}},"value":"hex","raw":"'hex'"}]},"operator":"+","right":{"type":"CallExpression","start":3980,"end":4000,"loc":{"start":{"line":154,"column":30},"end":{"line":154,"column":50}},"callee":{"type":"Identifier","start":3980,"end":3989,"loc":{"start":{"line":154,"column":30},"end":{"line":154,"column":39}},"name":"urlEncode"},"arguments":[{"type":"Identifier","start":3990,"end":3999,"loc":{"start":{"line":154,"column":40},"end":{"line":154,"column":49}},"name":"encrypted"}]}},"comments":[{"type":"Line","value":" add iv to encrypted string to use for decryption","start":3898,"end":3949,"loc":{"start":{"line":153,"column":2},"end":{"line":153,"column":53}}}]}]}}},"comments":[{"type":"Block","value":"*\n * Encrypt a buffer or string with AES256 and a random iv.\n *\n * @param {string} input\n * @param {string|Buffer} secret\n * @return {string} Ciphertext as a hex string, prefixed with 32 hex characters containing the iv.\n ","start":3429,"end":3655,"loc":{"start":{"line":141,"column":0},"end":{"line":147,"column":3}}}]},{"type":"ExpressionStatement","start":4212,"end":4766,"loc":{"start":{"line":164,"column":0},"end":{"line":176,"column":1}},"expression":{"type":"AssignmentExpression","start":4212,"end":4766,"loc":{"start":{"line":164,"column":0},"end":{"line":176,"column":1}},"operator":"=","left":{"type":"MemberExpression","start":4212,"end":4234,"loc":{"start":{"line":164,"column":0},"end":{"line":164,"column":22}},"object":{"type":"MemberExpression","start":4212,"end":4226,"loc":{"start":{"line":164,"column":0},"end":{"line":164,"column":14}},"object":{"type":"Identifier","start":4212,"end":4218,"loc":{"start":{"line":164,"column":0},"end":{"line":164,"column":6}},"name":"module"},"property":{"type":"Identifier","start":4219,"end":4226,"loc":{"start":{"line":164,"column":7},"end":{"line":164,"column":14}},"name":"exports"},"computed":false},"property":{"type":"Identifier","start":4227,"end":4234,"loc":{"start":{"line":164,"column":15},"end":{"line":164,"column":22}},"name":"decrypt"},"computed":false},"right":{"type":"ArrowFunctionExpression","start":4237,"end":4766,"loc":{"start":{"line":164,"column":25},"end":{"line":176,"column":1}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":4238,"end":4247,"loc":{"start":{"line":164,"column":26},"end":{"line":164,"column":35}},"name":"encrypted"},{"type":"Identifier","start":4249,"end":4255,"loc":{"start":{"line":164,"column":37},"end":{"line":164,"column":43}},"name":"secret"}],"body":{"type":"BlockStatement","start":4260,"end":4766,"loc":{"start":{"line":164,"column":48},"end":{"line":176,"column":1}},"body":[{"type":"IfStatement","start":4303,"end":4437,"loc":{"start":{"line":166,"column":2},"end":{"line":168,"column":3}},"test":{"type":"BinaryExpression","start":4307,"end":4328,"loc":{"start":{"line":166,"column":6},"end":{"line":166,"column":27}},"left":{"type":"MemberExpression","start":4307,"end":4323,"loc":{"start":{"line":166,"column":6},"end":{"line":166,"column":22}},"object":{"type":"Identifier","start":4307,"end":4316,"loc":{"start":{"line":166,"column":6},"end":{"line":166,"column":15}},"name":"encrypted"},"property":{"type":"Identifier","start":4317,"end":4323,"loc":{"start":{"line":166,"column":16},"end":{"line":166,"column":22}},"name":"length"},"computed":false},"operator":"<","right":{"type":"Literal","start":4326,"end":4328,"loc":{"start":{"line":166,"column":25},"end":{"line":166,"column":27}},"value":32,"raw":"32"}},"consequent":{"type":"BlockStatement","start":4330,"end":4437,"loc":{"start":{"line":166,"column":29},"end":{"line":168,"column":3}},"body":[{"type":"ThrowStatement","start":4336,"end":4433,"loc":{"start":{"line":167,"column":4},"end":{"line":167,"column":101}},"argument":{"type":"NewExpression","start":4342,"end":4433,"loc":{"start":{"line":167,"column":10},"end":{"line":167,"column":101}},"callee":{"type":"Identifier","start":4346,"end":4351,"loc":{"start":{"line":167,"column":14},"end":{"line":167,"column":19}},"name":"Error"},"arguments":[{"type":"Literal","start":4352,"end":4432,"loc":{"start":{"line":167,"column":20},"end":{"line":167,"column":100}},"value":"Invalid encrypted value. Maybe it was generated with an old Companion version?","raw":"'Invalid encrypted value. Maybe it was generated with an old Companion version?'"}]}}]},"alternate":null,"comments":[{"type":"Line","value":" Need at least 32 chars for the iv","start":4264,"end":4300,"loc":{"start":{"line":165,"column":2},"end":{"line":165,"column":38}}}]},{"type":"VariableDeclaration","start":4441,"end":4494,"loc":{"start":{"line":170,"column":2},"end":{"line":170,"column":55}},"declarations":[{"type":"VariableDeclarator","start":4447,"end":4494,"loc":{"start":{"line":170,"column":8},"end":{"line":170,"column":55}},"id":{"type":"Identifier","start":4447,"end":4449,"loc":{"start":{"line":170,"column":8},"end":{"line":170,"column":10}},"name":"iv"},"init":{"type":"CallExpression","start":4452,"end":4494,"loc":{"start":{"line":170,"column":13},"end":{"line":170,"column":55}},"callee":{"type":"MemberExpression","start":4452,"end":4463,"loc":{"start":{"line":170,"column":13},"end":{"line":170,"column":24}},"object":{"type":"Identifier","start":4452,"end":4458,"loc":{"start":{"line":170,"column":13},"end":{"line":170,"column":19}},"name":"Buffer"},"property":{"type":"Identifier","start":4459,"end":4463,"loc":{"start":{"line":170,"column":20},"end":{"line":170,"column":24}},"name":"from"},"computed":false},"arguments":[{"type":"CallExpression","start":4464,"end":4486,"loc":{"start":{"line":170,"column":25},"end":{"line":170,"column":47}},"callee":{"type":"MemberExpression","start":4464,"end":4479,"loc":{"start":{"line":170,"column":25},"end":{"line":170,"column":40}},"object":{"type":"Identifier","start":4464,"end":4473,"loc":{"start":{"line":170,"column":25},"end":{"line":170,"column":34}},"name":"encrypted"},"property":{"type":"Identifier","start":4474,"end":4479,"loc":{"start":{"line":170,"column":35},"end":{"line":170,"column":40}},"name":"slice"},"computed":false},"arguments":[{"type":"Literal","start":4480,"end":4481,"loc":{"start":{"line":170,"column":41},"end":{"line":170,"column":42}},"value":0,"raw":"0"},{"type":"Literal","start":4483,"end":4485,"loc":{"start":{"line":170,"column":44},"end":{"line":170,"column":46}},"value":32,"raw":"32"}]},{"type":"Literal","start":4488,"end":4493,"loc":{"start":{"line":170,"column":49},"end":{"line":170,"column":54}},"value":"hex","raw":"'hex'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":4497,"end":4544,"loc":{"start":{"line":171,"column":2},"end":{"line":171,"column":49}},"declarations":[{"type":"VariableDeclarator","start":4503,"end":4544,"loc":{"start":{"line":171,"column":8},"end":{"line":171,"column":49}},"id":{"type":"Identifier","start":4503,"end":4522,"loc":{"start":{"line":171,"column":8},"end":{"line":171,"column":27}},"name":"encryptionWithoutIv"},"init":{"type":"CallExpression","start":4525,"end":4544,"loc":{"start":{"line":171,"column":30},"end":{"line":171,"column":49}},"callee":{"type":"MemberExpression","start":4525,"end":4540,"loc":{"start":{"line":171,"column":30},"end":{"line":171,"column":45}},"object":{"type":"Identifier","start":4525,"end":4534,"loc":{"start":{"line":171,"column":30},"end":{"line":171,"column":39}},"name":"encrypted"},"property":{"type":"Identifier","start":4535,"end":4540,"loc":{"start":{"line":171,"column":40},"end":{"line":171,"column":45}},"name":"slice"},"computed":false},"arguments":[{"type":"Literal","start":4541,"end":4543,"loc":{"start":{"line":171,"column":46},"end":{"line":171,"column":48}},"value":32,"raw":"32"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":4547,"end":4623,"loc":{"start":{"line":172,"column":2},"end":{"line":172,"column":78}},"declarations":[{"type":"VariableDeclarator","start":4553,"end":4623,"loc":{"start":{"line":172,"column":8},"end":{"line":172,"column":78}},"id":{"type":"Identifier","start":4553,"end":4561,"loc":{"start":{"line":172,"column":8},"end":{"line":172,"column":16}},"name":"decipher"},"init":{"type":"CallExpression","start":4564,"end":4623,"loc":{"start":{"line":172,"column":19},"end":{"line":172,"column":78}},"callee":{"type":"MemberExpression","start":4564,"end":4587,"loc":{"start":{"line":172,"column":19},"end":{"line":172,"column":42}},"object":{"type":"Identifier","start":4564,"end":4570,"loc":{"start":{"line":172,"column":19},"end":{"line":172,"column":25}},"name":"crypto"},"property":{"type":"Identifier","start":4571,"end":4587,"loc":{"start":{"line":172,"column":26},"end":{"line":172,"column":42}},"name":"createDecipheriv"},"computed":false},"arguments":[{"type":"Literal","start":4588,"end":4596,"loc":{"start":{"line":172,"column":43},"end":{"line":172,"column":51}},"value":"aes256","raw":"'aes256'"},{"type":"CallExpression","start":4598,"end":4618,"loc":{"start":{"line":172,"column":53},"end":{"line":172,"column":73}},"callee":{"type":"Identifier","start":4598,"end":4610,"loc":{"start":{"line":172,"column":53},"end":{"line":172,"column":65}},"name":"createSecret"},"arguments":[{"type":"Identifier","start":4611,"end":4617,"loc":{"start":{"line":172,"column":66},"end":{"line":172,"column":72}},"name":"secret"}]},{"type":"Identifier","start":4620,"end":4622,"loc":{"start":{"line":172,"column":75},"end":{"line":172,"column":77}},"name":"iv"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":4626,"end":4707,"loc":{"start":{"line":173,"column":2},"end":{"line":173,"column":83}},"declarations":[{"type":"VariableDeclarator","start":4630,"end":4707,"loc":{"start":{"line":173,"column":6},"end":{"line":173,"column":83}},"id":{"type":"Identifier","start":4630,"end":4639,"loc":{"start":{"line":173,"column":6},"end":{"line":173,"column":15}},"name":"decrypted"},"init":{"type":"CallExpression","start":4642,"end":4707,"loc":{"start":{"line":173,"column":18},"end":{"line":173,"column":83}},"callee":{"type":"MemberExpression","start":4642,"end":4657,"loc":{"start":{"line":173,"column":18},"end":{"line":173,"column":33}},"object":{"type":"Identifier","start":4642,"end":4650,"loc":{"start":{"line":173,"column":18},"end":{"line":173,"column":26}},"name":"decipher"},"property":{"type":"Identifier","start":4651,"end":4657,"loc":{"start":{"line":173,"column":27},"end":{"line":173,"column":33}},"name":"update"},"computed":false},"arguments":[{"type":"CallExpression","start":4658,"end":4688,"loc":{"start":{"line":173,"column":34},"end":{"line":173,"column":64}},"callee":{"type":"Identifier","start":4658,"end":4667,"loc":{"start":{"line":173,"column":34},"end":{"line":173,"column":43}},"name":"urlDecode"},"arguments":[{"type":"Identifier","start":4668,"end":4687,"loc":{"start":{"line":173,"column":44},"end":{"line":173,"column":63}},"name":"encryptionWithoutIv"}]},{"type":"Literal","start":4690,"end":4698,"loc":{"start":{"line":173,"column":66},"end":{"line":173,"column":74}},"value":"base64","raw":"'base64'"},{"type":"Literal","start":4700,"end":4706,"loc":{"start":{"line":173,"column":76},"end":{"line":173,"column":82}},"value":"utf8","raw":"'utf8'"}]}}],"kind":"let"},{"type":"ExpressionStatement","start":4710,"end":4745,"loc":{"start":{"line":174,"column":2},"end":{"line":174,"column":37}},"expression":{"type":"AssignmentExpression","start":4710,"end":4745,"loc":{"start":{"line":174,"column":2},"end":{"line":174,"column":37}},"operator":"+=","left":{"type":"Identifier","start":4710,"end":4719,"loc":{"start":{"line":174,"column":2},"end":{"line":174,"column":11}},"name":"decrypted"},"right":{"type":"CallExpression","start":4723,"end":4745,"loc":{"start":{"line":174,"column":15},"end":{"line":174,"column":37}},"callee":{"type":"MemberExpression","start":4723,"end":4737,"loc":{"start":{"line":174,"column":15},"end":{"line":174,"column":29}},"object":{"type":"Identifier","start":4723,"end":4731,"loc":{"start":{"line":174,"column":15},"end":{"line":174,"column":23}},"name":"decipher"},"property":{"type":"Identifier","start":4732,"end":4737,"loc":{"start":{"line":174,"column":24},"end":{"line":174,"column":29}},"name":"final"},"computed":false},"arguments":[{"type":"Literal","start":4738,"end":4744,"loc":{"start":{"line":174,"column":30},"end":{"line":174,"column":36}},"value":"utf8","raw":"'utf8'"}]}}},{"type":"ReturnStatement","start":4748,"end":4764,"loc":{"start":{"line":175,"column":2},"end":{"line":175,"column":18}},"argument":{"type":"Identifier","start":4755,"end":4764,"loc":{"start":{"line":175,"column":9},"end":{"line":175,"column":18}},"name":"decrypted"}}]}}},"comments":[{"type":"Block","value":"*\n * Decrypt an iv-prefixed or string with AES256. The iv should be in the first 32 hex characters.\n *\n * @param {string} encrypted\n * @param {string|Buffer} secret\n * @return {string} Decrypted value.\n ","start":4004,"end":4211,"loc":{"start":{"line":157,"column":0},"end":{"line":163,"column":3}}}]}],"sourceType":"script"}