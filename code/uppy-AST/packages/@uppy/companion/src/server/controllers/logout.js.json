{"type":"Program","start":0,"end":1114,"body":[{"type":"VariableDeclaration","start":0,"end":46,"declarations":[{"type":"VariableDeclarator","start":6,"end":46,"id":{"type":"Identifier","start":6,"end":18,"name":"tokenService"},"init":{"type":"CallExpression","start":21,"end":46,"callee":{"type":"Identifier","start":21,"end":28,"name":"require"},"arguments":[{"type":"Literal","start":29,"end":45,"value":"../helpers/jwt","raw":"'../helpers/jwt'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":47,"end":103,"declarations":[{"type":"VariableDeclarator","start":53,"end":103,"id":{"type":"ObjectPattern","start":53,"end":72,"properties":[{"type":"Property","start":55,"end":70,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":55,"end":70,"name":"errorToResponse"},"kind":"init","value":{"type":"Identifier","start":55,"end":70,"name":"errorToResponse"}}]},"init":{"type":"CallExpression","start":75,"end":103,"callee":{"type":"Identifier","start":75,"end":82,"name":"require"},"arguments":[{"type":"Literal","start":83,"end":102,"value":"../provider/error","raw":"'../provider/error'"}]}}],"kind":"const"},{"type":"FunctionDeclaration","start":162,"end":1088,"id":{"type":"Identifier","start":171,"end":177,"name":"logout"},"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":179,"end":182,"name":"req"},{"type":"Identifier","start":184,"end":187,"name":"res"},{"type":"Identifier","start":189,"end":193,"name":"next"}],"body":{"type":"BlockStatement","start":195,"end":1088,"body":[{"type":"VariableDeclaration","start":199,"end":342,"declarations":[{"type":"VariableDeclarator","start":205,"end":342,"id":{"type":"Identifier","start":205,"end":217,"name":"cleanSession"},"init":{"type":"ArrowFunctionExpression","start":220,"end":342,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":226,"end":342,"body":[{"type":"IfStatement","start":232,"end":338,"test":{"type":"MemberExpression","start":236,"end":253,"object":{"type":"MemberExpression","start":236,"end":247,"object":{"type":"Identifier","start":236,"end":239,"name":"req"},"property":{"type":"Identifier","start":240,"end":247,"name":"session"},"computed":false},"property":{"type":"Identifier","start":248,"end":253,"name":"grant"},"computed":false},"consequent":{"type":"BlockStatement","start":255,"end":338,"body":[{"type":"ExpressionStatement","start":263,"end":293,"expression":{"type":"AssignmentExpression","start":263,"end":293,"operator":"=","left":{"type":"MemberExpression","start":263,"end":286,"object":{"type":"MemberExpression","start":263,"end":280,"object":{"type":"MemberExpression","start":263,"end":274,"object":{"type":"Identifier","start":263,"end":266,"name":"req"},"property":{"type":"Identifier","start":267,"end":274,"name":"session"},"computed":false},"property":{"type":"Identifier","start":275,"end":280,"name":"grant"},"computed":false},"property":{"type":"Identifier","start":281,"end":286,"name":"state"},"computed":false},"right":{"type":"Literal","start":289,"end":293,"value":null,"raw":"null"}}},{"type":"ExpressionStatement","start":300,"end":332,"expression":{"type":"AssignmentExpression","start":300,"end":332,"operator":"=","left":{"type":"MemberExpression","start":300,"end":325,"object":{"type":"MemberExpression","start":300,"end":317,"object":{"type":"MemberExpression","start":300,"end":311,"object":{"type":"Identifier","start":300,"end":303,"name":"req"},"property":{"type":"Identifier","start":304,"end":311,"name":"session"},"computed":false},"property":{"type":"Identifier","start":312,"end":317,"name":"grant"},"computed":false},"property":{"type":"Identifier","start":318,"end":325,"name":"dynamic"},"computed":false},"right":{"type":"Literal","start":328,"end":332,"value":null,"raw":"null"}}}]},"alternate":null}]}}}],"kind":"const"},{"type":"VariableDeclaration","start":345,"end":389,"declarations":[{"type":"VariableDeclarator","start":351,"end":389,"id":{"type":"Identifier","start":351,"end":363,"name":"providerName"},"init":{"type":"MemberExpression","start":366,"end":389,"object":{"type":"MemberExpression","start":366,"end":376,"object":{"type":"Identifier","start":366,"end":369,"name":"req"},"property":{"type":"Identifier","start":370,"end":376,"name":"params"},"computed":false},"property":{"type":"Identifier","start":377,"end":389,"name":"providerName"},"computed":false}}],"kind":"const"},{"type":"VariableDeclaration","start":392,"end":486,"declarations":[{"type":"VariableDeclarator","start":398,"end":486,"id":{"type":"Identifier","start":398,"end":403,"name":"token"},"init":{"type":"ConditionalExpression","start":406,"end":486,"test":{"type":"MemberExpression","start":406,"end":434,"object":{"type":"MemberExpression","start":406,"end":419,"object":{"type":"Identifier","start":406,"end":409,"name":"req"},"property":{"type":"Identifier","start":410,"end":419,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":420,"end":434,"name":"providerTokens"},"computed":false},"consequent":{"type":"MemberExpression","start":437,"end":479,"object":{"type":"MemberExpression","start":437,"end":465,"object":{"type":"MemberExpression","start":437,"end":450,"object":{"type":"Identifier","start":437,"end":440,"name":"req"},"property":{"type":"Identifier","start":441,"end":450,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":451,"end":465,"name":"providerTokens"},"computed":false},"property":{"type":"Identifier","start":466,"end":478,"name":"providerName"},"computed":true},"alternate":{"type":"Literal","start":482,"end":486,"value":null,"raw":"null"}}}],"kind":"const"},{"type":"IfStatement","start":489,"end":1086,"test":{"type":"Identifier","start":493,"end":498,"name":"token"},"consequent":{"type":"BlockStatement","start":500,"end":1013,"body":[{"type":"ExpressionStatement","start":506,"end":1009,"expression":{"type":"CallExpression","start":506,"end":1009,"callee":{"type":"MemberExpression","start":506,"end":535,"object":{"type":"MemberExpression","start":506,"end":528,"object":{"type":"MemberExpression","start":506,"end":519,"object":{"type":"Identifier","start":506,"end":509,"name":"req"},"property":{"type":"Identifier","start":510,"end":519,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":520,"end":528,"name":"provider"},"computed":false},"property":{"type":"Identifier","start":529,"end":535,"name":"logout"},"computed":false},"arguments":[{"type":"ObjectExpression","start":536,"end":545,"properties":[{"type":"Property","start":538,"end":543,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":538,"end":543,"name":"token"},"kind":"init","value":{"type":"Identifier","start":538,"end":543,"name":"token"}}]},{"type":"ArrowFunctionExpression","start":547,"end":1008,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":548,"end":551,"name":"err"},{"type":"Identifier","start":553,"end":557,"name":"data"}],"body":{"type":"BlockStatement","start":562,"end":1008,"body":[{"type":"IfStatement","start":570,"end":768,"test":{"type":"Identifier","start":574,"end":577,"name":"err"},"consequent":{"type":"BlockStatement","start":579,"end":768,"body":[{"type":"VariableDeclaration","start":589,"end":625,"declarations":[{"type":"VariableDeclarator","start":595,"end":625,"id":{"type":"Identifier","start":595,"end":602,"name":"errResp"},"init":{"type":"CallExpression","start":605,"end":625,"callee":{"type":"Identifier","start":605,"end":620,"name":"errorToResponse"},"arguments":[{"type":"Identifier","start":621,"end":624,"name":"err"}]}}],"kind":"const"},{"type":"IfStatement","start":634,"end":735,"test":{"type":"Identifier","start":638,"end":645,"name":"errResp"},"consequent":{"type":"BlockStatement","start":647,"end":735,"body":[{"type":"ReturnStatement","start":659,"end":725,"argument":{"type":"CallExpression","start":666,"end":725,"callee":{"type":"MemberExpression","start":666,"end":695,"object":{"type":"CallExpression","start":666,"end":690,"callee":{"type":"MemberExpression","start":666,"end":676,"object":{"type":"Identifier","start":666,"end":669,"name":"res"},"property":{"type":"Identifier","start":670,"end":676,"name":"status"},"computed":false},"arguments":[{"type":"MemberExpression","start":677,"end":689,"object":{"type":"Identifier","start":677,"end":684,"name":"errResp"},"property":{"type":"Identifier","start":685,"end":689,"name":"code"},"computed":false}]},"property":{"type":"Identifier","start":691,"end":695,"name":"json"},"computed":false},"arguments":[{"type":"ObjectExpression","start":696,"end":724,"properties":[{"type":"Property","start":698,"end":722,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":698,"end":705,"name":"message"},"value":{"type":"MemberExpression","start":707,"end":722,"object":{"type":"Identifier","start":707,"end":714,"name":"errResp"},"property":{"type":"Identifier","start":715,"end":722,"name":"message"},"computed":false},"kind":"init"}]}]}}]},"alternate":null},{"type":"ReturnStatement","start":744,"end":760,"argument":{"type":"CallExpression","start":751,"end":760,"callee":{"type":"Identifier","start":751,"end":755,"name":"next"},"arguments":[{"type":"Identifier","start":756,"end":759,"name":"err"}]}}]},"alternate":null},{"type":"ExpressionStatement","start":776,"end":825,"expression":{"type":"UnaryExpression","start":776,"end":825,"operator":"delete","prefix":true,"argument":{"type":"MemberExpression","start":783,"end":825,"object":{"type":"MemberExpression","start":783,"end":811,"object":{"type":"MemberExpression","start":783,"end":796,"object":{"type":"Identifier","start":783,"end":786,"name":"req"},"property":{"type":"Identifier","start":787,"end":796,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":797,"end":811,"name":"providerTokens"},"computed":false},"property":{"type":"Identifier","start":812,"end":824,"name":"providerName"},"computed":true}}},{"type":"ExpressionStatement","start":832,"end":931,"expression":{"type":"CallExpression","start":832,"end":931,"callee":{"type":"MemberExpression","start":832,"end":862,"object":{"type":"Identifier","start":832,"end":844,"name":"tokenService"},"property":{"type":"Identifier","start":845,"end":862,"name":"removeFromCookies"},"computed":false},"arguments":[{"type":"Identifier","start":863,"end":866,"name":"res"},{"type":"MemberExpression","start":868,"end":889,"object":{"type":"MemberExpression","start":868,"end":881,"object":{"type":"Identifier","start":868,"end":871,"name":"req"},"property":{"type":"Identifier","start":872,"end":881,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":882,"end":889,"name":"options"},"computed":false},{"type":"MemberExpression","start":891,"end":930,"object":{"type":"MemberExpression","start":891,"end":913,"object":{"type":"MemberExpression","start":891,"end":904,"object":{"type":"Identifier","start":891,"end":894,"name":"req"},"property":{"type":"Identifier","start":895,"end":904,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":905,"end":913,"name":"provider"},"computed":false},"property":{"type":"Identifier","start":914,"end":930,"name":"authProviderName"},"computed":false}]}},{"type":"ExpressionStatement","start":938,"end":952,"expression":{"type":"CallExpression","start":938,"end":952,"callee":{"type":"Identifier","start":938,"end":950,"name":"cleanSession"},"arguments":[]}},{"type":"ExpressionStatement","start":959,"end":1002,"expression":{"type":"CallExpression","start":959,"end":1002,"callee":{"type":"MemberExpression","start":959,"end":967,"object":{"type":"Identifier","start":959,"end":962,"name":"res"},"property":{"type":"Identifier","start":963,"end":967,"name":"json"},"computed":false},"arguments":[{"type":"CallExpression","start":968,"end":1001,"callee":{"type":"MemberExpression","start":968,"end":981,"object":{"type":"Identifier","start":968,"end":974,"name":"Object"},"property":{"type":"Identifier","start":975,"end":981,"name":"assign"},"computed":false},"arguments":[{"type":"ObjectExpression","start":982,"end":994,"properties":[{"type":"Property","start":984,"end":992,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":984,"end":986,"name":"ok"},"value":{"type":"Literal","start":988,"end":992,"value":true,"raw":"true"},"kind":"init"}]},{"type":"Identifier","start":996,"end":1000,"name":"data"}]}]}}]}}]}}]},"alternate":{"type":"BlockStatement","start":1019,"end":1086,"body":[{"type":"ExpressionStatement","start":1025,"end":1039,"expression":{"type":"CallExpression","start":1025,"end":1039,"callee":{"type":"Identifier","start":1025,"end":1037,"name":"cleanSession"},"arguments":[]}},{"type":"ExpressionStatement","start":1044,"end":1082,"expression":{"type":"CallExpression","start":1044,"end":1082,"callee":{"type":"MemberExpression","start":1044,"end":1052,"object":{"type":"Identifier","start":1044,"end":1047,"name":"res"},"property":{"type":"Identifier","start":1048,"end":1052,"name":"json"},"computed":false},"arguments":[{"type":"ObjectExpression","start":1053,"end":1081,"properties":[{"type":"Property","start":1055,"end":1063,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1055,"end":1057,"name":"ok"},"value":{"type":"Literal","start":1059,"end":1063,"value":true,"raw":"true"},"kind":"init"},{"type":"Property","start":1065,"end":1079,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1065,"end":1072,"name":"revoked"},"value":{"type":"Literal","start":1074,"end":1079,"value":false,"raw":"false"},"kind":"init"}]}]}}]}}]}},{"type":"ExpressionStatement","start":1090,"end":1113,"expression":{"type":"AssignmentExpression","start":1090,"end":1113,"operator":"=","left":{"type":"MemberExpression","start":1090,"end":1104,"object":{"type":"Identifier","start":1090,"end":1096,"name":"module"},"property":{"type":"Identifier","start":1097,"end":1104,"name":"exports"},"computed":false},"right":{"type":"Identifier","start":1107,"end":1113,"name":"logout"}}}],"sourceType":"script"}