{"type":"Program","start":0,"end":989,"body":[{"type":"VariableDeclaration","start":0,"end":33,"declarations":[{"type":"VariableDeclarator","start":6,"end":33,"id":{"type":"Identifier","start":6,"end":8,"name":"qs"},"init":{"type":"CallExpression","start":11,"end":33,"callee":{"type":"Identifier","start":11,"end":18,"name":"require"},"arguments":[{"type":"Literal","start":19,"end":32,"value":"querystring","raw":"'querystring'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":34,"end":71,"declarations":[{"type":"VariableDeclarator","start":40,"end":71,"id":{"type":"Identifier","start":40,"end":48,"name":"parseUrl"},"init":{"type":"MemberExpression","start":51,"end":71,"object":{"type":"CallExpression","start":51,"end":65,"callee":{"type":"Identifier","start":51,"end":58,"name":"require"},"arguments":[{"type":"Literal","start":59,"end":64,"value":"url","raw":"'url'"}]},"property":{"type":"Identifier","start":66,"end":71,"name":"parse"},"computed":false}}],"kind":"const"},{"type":"VariableDeclaration","start":118,"end":166,"declarations":[{"type":"VariableDeclarator","start":124,"end":166,"id":{"type":"ObjectPattern","start":124,"end":136,"properties":[{"type":"Property","start":126,"end":134,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":126,"end":134,"name":"hasMatch"},"kind":"init","value":{"type":"Identifier","start":126,"end":134,"name":"hasMatch"}}]},"init":{"type":"CallExpression","start":139,"end":166,"callee":{"type":"Identifier","start":139,"end":146,"name":"require"},"arguments":[{"type":"Literal","start":147,"end":165,"value":"../helpers/utils","raw":"'../helpers/utils'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":167,"end":219,"declarations":[{"type":"VariableDeclarator","start":173,"end":219,"id":{"type":"Identifier","start":173,"end":183,"name":"oAuthState"},"init":{"type":"CallExpression","start":186,"end":219,"callee":{"type":"Identifier","start":186,"end":193,"name":"require"},"arguments":[{"type":"Literal","start":194,"end":218,"value":"../helpers/oauth-state","raw":"'../helpers/oauth-state'"}]}}],"kind":"const"},{"type":"ExpressionStatement","start":278,"end":988,"expression":{"type":"AssignmentExpression","start":278,"end":988,"operator":"=","left":{"type":"MemberExpression","start":278,"end":292,"object":{"type":"Identifier","start":278,"end":284,"name":"module"},"property":{"type":"Identifier","start":285,"end":292,"name":"exports"},"computed":false},"right":{"type":"FunctionExpression","start":295,"end":988,"id":{"type":"Identifier","start":304,"end":317,"name":"oauthRedirect"},"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":319,"end":322,"name":"req"},{"type":"Identifier","start":324,"end":327,"name":"res"}],"body":{"type":"BlockStatement","start":329,"end":988,"body":[{"type":"VariableDeclaration","start":333,"end":388,"declarations":[{"type":"VariableDeclarator","start":339,"end":388,"id":{"type":"Identifier","start":339,"end":346,"name":"dynamic"},"init":{"type":"LogicalExpression","start":349,"end":388,"left":{"type":"MemberExpression","start":349,"end":382,"object":{"type":"LogicalExpression","start":350,"end":373,"left":{"type":"MemberExpression","start":350,"end":367,"object":{"type":"MemberExpression","start":350,"end":361,"object":{"type":"Identifier","start":350,"end":353,"name":"req"},"property":{"type":"Identifier","start":354,"end":361,"name":"session"},"computed":false},"property":{"type":"Identifier","start":362,"end":367,"name":"grant"},"computed":false},"operator":"||","right":{"type":"ObjectExpression","start":371,"end":373,"properties":[]}},"property":{"type":"Identifier","start":375,"end":382,"name":"dynamic"},"computed":false},"operator":"||","right":{"type":"ObjectExpression","start":386,"end":388,"properties":[]}}}],"kind":"const"},{"type":"VariableDeclaration","start":391,"end":418,"declarations":[{"type":"VariableDeclarator","start":397,"end":418,"id":{"type":"Identifier","start":397,"end":402,"name":"state"},"init":{"type":"MemberExpression","start":405,"end":418,"object":{"type":"Identifier","start":405,"end":412,"name":"dynamic"},"property":{"type":"Identifier","start":413,"end":418,"name":"state"},"computed":false}}],"kind":"const"},{"type":"IfStatement","start":421,"end":502,"test":{"type":"UnaryExpression","start":425,"end":431,"operator":"!","prefix":true,"argument":{"type":"Identifier","start":426,"end":431,"name":"state"}},"consequent":{"type":"BlockStatement","start":433,"end":502,"body":[{"type":"ReturnStatement","start":439,"end":498,"argument":{"type":"CallExpression","start":446,"end":498,"callee":{"type":"MemberExpression","start":446,"end":466,"object":{"type":"CallExpression","start":446,"end":461,"callee":{"type":"MemberExpression","start":446,"end":456,"object":{"type":"Identifier","start":446,"end":449,"name":"res"},"property":{"type":"Identifier","start":450,"end":456,"name":"status"},"computed":false},"arguments":[{"type":"Literal","start":457,"end":460,"value":400,"raw":"400"}]},"property":{"type":"Identifier","start":462,"end":466,"name":"send"},"computed":false},"arguments":[{"type":"Literal","start":467,"end":497,"value":"Cannot find state in session","raw":"'Cannot find state in session'"}]}}]},"alternate":null},{"type":"VariableDeclaration","start":505,"end":602,"declarations":[{"type":"VariableDeclarator","start":511,"end":602,"id":{"type":"Identifier","start":511,"end":518,"name":"handler"},"init":{"type":"CallExpression","start":521,"end":602,"callee":{"type":"MemberExpression","start":521,"end":544,"object":{"type":"Identifier","start":521,"end":531,"name":"oAuthState"},"property":{"type":"Identifier","start":532,"end":544,"name":"getFromState"},"computed":false},"arguments":[{"type":"Identifier","start":545,"end":550,"name":"state"},{"type":"Literal","start":552,"end":571,"value":"companionInstance","raw":"'companionInstance'"},{"type":"MemberExpression","start":573,"end":601,"object":{"type":"MemberExpression","start":573,"end":594,"object":{"type":"MemberExpression","start":573,"end":586,"object":{"type":"Identifier","start":573,"end":576,"name":"req"},"property":{"type":"Identifier","start":577,"end":586,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":587,"end":594,"name":"options"},"computed":false},"property":{"type":"Identifier","start":595,"end":601,"name":"secret"},"computed":false}]}}],"kind":"const"},{"type":"VariableDeclaration","start":605,"end":651,"declarations":[{"type":"VariableDeclarator","start":611,"end":651,"id":{"type":"Identifier","start":611,"end":626,"name":"handlerHostName"},"init":{"type":"MemberExpression","start":629,"end":651,"object":{"type":"CallExpression","start":629,"end":646,"callee":{"type":"Identifier","start":629,"end":637,"name":"parseUrl"},"arguments":[{"type":"Identifier","start":638,"end":645,"name":"handler"}]},"property":{"type":"Identifier","start":647,"end":651,"name":"host"},"computed":false}}],"kind":"const"},{"type":"IfStatement","start":655,"end":937,"test":{"type":"CallExpression","start":659,"end":725,"callee":{"type":"Identifier","start":659,"end":667,"name":"hasMatch"},"arguments":[{"type":"Identifier","start":668,"end":683,"name":"handlerHostName"},{"type":"MemberExpression","start":685,"end":724,"object":{"type":"MemberExpression","start":685,"end":713,"object":{"type":"MemberExpression","start":685,"end":706,"object":{"type":"MemberExpression","start":685,"end":698,"object":{"type":"Identifier","start":685,"end":688,"name":"req"},"property":{"type":"Identifier","start":689,"end":698,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":699,"end":706,"name":"options"},"computed":false},"property":{"type":"Identifier","start":707,"end":713,"name":"server"},"computed":false},"property":{"type":"Identifier","start":714,"end":724,"name":"validHosts"},"computed":false}]},"consequent":{"type":"BlockStatement","start":727,"end":937,"body":[{"type":"VariableDeclaration","start":733,"end":789,"declarations":[{"type":"VariableDeclarator","start":739,"end":789,"id":{"type":"Identifier","start":739,"end":751,"name":"providerName"},"init":{"type":"MemberExpression","start":754,"end":789,"object":{"type":"MemberExpression","start":754,"end":776,"object":{"type":"MemberExpression","start":754,"end":767,"object":{"type":"Identifier","start":754,"end":757,"name":"req"},"property":{"type":"Identifier","start":758,"end":767,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":768,"end":776,"name":"provider"},"computed":false},"property":{"type":"Identifier","start":777,"end":789,"name":"authProvider"},"computed":false}}],"kind":"const"},{"type":"VariableDeclaration","start":794,"end":832,"declarations":[{"type":"VariableDeclarator","start":800,"end":832,"id":{"type":"Identifier","start":800,"end":806,"name":"params"},"init":{"type":"CallExpression","start":809,"end":832,"callee":{"type":"MemberExpression","start":809,"end":821,"object":{"type":"Identifier","start":809,"end":811,"name":"qs"},"property":{"type":"Identifier","start":812,"end":821,"name":"stringify"},"computed":false},"arguments":[{"type":"MemberExpression","start":822,"end":831,"object":{"type":"Identifier","start":822,"end":825,"name":"req"},"property":{"type":"Identifier","start":826,"end":831,"name":"query"},"computed":false}]}}],"kind":"const"},{"type":"VariableDeclaration","start":837,"end":904,"declarations":[{"type":"VariableDeclarator","start":843,"end":904,"id":{"type":"Identifier","start":843,"end":846,"name":"url"},"init":{"type":"TemplateLiteral","start":849,"end":904,"expressions":[{"type":"Identifier","start":852,"end":859,"name":"handler"},{"type":"Identifier","start":871,"end":883,"name":"providerName"},{"type":"Identifier","start":896,"end":902,"name":"params"}],"quasis":[{"type":"TemplateElement","start":850,"end":850,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":860,"end":869,"value":{"raw":"/connect/","cooked":"/connect/"},"tail":false},{"type":"TemplateElement","start":884,"end":894,"value":{"raw":"/callback?","cooked":"/callback?"},"tail":false},{"type":"TemplateElement","start":903,"end":903,"value":{"raw":"","cooked":""},"tail":true}]}}],"kind":"const"},{"type":"ReturnStatement","start":909,"end":933,"argument":{"type":"CallExpression","start":916,"end":933,"callee":{"type":"MemberExpression","start":916,"end":928,"object":{"type":"Identifier","start":916,"end":919,"name":"res"},"property":{"type":"Identifier","start":920,"end":928,"name":"redirect"},"computed":false},"arguments":[{"type":"Identifier","start":929,"end":932,"name":"url"}]}}]},"alternate":null},{"type":"ExpressionStatement","start":941,"end":986,"expression":{"type":"CallExpression","start":941,"end":986,"callee":{"type":"MemberExpression","start":941,"end":961,"object":{"type":"CallExpression","start":941,"end":956,"callee":{"type":"MemberExpression","start":941,"end":951,"object":{"type":"Identifier","start":941,"end":944,"name":"res"},"property":{"type":"Identifier","start":945,"end":951,"name":"status"},"computed":false},"arguments":[{"type":"Literal","start":952,"end":955,"value":400,"raw":"400"}]},"property":{"type":"Identifier","start":957,"end":961,"name":"send"},"computed":false},"arguments":[{"type":"Literal","start":962,"end":985,"value":"Invalid Host in state","raw":"'Invalid Host in state'"}]}}]}}}}],"sourceType":"script"}