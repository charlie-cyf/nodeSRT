{"type":"Program","start":0,"end":17985,"body":[{"type":"VariableDeclaration","start":0,"end":24,"declarations":[{"type":"VariableDeclarator","start":6,"end":24,"id":{"type":"Identifier","start":6,"end":8,"name":"fs"},"init":{"type":"CallExpression","start":11,"end":24,"callee":{"type":"Identifier","start":11,"end":18,"name":"require"},"arguments":[{"type":"Literal","start":19,"end":23,"value":"fs","raw":"'fs'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":25,"end":53,"declarations":[{"type":"VariableDeclarator","start":31,"end":53,"id":{"type":"Identifier","start":31,"end":35,"name":"path"},"init":{"type":"CallExpression","start":38,"end":53,"callee":{"type":"Identifier","start":38,"end":45,"name":"require"},"arguments":[{"type":"Literal","start":46,"end":52,"value":"path","raw":"'path'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":54,"end":90,"declarations":[{"type":"VariableDeclarator","start":60,"end":90,"id":{"type":"Identifier","start":60,"end":63,"name":"tus"},"init":{"type":"CallExpression","start":66,"end":90,"callee":{"type":"Identifier","start":66,"end":73,"name":"require"},"arguments":[{"type":"Literal","start":74,"end":89,"value":"tus-js-client","raw":"'tus-js-client'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":91,"end":119,"declarations":[{"type":"VariableDeclarator","start":97,"end":119,"id":{"type":"Identifier","start":97,"end":101,"name":"uuid"},"init":{"type":"CallExpression","start":104,"end":119,"callee":{"type":"Identifier","start":104,"end":111,"name":"require"},"arguments":[{"type":"Literal","start":112,"end":118,"value":"uuid","raw":"'uuid'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":120,"end":156,"declarations":[{"type":"VariableDeclarator","start":126,"end":156,"id":{"type":"Identifier","start":126,"end":134,"name":"isObject"},"init":{"type":"CallExpression","start":137,"end":156,"callee":{"type":"Identifier","start":137,"end":144,"name":"require"},"arguments":[{"type":"Literal","start":145,"end":155,"value":"isobject","raw":"'isobject'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":157,"end":195,"declarations":[{"type":"VariableDeclarator","start":163,"end":195,"id":{"type":"Identifier","start":163,"end":172,"name":"validator"},"init":{"type":"CallExpression","start":175,"end":195,"callee":{"type":"Identifier","start":175,"end":182,"name":"require"},"arguments":[{"type":"Literal","start":183,"end":194,"value":"validator","raw":"'validator'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":196,"end":230,"declarations":[{"type":"VariableDeclarator","start":202,"end":230,"id":{"type":"Identifier","start":202,"end":209,"name":"request"},"init":{"type":"CallExpression","start":212,"end":230,"callee":{"type":"Identifier","start":212,"end":219,"name":"require"},"arguments":[{"type":"Literal","start":220,"end":229,"value":"request","raw":"'request'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":231,"end":267,"declarations":[{"type":"VariableDeclarator","start":237,"end":267,"id":{"type":"Identifier","start":237,"end":244,"name":"emitter"},"init":{"type":"CallExpression","start":247,"end":267,"callee":{"type":"Identifier","start":247,"end":254,"name":"require"},"arguments":[{"type":"Literal","start":255,"end":266,"value":"./emitter","raw":"'./emitter'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":268,"end":317,"declarations":[{"type":"VariableDeclarator","start":274,"end":317,"id":{"type":"Identifier","start":274,"end":288,"name":"serializeError"},"init":{"type":"CallExpression","start":291,"end":317,"callee":{"type":"Identifier","start":291,"end":298,"name":"require"},"arguments":[{"type":"Literal","start":299,"end":316,"value":"serialize-error","raw":"'serialize-error'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":318,"end":380,"declarations":[{"type":"VariableDeclarator","start":324,"end":380,"id":{"type":"ObjectPattern","start":324,"end":351,"properties":[{"type":"Property","start":326,"end":339,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":326,"end":339,"name":"jsonStringify"},"kind":"init","value":{"type":"Identifier","start":326,"end":339,"name":"jsonStringify"}},{"type":"Property","start":341,"end":349,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":341,"end":349,"name":"hasMatch"},"kind":"init","value":{"type":"Identifier","start":341,"end":349,"name":"hasMatch"}}]},"init":{"type":"CallExpression","start":354,"end":380,"callee":{"type":"Identifier","start":354,"end":361,"name":"require"},"arguments":[{"type":"Literal","start":362,"end":379,"value":"./helpers/utils","raw":"'./helpers/utils'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":381,"end":415,"declarations":[{"type":"VariableDeclarator","start":387,"end":415,"id":{"type":"Identifier","start":387,"end":393,"name":"logger"},"init":{"type":"CallExpression","start":396,"end":415,"callee":{"type":"Identifier","start":396,"end":403,"name":"require"},"arguments":[{"type":"Literal","start":404,"end":414,"value":"./logger","raw":"'./logger'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":416,"end":468,"declarations":[{"type":"VariableDeclarator","start":422,"end":468,"id":{"type":"Identifier","start":422,"end":436,"name":"headerSanitize"},"init":{"type":"CallExpression","start":439,"end":468,"callee":{"type":"Identifier","start":439,"end":446,"name":"require"},"arguments":[{"type":"Literal","start":447,"end":467,"value":"./header-blacklist","raw":"'./header-blacklist'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":469,"end":501,"declarations":[{"type":"VariableDeclarator","start":475,"end":501,"id":{"type":"Identifier","start":475,"end":480,"name":"redis"},"init":{"type":"CallExpression","start":483,"end":501,"callee":{"type":"Identifier","start":483,"end":490,"name":"require"},"arguments":[{"type":"Literal","start":491,"end":500,"value":"./redis","raw":"'./redis'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":503,"end":539,"declarations":[{"type":"VariableDeclarator","start":509,"end":539,"id":{"type":"Identifier","start":509,"end":527,"name":"DEFAULT_FIELD_NAME"},"init":{"type":"Literal","start":530,"end":539,"value":"files[]","raw":"'files[]'"}}],"kind":"const"},{"type":"VariableDeclaration","start":540,"end":646,"declarations":[{"type":"VariableDeclarator","start":546,"end":646,"id":{"type":"Identifier","start":546,"end":555,"name":"PROTOCOLS"},"init":{"type":"CallExpression","start":558,"end":646,"callee":{"type":"MemberExpression","start":558,"end":571,"object":{"type":"Identifier","start":558,"end":564,"name":"Object"},"property":{"type":"Identifier","start":565,"end":571,"name":"freeze"},"computed":false},"arguments":[{"type":"ObjectExpression","start":572,"end":645,"properties":[{"type":"Property","start":576,"end":598,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":576,"end":585,"name":"multipart"},"value":{"type":"Literal","start":587,"end":598,"value":"multipart","raw":"'multipart'"},"kind":"init"},{"type":"Property","start":602,"end":629,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":602,"end":613,"name":"s3Multipart"},"value":{"type":"Literal","start":615,"end":629,"value":"s3-multipart","raw":"'s3-multipart'"},"kind":"init"},{"type":"Property","start":633,"end":643,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":633,"end":636,"name":"tus"},"value":{"type":"Literal","start":638,"end":643,"value":"tus","raw":"'tus'"},"kind":"init"}]}]}}],"kind":"const"},{"type":"ClassDeclaration","start":648,"end":17878,"id":{"type":"Identifier","start":654,"end":662,"name":"Uploader"},"superClass":null,"body":{"type":"ClassBody","start":663,"end":17878,"body":[{"type":"MethodDefinition","start":1439,"end":3216,"kind":"constructor","static":false,"computed":false,"key":{"type":"Identifier","start":1439,"end":1450,"name":"constructor"},"value":{"type":"FunctionExpression","start":1451,"end":3216,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":1452,"end":1459,"name":"options"}],"body":{"type":"BlockStatement","start":1461,"end":3216,"body":[{"type":"IfStatement","start":1467,"end":1591,"test":{"type":"UnaryExpression","start":1471,"end":1501,"operator":"!","prefix":true,"argument":{"type":"CallExpression","start":1472,"end":1501,"callee":{"type":"MemberExpression","start":1472,"end":1492,"object":{"type":"ThisExpression","start":1472,"end":1476},"property":{"type":"Identifier","start":1477,"end":1492,"name":"validateOptions"},"computed":false},"arguments":[{"type":"Identifier","start":1493,"end":1500,"name":"options"}]}},"consequent":{"type":"BlockStatement","start":1503,"end":1591,"body":[{"type":"ExpressionStatement","start":1511,"end":1572,"expression":{"type":"CallExpression","start":1511,"end":1572,"callee":{"type":"MemberExpression","start":1511,"end":1523,"object":{"type":"Identifier","start":1511,"end":1517,"name":"logger"},"property":{"type":"Identifier","start":1518,"end":1523,"name":"debug"},"computed":false},"arguments":[{"type":"MemberExpression","start":1524,"end":1544,"object":{"type":"ThisExpression","start":1524,"end":1528},"property":{"type":"Identifier","start":1529,"end":1544,"name":"_errRespMessage"},"computed":false},{"type":"Literal","start":1546,"end":1571,"value":"uploader.validator.fail","raw":"'uploader.validator.fail'"}]}},{"type":"ReturnStatement","start":1579,"end":1585,"argument":null}]},"alternate":null},{"type":"ExpressionStatement","start":1597,"end":1619,"expression":{"type":"AssignmentExpression","start":1597,"end":1619,"operator":"=","left":{"type":"MemberExpression","start":1597,"end":1609,"object":{"type":"ThisExpression","start":1597,"end":1601},"property":{"type":"Identifier","start":1602,"end":1609,"name":"options"},"computed":false},"right":{"type":"Identifier","start":1612,"end":1619,"name":"options"}}},{"type":"ExpressionStatement","start":1624,"end":1646,"expression":{"type":"AssignmentExpression","start":1624,"end":1646,"operator":"=","left":{"type":"MemberExpression","start":1624,"end":1634,"object":{"type":"ThisExpression","start":1624,"end":1628},"property":{"type":"Identifier","start":1629,"end":1634,"name":"token"},"computed":false},"right":{"type":"CallExpression","start":1637,"end":1646,"callee":{"type":"MemberExpression","start":1637,"end":1644,"object":{"type":"Identifier","start":1637,"end":1641,"name":"uuid"},"property":{"type":"Identifier","start":1642,"end":1644,"name":"v4"},"computed":false},"arguments":[]}}},{"type":"ExpressionStatement","start":1651,"end":1734,"expression":{"type":"AssignmentExpression","start":1651,"end":1734,"operator":"=","left":{"type":"MemberExpression","start":1651,"end":1660,"object":{"type":"ThisExpression","start":1651,"end":1655},"property":{"type":"Identifier","start":1656,"end":1660,"name":"path"},"computed":false},"right":{"type":"TemplateLiteral","start":1663,"end":1734,"expressions":[{"type":"MemberExpression","start":1666,"end":1689,"object":{"type":"MemberExpression","start":1666,"end":1678,"object":{"type":"ThisExpression","start":1666,"end":1670},"property":{"type":"Identifier","start":1671,"end":1678,"name":"options"},"computed":false},"property":{"type":"Identifier","start":1679,"end":1689,"name":"pathPrefix"},"computed":false},{"type":"MemberExpression","start":1693,"end":1718,"object":{"type":"Identifier","start":1693,"end":1701,"name":"Uploader"},"property":{"type":"Identifier","start":1702,"end":1718,"name":"FILE_NAME_PREFIX"},"computed":false},{"type":"MemberExpression","start":1722,"end":1732,"object":{"type":"ThisExpression","start":1722,"end":1726},"property":{"type":"Identifier","start":1727,"end":1732,"name":"token"},"computed":false}],"quasis":[{"type":"TemplateElement","start":1664,"end":1664,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":1690,"end":1691,"value":{"raw":"/","cooked":"/"},"tail":false},{"type":"TemplateElement","start":1719,"end":1720,"value":{"raw":"-","cooked":"-"},"tail":false},{"type":"TemplateElement","start":1733,"end":1733,"value":{"raw":"","cooked":""},"tail":true}]}}},{"type":"ExpressionStatement","start":1739,"end":1790,"expression":{"type":"AssignmentExpression","start":1739,"end":1790,"operator":"=","left":{"type":"MemberExpression","start":1739,"end":1760,"object":{"type":"MemberExpression","start":1739,"end":1751,"object":{"type":"ThisExpression","start":1739,"end":1743},"property":{"type":"Identifier","start":1744,"end":1751,"name":"options"},"computed":false},"property":{"type":"Identifier","start":1752,"end":1760,"name":"metadata"},"computed":false},"right":{"type":"LogicalExpression","start":1763,"end":1790,"left":{"type":"MemberExpression","start":1763,"end":1784,"object":{"type":"MemberExpression","start":1763,"end":1775,"object":{"type":"ThisExpression","start":1763,"end":1767},"property":{"type":"Identifier","start":1768,"end":1775,"name":"options"},"computed":false},"property":{"type":"Identifier","start":1776,"end":1784,"name":"metadata"},"computed":false},"operator":"||","right":{"type":"ObjectExpression","start":1788,"end":1790,"properties":[]}}}},{"type":"ExpressionStatement","start":1795,"end":1864,"expression":{"type":"AssignmentExpression","start":1795,"end":1864,"operator":"=","left":{"type":"MemberExpression","start":1795,"end":1817,"object":{"type":"MemberExpression","start":1795,"end":1807,"object":{"type":"ThisExpression","start":1795,"end":1799},"property":{"type":"Identifier","start":1800,"end":1807,"name":"options"},"computed":false},"property":{"type":"Identifier","start":1808,"end":1817,"name":"fieldname"},"computed":false},"right":{"type":"LogicalExpression","start":1820,"end":1864,"left":{"type":"MemberExpression","start":1820,"end":1842,"object":{"type":"MemberExpression","start":1820,"end":1832,"object":{"type":"ThisExpression","start":1820,"end":1824},"property":{"type":"Identifier","start":1825,"end":1832,"name":"options"},"computed":false},"property":{"type":"Identifier","start":1833,"end":1842,"name":"fieldname"},"computed":false},"operator":"||","right":{"type":"Identifier","start":1846,"end":1864,"name":"DEFAULT_FIELD_NAME"}}}},{"type":"ExpressionStatement","start":1869,"end":1945,"expression":{"type":"AssignmentExpression","start":1869,"end":1945,"operator":"=","left":{"type":"MemberExpression","start":1869,"end":1888,"object":{"type":"ThisExpression","start":1869,"end":1873},"property":{"type":"Identifier","start":1874,"end":1888,"name":"uploadFileName"},"computed":false},"right":{"type":"LogicalExpression","start":1891,"end":1945,"left":{"type":"MemberExpression","start":1891,"end":1917,"object":{"type":"MemberExpression","start":1891,"end":1912,"object":{"type":"MemberExpression","start":1891,"end":1903,"object":{"type":"ThisExpression","start":1891,"end":1895},"property":{"type":"Identifier","start":1896,"end":1903,"name":"options"},"computed":false},"property":{"type":"Identifier","start":1904,"end":1912,"name":"metadata"},"computed":false},"property":{"type":"Identifier","start":1913,"end":1917,"name":"name"},"computed":false},"operator":"||","right":{"type":"CallExpression","start":1921,"end":1945,"callee":{"type":"MemberExpression","start":1921,"end":1934,"object":{"type":"Identifier","start":1921,"end":1925,"name":"path"},"property":{"type":"Identifier","start":1926,"end":1934,"name":"basename"},"computed":false},"arguments":[{"type":"MemberExpression","start":1935,"end":1944,"object":{"type":"ThisExpression","start":1935,"end":1939},"property":{"type":"Identifier","start":1940,"end":1944,"name":"path"},"computed":false}]}}}},{"type":"ExpressionStatement","start":1950,"end":1975,"expression":{"type":"AssignmentExpression","start":1950,"end":1975,"operator":"=","left":{"type":"MemberExpression","start":1950,"end":1967,"object":{"type":"ThisExpression","start":1950,"end":1954},"property":{"type":"Identifier","start":1955,"end":1967,"name":"streamsEnded"},"computed":false},"right":{"type":"Literal","start":1970,"end":1975,"value":false,"raw":"false"}}},{"type":"ExpressionStatement","start":1980,"end":2006,"expression":{"type":"AssignmentExpression","start":1980,"end":2006,"operator":"=","left":{"type":"MemberExpression","start":1980,"end":1998,"object":{"type":"ThisExpression","start":1980,"end":1984},"property":{"type":"Identifier","start":1985,"end":1998,"name":"uploadStopped"},"computed":false},"right":{"type":"Literal","start":2001,"end":2006,"value":false,"raw":"false"}}},{"type":"ExpressionStatement","start":2011,"end":2035,"expression":{"type":"AssignmentExpression","start":2011,"end":2035,"operator":"=","left":{"type":"MemberExpression","start":2011,"end":2028,"object":{"type":"ThisExpression","start":2011,"end":2015},"property":{"type":"Identifier","start":2016,"end":2028,"name":"duplexStream"},"computed":false},"right":{"type":"Literal","start":2031,"end":2035,"value":null,"raw":"null"}}},{"type":"ExpressionStatement","start":2320,"end":2503,"expression":{"type":"AssignmentExpression","start":2320,"end":2503,"operator":"=","left":{"type":"MemberExpression","start":2320,"end":2336,"object":{"type":"ThisExpression","start":2320,"end":2324},"property":{"type":"Identifier","start":2325,"end":2336,"name":"writeStream"},"computed":false},"right":{"type":"CallExpression","start":2339,"end":2503,"callee":{"type":"MemberExpression","start":2339,"end":2420,"object":{"type":"CallExpression","start":2339,"end":2387,"callee":{"type":"MemberExpression","start":2339,"end":2359,"object":{"type":"Identifier","start":2339,"end":2341,"name":"fs"},"property":{"type":"Identifier","start":2342,"end":2359,"name":"createWriteStream"},"computed":false},"arguments":[{"type":"MemberExpression","start":2360,"end":2369,"object":{"type":"ThisExpression","start":2360,"end":2364},"property":{"type":"Identifier","start":2365,"end":2369,"name":"path"},"computed":false},{"type":"ObjectExpression","start":2371,"end":2386,"properties":[{"type":"Property","start":2373,"end":2384,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2373,"end":2377,"name":"mode"},"value":{"type":"Literal","start":2379,"end":2384,"value":438,"raw":"0o666"},"kind":"init"}]}]},"property":{"type":"Identifier","start":2418,"end":2420,"name":"on"},"computed":false},"arguments":[{"type":"Literal","start":2421,"end":2428,"value":"error","raw":"'error'"},{"type":"ArrowFunctionExpression","start":2430,"end":2502,"id":null,"expression":true,"generator":false,"async":false,"params":[{"type":"Identifier","start":2431,"end":2434,"name":"err"}],"body":{"type":"CallExpression","start":2439,"end":2502,"callee":{"type":"MemberExpression","start":2439,"end":2451,"object":{"type":"Identifier","start":2439,"end":2445,"name":"logger"},"property":{"type":"Identifier","start":2446,"end":2451,"name":"error"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":2452,"end":2460,"expressions":[{"type":"Identifier","start":2455,"end":2458,"name":"err"}],"quasis":[{"type":"TemplateElement","start":2453,"end":2453,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":2459,"end":2459,"value":{"raw":"","cooked":""},"tail":true}]},{"type":"Literal","start":2462,"end":2484,"value":"uploader.write.error","raw":"'uploader.write.error'"},{"type":"MemberExpression","start":2486,"end":2501,"object":{"type":"ThisExpression","start":2486,"end":2490},"property":{"type":"Identifier","start":2491,"end":2501,"name":"shortToken"},"computed":false}]}}]}}},{"type":"ExpressionStatement","start":2534,"end":2558,"expression":{"type":"AssignmentExpression","start":2534,"end":2558,"operator":"=","left":{"type":"MemberExpression","start":2534,"end":2554,"object":{"type":"ThisExpression","start":2534,"end":2538},"property":{"type":"Identifier","start":2539,"end":2554,"name":"emittedProgress"},"computed":false},"right":{"type":"Literal","start":2557,"end":2558,"value":0,"raw":"0"}}},{"type":"ExpressionStatement","start":2563,"end":2593,"expression":{"type":"AssignmentExpression","start":2563,"end":2593,"operator":"=","left":{"type":"MemberExpression","start":2563,"end":2575,"object":{"type":"ThisExpression","start":2563,"end":2567},"property":{"type":"Identifier","start":2568,"end":2575,"name":"storage"},"computed":false},"right":{"type":"MemberExpression","start":2578,"end":2593,"object":{"type":"Identifier","start":2578,"end":2585,"name":"options"},"property":{"type":"Identifier","start":2586,"end":2593,"name":"storage"},"computed":false}}},{"type":"ExpressionStatement","start":2598,"end":2618,"expression":{"type":"AssignmentExpression","start":2598,"end":2618,"operator":"=","left":{"type":"MemberExpression","start":2598,"end":2610,"object":{"type":"ThisExpression","start":2598,"end":2602},"property":{"type":"Identifier","start":2603,"end":2610,"name":"_paused"},"computed":false},"right":{"type":"Literal","start":2613,"end":2618,"value":false,"raw":"false"}}},{"type":"IfStatement","start":2624,"end":3212,"test":{"type":"BinaryExpression","start":2628,"end":2667,"left":{"type":"MemberExpression","start":2628,"end":2649,"object":{"type":"MemberExpression","start":2628,"end":2640,"object":{"type":"ThisExpression","start":2628,"end":2632},"property":{"type":"Identifier","start":2633,"end":2640,"name":"options"},"computed":false},"property":{"type":"Identifier","start":2641,"end":2649,"name":"protocol"},"computed":false},"operator":"===","right":{"type":"MemberExpression","start":2654,"end":2667,"object":{"type":"Identifier","start":2654,"end":2663,"name":"PROTOCOLS"},"property":{"type":"Identifier","start":2664,"end":2667,"name":"tus"},"computed":false}},"consequent":{"type":"BlockStatement","start":2669,"end":3212,"body":[{"type":"ExpressionStatement","start":2677,"end":2818,"expression":{"type":"CallExpression","start":2677,"end":2818,"callee":{"type":"MemberExpression","start":2677,"end":2689,"object":{"type":"CallExpression","start":2677,"end":2686,"callee":{"type":"Identifier","start":2677,"end":2684,"name":"emitter"},"arguments":[]},"property":{"type":"Identifier","start":2687,"end":2689,"name":"on"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":2690,"end":2711,"expressions":[{"type":"MemberExpression","start":2699,"end":2709,"object":{"type":"ThisExpression","start":2699,"end":2703},"property":{"type":"Identifier","start":2704,"end":2709,"name":"token"},"computed":false}],"quasis":[{"type":"TemplateElement","start":2691,"end":2697,"value":{"raw":"pause:","cooked":"pause:"},"tail":false},{"type":"TemplateElement","start":2710,"end":2710,"value":{"raw":"","cooked":""},"tail":true}]},{"type":"ArrowFunctionExpression","start":2713,"end":2817,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":2719,"end":2817,"body":[{"type":"ExpressionStatement","start":2729,"end":2748,"expression":{"type":"AssignmentExpression","start":2729,"end":2748,"operator":"=","left":{"type":"MemberExpression","start":2729,"end":2741,"object":{"type":"ThisExpression","start":2729,"end":2733},"property":{"type":"Identifier","start":2734,"end":2741,"name":"_paused"},"computed":false},"right":{"type":"Literal","start":2744,"end":2748,"value":true,"raw":"true"}}},{"type":"IfStatement","start":2757,"end":2809,"test":{"type":"MemberExpression","start":2761,"end":2769,"object":{"type":"ThisExpression","start":2761,"end":2765},"property":{"type":"Identifier","start":2766,"end":2769,"name":"tus"},"computed":false},"consequent":{"type":"BlockStatement","start":2771,"end":2809,"body":[{"type":"ExpressionStatement","start":2783,"end":2799,"expression":{"type":"CallExpression","start":2783,"end":2799,"callee":{"type":"MemberExpression","start":2783,"end":2797,"object":{"type":"MemberExpression","start":2783,"end":2791,"object":{"type":"ThisExpression","start":2783,"end":2787},"property":{"type":"Identifier","start":2788,"end":2791,"name":"tus"},"computed":false},"property":{"type":"Identifier","start":2792,"end":2797,"name":"abort"},"computed":false},"arguments":[]}}]},"alternate":null}]}}]}},{"type":"ExpressionStatement","start":2826,"end":2969,"expression":{"type":"CallExpression","start":2826,"end":2969,"callee":{"type":"MemberExpression","start":2826,"end":2838,"object":{"type":"CallExpression","start":2826,"end":2835,"callee":{"type":"Identifier","start":2826,"end":2833,"name":"emitter"},"arguments":[]},"property":{"type":"Identifier","start":2836,"end":2838,"name":"on"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":2839,"end":2861,"expressions":[{"type":"MemberExpression","start":2849,"end":2859,"object":{"type":"ThisExpression","start":2849,"end":2853},"property":{"type":"Identifier","start":2854,"end":2859,"name":"token"},"computed":false}],"quasis":[{"type":"TemplateElement","start":2840,"end":2847,"value":{"raw":"resume:","cooked":"resume:"},"tail":false},{"type":"TemplateElement","start":2860,"end":2860,"value":{"raw":"","cooked":""},"tail":true}]},{"type":"ArrowFunctionExpression","start":2863,"end":2968,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":2869,"end":2968,"body":[{"type":"ExpressionStatement","start":2879,"end":2899,"expression":{"type":"AssignmentExpression","start":2879,"end":2899,"operator":"=","left":{"type":"MemberExpression","start":2879,"end":2891,"object":{"type":"ThisExpression","start":2879,"end":2883},"property":{"type":"Identifier","start":2884,"end":2891,"name":"_paused"},"computed":false},"right":{"type":"Literal","start":2894,"end":2899,"value":false,"raw":"false"}}},{"type":"IfStatement","start":2908,"end":2960,"test":{"type":"MemberExpression","start":2912,"end":2920,"object":{"type":"ThisExpression","start":2912,"end":2916},"property":{"type":"Identifier","start":2917,"end":2920,"name":"tus"},"computed":false},"consequent":{"type":"BlockStatement","start":2922,"end":2960,"body":[{"type":"ExpressionStatement","start":2934,"end":2950,"expression":{"type":"CallExpression","start":2934,"end":2950,"callee":{"type":"MemberExpression","start":2934,"end":2948,"object":{"type":"MemberExpression","start":2934,"end":2942,"object":{"type":"ThisExpression","start":2934,"end":2938},"property":{"type":"Identifier","start":2939,"end":2942,"name":"tus"},"computed":false},"property":{"type":"Identifier","start":2943,"end":2948,"name":"start"},"computed":false},"arguments":[]}}]},"alternate":null}]}}]}},{"type":"ExpressionStatement","start":2977,"end":3206,"expression":{"type":"CallExpression","start":2977,"end":3206,"callee":{"type":"MemberExpression","start":2977,"end":2989,"object":{"type":"CallExpression","start":2977,"end":2986,"callee":{"type":"Identifier","start":2977,"end":2984,"name":"emitter"},"arguments":[]},"property":{"type":"Identifier","start":2987,"end":2989,"name":"on"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":2990,"end":3012,"expressions":[{"type":"MemberExpression","start":3000,"end":3010,"object":{"type":"ThisExpression","start":3000,"end":3004},"property":{"type":"Identifier","start":3005,"end":3010,"name":"token"},"computed":false}],"quasis":[{"type":"TemplateElement","start":2991,"end":2998,"value":{"raw":"cancel:","cooked":"cancel:"},"tail":false},{"type":"TemplateElement","start":3011,"end":3011,"value":{"raw":"","cooked":""},"tail":true}]},{"type":"ArrowFunctionExpression","start":3014,"end":3205,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":3020,"end":3205,"body":[{"type":"ExpressionStatement","start":3030,"end":3049,"expression":{"type":"AssignmentExpression","start":3030,"end":3049,"operator":"=","left":{"type":"MemberExpression","start":3030,"end":3042,"object":{"type":"ThisExpression","start":3030,"end":3034},"property":{"type":"Identifier","start":3035,"end":3042,"name":"_paused"},"computed":false},"right":{"type":"Literal","start":3045,"end":3049,"value":true,"raw":"true"}}},{"type":"IfStatement","start":3058,"end":3174,"test":{"type":"MemberExpression","start":3062,"end":3070,"object":{"type":"ThisExpression","start":3062,"end":3066},"property":{"type":"Identifier","start":3067,"end":3070,"name":"tus"},"computed":false},"consequent":{"type":"BlockStatement","start":3072,"end":3174,"body":[{"type":"VariableDeclaration","start":3084,"end":3122,"declarations":[{"type":"VariableDeclarator","start":3090,"end":3122,"id":{"type":"Identifier","start":3090,"end":3105,"name":"shouldTerminate"},"init":{"type":"UnaryExpression","start":3108,"end":3122,"operator":"!","prefix":true,"argument":{"type":"UnaryExpression","start":3109,"end":3122,"operator":"!","prefix":true,"argument":{"type":"MemberExpression","start":3110,"end":3122,"object":{"type":"MemberExpression","start":3110,"end":3118,"object":{"type":"ThisExpression","start":3110,"end":3114},"property":{"type":"Identifier","start":3115,"end":3118,"name":"tus"},"computed":false},"property":{"type":"Identifier","start":3119,"end":3122,"name":"url"},"computed":false}}}}],"kind":"const"},{"type":"ExpressionStatement","start":3133,"end":3164,"expression":{"type":"CallExpression","start":3133,"end":3164,"callee":{"type":"MemberExpression","start":3133,"end":3147,"object":{"type":"MemberExpression","start":3133,"end":3141,"object":{"type":"ThisExpression","start":3133,"end":3137},"property":{"type":"Identifier","start":3138,"end":3141,"name":"tus"},"computed":false},"property":{"type":"Identifier","start":3142,"end":3147,"name":"abort"},"computed":false},"arguments":[{"type":"Identifier","start":3148,"end":3163,"name":"shouldTerminate"}]}}]},"alternate":null},{"type":"ExpressionStatement","start":3183,"end":3197,"expression":{"type":"CallExpression","start":3183,"end":3197,"callee":{"type":"MemberExpression","start":3183,"end":3195,"object":{"type":"ThisExpression","start":3183,"end":3187},"property":{"type":"Identifier","start":3188,"end":3195,"name":"cleanUp"},"computed":false},"arguments":[]}}]}}]}}]},"alternate":null}]}}},{"type":"MethodDefinition","start":3510,"end":3576,"kind":"method","static":true,"computed":false,"key":{"type":"Identifier","start":3517,"end":3529,"name":"shortenToken"},"value":{"type":"FunctionExpression","start":3530,"end":3576,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":3531,"end":3536,"name":"token"}],"body":{"type":"BlockStatement","start":3538,"end":3576,"body":[{"type":"ReturnStatement","start":3544,"end":3572,"argument":{"type":"CallExpression","start":3551,"end":3572,"callee":{"type":"MemberExpression","start":3551,"end":3566,"object":{"type":"Identifier","start":3551,"end":3556,"name":"token"},"property":{"type":"Identifier","start":3557,"end":3566,"name":"substring"},"computed":false},"arguments":[{"type":"Literal","start":3567,"end":3568,"value":0,"raw":"0"},{"type":"Literal","start":3570,"end":3571,"value":8,"raw":"8"}]}}]}}},{"type":"MethodDefinition","start":3580,"end":4364,"kind":"method","static":true,"computed":false,"key":{"type":"Identifier","start":3587,"end":3599,"name":"reqToOptions"},"value":{"type":"FunctionExpression","start":3600,"end":4364,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":3601,"end":3604,"name":"req"},{"type":"Identifier","start":3606,"end":3610,"name":"size"}],"body":{"type":"BlockStatement","start":3612,"end":4364,"body":[{"type":"VariableDeclaration","start":3618,"end":3704,"declarations":[{"type":"VariableDeclarator","start":3624,"end":3704,"id":{"type":"Identifier","start":3624,"end":3640,"name":"useFormDataIsSet"},"init":{"type":"CallExpression","start":3643,"end":3704,"callee":{"type":"MemberExpression","start":3643,"end":3679,"object":{"type":"MemberExpression","start":3643,"end":3674,"object":{"type":"MemberExpression","start":3643,"end":3659,"object":{"type":"Identifier","start":3643,"end":3649,"name":"Object"},"property":{"type":"Identifier","start":3650,"end":3659,"name":"prototype"},"computed":false},"property":{"type":"Identifier","start":3660,"end":3674,"name":"hasOwnProperty"},"computed":false},"property":{"type":"Identifier","start":3675,"end":3679,"name":"call"},"computed":false},"arguments":[{"type":"MemberExpression","start":3680,"end":3688,"object":{"type":"Identifier","start":3680,"end":3683,"name":"req"},"property":{"type":"Identifier","start":3684,"end":3688,"name":"body"},"computed":false},{"type":"Literal","start":3690,"end":3703,"value":"useFormData","raw":"'useFormData'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":3709,"end":3775,"declarations":[{"type":"VariableDeclarator","start":3715,"end":3775,"id":{"type":"Identifier","start":3715,"end":3726,"name":"useFormData"},"init":{"type":"ConditionalExpression","start":3729,"end":3775,"test":{"type":"Identifier","start":3729,"end":3745,"name":"useFormDataIsSet"},"consequent":{"type":"MemberExpression","start":3748,"end":3768,"object":{"type":"MemberExpression","start":3748,"end":3756,"object":{"type":"Identifier","start":3748,"end":3751,"name":"req"},"property":{"type":"Identifier","start":3752,"end":3756,"name":"body"},"computed":false},"property":{"type":"Identifier","start":3757,"end":3768,"name":"useFormData"},"computed":false},"alternate":{"type":"Literal","start":3771,"end":3775,"value":true,"raw":"true"}}}],"kind":"const"},{"type":"ReturnStatement","start":3781,"end":4360,"argument":{"type":"ObjectExpression","start":3788,"end":4360,"properties":[{"type":"Property","start":3796,"end":3835,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3796,"end":3812,"name":"companionOptions"},"value":{"type":"MemberExpression","start":3814,"end":3835,"object":{"type":"MemberExpression","start":3814,"end":3827,"object":{"type":"Identifier","start":3814,"end":3817,"name":"req"},"property":{"type":"Identifier","start":3818,"end":3827,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":3828,"end":3835,"name":"options"},"computed":false},"kind":"init"},{"type":"Property","start":3843,"end":3870,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3843,"end":3851,"name":"endpoint"},"value":{"type":"MemberExpression","start":3853,"end":3870,"object":{"type":"MemberExpression","start":3853,"end":3861,"object":{"type":"Identifier","start":3853,"end":3856,"name":"req"},"property":{"type":"Identifier","start":3857,"end":3861,"name":"body"},"computed":false},"property":{"type":"Identifier","start":3862,"end":3870,"name":"endpoint"},"computed":false},"kind":"init"},{"type":"Property","start":3878,"end":3907,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3878,"end":3887,"name":"uploadUrl"},"value":{"type":"MemberExpression","start":3889,"end":3907,"object":{"type":"MemberExpression","start":3889,"end":3897,"object":{"type":"Identifier","start":3889,"end":3892,"name":"req"},"property":{"type":"Identifier","start":3893,"end":3897,"name":"body"},"computed":false},"property":{"type":"Identifier","start":3898,"end":3907,"name":"uploadUrl"},"computed":false},"kind":"init"},{"type":"Property","start":3915,"end":3942,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3915,"end":3923,"name":"protocol"},"value":{"type":"MemberExpression","start":3925,"end":3942,"object":{"type":"MemberExpression","start":3925,"end":3933,"object":{"type":"Identifier","start":3925,"end":3928,"name":"req"},"property":{"type":"Identifier","start":3929,"end":3933,"name":"body"},"computed":false},"property":{"type":"Identifier","start":3934,"end":3942,"name":"protocol"},"computed":false},"kind":"init"},{"type":"Property","start":3950,"end":3977,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3950,"end":3958,"name":"metadata"},"value":{"type":"MemberExpression","start":3960,"end":3977,"object":{"type":"MemberExpression","start":3960,"end":3968,"object":{"type":"Identifier","start":3960,"end":3963,"name":"req"},"property":{"type":"Identifier","start":3964,"end":3968,"name":"body"},"computed":false},"property":{"type":"Identifier","start":3969,"end":3977,"name":"metadata"},"computed":false},"kind":"init"},{"type":"Property","start":3985,"end":4016,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3985,"end":3995,"name":"httpMethod"},"value":{"type":"MemberExpression","start":3997,"end":4016,"object":{"type":"MemberExpression","start":3997,"end":4005,"object":{"type":"Identifier","start":3997,"end":4000,"name":"req"},"property":{"type":"Identifier","start":4001,"end":4005,"name":"body"},"computed":false},"property":{"type":"Identifier","start":4006,"end":4016,"name":"httpMethod"},"computed":false},"kind":"init"},{"type":"Property","start":4024,"end":4035,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":4024,"end":4035,"name":"useFormData"},"kind":"init","value":{"type":"Identifier","start":4024,"end":4035,"name":"useFormData"}},{"type":"Property","start":4043,"end":4047,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":4043,"end":4047,"name":"size"},"kind":"init","value":{"type":"Identifier","start":4043,"end":4047,"name":"size"}},{"type":"Property","start":4055,"end":4084,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4055,"end":4064,"name":"fieldname"},"value":{"type":"MemberExpression","start":4066,"end":4084,"object":{"type":"MemberExpression","start":4066,"end":4074,"object":{"type":"Identifier","start":4066,"end":4069,"name":"req"},"property":{"type":"Identifier","start":4070,"end":4074,"name":"body"},"computed":false},"property":{"type":"Identifier","start":4075,"end":4084,"name":"fieldname"},"computed":false},"kind":"init"},{"type":"Property","start":4092,"end":4139,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4092,"end":4102,"name":"pathPrefix"},"value":{"type":"TemplateLiteral","start":4104,"end":4139,"expressions":[{"type":"MemberExpression","start":4107,"end":4137,"object":{"type":"MemberExpression","start":4107,"end":4128,"object":{"type":"MemberExpression","start":4107,"end":4120,"object":{"type":"Identifier","start":4107,"end":4110,"name":"req"},"property":{"type":"Identifier","start":4111,"end":4120,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":4121,"end":4128,"name":"options"},"computed":false},"property":{"type":"Identifier","start":4129,"end":4137,"name":"filePath"},"computed":false}],"quasis":[{"type":"TemplateElement","start":4105,"end":4105,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":4138,"end":4138,"value":{"raw":"","cooked":""},"tail":true}]},"kind":"init"},{"type":"Property","start":4147,"end":4170,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4147,"end":4154,"name":"storage"},"value":{"type":"CallExpression","start":4156,"end":4170,"callee":{"type":"MemberExpression","start":4156,"end":4168,"object":{"type":"Identifier","start":4156,"end":4161,"name":"redis"},"property":{"type":"Identifier","start":4162,"end":4168,"name":"client"},"computed":false},"arguments":[]},"kind":"init"},{"type":"Property","start":4178,"end":4321,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4178,"end":4180,"name":"s3"},"value":{"type":"ConditionalExpression","start":4182,"end":4321,"test":{"type":"MemberExpression","start":4182,"end":4204,"object":{"type":"MemberExpression","start":4182,"end":4195,"object":{"type":"Identifier","start":4182,"end":4185,"name":"req"},"property":{"type":"Identifier","start":4186,"end":4195,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":4196,"end":4204,"name":"s3Client"},"computed":false},"consequent":{"type":"ObjectExpression","start":4207,"end":4314,"properties":[{"type":"Property","start":4217,"end":4247,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4217,"end":4223,"name":"client"},"value":{"type":"MemberExpression","start":4225,"end":4247,"object":{"type":"MemberExpression","start":4225,"end":4238,"object":{"type":"Identifier","start":4225,"end":4228,"name":"req"},"property":{"type":"Identifier","start":4229,"end":4238,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":4239,"end":4247,"name":"s3Client"},"computed":false},"kind":"init"},{"type":"Property","start":4257,"end":4306,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4257,"end":4264,"name":"options"},"value":{"type":"MemberExpression","start":4266,"end":4306,"object":{"type":"MemberExpression","start":4266,"end":4303,"object":{"type":"MemberExpression","start":4266,"end":4287,"object":{"type":"MemberExpression","start":4266,"end":4279,"object":{"type":"Identifier","start":4266,"end":4269,"name":"req"},"property":{"type":"Identifier","start":4270,"end":4279,"name":"companion"},"computed":false},"property":{"type":"Identifier","start":4280,"end":4287,"name":"options"},"computed":false},"property":{"type":"Identifier","start":4288,"end":4303,"name":"providerOptions"},"computed":false},"property":{"type":"Identifier","start":4304,"end":4306,"name":"s3"},"computed":false},"kind":"init"}]},"alternate":{"type":"Literal","start":4317,"end":4321,"value":null,"raw":"null"}},"kind":"init"},{"type":"Property","start":4329,"end":4354,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4329,"end":4336,"name":"headers"},"value":{"type":"MemberExpression","start":4338,"end":4354,"object":{"type":"MemberExpression","start":4338,"end":4346,"object":{"type":"Identifier","start":4338,"end":4341,"name":"req"},"property":{"type":"Identifier","start":4342,"end":4346,"name":"body"},"computed":false},"property":{"type":"Identifier","start":4347,"end":4354,"name":"headers"},"computed":false},"kind":"init"}]}}]}}},{"type":"MethodDefinition","start":4430,"end":4496,"kind":"get","static":false,"computed":false,"key":{"type":"Identifier","start":4434,"end":4446,"name":"bytesWritten"},"value":{"type":"FunctionExpression","start":4447,"end":4496,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":4450,"end":4496,"body":[{"type":"ReturnStatement","start":4456,"end":4492,"argument":{"type":"MemberExpression","start":4463,"end":4492,"object":{"type":"MemberExpression","start":4463,"end":4479,"object":{"type":"ThisExpression","start":4463,"end":4467},"property":{"type":"Identifier","start":4468,"end":4479,"name":"writeStream"},"computed":false},"property":{"type":"Identifier","start":4480,"end":4492,"name":"bytesWritten"},"computed":false}}]}}},{"type":"MethodDefinition","start":4633,"end":6836,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":4633,"end":4648,"name":"validateOptions"},"value":{"type":"FunctionExpression","start":4649,"end":6836,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":4650,"end":4657,"name":"options"}],"body":{"type":"BlockStatement","start":4659,"end":6836,"body":[{"type":"IfStatement","start":4693,"end":5074,"test":{"type":"MemberExpression","start":4697,"end":4715,"object":{"type":"Identifier","start":4697,"end":4704,"name":"options"},"property":{"type":"Identifier","start":4705,"end":4715,"name":"httpMethod"},"computed":false},"consequent":{"type":"BlockStatement","start":4717,"end":5074,"body":[{"type":"IfStatement","start":4725,"end":4866,"test":{"type":"BinaryExpression","start":4729,"end":4767,"left":{"type":"UnaryExpression","start":4729,"end":4754,"operator":"typeof","prefix":true,"argument":{"type":"MemberExpression","start":4736,"end":4754,"object":{"type":"Identifier","start":4736,"end":4743,"name":"options"},"property":{"type":"Identifier","start":4744,"end":4754,"name":"httpMethod"},"computed":false}},"operator":"!==","right":{"type":"Literal","start":4759,"end":4767,"value":"string","raw":"'string'"}},"consequent":{"type":"BlockStatement","start":4769,"end":4866,"body":[{"type":"ExpressionStatement","start":4779,"end":4837,"expression":{"type":"AssignmentExpression","start":4779,"end":4837,"operator":"=","left":{"type":"MemberExpression","start":4779,"end":4799,"object":{"type":"ThisExpression","start":4779,"end":4783},"property":{"type":"Identifier","start":4784,"end":4799,"name":"_errRespMessage"},"computed":false},"right":{"type":"Literal","start":4802,"end":4837,"value":"unsupported HTTP METHOD specified","raw":"'unsupported HTTP METHOD specified'"}}},{"type":"ReturnStatement","start":4846,"end":4858,"argument":{"type":"Literal","start":4853,"end":4858,"value":false,"raw":"false"}}]},"alternate":null},{"type":"VariableDeclaration","start":4874,"end":4921,"declarations":[{"type":"VariableDeclarator","start":4880,"end":4921,"id":{"type":"Identifier","start":4880,"end":4886,"name":"method"},"init":{"type":"CallExpression","start":4889,"end":4921,"callee":{"type":"MemberExpression","start":4889,"end":4919,"object":{"type":"MemberExpression","start":4889,"end":4907,"object":{"type":"Identifier","start":4889,"end":4896,"name":"options"},"property":{"type":"Identifier","start":4897,"end":4907,"name":"httpMethod"},"computed":false},"property":{"type":"Identifier","start":4908,"end":4919,"name":"toLowerCase"},"computed":false},"arguments":[]}}],"kind":"const"},{"type":"IfStatement","start":4928,"end":5068,"test":{"type":"LogicalExpression","start":4932,"end":4969,"left":{"type":"BinaryExpression","start":4932,"end":4948,"left":{"type":"Identifier","start":4932,"end":4938,"name":"method"},"operator":"!==","right":{"type":"Literal","start":4943,"end":4948,"value":"put","raw":"'put'"}},"operator":"&&","right":{"type":"BinaryExpression","start":4952,"end":4969,"left":{"type":"Identifier","start":4952,"end":4958,"name":"method"},"operator":"!==","right":{"type":"Literal","start":4963,"end":4969,"value":"post","raw":"'post'"}}},"consequent":{"type":"BlockStatement","start":4971,"end":5068,"body":[{"type":"ExpressionStatement","start":4981,"end":5039,"expression":{"type":"AssignmentExpression","start":4981,"end":5039,"operator":"=","left":{"type":"MemberExpression","start":4981,"end":5001,"object":{"type":"ThisExpression","start":4981,"end":4985},"property":{"type":"Identifier","start":4986,"end":5001,"name":"_errRespMessage"},"computed":false},"right":{"type":"Literal","start":5004,"end":5039,"value":"unsupported HTTP METHOD specified","raw":"'unsupported HTTP METHOD specified'"}}},{"type":"ReturnStatement","start":5048,"end":5060,"argument":{"type":"Literal","start":5055,"end":5060,"value":false,"raw":"false"}}]},"alternate":null}]},"alternate":null},{"type":"IfStatement","start":5106,"end":5254,"test":{"type":"LogicalExpression","start":5110,"end":5168,"left":{"type":"MemberExpression","start":5110,"end":5127,"object":{"type":"Identifier","start":5110,"end":5117,"name":"options"},"property":{"type":"Identifier","start":5118,"end":5127,"name":"fieldname"},"computed":false},"operator":"&&","right":{"type":"BinaryExpression","start":5131,"end":5168,"left":{"type":"UnaryExpression","start":5131,"end":5155,"operator":"typeof","prefix":true,"argument":{"type":"MemberExpression","start":5138,"end":5155,"object":{"type":"Identifier","start":5138,"end":5145,"name":"options"},"property":{"type":"Identifier","start":5146,"end":5155,"name":"fieldname"},"computed":false}},"operator":"!==","right":{"type":"Literal","start":5160,"end":5168,"value":"string","raw":"'string'"}}},"consequent":{"type":"BlockStatement","start":5170,"end":5254,"body":[{"type":"ExpressionStatement","start":5178,"end":5229,"expression":{"type":"AssignmentExpression","start":5178,"end":5229,"operator":"=","left":{"type":"MemberExpression","start":5178,"end":5198,"object":{"type":"ThisExpression","start":5178,"end":5182},"property":{"type":"Identifier","start":5183,"end":5198,"name":"_errRespMessage"},"computed":false},"right":{"type":"Literal","start":5201,"end":5229,"value":"fieldname must be a string","raw":"'fieldname must be a string'"}}},{"type":"ReturnStatement","start":5236,"end":5248,"argument":{"type":"Literal","start":5243,"end":5248,"value":false,"raw":"false"}}]},"alternate":null},{"type":"IfStatement","start":5285,"end":5422,"test":{"type":"LogicalExpression","start":5289,"end":5336,"left":{"type":"MemberExpression","start":5289,"end":5305,"object":{"type":"Identifier","start":5289,"end":5296,"name":"options"},"property":{"type":"Identifier","start":5297,"end":5305,"name":"metadata"},"computed":false},"operator":"&&","right":{"type":"UnaryExpression","start":5309,"end":5336,"operator":"!","prefix":true,"argument":{"type":"CallExpression","start":5310,"end":5336,"callee":{"type":"Identifier","start":5310,"end":5318,"name":"isObject"},"arguments":[{"type":"MemberExpression","start":5319,"end":5335,"object":{"type":"Identifier","start":5319,"end":5326,"name":"options"},"property":{"type":"Identifier","start":5327,"end":5335,"name":"metadata"},"computed":false}]}}},"consequent":{"type":"BlockStatement","start":5338,"end":5422,"body":[{"type":"ExpressionStatement","start":5346,"end":5397,"expression":{"type":"AssignmentExpression","start":5346,"end":5397,"operator":"=","left":{"type":"MemberExpression","start":5346,"end":5366,"object":{"type":"ThisExpression","start":5346,"end":5350},"property":{"type":"Identifier","start":5351,"end":5366,"name":"_errRespMessage"},"computed":false},"right":{"type":"Literal","start":5369,"end":5397,"value":"metadata must be an object","raw":"'metadata must be an object'"}}},{"type":"ReturnStatement","start":5404,"end":5416,"argument":{"type":"Literal","start":5411,"end":5416,"value":false,"raw":"false"}}]},"alternate":null},{"type":"IfStatement","start":5452,"end":5586,"test":{"type":"LogicalExpression","start":5456,"end":5501,"left":{"type":"MemberExpression","start":5456,"end":5471,"object":{"type":"Identifier","start":5456,"end":5463,"name":"options"},"property":{"type":"Identifier","start":5464,"end":5471,"name":"headers"},"computed":false},"operator":"&&","right":{"type":"UnaryExpression","start":5475,"end":5501,"operator":"!","prefix":true,"argument":{"type":"CallExpression","start":5476,"end":5501,"callee":{"type":"Identifier","start":5476,"end":5484,"name":"isObject"},"arguments":[{"type":"MemberExpression","start":5485,"end":5500,"object":{"type":"Identifier","start":5485,"end":5492,"name":"options"},"property":{"type":"Identifier","start":5493,"end":5500,"name":"headers"},"computed":false}]}}},"consequent":{"type":"BlockStatement","start":5503,"end":5586,"body":[{"type":"ExpressionStatement","start":5511,"end":5561,"expression":{"type":"AssignmentExpression","start":5511,"end":5561,"operator":"=","left":{"type":"MemberExpression","start":5511,"end":5531,"object":{"type":"ThisExpression","start":5511,"end":5515},"property":{"type":"Identifier","start":5516,"end":5531,"name":"_errRespMessage"},"computed":false},"right":{"type":"Literal","start":5534,"end":5561,"value":"headers must be an object","raw":"'headers must be an object'"}}},{"type":"ReturnStatement","start":5568,"end":5580,"argument":{"type":"Literal","start":5575,"end":5580,"value":false,"raw":"false"}}]},"alternate":null},{"type":"IfStatement","start":5709,"end":5897,"test":{"type":"LogicalExpression","start":5713,"end":5807,"left":{"type":"MemberExpression","start":5713,"end":5729,"object":{"type":"Identifier","start":5713,"end":5720,"name":"options"},"property":{"type":"Identifier","start":5721,"end":5729,"name":"protocol"},"computed":false},"operator":"&&","right":{"type":"UnaryExpression","start":5733,"end":5807,"operator":"!","prefix":true,"argument":{"type":"CallExpression","start":5734,"end":5807,"callee":{"type":"MemberExpression","start":5734,"end":5761,"object":{"type":"CallExpression","start":5734,"end":5756,"callee":{"type":"MemberExpression","start":5734,"end":5745,"object":{"type":"Identifier","start":5734,"end":5740,"name":"Object"},"property":{"type":"Identifier","start":5741,"end":5745,"name":"keys"},"computed":false},"arguments":[{"type":"Identifier","start":5746,"end":5755,"name":"PROTOCOLS"}]},"property":{"type":"Identifier","start":5757,"end":5761,"name":"some"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":5762,"end":5806,"id":null,"expression":true,"generator":false,"async":false,"params":[{"type":"Identifier","start":5763,"end":5766,"name":"key"}],"body":{"type":"BinaryExpression","start":5771,"end":5806,"left":{"type":"MemberExpression","start":5771,"end":5785,"object":{"type":"Identifier","start":5771,"end":5780,"name":"PROTOCOLS"},"property":{"type":"Identifier","start":5781,"end":5784,"name":"key"},"computed":true},"operator":"===","right":{"type":"MemberExpression","start":5790,"end":5806,"object":{"type":"Identifier","start":5790,"end":5797,"name":"options"},"property":{"type":"Identifier","start":5798,"end":5806,"name":"protocol"},"computed":false}}}]}}},"consequent":{"type":"BlockStatement","start":5809,"end":5897,"body":[{"type":"ExpressionStatement","start":5817,"end":5872,"expression":{"type":"AssignmentExpression","start":5817,"end":5872,"operator":"=","left":{"type":"MemberExpression","start":5817,"end":5837,"object":{"type":"ThisExpression","start":5817,"end":5821},"property":{"type":"Identifier","start":5822,"end":5837,"name":"_errRespMessage"},"computed":false},"right":{"type":"Literal","start":5840,"end":5872,"value":"unsupported protocol specified","raw":"'unsupported protocol specified'"}}},{"type":"ReturnStatement","start":5879,"end":5891,"argument":{"type":"Literal","start":5886,"end":5891,"value":false,"raw":"false"}}]},"alternate":null},{"type":"IfStatement","start":6044,"end":6117,"test":{"type":"BinaryExpression","start":6048,"end":6090,"left":{"type":"MemberExpression","start":6048,"end":6064,"object":{"type":"Identifier","start":6048,"end":6055,"name":"options"},"property":{"type":"Identifier","start":6056,"end":6064,"name":"protocol"},"computed":false},"operator":"===","right":{"type":"MemberExpression","start":6069,"end":6090,"object":{"type":"Identifier","start":6069,"end":6078,"name":"PROTOCOLS"},"property":{"type":"Identifier","start":6079,"end":6090,"name":"s3Multipart"},"computed":false}},"consequent":{"type":"BlockStatement","start":6092,"end":6117,"body":[{"type":"ReturnStatement","start":6100,"end":6111,"argument":{"type":"Literal","start":6107,"end":6111,"value":true,"raw":"true"}}]},"alternate":null},{"type":"IfStatement","start":6123,"end":6250,"test":{"type":"LogicalExpression","start":6127,"end":6166,"left":{"type":"UnaryExpression","start":6127,"end":6144,"operator":"!","prefix":true,"argument":{"type":"MemberExpression","start":6128,"end":6144,"object":{"type":"Identifier","start":6128,"end":6135,"name":"options"},"property":{"type":"Identifier","start":6136,"end":6144,"name":"endpoint"},"computed":false}},"operator":"&&","right":{"type":"UnaryExpression","start":6148,"end":6166,"operator":"!","prefix":true,"argument":{"type":"MemberExpression","start":6149,"end":6166,"object":{"type":"Identifier","start":6149,"end":6156,"name":"options"},"property":{"type":"Identifier","start":6157,"end":6166,"name":"uploadUrl"},"computed":false}}},"consequent":{"type":"BlockStatement","start":6168,"end":6250,"body":[{"type":"ExpressionStatement","start":6176,"end":6225,"expression":{"type":"AssignmentExpression","start":6176,"end":6225,"operator":"=","left":{"type":"MemberExpression","start":6176,"end":6196,"object":{"type":"ThisExpression","start":6176,"end":6180},"property":{"type":"Identifier","start":6181,"end":6196,"name":"_errRespMessage"},"computed":false},"right":{"type":"Literal","start":6199,"end":6225,"value":"no destination specified","raw":"'no destination specified'"}}},{"type":"ReturnStatement","start":6232,"end":6244,"argument":{"type":"Literal","start":6239,"end":6244,"value":false,"raw":"false"}}]},"alternate":null},{"type":"VariableDeclaration","start":6256,"end":6350,"declarations":[{"type":"VariableDeclarator","start":6262,"end":6350,"id":{"type":"Identifier","start":6262,"end":6275,"name":"validatorOpts"},"init":{"type":"ObjectExpression","start":6278,"end":6350,"properties":[{"type":"Property","start":6280,"end":6302,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6280,"end":6296,"name":"require_protocol"},"value":{"type":"Literal","start":6298,"end":6302,"value":true,"raw":"true"},"kind":"init"},{"type":"Property","start":6304,"end":6348,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6304,"end":6315,"name":"require_tld"},"value":{"type":"UnaryExpression","start":6317,"end":6348,"operator":"!","prefix":true,"argument":{"type":"MemberExpression","start":6318,"end":6348,"object":{"type":"MemberExpression","start":6318,"end":6342,"object":{"type":"Identifier","start":6318,"end":6325,"name":"options"},"property":{"type":"Identifier","start":6326,"end":6342,"name":"companionOptions"},"computed":false},"property":{"type":"Identifier","start":6343,"end":6348,"name":"debug"},"computed":false}},"kind":"init"}]}}],"kind":"const"},{"type":"ReturnStatement","start":6355,"end":6832,"argument":{"type":"CallExpression","start":6362,"end":6832,"callee":{"type":"MemberExpression","start":6362,"end":6405,"object":{"type":"ArrayExpression","start":6362,"end":6399,"elements":[{"type":"MemberExpression","start":6363,"end":6379,"object":{"type":"Identifier","start":6363,"end":6370,"name":"options"},"property":{"type":"Identifier","start":6371,"end":6379,"name":"endpoint"},"computed":false},{"type":"MemberExpression","start":6381,"end":6398,"object":{"type":"Identifier","start":6381,"end":6388,"name":"options"},"property":{"type":"Identifier","start":6389,"end":6398,"name":"uploadUrl"},"computed":false}]},"property":{"type":"Identifier","start":6400,"end":6405,"name":"every"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":6406,"end":6831,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":6407,"end":6410,"name":"url"}],"body":{"type":"BlockStatement","start":6415,"end":6831,"body":[{"type":"IfStatement","start":6423,"end":6559,"test":{"type":"LogicalExpression","start":6427,"end":6470,"left":{"type":"Identifier","start":6427,"end":6430,"name":"url"},"operator":"&&","right":{"type":"UnaryExpression","start":6434,"end":6470,"operator":"!","prefix":true,"argument":{"type":"CallExpression","start":6435,"end":6470,"callee":{"type":"MemberExpression","start":6435,"end":6450,"object":{"type":"Identifier","start":6435,"end":6444,"name":"validator"},"property":{"type":"Identifier","start":6445,"end":6450,"name":"isURL"},"computed":false},"arguments":[{"type":"Identifier","start":6451,"end":6454,"name":"url"},{"type":"Identifier","start":6456,"end":6469,"name":"validatorOpts"}]}}},"consequent":{"type":"BlockStatement","start":6472,"end":6559,"body":[{"type":"ExpressionStatement","start":6482,"end":6530,"expression":{"type":"AssignmentExpression","start":6482,"end":6530,"operator":"=","left":{"type":"MemberExpression","start":6482,"end":6502,"object":{"type":"ThisExpression","start":6482,"end":6486},"property":{"type":"Identifier","start":6487,"end":6502,"name":"_errRespMessage"},"computed":false},"right":{"type":"Literal","start":6505,"end":6530,"value":"invalid destination url","raw":"'invalid destination url'"}}},{"type":"ReturnStatement","start":6539,"end":6551,"argument":{"type":"Literal","start":6546,"end":6551,"value":false,"raw":"false"}}]},"alternate":null},{"type":"VariableDeclaration","start":6567,"end":6622,"declarations":[{"type":"VariableDeclarator","start":6573,"end":6622,"id":{"type":"Identifier","start":6573,"end":6584,"name":"allowedUrls"},"init":{"type":"MemberExpression","start":6587,"end":6622,"object":{"type":"MemberExpression","start":6587,"end":6611,"object":{"type":"Identifier","start":6587,"end":6594,"name":"options"},"property":{"type":"Identifier","start":6595,"end":6611,"name":"companionOptions"},"computed":false},"property":{"type":"Identifier","start":6612,"end":6622,"name":"uploadUrls"},"computed":false}}],"kind":"const"},{"type":"IfStatement","start":6629,"end":6806,"test":{"type":"LogicalExpression","start":6633,"end":6682,"left":{"type":"LogicalExpression","start":6633,"end":6651,"left":{"type":"Identifier","start":6633,"end":6644,"name":"allowedUrls"},"operator":"&&","right":{"type":"Identifier","start":6648,"end":6651,"name":"url"}},"operator":"&&","right":{"type":"UnaryExpression","start":6655,"end":6682,"operator":"!","prefix":true,"argument":{"type":"CallExpression","start":6656,"end":6682,"callee":{"type":"Identifier","start":6656,"end":6664,"name":"hasMatch"},"arguments":[{"type":"Identifier","start":6665,"end":6668,"name":"url"},{"type":"Identifier","start":6670,"end":6681,"name":"allowedUrls"}]}}},"consequent":{"type":"BlockStatement","start":6684,"end":6806,"body":[{"type":"ExpressionStatement","start":6694,"end":6777,"expression":{"type":"AssignmentExpression","start":6694,"end":6777,"operator":"=","left":{"type":"MemberExpression","start":6694,"end":6714,"object":{"type":"ThisExpression","start":6694,"end":6698},"property":{"type":"Identifier","start":6699,"end":6714,"name":"_errRespMessage"},"computed":false},"right":{"type":"Literal","start":6717,"end":6777,"value":"upload destination does not match any allowed destinations","raw":"'upload destination does not match any allowed destinations'"}}},{"type":"ReturnStatement","start":6786,"end":6798,"argument":{"type":"Literal","start":6793,"end":6798,"value":false,"raw":"false"}}]},"alternate":null},{"type":"ReturnStatement","start":6814,"end":6825,"argument":{"type":"Literal","start":6821,"end":6825,"value":true,"raw":"true"}}]}}]}}]}}},{"type":"MethodDefinition","start":6840,"end":6897,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":6840,"end":6848,"name":"hasError"},"value":{"type":"FunctionExpression","start":6849,"end":6897,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":6852,"end":6897,"body":[{"type":"ReturnStatement","start":6858,"end":6893,"argument":{"type":"BinaryExpression","start":6865,"end":6893,"left":{"type":"MemberExpression","start":6865,"end":6885,"object":{"type":"ThisExpression","start":6865,"end":6869},"property":{"type":"Identifier","start":6870,"end":6885,"name":"_errRespMessage"},"computed":false},"operator":"!=","right":{"type":"Literal","start":6889,"end":6893,"value":null,"raw":"null"}}}]}}},{"type":"MethodDefinition","start":7120,"end":7188,"kind":"get","static":false,"computed":false,"key":{"type":"Identifier","start":7124,"end":7134,"name":"shortToken"},"value":{"type":"FunctionExpression","start":7135,"end":7188,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":7138,"end":7188,"body":[{"type":"ReturnStatement","start":7144,"end":7184,"argument":{"type":"CallExpression","start":7151,"end":7184,"callee":{"type":"MemberExpression","start":7151,"end":7172,"object":{"type":"Identifier","start":7151,"end":7159,"name":"Uploader"},"property":{"type":"Identifier","start":7160,"end":7172,"name":"shortenToken"},"computed":false},"arguments":[{"type":"MemberExpression","start":7173,"end":7183,"object":{"type":"ThisExpression","start":7173,"end":7177},"property":{"type":"Identifier","start":7178,"end":7183,"name":"token"},"computed":false}]}}]}}},{"type":"MethodDefinition","start":7241,"end":7420,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":7241,"end":7254,"name":"onSocketReady"},"value":{"type":"FunctionExpression","start":7255,"end":7420,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":7256,"end":7264,"name":"callback"}],"body":{"type":"BlockStatement","start":7266,"end":7420,"body":[{"type":"ExpressionStatement","start":7272,"end":7332,"expression":{"type":"CallExpression","start":7272,"end":7332,"callee":{"type":"MemberExpression","start":7272,"end":7286,"object":{"type":"CallExpression","start":7272,"end":7281,"callee":{"type":"Identifier","start":7272,"end":7279,"name":"emitter"},"arguments":[]},"property":{"type":"Identifier","start":7282,"end":7286,"name":"once"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":7287,"end":7313,"expressions":[{"type":"MemberExpression","start":7301,"end":7311,"object":{"type":"ThisExpression","start":7301,"end":7305},"property":{"type":"Identifier","start":7306,"end":7311,"name":"token"},"computed":false}],"quasis":[{"type":"TemplateElement","start":7288,"end":7299,"value":{"raw":"connection:","cooked":"connection:"},"tail":false},{"type":"TemplateElement","start":7312,"end":7312,"value":{"raw":"","cooked":""},"tail":true}]},{"type":"ArrowFunctionExpression","start":7315,"end":7331,"id":null,"expression":true,"generator":false,"async":false,"params":[],"body":{"type":"CallExpression","start":7321,"end":7331,"callee":{"type":"Identifier","start":7321,"end":7329,"name":"callback"},"arguments":[]}}]}},{"type":"ExpressionStatement","start":7337,"end":7416,"expression":{"type":"CallExpression","start":7337,"end":7416,"callee":{"type":"MemberExpression","start":7337,"end":7349,"object":{"type":"Identifier","start":7337,"end":7343,"name":"logger"},"property":{"type":"Identifier","start":7344,"end":7349,"name":"debug"},"computed":false},"arguments":[{"type":"Literal","start":7350,"end":7374,"value":"waiting for connection","raw":"'waiting for connection'"},{"type":"Literal","start":7376,"end":7398,"value":"uploader.socket.wait","raw":"'uploader.socket.wait'"},{"type":"MemberExpression","start":7400,"end":7415,"object":{"type":"ThisExpression","start":7400,"end":7404},"property":{"type":"Identifier","start":7405,"end":7415,"name":"shortToken"},"computed":false}]}}]}}},{"type":"MethodDefinition","start":7424,"end":7803,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":7424,"end":7431,"name":"cleanUp"},"value":{"type":"FunctionExpression","start":7432,"end":7803,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":7435,"end":7803,"body":[{"type":"ExpressionStatement","start":7441,"end":7599,"expression":{"type":"CallExpression","start":7441,"end":7599,"callee":{"type":"MemberExpression","start":7441,"end":7450,"object":{"type":"Identifier","start":7441,"end":7443,"name":"fs"},"property":{"type":"Identifier","start":7444,"end":7450,"name":"unlink"},"computed":false},"arguments":[{"type":"MemberExpression","start":7451,"end":7460,"object":{"type":"ThisExpression","start":7451,"end":7455},"property":{"type":"Identifier","start":7456,"end":7460,"name":"path"},"computed":false},{"type":"ArrowFunctionExpression","start":7462,"end":7598,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":7463,"end":7466,"name":"err"}],"body":{"type":"BlockStatement","start":7471,"end":7598,"body":[{"type":"IfStatement","start":7479,"end":7592,"test":{"type":"Identifier","start":7483,"end":7486,"name":"err"},"consequent":{"type":"BlockStatement","start":7488,"end":7592,"body":[{"type":"ExpressionStatement","start":7498,"end":7584,"expression":{"type":"CallExpression","start":7498,"end":7584,"callee":{"type":"MemberExpression","start":7498,"end":7510,"object":{"type":"Identifier","start":7498,"end":7504,"name":"logger"},"property":{"type":"Identifier","start":7505,"end":7510,"name":"error"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":7511,"end":7557,"expressions":[{"type":"MemberExpression","start":7534,"end":7543,"object":{"type":"ThisExpression","start":7534,"end":7538},"property":{"type":"Identifier","start":7539,"end":7543,"name":"path"},"computed":false},{"type":"Identifier","start":7552,"end":7555,"name":"err"}],"quasis":[{"type":"TemplateElement","start":7512,"end":7532,"value":{"raw":"cleanup failed for: ","cooked":"cleanup failed for: "},"tail":false},{"type":"TemplateElement","start":7544,"end":7550,"value":{"raw":" err: ","cooked":" err: "},"tail":false},{"type":"TemplateElement","start":7556,"end":7556,"value":{"raw":"","cooked":""},"tail":true}]},{"type":"Literal","start":7559,"end":7583,"value":"uploader.cleanup.error","raw":"'uploader.cleanup.error'"}]}}]},"alternate":null}]}}]}},{"type":"ExpressionStatement","start":7604,"end":7655,"expression":{"type":"CallExpression","start":7604,"end":7655,"callee":{"type":"MemberExpression","start":7604,"end":7632,"object":{"type":"CallExpression","start":7604,"end":7613,"callee":{"type":"Identifier","start":7604,"end":7611,"name":"emitter"},"arguments":[]},"property":{"type":"Identifier","start":7614,"end":7632,"name":"removeAllListeners"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":7633,"end":7654,"expressions":[{"type":"MemberExpression","start":7642,"end":7652,"object":{"type":"ThisExpression","start":7642,"end":7646},"property":{"type":"Identifier","start":7647,"end":7652,"name":"token"},"computed":false}],"quasis":[{"type":"TemplateElement","start":7634,"end":7640,"value":{"raw":"pause:","cooked":"pause:"},"tail":false},{"type":"TemplateElement","start":7653,"end":7653,"value":{"raw":"","cooked":""},"tail":true}]}]}},{"type":"ExpressionStatement","start":7660,"end":7712,"expression":{"type":"CallExpression","start":7660,"end":7712,"callee":{"type":"MemberExpression","start":7660,"end":7688,"object":{"type":"CallExpression","start":7660,"end":7669,"callee":{"type":"Identifier","start":7660,"end":7667,"name":"emitter"},"arguments":[]},"property":{"type":"Identifier","start":7670,"end":7688,"name":"removeAllListeners"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":7689,"end":7711,"expressions":[{"type":"MemberExpression","start":7699,"end":7709,"object":{"type":"ThisExpression","start":7699,"end":7703},"property":{"type":"Identifier","start":7704,"end":7709,"name":"token"},"computed":false}],"quasis":[{"type":"TemplateElement","start":7690,"end":7697,"value":{"raw":"resume:","cooked":"resume:"},"tail":false},{"type":"TemplateElement","start":7710,"end":7710,"value":{"raw":"","cooked":""},"tail":true}]}]}},{"type":"ExpressionStatement","start":7717,"end":7769,"expression":{"type":"CallExpression","start":7717,"end":7769,"callee":{"type":"MemberExpression","start":7717,"end":7745,"object":{"type":"CallExpression","start":7717,"end":7726,"callee":{"type":"Identifier","start":7717,"end":7724,"name":"emitter"},"arguments":[]},"property":{"type":"Identifier","start":7727,"end":7745,"name":"removeAllListeners"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":7746,"end":7768,"expressions":[{"type":"MemberExpression","start":7756,"end":7766,"object":{"type":"ThisExpression","start":7756,"end":7760},"property":{"type":"Identifier","start":7761,"end":7766,"name":"token"},"computed":false}],"quasis":[{"type":"TemplateElement","start":7747,"end":7754,"value":{"raw":"cancel:","cooked":"cancel:"},"tail":false},{"type":"TemplateElement","start":7767,"end":7767,"value":{"raw":"","cooked":""},"tail":true}]}]}},{"type":"ExpressionStatement","start":7774,"end":7799,"expression":{"type":"AssignmentExpression","start":7774,"end":7799,"operator":"=","left":{"type":"MemberExpression","start":7774,"end":7792,"object":{"type":"ThisExpression","start":7774,"end":7778},"property":{"type":"Identifier","start":7779,"end":7792,"name":"uploadStopped"},"computed":false},"right":{"type":"Literal","start":7795,"end":7799,"value":true,"raw":"true"}}}]}}},{"type":"MethodDefinition","start":7895,"end":9427,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":7895,"end":7906,"name":"handleChunk"},"value":{"type":"FunctionExpression","start":7907,"end":9427,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":7908,"end":7911,"name":"err"},{"type":"Identifier","start":7913,"end":7918,"name":"chunk"}],"body":{"type":"BlockStatement","start":7920,"end":9427,"body":[{"type":"IfStatement","start":7926,"end":7970,"test":{"type":"MemberExpression","start":7930,"end":7948,"object":{"type":"ThisExpression","start":7930,"end":7934},"property":{"type":"Identifier","start":7935,"end":7948,"name":"uploadStopped"},"computed":false},"consequent":{"type":"BlockStatement","start":7950,"end":7970,"body":[{"type":"ReturnStatement","start":7958,"end":7964,"argument":null}]},"alternate":null},{"type":"IfStatement","start":7976,"end":8120,"test":{"type":"Identifier","start":7980,"end":7983,"name":"err"},"consequent":{"type":"BlockStatement","start":7985,"end":8120,"body":[{"type":"ExpressionStatement","start":7993,"end":8054,"expression":{"type":"CallExpression","start":7993,"end":8054,"callee":{"type":"MemberExpression","start":7993,"end":8005,"object":{"type":"Identifier","start":7993,"end":7999,"name":"logger"},"property":{"type":"Identifier","start":8000,"end":8005,"name":"error"},"computed":false},"arguments":[{"type":"Identifier","start":8006,"end":8009,"name":"err"},{"type":"Literal","start":8011,"end":8036,"value":"uploader.download.error","raw":"'uploader.download.error'"},{"type":"MemberExpression","start":8038,"end":8053,"object":{"type":"ThisExpression","start":8038,"end":8042},"property":{"type":"Identifier","start":8043,"end":8053,"name":"shortToken"},"computed":false}]}},{"type":"ExpressionStatement","start":8061,"end":8080,"expression":{"type":"CallExpression","start":8061,"end":8080,"callee":{"type":"MemberExpression","start":8061,"end":8075,"object":{"type":"ThisExpression","start":8061,"end":8065},"property":{"type":"Identifier","start":8066,"end":8075,"name":"emitError"},"computed":false},"arguments":[{"type":"Identifier","start":8076,"end":8079,"name":"err"}]}},{"type":"ExpressionStatement","start":8087,"end":8101,"expression":{"type":"CallExpression","start":8087,"end":8101,"callee":{"type":"MemberExpression","start":8087,"end":8099,"object":{"type":"ThisExpression","start":8087,"end":8091},"property":{"type":"Identifier","start":8092,"end":8099,"name":"cleanUp"},"computed":false},"arguments":[]}},{"type":"ReturnStatement","start":8108,"end":8114,"argument":null}]},"alternate":null},{"type":"VariableDeclaration","start":8234,"end":8295,"declarations":[{"type":"VariableDeclarator","start":8240,"end":8295,"id":{"type":"Identifier","start":8240,"end":8248,"name":"protocol"},"init":{"type":"LogicalExpression","start":8251,"end":8295,"left":{"type":"MemberExpression","start":8251,"end":8272,"object":{"type":"MemberExpression","start":8251,"end":8263,"object":{"type":"ThisExpression","start":8251,"end":8255},"property":{"type":"Identifier","start":8256,"end":8263,"name":"options"},"computed":false},"property":{"type":"Identifier","start":8264,"end":8272,"name":"protocol"},"computed":false},"operator":"||","right":{"type":"MemberExpression","start":8276,"end":8295,"object":{"type":"Identifier","start":8276,"end":8285,"name":"PROTOCOLS"},"property":{"type":"Identifier","start":8286,"end":8295,"name":"multipart"},"computed":false}}}],"kind":"const"},{"type":"IfStatement","start":8385,"end":9236,"test":{"type":"BinaryExpression","start":8389,"end":8403,"left":{"type":"Identifier","start":8389,"end":8394,"name":"chunk"},"operator":"===","right":{"type":"Literal","start":8399,"end":8403,"value":null,"raw":"null"}},"consequent":{"type":"BlockStatement","start":8405,"end":9236,"body":[{"type":"ExpressionStatement","start":8413,"end":9198,"expression":{"type":"CallExpression","start":8413,"end":9198,"callee":{"type":"MemberExpression","start":8413,"end":8432,"object":{"type":"MemberExpression","start":8413,"end":8429,"object":{"type":"ThisExpression","start":8413,"end":8417},"property":{"type":"Identifier","start":8418,"end":8429,"name":"writeStream"},"computed":false},"property":{"type":"Identifier","start":8430,"end":8432,"name":"on"},"computed":false},"arguments":[{"type":"Literal","start":8433,"end":8441,"value":"finish","raw":"'finish'"},{"type":"ArrowFunctionExpression","start":8443,"end":9197,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":8449,"end":9197,"body":[{"type":"ExpressionStatement","start":8459,"end":8483,"expression":{"type":"AssignmentExpression","start":8459,"end":8483,"operator":"=","left":{"type":"MemberExpression","start":8459,"end":8476,"object":{"type":"ThisExpression","start":8459,"end":8463},"property":{"type":"Identifier","start":8464,"end":8476,"name":"streamsEnded"},"computed":false},"right":{"type":"Literal","start":8479,"end":8483,"value":true,"raw":"true"}}},{"type":"SwitchStatement","start":8492,"end":9189,"discriminant":{"type":"Identifier","start":8500,"end":8508,"name":"protocol"},"cases":[{"type":"SwitchCase","start":8522,"end":8657,"consequent":[{"type":"IfStatement","start":8560,"end":8639,"test":{"type":"MemberExpression","start":8564,"end":8585,"object":{"type":"MemberExpression","start":8564,"end":8576,"object":{"type":"ThisExpression","start":8564,"end":8568},"property":{"type":"Identifier","start":8569,"end":8576,"name":"options"},"computed":false},"property":{"type":"Identifier","start":8577,"end":8585,"name":"endpoint"},"computed":false},"consequent":{"type":"BlockStatement","start":8587,"end":8639,"body":[{"type":"ExpressionStatement","start":8603,"end":8625,"expression":{"type":"CallExpression","start":8603,"end":8625,"callee":{"type":"MemberExpression","start":8603,"end":8623,"object":{"type":"ThisExpression","start":8603,"end":8607},"property":{"type":"Identifier","start":8608,"end":8623,"name":"uploadMultipart"},"computed":false},"arguments":[]}}]},"alternate":null},{"type":"BreakStatement","start":8652,"end":8657,"label":null}],"test":{"type":"MemberExpression","start":8527,"end":8546,"object":{"type":"Identifier","start":8527,"end":8536,"name":"PROTOCOLS"},"property":{"type":"Identifier","start":8537,"end":8546,"name":"multipart"},"computed":false}},{"type":"SwitchCase","start":8668,"end":8928,"consequent":[{"type":"IfStatement","start":8708,"end":8910,"test":{"type":"UnaryExpression","start":8712,"end":8726,"operator":"!","prefix":true,"argument":{"type":"MemberExpression","start":8713,"end":8726,"object":{"type":"ThisExpression","start":8713,"end":8717},"property":{"type":"Identifier","start":8718,"end":8726,"name":"s3Upload"},"computed":false}},"consequent":{"type":"BlockStatement","start":8728,"end":8782,"body":[{"type":"ExpressionStatement","start":8744,"end":8768,"expression":{"type":"CallExpression","start":8744,"end":8768,"callee":{"type":"MemberExpression","start":8744,"end":8766,"object":{"type":"ThisExpression","start":8744,"end":8748},"property":{"type":"Identifier","start":8749,"end":8766,"name":"uploadS3Multipart"},"computed":false},"arguments":[]}}]},"alternate":{"type":"BlockStatement","start":8788,"end":8910,"body":[{"type":"ExpressionStatement","start":8804,"end":8896,"expression":{"type":"CallExpression","start":8804,"end":8896,"callee":{"type":"MemberExpression","start":8804,"end":8815,"object":{"type":"Identifier","start":8804,"end":8810,"name":"logger"},"property":{"type":"Identifier","start":8811,"end":8815,"name":"warn"},"computed":false},"arguments":[{"type":"Literal","start":8816,"end":8853,"value":"handleChunk() called multiple times","raw":"'handleChunk() called multiple times'"},{"type":"Literal","start":8855,"end":8878,"value":"uploader.s3.duplicate","raw":"'uploader.s3.duplicate'"},{"type":"MemberExpression","start":8880,"end":8895,"object":{"type":"ThisExpression","start":8880,"end":8884},"property":{"type":"Identifier","start":8885,"end":8895,"name":"shortToken"},"computed":false}]}}]}},{"type":"BreakStatement","start":8923,"end":8928,"label":null}],"test":{"type":"MemberExpression","start":8673,"end":8694,"object":{"type":"Identifier","start":8673,"end":8682,"name":"PROTOCOLS"},"property":{"type":"Identifier","start":8683,"end":8694,"name":"s3Multipart"},"computed":false}},{"type":"SwitchCase","start":8939,"end":9179,"consequent":[{"type":"IfStatement","start":8971,"end":9161,"test":{"type":"UnaryExpression","start":8975,"end":8984,"operator":"!","prefix":true,"argument":{"type":"MemberExpression","start":8976,"end":8984,"object":{"type":"ThisExpression","start":8976,"end":8980},"property":{"type":"Identifier","start":8981,"end":8984,"name":"tus"},"computed":false}},"consequent":{"type":"BlockStatement","start":8986,"end":9032,"body":[{"type":"ExpressionStatement","start":9002,"end":9018,"expression":{"type":"CallExpression","start":9002,"end":9018,"callee":{"type":"MemberExpression","start":9002,"end":9016,"object":{"type":"ThisExpression","start":9002,"end":9006},"property":{"type":"Identifier","start":9007,"end":9016,"name":"uploadTus"},"computed":false},"arguments":[]}}]},"alternate":{"type":"BlockStatement","start":9038,"end":9161,"body":[{"type":"ExpressionStatement","start":9054,"end":9147,"expression":{"type":"CallExpression","start":9054,"end":9147,"callee":{"type":"MemberExpression","start":9054,"end":9065,"object":{"type":"Identifier","start":9054,"end":9060,"name":"logger"},"property":{"type":"Identifier","start":9061,"end":9065,"name":"warn"},"computed":false},"arguments":[{"type":"Literal","start":9066,"end":9103,"value":"handleChunk() called multiple times","raw":"'handleChunk() called multiple times'"},{"type":"Literal","start":9105,"end":9129,"value":"uploader.tus.duplicate","raw":"'uploader.tus.duplicate'"},{"type":"MemberExpression","start":9131,"end":9146,"object":{"type":"ThisExpression","start":9131,"end":9135},"property":{"type":"Identifier","start":9136,"end":9146,"name":"shortToken"},"computed":false}]}}]}},{"type":"BreakStatement","start":9174,"end":9179,"label":null}],"test":{"type":"MemberExpression","start":8944,"end":8957,"object":{"type":"Identifier","start":8944,"end":8953,"name":"PROTOCOLS"},"property":{"type":"Identifier","start":8954,"end":8957,"name":"tus"},"computed":false}}]}]}}]}},{"type":"ReturnStatement","start":9206,"end":9230,"argument":{"type":"CallExpression","start":9213,"end":9230,"callee":{"type":"MemberExpression","start":9213,"end":9228,"object":{"type":"ThisExpression","start":9213,"end":9217},"property":{"type":"Identifier","start":9218,"end":9228,"name":"endStreams"},"computed":false},"arguments":[]}}]},"alternate":null},{"type":"ExpressionStatement","start":9242,"end":9423,"expression":{"type":"CallExpression","start":9242,"end":9423,"callee":{"type":"MemberExpression","start":9242,"end":9264,"object":{"type":"MemberExpression","start":9242,"end":9258,"object":{"type":"ThisExpression","start":9242,"end":9246},"property":{"type":"Identifier","start":9247,"end":9258,"name":"writeStream"},"computed":false},"property":{"type":"Identifier","start":9259,"end":9264,"name":"write"},"computed":false},"arguments":[{"type":"Identifier","start":9265,"end":9270,"name":"chunk"},{"type":"ArrowFunctionExpression","start":9272,"end":9422,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":9278,"end":9422,"body":[{"type":"ExpressionStatement","start":9286,"end":9375,"expression":{"type":"CallExpression","start":9286,"end":9375,"callee":{"type":"MemberExpression","start":9286,"end":9298,"object":{"type":"Identifier","start":9286,"end":9292,"name":"logger"},"property":{"type":"Identifier","start":9293,"end":9298,"name":"debug"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":9299,"end":9327,"expressions":[{"type":"MemberExpression","start":9302,"end":9319,"object":{"type":"ThisExpression","start":9302,"end":9306},"property":{"type":"Identifier","start":9307,"end":9319,"name":"bytesWritten"},"computed":false}],"quasis":[{"type":"TemplateElement","start":9300,"end":9300,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":9320,"end":9326,"value":{"raw":" bytes","cooked":" bytes"},"tail":true}]},{"type":"Literal","start":9329,"end":9357,"value":"uploader.download.progress","raw":"'uploader.download.progress'"},{"type":"MemberExpression","start":9359,"end":9374,"object":{"type":"ThisExpression","start":9359,"end":9363},"property":{"type":"Identifier","start":9364,"end":9374,"name":"shortToken"},"computed":false}]}},{"type":"ReturnStatement","start":9382,"end":9416,"argument":{"type":"CallExpression","start":9389,"end":9416,"callee":{"type":"MemberExpression","start":9389,"end":9414,"object":{"type":"ThisExpression","start":9389,"end":9393},"property":{"type":"Identifier","start":9394,"end":9414,"name":"emitIllusiveProgress"},"computed":false},"arguments":[]}}]}}]}}]}}},{"type":"MethodDefinition","start":9507,"end":9846,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":9507,"end":9521,"name":"writeToStreams"},"value":{"type":"FunctionExpression","start":9522,"end":9846,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":9523,"end":9528,"name":"chunk"},{"type":"Identifier","start":9530,"end":9532,"name":"cb"}],"body":{"type":"BlockStatement","start":9534,"end":9846,"body":[{"type":"VariableDeclaration","start":9540,"end":9555,"declarations":[{"type":"VariableDeclarator","start":9546,"end":9555,"id":{"type":"Identifier","start":9546,"end":9550,"name":"done"},"init":{"type":"ArrayExpression","start":9553,"end":9555,"elements":[]}}],"kind":"const"},{"type":"VariableDeclaration","start":9560,"end":9604,"declarations":[{"type":"VariableDeclarator","start":9566,"end":9604,"id":{"type":"Identifier","start":9566,"end":9576,"name":"doneLength"},"init":{"type":"ConditionalExpression","start":9579,"end":9604,"test":{"type":"MemberExpression","start":9579,"end":9596,"object":{"type":"ThisExpression","start":9579,"end":9583},"property":{"type":"Identifier","start":9584,"end":9596,"name":"duplexStream"},"computed":false},"consequent":{"type":"Literal","start":9599,"end":9600,"value":2,"raw":"2"},"alternate":{"type":"Literal","start":9603,"end":9604,"value":1,"raw":"1"}}}],"kind":"const"},{"type":"VariableDeclaration","start":9609,"end":9719,"declarations":[{"type":"VariableDeclarator","start":9615,"end":9719,"id":{"type":"Identifier","start":9615,"end":9621,"name":"onDone"},"init":{"type":"ArrowFunctionExpression","start":9624,"end":9719,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":9630,"end":9719,"body":[{"type":"ExpressionStatement","start":9638,"end":9653,"expression":{"type":"CallExpression","start":9638,"end":9653,"callee":{"type":"MemberExpression","start":9638,"end":9647,"object":{"type":"Identifier","start":9638,"end":9642,"name":"done"},"property":{"type":"Identifier","start":9643,"end":9647,"name":"push"},"computed":false},"arguments":[{"type":"Literal","start":9648,"end":9652,"value":true,"raw":"true"}]}},{"type":"IfStatement","start":9660,"end":9713,"test":{"type":"BinaryExpression","start":9664,"end":9689,"left":{"type":"MemberExpression","start":9664,"end":9675,"object":{"type":"Identifier","start":9664,"end":9668,"name":"done"},"property":{"type":"Identifier","start":9669,"end":9675,"name":"length"},"computed":false},"operator":">=","right":{"type":"Identifier","start":9679,"end":9689,"name":"doneLength"}},"consequent":{"type":"BlockStatement","start":9691,"end":9713,"body":[{"type":"ExpressionStatement","start":9701,"end":9705,"expression":{"type":"CallExpression","start":9701,"end":9705,"callee":{"type":"Identifier","start":9701,"end":9703,"name":"cb"},"arguments":[]}}]},"alternate":null}]}}}],"kind":"const"},{"type":"ExpressionStatement","start":9725,"end":9762,"expression":{"type":"CallExpression","start":9725,"end":9762,"callee":{"type":"MemberExpression","start":9725,"end":9747,"object":{"type":"MemberExpression","start":9725,"end":9741,"object":{"type":"ThisExpression","start":9725,"end":9729},"property":{"type":"Identifier","start":9730,"end":9741,"name":"writeStream"},"computed":false},"property":{"type":"Identifier","start":9742,"end":9747,"name":"write"},"computed":false},"arguments":[{"type":"Identifier","start":9748,"end":9753,"name":"chunk"},{"type":"Identifier","start":9755,"end":9761,"name":"onDone"}]}},{"type":"IfStatement","start":9767,"end":9842,"test":{"type":"MemberExpression","start":9771,"end":9788,"object":{"type":"ThisExpression","start":9771,"end":9775},"property":{"type":"Identifier","start":9776,"end":9788,"name":"duplexStream"},"computed":false},"consequent":{"type":"BlockStatement","start":9790,"end":9842,"body":[{"type":"ExpressionStatement","start":9798,"end":9836,"expression":{"type":"CallExpression","start":9798,"end":9836,"callee":{"type":"MemberExpression","start":9798,"end":9821,"object":{"type":"MemberExpression","start":9798,"end":9815,"object":{"type":"ThisExpression","start":9798,"end":9802},"property":{"type":"Identifier","start":9803,"end":9815,"name":"duplexStream"},"computed":false},"property":{"type":"Identifier","start":9816,"end":9821,"name":"write"},"computed":false},"arguments":[{"type":"Identifier","start":9822,"end":9827,"name":"chunk"},{"type":"Identifier","start":9829,"end":9835,"name":"onDone"}]}}]},"alternate":null}]}}},{"type":"MethodDefinition","start":9850,"end":9961,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":9850,"end":9860,"name":"endStreams"},"value":{"type":"FunctionExpression","start":9861,"end":9961,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":9864,"end":9961,"body":[{"type":"ExpressionStatement","start":9870,"end":9892,"expression":{"type":"CallExpression","start":9870,"end":9892,"callee":{"type":"MemberExpression","start":9870,"end":9890,"object":{"type":"MemberExpression","start":9870,"end":9886,"object":{"type":"ThisExpression","start":9870,"end":9874},"property":{"type":"Identifier","start":9875,"end":9886,"name":"writeStream"},"computed":false},"property":{"type":"Identifier","start":9887,"end":9890,"name":"end"},"computed":false},"arguments":[]}},{"type":"IfStatement","start":9897,"end":9957,"test":{"type":"MemberExpression","start":9901,"end":9918,"object":{"type":"ThisExpression","start":9901,"end":9905},"property":{"type":"Identifier","start":9906,"end":9918,"name":"duplexStream"},"computed":false},"consequent":{"type":"BlockStatement","start":9920,"end":9957,"body":[{"type":"ExpressionStatement","start":9928,"end":9951,"expression":{"type":"CallExpression","start":9928,"end":9951,"callee":{"type":"MemberExpression","start":9928,"end":9949,"object":{"type":"MemberExpression","start":9928,"end":9945,"object":{"type":"ThisExpression","start":9928,"end":9932},"property":{"type":"Identifier","start":9933,"end":9945,"name":"duplexStream"},"computed":false},"property":{"type":"Identifier","start":9946,"end":9949,"name":"end"},"computed":false},"arguments":[]}}]},"alternate":null}]}}},{"type":"MethodDefinition","start":9965,"end":10149,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":9965,"end":9976,"name":"getResponse"},"value":{"type":"FunctionExpression","start":9977,"end":10149,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":9980,"end":10149,"body":[{"type":"IfStatement","start":9986,"end":10089,"test":{"type":"MemberExpression","start":9990,"end":10010,"object":{"type":"ThisExpression","start":9990,"end":9994},"property":{"type":"Identifier","start":9995,"end":10010,"name":"_errRespMessage"},"computed":false},"consequent":{"type":"BlockStatement","start":10012,"end":10089,"body":[{"type":"ReturnStatement","start":10020,"end":10083,"argument":{"type":"ObjectExpression","start":10027,"end":10083,"properties":[{"type":"Property","start":10029,"end":10068,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":10029,"end":10033,"name":"body"},"value":{"type":"ObjectExpression","start":10035,"end":10068,"properties":[{"type":"Property","start":10037,"end":10066,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":10037,"end":10044,"name":"message"},"value":{"type":"MemberExpression","start":10046,"end":10066,"object":{"type":"ThisExpression","start":10046,"end":10050},"property":{"type":"Identifier","start":10051,"end":10066,"name":"_errRespMessage"},"computed":false},"kind":"init"}]},"kind":"init"},{"type":"Property","start":10070,"end":10081,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":10070,"end":10076,"name":"status"},"value":{"type":"Literal","start":10078,"end":10081,"value":400,"raw":"400"},"kind":"init"}]}}]},"alternate":null},{"type":"ReturnStatement","start":10094,"end":10145,"argument":{"type":"ObjectExpression","start":10101,"end":10145,"properties":[{"type":"Property","start":10103,"end":10130,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":10103,"end":10107,"name":"body"},"value":{"type":"ObjectExpression","start":10109,"end":10130,"properties":[{"type":"Property","start":10111,"end":10128,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":10111,"end":10116,"name":"token"},"value":{"type":"MemberExpression","start":10118,"end":10128,"object":{"type":"ThisExpression","start":10118,"end":10122},"property":{"type":"Identifier","start":10123,"end":10128,"name":"token"},"computed":false},"kind":"init"}]},"kind":"init"},{"type":"Property","start":10132,"end":10143,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":10132,"end":10138,"name":"status"},"value":{"type":"Literal","start":10140,"end":10143,"value":200,"raw":"200"},"kind":"init"}]}}]}}},{"type":"MethodDefinition","start":10247,"end":10387,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":10247,"end":10256,"name":"saveState"},"value":{"type":"FunctionExpression","start":10257,"end":10387,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":10258,"end":10263,"name":"state"}],"body":{"type":"BlockStatement","start":10265,"end":10387,"body":[{"type":"IfStatement","start":10271,"end":10296,"test":{"type":"UnaryExpression","start":10275,"end":10288,"operator":"!","prefix":true,"argument":{"type":"MemberExpression","start":10276,"end":10288,"object":{"type":"ThisExpression","start":10276,"end":10280},"property":{"type":"Identifier","start":10281,"end":10288,"name":"storage"},"computed":false}},"consequent":{"type":"ReturnStatement","start":10290,"end":10296,"argument":null},"alternate":null},{"type":"ExpressionStatement","start":10301,"end":10383,"expression":{"type":"CallExpression","start":10301,"end":10383,"callee":{"type":"MemberExpression","start":10301,"end":10317,"object":{"type":"MemberExpression","start":10301,"end":10313,"object":{"type":"ThisExpression","start":10301,"end":10305},"property":{"type":"Identifier","start":10306,"end":10313,"name":"storage"},"computed":false},"property":{"type":"Identifier","start":10314,"end":10317,"name":"set"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":10318,"end":10360,"expressions":[{"type":"MemberExpression","start":10321,"end":10344,"object":{"type":"Identifier","start":10321,"end":10329,"name":"Uploader"},"property":{"type":"Identifier","start":10330,"end":10344,"name":"STORAGE_PREFIX"},"computed":false},{"type":"MemberExpression","start":10348,"end":10358,"object":{"type":"ThisExpression","start":10348,"end":10352},"property":{"type":"Identifier","start":10353,"end":10358,"name":"token"},"computed":false}],"quasis":[{"type":"TemplateElement","start":10319,"end":10319,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":10345,"end":10346,"value":{"raw":":","cooked":":"},"tail":false},{"type":"TemplateElement","start":10359,"end":10359,"value":{"raw":"","cooked":""},"tail":true}]},{"type":"CallExpression","start":10362,"end":10382,"callee":{"type":"Identifier","start":10362,"end":10375,"name":"jsonStringify"},"arguments":[{"type":"Identifier","start":10376,"end":10381,"name":"state"}]}]}}]}}},{"type":"MethodDefinition","start":10719,"end":11427,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":10719,"end":10739,"name":"emitIllusiveProgress"},"value":{"type":"FunctionExpression","start":10740,"end":11427,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"AssignmentPattern","start":10741,"end":10758,"left":{"type":"Identifier","start":10741,"end":10754,"name":"bytesUploaded"},"right":{"type":"Literal","start":10757,"end":10758,"value":0,"raw":"0"}}],"body":{"type":"BlockStatement","start":10760,"end":11427,"body":[{"type":"IfStatement","start":10766,"end":10804,"test":{"type":"MemberExpression","start":10770,"end":10782,"object":{"type":"ThisExpression","start":10770,"end":10774},"property":{"type":"Identifier","start":10775,"end":10782,"name":"_paused"},"computed":false},"consequent":{"type":"BlockStatement","start":10784,"end":10804,"body":[{"type":"ReturnStatement","start":10792,"end":10798,"argument":null}]},"alternate":null},{"type":"VariableDeclaration","start":10810,"end":10884,"declarations":[{"type":"VariableDeclarator","start":10814,"end":10884,"id":{"type":"Identifier","start":10814,"end":10824,"name":"bytesTotal"},"init":{"type":"ConditionalExpression","start":10827,"end":10884,"test":{"type":"MemberExpression","start":10827,"end":10844,"object":{"type":"ThisExpression","start":10827,"end":10831},"property":{"type":"Identifier","start":10832,"end":10844,"name":"streamsEnded"},"computed":false},"consequent":{"type":"MemberExpression","start":10847,"end":10864,"object":{"type":"ThisExpression","start":10847,"end":10851},"property":{"type":"Identifier","start":10852,"end":10864,"name":"bytesWritten"},"computed":false},"alternate":{"type":"MemberExpression","start":10867,"end":10884,"object":{"type":"MemberExpression","start":10867,"end":10879,"object":{"type":"ThisExpression","start":10867,"end":10871},"property":{"type":"Identifier","start":10872,"end":10879,"name":"options"},"computed":false},"property":{"type":"Identifier","start":10880,"end":10884,"name":"size"},"computed":false}}}],"kind":"let"},{"type":"IfStatement","start":10889,"end":10979,"test":{"type":"UnaryExpression","start":10893,"end":10911,"operator":"!","prefix":true,"argument":{"type":"MemberExpression","start":10894,"end":10911,"object":{"type":"ThisExpression","start":10894,"end":10898},"property":{"type":"Identifier","start":10899,"end":10911,"name":"streamsEnded"},"computed":false}},"consequent":{"type":"BlockStatement","start":10913,"end":10979,"body":[{"type":"ExpressionStatement","start":10921,"end":10973,"expression":{"type":"AssignmentExpression","start":10921,"end":10973,"operator":"=","left":{"type":"Identifier","start":10921,"end":10931,"name":"bytesTotal"},"right":{"type":"CallExpression","start":10934,"end":10973,"callee":{"type":"MemberExpression","start":10934,"end":10942,"object":{"type":"Identifier","start":10934,"end":10938,"name":"Math"},"property":{"type":"Identifier","start":10939,"end":10942,"name":"max"},"computed":false},"arguments":[{"type":"Identifier","start":10943,"end":10953,"name":"bytesTotal"},{"type":"MemberExpression","start":10955,"end":10972,"object":{"type":"ThisExpression","start":10955,"end":10959},"property":{"type":"Identifier","start":10960,"end":10972,"name":"bytesWritten"},"computed":false}]}}}]},"alternate":null},{"type":"VariableDeclaration","start":11143,"end":11218,"declarations":[{"type":"VariableDeclarator","start":11149,"end":11218,"id":{"type":"Identifier","start":11149,"end":11170,"name":"illusiveBytesUploaded"},"init":{"type":"BinaryExpression","start":11173,"end":11218,"left":{"type":"BinaryExpression","start":11174,"end":11195,"left":{"type":"MemberExpression","start":11174,"end":11191,"object":{"type":"ThisExpression","start":11174,"end":11178},"property":{"type":"Identifier","start":11179,"end":11191,"name":"bytesWritten"},"computed":false},"operator":"/","right":{"type":"Literal","start":11194,"end":11195,"value":2,"raw":"2"}},"operator":"+","right":{"type":"BinaryExpression","start":11200,"end":11217,"left":{"type":"Identifier","start":11200,"end":11213,"name":"bytesUploaded"},"operator":"/","right":{"type":"Literal","start":11216,"end":11217,"value":2,"raw":"2"}}}}],"kind":"const"},{"type":"ExpressionStatement","start":11224,"end":11366,"expression":{"type":"CallExpression","start":11224,"end":11366,"callee":{"type":"MemberExpression","start":11224,"end":11236,"object":{"type":"Identifier","start":11224,"end":11230,"name":"logger"},"property":{"type":"Identifier","start":11231,"end":11236,"name":"debug"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":11244,"end":11301,"expressions":[{"type":"Identifier","start":11247,"end":11260,"name":"bytesUploaded"},{"type":"Identifier","start":11264,"end":11285,"name":"illusiveBytesUploaded"},{"type":"Identifier","start":11289,"end":11299,"name":"bytesTotal"}],"quasis":[{"type":"TemplateElement","start":11245,"end":11245,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":11261,"end":11262,"value":{"raw":" ","cooked":" "},"tail":false},{"type":"TemplateElement","start":11286,"end":11287,"value":{"raw":" ","cooked":" "},"tail":false},{"type":"TemplateElement","start":11300,"end":11300,"value":{"raw":"","cooked":""},"tail":true}]},{"type":"Literal","start":11309,"end":11337,"value":"uploader.illusive.progress","raw":"'uploader.illusive.progress'"},{"type":"MemberExpression","start":11345,"end":11360,"object":{"type":"ThisExpression","start":11345,"end":11349},"property":{"type":"Identifier","start":11350,"end":11360,"name":"shortToken"},"computed":false}]}},{"type":"ExpressionStatement","start":11371,"end":11423,"expression":{"type":"CallExpression","start":11371,"end":11423,"callee":{"type":"MemberExpression","start":11371,"end":11388,"object":{"type":"ThisExpression","start":11371,"end":11375},"property":{"type":"Identifier","start":11376,"end":11388,"name":"emitProgress"},"computed":false},"arguments":[{"type":"Identifier","start":11389,"end":11410,"name":"illusiveBytesUploaded"},{"type":"Identifier","start":11412,"end":11422,"name":"bytesTotal"}]}}]}}},{"type":"MethodDefinition","start":11522,"end":12415,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":11522,"end":11534,"name":"emitProgress"},"value":{"type":"FunctionExpression","start":11535,"end":12415,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":11536,"end":11549,"name":"bytesUploaded"},{"type":"Identifier","start":11551,"end":11561,"name":"bytesTotal"}],"body":{"type":"BlockStatement","start":11563,"end":12415,"body":[{"type":"ExpressionStatement","start":11569,"end":11613,"expression":{"type":"AssignmentExpression","start":11569,"end":11613,"operator":"=","left":{"type":"Identifier","start":11569,"end":11579,"name":"bytesTotal"},"right":{"type":"LogicalExpression","start":11582,"end":11613,"left":{"type":"Identifier","start":11582,"end":11592,"name":"bytesTotal"},"operator":"||","right":{"type":"MemberExpression","start":11596,"end":11613,"object":{"type":"MemberExpression","start":11596,"end":11608,"object":{"type":"ThisExpression","start":11596,"end":11600},"property":{"type":"Identifier","start":11601,"end":11608,"name":"options"},"computed":false},"property":{"type":"Identifier","start":11609,"end":11613,"name":"size"},"computed":false}}}},{"type":"IfStatement","start":11618,"end":11738,"test":{"type":"LogicalExpression","start":11622,"end":11692,"left":{"type":"LogicalExpression","start":11622,"end":11671,"left":{"type":"MemberExpression","start":11622,"end":11630,"object":{"type":"ThisExpression","start":11622,"end":11626},"property":{"type":"Identifier","start":11627,"end":11630,"name":"tus"},"computed":false},"operator":"&&","right":{"type":"MemberExpression","start":11634,"end":11671,"object":{"type":"MemberExpression","start":11634,"end":11650,"object":{"type":"MemberExpression","start":11634,"end":11642,"object":{"type":"ThisExpression","start":11634,"end":11638},"property":{"type":"Identifier","start":11639,"end":11642,"name":"tus"},"computed":false},"property":{"type":"Identifier","start":11643,"end":11650,"name":"options"},"computed":false},"property":{"type":"Identifier","start":11651,"end":11671,"name":"uploadLengthDeferred"},"computed":false}},"operator":"&&","right":{"type":"MemberExpression","start":11675,"end":11692,"object":{"type":"ThisExpression","start":11675,"end":11679},"property":{"type":"Identifier","start":11680,"end":11692,"name":"streamsEnded"},"computed":false}},"consequent":{"type":"BlockStatement","start":11694,"end":11738,"body":[{"type":"ExpressionStatement","start":11702,"end":11732,"expression":{"type":"AssignmentExpression","start":11702,"end":11732,"operator":"=","left":{"type":"Identifier","start":11702,"end":11712,"name":"bytesTotal"},"right":{"type":"MemberExpression","start":11715,"end":11732,"object":{"type":"ThisExpression","start":11715,"end":11719},"property":{"type":"Identifier","start":11720,"end":11732,"name":"bytesWritten"},"computed":false}}}]},"alternate":null},{"type":"VariableDeclaration","start":11743,"end":11796,"declarations":[{"type":"VariableDeclarator","start":11749,"end":11796,"id":{"type":"Identifier","start":11749,"end":11759,"name":"percentage"},"init":{"type":"BinaryExpression","start":11763,"end":11795,"left":{"type":"BinaryExpression","start":11763,"end":11789,"left":{"type":"Identifier","start":11763,"end":11776,"name":"bytesUploaded"},"operator":"/","right":{"type":"Identifier","start":11779,"end":11789,"name":"bytesTotal"}},"operator":"*","right":{"type":"Literal","start":11792,"end":11795,"value":100,"raw":"100"}}}],"kind":"const"},{"type":"VariableDeclaration","start":11801,"end":11847,"declarations":[{"type":"VariableDeclarator","start":11807,"end":11847,"id":{"type":"Identifier","start":11807,"end":11823,"name":"formatPercentage"},"init":{"type":"CallExpression","start":11826,"end":11847,"callee":{"type":"MemberExpression","start":11826,"end":11844,"object":{"type":"Identifier","start":11826,"end":11836,"name":"percentage"},"property":{"type":"Identifier","start":11837,"end":11844,"name":"toFixed"},"computed":false},"arguments":[{"type":"Literal","start":11845,"end":11846,"value":2,"raw":"2"}]}}],"kind":"const"},{"type":"ExpressionStatement","start":11852,"end":11988,"expression":{"type":"CallExpression","start":11852,"end":11988,"callee":{"type":"MemberExpression","start":11852,"end":11864,"object":{"type":"Identifier","start":11852,"end":11858,"name":"logger"},"property":{"type":"Identifier","start":11859,"end":11864,"name":"debug"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":11872,"end":11925,"expressions":[{"type":"Identifier","start":11875,"end":11888,"name":"bytesUploaded"},{"type":"Identifier","start":11892,"end":11902,"name":"bytesTotal"},{"type":"Identifier","start":11906,"end":11922,"name":"formatPercentage"}],"quasis":[{"type":"TemplateElement","start":11873,"end":11873,"value":{"raw":"","cooked":""},"tail":false},{"type":"TemplateElement","start":11889,"end":11890,"value":{"raw":" ","cooked":" "},"tail":false},{"type":"TemplateElement","start":11903,"end":11904,"value":{"raw":" ","cooked":" "},"tail":false},{"type":"TemplateElement","start":11923,"end":11924,"value":{"raw":"%","cooked":"%"},"tail":true}]},{"type":"Literal","start":11933,"end":11959,"value":"uploader.upload.progress","raw":"'uploader.upload.progress'"},{"type":"MemberExpression","start":11967,"end":11982,"object":{"type":"ThisExpression","start":11967,"end":11971},"property":{"type":"Identifier","start":11972,"end":11982,"name":"shortToken"},"computed":false}]}},{"type":"VariableDeclaration","start":11994,"end":12119,"declarations":[{"type":"VariableDeclarator","start":12000,"end":12119,"id":{"type":"Identifier","start":12000,"end":12010,"name":"dataToEmit"},"init":{"type":"ObjectExpression","start":12013,"end":12119,"properties":[{"type":"Property","start":12021,"end":12039,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":12021,"end":12027,"name":"action"},"value":{"type":"Literal","start":12029,"end":12039,"value":"progress","raw":"'progress'"},"kind":"init"},{"type":"Property","start":12047,"end":12113,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":12047,"end":12054,"name":"payload"},"value":{"type":"ObjectExpression","start":12056,"end":12113,"properties":[{"type":"Property","start":12058,"end":12084,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":12058,"end":12066,"name":"progress"},"value":{"type":"Identifier","start":12068,"end":12084,"name":"formatPercentage"},"kind":"init"},{"type":"Property","start":12086,"end":12099,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":12086,"end":12099,"name":"bytesUploaded"},"kind":"init","value":{"type":"Identifier","start":12086,"end":12099,"name":"bytesUploaded"}},{"type":"Property","start":12101,"end":12111,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":12101,"end":12111,"name":"bytesTotal"},"kind":"init","value":{"type":"Identifier","start":12101,"end":12111,"name":"bytesTotal"}}]},"kind":"init"}]}}],"kind":"const"},{"type":"ExpressionStatement","start":12124,"end":12150,"expression":{"type":"CallExpression","start":12124,"end":12150,"callee":{"type":"MemberExpression","start":12124,"end":12138,"object":{"type":"ThisExpression","start":12124,"end":12128},"property":{"type":"Identifier","start":12129,"end":12138,"name":"saveState"},"computed":false},"arguments":[{"type":"Identifier","start":12139,"end":12149,"name":"dataToEmit"}]}},{"type":"VariableDeclaration","start":12211,"end":12259,"declarations":[{"type":"VariableDeclarator","start":12217,"end":12259,"id":{"type":"Identifier","start":12217,"end":12234,"name":"roundedPercentage"},"init":{"type":"CallExpression","start":12237,"end":12259,"callee":{"type":"MemberExpression","start":12237,"end":12247,"object":{"type":"Identifier","start":12237,"end":12241,"name":"Math"},"property":{"type":"Identifier","start":12242,"end":12247,"name":"floor"},"computed":false},"arguments":[{"type":"Identifier","start":12248,"end":12258,"name":"percentage"}]}}],"kind":"const"},{"type":"IfStatement","start":12264,"end":12411,"test":{"type":"BinaryExpression","start":12268,"end":12310,"left":{"type":"MemberExpression","start":12268,"end":12288,"object":{"type":"ThisExpression","start":12268,"end":12272},"property":{"type":"Identifier","start":12273,"end":12288,"name":"emittedProgress"},"computed":false},"operator":"!==","right":{"type":"Identifier","start":12293,"end":12310,"name":"roundedPercentage"}},"consequent":{"type":"BlockStatement","start":12312,"end":12411,"body":[{"type":"ExpressionStatement","start":12320,"end":12360,"expression":{"type":"AssignmentExpression","start":12320,"end":12360,"operator":"=","left":{"type":"MemberExpression","start":12320,"end":12340,"object":{"type":"ThisExpression","start":12320,"end":12324},"property":{"type":"Identifier","start":12325,"end":12340,"name":"emittedProgress"},"computed":false},"right":{"type":"Identifier","start":12343,"end":12360,"name":"roundedPercentage"}}},{"type":"ExpressionStatement","start":12367,"end":12405,"expression":{"type":"CallExpression","start":12367,"end":12405,"callee":{"type":"MemberExpression","start":12367,"end":12381,"object":{"type":"CallExpression","start":12367,"end":12376,"callee":{"type":"Identifier","start":12367,"end":12374,"name":"emitter"},"arguments":[]},"property":{"type":"Identifier","start":12377,"end":12381,"name":"emit"},"computed":false},"arguments":[{"type":"MemberExpression","start":12382,"end":12392,"object":{"type":"ThisExpression","start":12382,"end":12386},"property":{"type":"Identifier","start":12387,"end":12392,"name":"token"},"computed":false},{"type":"Identifier","start":12394,"end":12404,"name":"dataToEmit"}]}}]},"alternate":null}]}}},{"type":"MethodDefinition","start":12492,"end":12720,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":12492,"end":12503,"name":"emitSuccess"},"value":{"type":"FunctionExpression","start":12504,"end":12720,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":12505,"end":12508,"name":"url"},{"type":"AssignmentPattern","start":12510,"end":12524,"left":{"type":"Identifier","start":12510,"end":12519,"name":"extraData"},"right":{"type":"ObjectExpression","start":12522,"end":12524,"properties":[]}}],"body":{"type":"BlockStatement","start":12526,"end":12720,"body":[{"type":"VariableDeclaration","start":12532,"end":12646,"declarations":[{"type":"VariableDeclarator","start":12538,"end":12646,"id":{"type":"Identifier","start":12538,"end":12546,"name":"emitData"},"init":{"type":"ObjectExpression","start":12549,"end":12646,"properties":[{"type":"Property","start":12557,"end":12574,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":12557,"end":12563,"name":"action"},"value":{"type":"Literal","start":12565,"end":12574,"value":"success","raw":"'success'"},"kind":"init"},{"type":"Property","start":12582,"end":12640,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":12582,"end":12589,"name":"payload"},"value":{"type":"CallExpression","start":12591,"end":12640,"callee":{"type":"MemberExpression","start":12591,"end":12604,"object":{"type":"Identifier","start":12591,"end":12597,"name":"Object"},"property":{"type":"Identifier","start":12598,"end":12604,"name":"assign"},"computed":false},"arguments":[{"type":"Identifier","start":12605,"end":12614,"name":"extraData"},{"type":"ObjectExpression","start":12616,"end":12639,"properties":[{"type":"Property","start":12618,"end":12632,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":12618,"end":12626,"name":"complete"},"value":{"type":"Literal","start":12628,"end":12632,"value":true,"raw":"true"},"kind":"init"},{"type":"Property","start":12634,"end":12637,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":12634,"end":12637,"name":"url"},"kind":"init","value":{"type":"Identifier","start":12634,"end":12637,"name":"url"}}]}]},"kind":"init"}]}}],"kind":"const"},{"type":"ExpressionStatement","start":12651,"end":12675,"expression":{"type":"CallExpression","start":12651,"end":12675,"callee":{"type":"MemberExpression","start":12651,"end":12665,"object":{"type":"ThisExpression","start":12651,"end":12655},"property":{"type":"Identifier","start":12656,"end":12665,"name":"saveState"},"computed":false},"arguments":[{"type":"Identifier","start":12666,"end":12674,"name":"emitData"}]}},{"type":"ExpressionStatement","start":12680,"end":12716,"expression":{"type":"CallExpression","start":12680,"end":12716,"callee":{"type":"MemberExpression","start":12680,"end":12694,"object":{"type":"CallExpression","start":12680,"end":12689,"callee":{"type":"Identifier","start":12680,"end":12687,"name":"emitter"},"arguments":[]},"property":{"type":"Identifier","start":12690,"end":12694,"name":"emit"},"computed":false},"arguments":[{"type":"MemberExpression","start":12695,"end":12705,"object":{"type":"ThisExpression","start":12695,"end":12699},"property":{"type":"Identifier","start":12700,"end":12705,"name":"token"},"computed":false},{"type":"Identifier","start":12707,"end":12715,"name":"emitData"}]}}]}}},{"type":"MethodDefinition","start":12797,"end":13164,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":12797,"end":12806,"name":"emitError"},"value":{"type":"FunctionExpression","start":12807,"end":13164,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":12808,"end":12811,"name":"err"},{"type":"AssignmentPattern","start":12813,"end":12827,"left":{"type":"Identifier","start":12813,"end":12822,"name":"extraData"},"right":{"type":"ObjectExpression","start":12825,"end":12827,"properties":[]}}],"body":{"type":"BlockStatement","start":12829,"end":13164,"body":[{"type":"VariableDeclaration","start":12835,"end":12876,"declarations":[{"type":"VariableDeclarator","start":12841,"end":12876,"id":{"type":"Identifier","start":12841,"end":12854,"name":"serializedErr"},"init":{"type":"CallExpression","start":12857,"end":12876,"callee":{"type":"Identifier","start":12857,"end":12871,"name":"serializeError"},"arguments":[{"type":"Identifier","start":12872,"end":12875,"name":"err"}]}}],"kind":"const"},{"type":"ExpressionStatement","start":12940,"end":12966,"expression":{"type":"UnaryExpression","start":12940,"end":12966,"operator":"delete","prefix":true,"argument":{"type":"MemberExpression","start":12947,"end":12966,"object":{"type":"Identifier","start":12947,"end":12960,"name":"serializedErr"},"property":{"type":"Identifier","start":12961,"end":12966,"name":"stack"},"computed":false}}},{"type":"VariableDeclaration","start":12971,"end":13086,"declarations":[{"type":"VariableDeclarator","start":12977,"end":13086,"id":{"type":"Identifier","start":12977,"end":12987,"name":"dataToEmit"},"init":{"type":"ObjectExpression","start":12990,"end":13086,"properties":[{"type":"Property","start":12998,"end":13013,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":12998,"end":13004,"name":"action"},"value":{"type":"Literal","start":13006,"end":13013,"value":"error","raw":"'error'"},"kind":"init"},{"type":"Property","start":13021,"end":13080,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":13021,"end":13028,"name":"payload"},"value":{"type":"CallExpression","start":13030,"end":13080,"callee":{"type":"MemberExpression","start":13030,"end":13043,"object":{"type":"Identifier","start":13030,"end":13036,"name":"Object"},"property":{"type":"Identifier","start":13037,"end":13043,"name":"assign"},"computed":false},"arguments":[{"type":"Identifier","start":13044,"end":13053,"name":"extraData"},{"type":"ObjectExpression","start":13055,"end":13079,"properties":[{"type":"Property","start":13057,"end":13077,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":13057,"end":13062,"name":"error"},"value":{"type":"Identifier","start":13064,"end":13077,"name":"serializedErr"},"kind":"init"}]}]},"kind":"init"}]}}],"kind":"const"},{"type":"ExpressionStatement","start":13091,"end":13117,"expression":{"type":"CallExpression","start":13091,"end":13117,"callee":{"type":"MemberExpression","start":13091,"end":13105,"object":{"type":"ThisExpression","start":13091,"end":13095},"property":{"type":"Identifier","start":13096,"end":13105,"name":"saveState"},"computed":false},"arguments":[{"type":"Identifier","start":13106,"end":13116,"name":"dataToEmit"}]}},{"type":"ExpressionStatement","start":13122,"end":13160,"expression":{"type":"CallExpression","start":13122,"end":13160,"callee":{"type":"MemberExpression","start":13122,"end":13136,"object":{"type":"CallExpression","start":13122,"end":13131,"callee":{"type":"Identifier","start":13122,"end":13129,"name":"emitter"},"arguments":[]},"property":{"type":"Identifier","start":13132,"end":13136,"name":"emit"},"computed":false},"arguments":[{"type":"MemberExpression","start":13137,"end":13147,"object":{"type":"ThisExpression","start":13137,"end":13141},"property":{"type":"Identifier","start":13142,"end":13147,"name":"token"},"computed":false},{"type":"Identifier","start":13149,"end":13159,"name":"dataToEmit"}]}}]}}},{"type":"MethodDefinition","start":13206,"end":14498,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":13206,"end":13215,"name":"uploadTus"},"value":{"type":"FunctionExpression","start":13216,"end":14498,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":13219,"end":14498,"body":[{"type":"VariableDeclaration","start":13225,"end":13268,"declarations":[{"type":"VariableDeclarator","start":13231,"end":13268,"id":{"type":"Identifier","start":13231,"end":13235,"name":"file"},"init":{"type":"CallExpression","start":13238,"end":13268,"callee":{"type":"MemberExpression","start":13238,"end":13257,"object":{"type":"Identifier","start":13238,"end":13240,"name":"fs"},"property":{"type":"Identifier","start":13241,"end":13257,"name":"createReadStream"},"computed":false},"arguments":[{"type":"MemberExpression","start":13258,"end":13267,"object":{"type":"ThisExpression","start":13258,"end":13262},"property":{"type":"Identifier","start":13263,"end":13267,"name":"path"},"computed":false}]}}],"kind":"const"},{"type":"VariableDeclaration","start":13273,"end":13294,"declarations":[{"type":"VariableDeclarator","start":13279,"end":13294,"id":{"type":"Identifier","start":13279,"end":13287,"name":"uploader"},"init":{"type":"ThisExpression","start":13290,"end":13294}}],"kind":"const"},{"type":"ExpressionStatement","start":13318,"end":14439,"expression":{"type":"AssignmentExpression","start":13318,"end":14439,"operator":"=","left":{"type":"MemberExpression","start":13318,"end":13326,"object":{"type":"ThisExpression","start":13318,"end":13322},"property":{"type":"Identifier","start":13323,"end":13326,"name":"tus"},"computed":false},"right":{"type":"NewExpression","start":13329,"end":14439,"callee":{"type":"MemberExpression","start":13333,"end":13343,"object":{"type":"Identifier","start":13333,"end":13336,"name":"tus"},"property":{"type":"Identifier","start":13337,"end":13343,"name":"Upload"},"computed":false},"arguments":[{"type":"Identifier","start":13344,"end":13348,"name":"file"},{"type":"ObjectExpression","start":13350,"end":14438,"properties":[{"type":"Property","start":13358,"end":13389,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":13358,"end":13366,"name":"endpoint"},"value":{"type":"MemberExpression","start":13368,"end":13389,"object":{"type":"MemberExpression","start":13368,"end":13380,"object":{"type":"ThisExpression","start":13368,"end":13372},"property":{"type":"Identifier","start":13373,"end":13380,"name":"options"},"computed":false},"property":{"type":"Identifier","start":13381,"end":13389,"name":"endpoint"},"computed":false},"kind":"init"},{"type":"Property","start":13397,"end":13430,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":13397,"end":13406,"name":"uploadUrl"},"value":{"type":"MemberExpression","start":13408,"end":13430,"object":{"type":"MemberExpression","start":13408,"end":13420,"object":{"type":"ThisExpression","start":13408,"end":13412},"property":{"type":"Identifier","start":13413,"end":13420,"name":"options"},"computed":false},"property":{"type":"Identifier","start":13421,"end":13430,"name":"uploadUrl"},"computed":false},"kind":"init"},{"type":"Property","start":13458,"end":13485,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":13458,"end":13478,"name":"uploadLengthDeferred"},"value":{"type":"Literal","start":13480,"end":13485,"value":false,"raw":"false"},"kind":"init"},{"type":"Property","start":13493,"end":13505,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":13493,"end":13499,"name":"resume"},"value":{"type":"Literal","start":13501,"end":13505,"value":true,"raw":"true"},"kind":"init"},{"type":"Property","start":13513,"end":13547,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":13513,"end":13524,"name":"retryDelays"},"value":{"type":"ArrayExpression","start":13526,"end":13547,"elements":[{"type":"Literal","start":13527,"end":13528,"value":0,"raw":"0"},{"type":"Literal","start":13530,"end":13534,"value":1000,"raw":"1000"},{"type":"Literal","start":13536,"end":13540,"value":3000,"raw":"3000"},{"type":"Literal","start":13542,"end":13546,"value":5000,"raw":"5000"}]},"kind":"init"},{"type":"Property","start":13555,"end":13584,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":13555,"end":13565,"name":"uploadSize"},"value":{"type":"MemberExpression","start":13567,"end":13584,"object":{"type":"ThisExpression","start":13567,"end":13571},"property":{"type":"Identifier","start":13572,"end":13584,"name":"bytesWritten"},"computed":false},"kind":"init"},{"type":"Property","start":13592,"end":13939,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":13592,"end":13600,"name":"metadata"},"value":{"type":"CallExpression","start":13602,"end":13939,"callee":{"type":"MemberExpression","start":13602,"end":13615,"object":{"type":"Identifier","start":13602,"end":13608,"name":"Object"},"property":{"type":"Identifier","start":13609,"end":13615,"name":"assign"},"computed":false},"arguments":[{"type":"ObjectExpression","start":13625,"end":13908,"properties":[{"type":"Property","start":13821,"end":13850,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":13821,"end":13829,"name":"filename"},"value":{"type":"MemberExpression","start":13831,"end":13850,"object":{"type":"ThisExpression","start":13831,"end":13835},"property":{"type":"Identifier","start":13836,"end":13850,"name":"uploadFileName"},"computed":false},"kind":"init"},{"type":"Property","start":13862,"end":13898,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":13862,"end":13870,"name":"filetype"},"value":{"type":"MemberExpression","start":13872,"end":13898,"object":{"type":"MemberExpression","start":13872,"end":13893,"object":{"type":"MemberExpression","start":13872,"end":13884,"object":{"type":"ThisExpression","start":13872,"end":13876},"property":{"type":"Identifier","start":13877,"end":13884,"name":"options"},"computed":false},"property":{"type":"Identifier","start":13885,"end":13893,"name":"metadata"},"computed":false},"property":{"type":"Identifier","start":13894,"end":13898,"name":"type"},"computed":false},"kind":"init"}]},{"type":"MemberExpression","start":13910,"end":13931,"object":{"type":"MemberExpression","start":13910,"end":13922,"object":{"type":"ThisExpression","start":13910,"end":13914},"property":{"type":"Identifier","start":13915,"end":13922,"name":"options"},"computed":false},"property":{"type":"Identifier","start":13923,"end":13931,"name":"metadata"},"computed":false}]},"kind":"init"},{"type":"Property","start":14006,"end":14115,"method":true,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":14006,"end":14013,"name":"onError"},"kind":"init","value":{"type":"FunctionExpression","start":14014,"end":14115,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":14015,"end":14020,"name":"error"}],"body":{"type":"BlockStatement","start":14022,"end":14115,"body":[{"type":"ExpressionStatement","start":14032,"end":14073,"expression":{"type":"CallExpression","start":14032,"end":14073,"callee":{"type":"MemberExpression","start":14032,"end":14044,"object":{"type":"Identifier","start":14032,"end":14038,"name":"logger"},"property":{"type":"Identifier","start":14039,"end":14044,"name":"error"},"computed":false},"arguments":[{"type":"Identifier","start":14045,"end":14050,"name":"error"},{"type":"Literal","start":14052,"end":14072,"value":"uploader.tus.error","raw":"'uploader.tus.error'"}]}},{"type":"ExpressionStatement","start":14082,"end":14107,"expression":{"type":"CallExpression","start":14082,"end":14107,"callee":{"type":"MemberExpression","start":14082,"end":14100,"object":{"type":"Identifier","start":14082,"end":14090,"name":"uploader"},"property":{"type":"Identifier","start":14091,"end":14100,"name":"emitError"},"computed":false},"arguments":[{"type":"Identifier","start":14101,"end":14106,"name":"error"}]}}]}}},{"type":"Property","start":14227,"end":14328,"method":true,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":14227,"end":14237,"name":"onProgress"},"kind":"init","value":{"type":"FunctionExpression","start":14238,"end":14328,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":14239,"end":14252,"name":"bytesUploaded"},{"type":"Identifier","start":14254,"end":14264,"name":"bytesTotal"}],"body":{"type":"BlockStatement","start":14266,"end":14328,"body":[{"type":"ExpressionStatement","start":14276,"end":14320,"expression":{"type":"CallExpression","start":14276,"end":14320,"callee":{"type":"MemberExpression","start":14276,"end":14305,"object":{"type":"Identifier","start":14276,"end":14284,"name":"uploader"},"property":{"type":"Identifier","start":14285,"end":14305,"name":"emitIllusiveProgress"},"computed":false},"arguments":[{"type":"Identifier","start":14306,"end":14319,"name":"bytesUploaded"}]}}]}}},{"type":"Property","start":14336,"end":14432,"method":true,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":14336,"end":14345,"name":"onSuccess"},"kind":"init","value":{"type":"FunctionExpression","start":14346,"end":14432,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":14349,"end":14432,"body":[{"type":"ExpressionStatement","start":14359,"end":14397,"expression":{"type":"CallExpression","start":14359,"end":14397,"callee":{"type":"MemberExpression","start":14359,"end":14379,"object":{"type":"Identifier","start":14359,"end":14367,"name":"uploader"},"property":{"type":"Identifier","start":14368,"end":14379,"name":"emitSuccess"},"computed":false},"arguments":[{"type":"MemberExpression","start":14380,"end":14396,"object":{"type":"MemberExpression","start":14380,"end":14392,"object":{"type":"Identifier","start":14380,"end":14388,"name":"uploader"},"property":{"type":"Identifier","start":14389,"end":14392,"name":"tus"},"computed":false},"property":{"type":"Identifier","start":14393,"end":14396,"name":"url"},"computed":false}]}},{"type":"ExpressionStatement","start":14406,"end":14424,"expression":{"type":"CallExpression","start":14406,"end":14424,"callee":{"type":"MemberExpression","start":14406,"end":14422,"object":{"type":"Identifier","start":14406,"end":14414,"name":"uploader"},"property":{"type":"Identifier","start":14415,"end":14422,"name":"cleanUp"},"computed":false},"arguments":[]}}]}}}]}]}}},{"type":"IfStatement","start":14445,"end":14494,"test":{"type":"UnaryExpression","start":14449,"end":14462,"operator":"!","prefix":true,"argument":{"type":"MemberExpression","start":14450,"end":14462,"object":{"type":"ThisExpression","start":14450,"end":14454},"property":{"type":"Identifier","start":14455,"end":14462,"name":"_paused"},"computed":false}},"consequent":{"type":"BlockStatement","start":14464,"end":14494,"body":[{"type":"ExpressionStatement","start":14472,"end":14488,"expression":{"type":"CallExpression","start":14472,"end":14488,"callee":{"type":"MemberExpression","start":14472,"end":14486,"object":{"type":"MemberExpression","start":14472,"end":14480,"object":{"type":"ThisExpression","start":14472,"end":14476},"property":{"type":"Identifier","start":14477,"end":14480,"name":"tus"},"computed":false},"property":{"type":"Identifier","start":14481,"end":14486,"name":"start"},"computed":false},"arguments":[]}}]},"alternate":null}]}}},{"type":"MethodDefinition","start":14502,"end":16531,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":14502,"end":14517,"name":"uploadMultipart"},"value":{"type":"FunctionExpression","start":14518,"end":16531,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":14521,"end":16531,"body":[{"type":"VariableDeclaration","start":14527,"end":14570,"declarations":[{"type":"VariableDeclarator","start":14533,"end":14570,"id":{"type":"Identifier","start":14533,"end":14537,"name":"file"},"init":{"type":"CallExpression","start":14540,"end":14570,"callee":{"type":"MemberExpression","start":14540,"end":14559,"object":{"type":"Identifier","start":14540,"end":14542,"name":"fs"},"property":{"type":"Identifier","start":14543,"end":14559,"name":"createReadStream"},"computed":false},"arguments":[{"type":"MemberExpression","start":14560,"end":14569,"object":{"type":"ThisExpression","start":14560,"end":14564},"property":{"type":"Identifier","start":14565,"end":14569,"name":"path"},"computed":false}]}}],"kind":"const"},{"type":"VariableDeclaration","start":14599,"end":14620,"declarations":[{"type":"VariableDeclarator","start":14603,"end":14620,"id":{"type":"Identifier","start":14603,"end":14616,"name":"bytesUploaded"},"init":{"type":"Literal","start":14619,"end":14620,"value":0,"raw":"0"}}],"kind":"let"},{"type":"ExpressionStatement","start":14625,"end":14741,"expression":{"type":"CallExpression","start":14625,"end":14741,"callee":{"type":"MemberExpression","start":14625,"end":14632,"object":{"type":"Identifier","start":14625,"end":14629,"name":"file"},"property":{"type":"Identifier","start":14630,"end":14632,"name":"on"},"computed":false},"arguments":[{"type":"Literal","start":14633,"end":14639,"value":"data","raw":"'data'"},{"type":"ArrowFunctionExpression","start":14641,"end":14740,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":14642,"end":14646,"name":"data"}],"body":{"type":"BlockStatement","start":14651,"end":14740,"body":[{"type":"ExpressionStatement","start":14659,"end":14687,"expression":{"type":"AssignmentExpression","start":14659,"end":14687,"operator":"+=","left":{"type":"Identifier","start":14659,"end":14672,"name":"bytesUploaded"},"right":{"type":"MemberExpression","start":14676,"end":14687,"object":{"type":"Identifier","start":14676,"end":14680,"name":"data"},"property":{"type":"Identifier","start":14681,"end":14687,"name":"length"},"computed":false}}},{"type":"ExpressionStatement","start":14694,"end":14734,"expression":{"type":"CallExpression","start":14694,"end":14734,"callee":{"type":"MemberExpression","start":14694,"end":14719,"object":{"type":"ThisExpression","start":14694,"end":14698},"property":{"type":"Identifier","start":14699,"end":14719,"name":"emitIllusiveProgress"},"computed":false},"arguments":[{"type":"Identifier","start":14720,"end":14733,"name":"bytesUploaded"}]}}]}}]}},{"type":"VariableDeclaration","start":14747,"end":14838,"declarations":[{"type":"VariableDeclarator","start":14753,"end":14838,"id":{"type":"Identifier","start":14753,"end":14763,"name":"httpMethod"},"init":{"type":"ConditionalExpression","start":14766,"end":14838,"test":{"type":"BinaryExpression","start":14766,"end":14821,"left":{"type":"CallExpression","start":14766,"end":14811,"callee":{"type":"MemberExpression","start":14766,"end":14809,"object":{"type":"LogicalExpression","start":14767,"end":14796,"left":{"type":"MemberExpression","start":14767,"end":14790,"object":{"type":"MemberExpression","start":14767,"end":14779,"object":{"type":"ThisExpression","start":14767,"end":14771},"property":{"type":"Identifier","start":14772,"end":14779,"name":"options"},"computed":false},"property":{"type":"Identifier","start":14780,"end":14790,"name":"httpMethod"},"computed":false},"operator":"||","right":{"type":"Literal","start":14794,"end":14796,"value":"","raw":"''"}},"property":{"type":"Identifier","start":14798,"end":14809,"name":"toLowerCase"},"computed":false},"arguments":[]},"operator":"===","right":{"type":"Literal","start":14816,"end":14821,"value":"put","raw":"'put'"}},"consequent":{"type":"Literal","start":14824,"end":14829,"value":"put","raw":"'put'"},"alternate":{"type":"Literal","start":14832,"end":14838,"value":"post","raw":"'post'"}}}],"kind":"const"},{"type":"VariableDeclaration","start":14843,"end":14895,"declarations":[{"type":"VariableDeclarator","start":14849,"end":14895,"id":{"type":"Identifier","start":14849,"end":14856,"name":"headers"},"init":{"type":"CallExpression","start":14859,"end":14895,"callee":{"type":"Identifier","start":14859,"end":14873,"name":"headerSanitize"},"arguments":[{"type":"MemberExpression","start":14874,"end":14894,"object":{"type":"MemberExpression","start":14874,"end":14886,"object":{"type":"ThisExpression","start":14874,"end":14878},"property":{"type":"Identifier","start":14879,"end":14886,"name":"options"},"computed":false},"property":{"type":"Identifier","start":14887,"end":14894,"name":"headers"},"computed":false}]}}],"kind":"const"},{"type":"VariableDeclaration","start":14900,"end":14974,"declarations":[{"type":"VariableDeclarator","start":14906,"end":14974,"id":{"type":"Identifier","start":14906,"end":14916,"name":"reqOptions"},"init":{"type":"ObjectExpression","start":14919,"end":14974,"properties":[{"type":"Property","start":14921,"end":14947,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":14921,"end":14924,"name":"url"},"value":{"type":"MemberExpression","start":14926,"end":14947,"object":{"type":"MemberExpression","start":14926,"end":14938,"object":{"type":"ThisExpression","start":14926,"end":14930},"property":{"type":"Identifier","start":14931,"end":14938,"name":"options"},"computed":false},"property":{"type":"Identifier","start":14939,"end":14947,"name":"endpoint"},"computed":false},"kind":"init"},{"type":"Property","start":14949,"end":14956,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":14949,"end":14956,"name":"headers"},"kind":"init","value":{"type":"Identifier","start":14949,"end":14956,"name":"headers"}},{"type":"Property","start":14958,"end":14972,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":14958,"end":14966,"name":"encoding"},"value":{"type":"Literal","start":14968,"end":14972,"value":null,"raw":"null"},"kind":"init"}]}}],"kind":"const"},{"type":"IfStatement","start":14979,"end":15383,"test":{"type":"MemberExpression","start":14983,"end":15007,"object":{"type":"MemberExpression","start":14983,"end":14995,"object":{"type":"ThisExpression","start":14983,"end":14987},"property":{"type":"Identifier","start":14988,"end":14995,"name":"options"},"computed":false},"property":{"type":"Identifier","start":14996,"end":15007,"name":"useFormData"},"computed":false},"consequent":{"type":"BlockStatement","start":15009,"end":15341,"body":[{"type":"ExpressionStatement","start":15017,"end":15335,"expression":{"type":"AssignmentExpression","start":15017,"end":15335,"operator":"=","left":{"type":"MemberExpression","start":15017,"end":15036,"object":{"type":"Identifier","start":15017,"end":15027,"name":"reqOptions"},"property":{"type":"Identifier","start":15028,"end":15036,"name":"formData"},"computed":false},"right":{"type":"CallExpression","start":15039,"end":15335,"callee":{"type":"MemberExpression","start":15039,"end":15052,"object":{"type":"Identifier","start":15039,"end":15045,"name":"Object"},"property":{"type":"Identifier","start":15046,"end":15052,"name":"assign"},"computed":false},"arguments":[{"type":"ObjectExpression","start":15062,"end":15064,"properties":[]},{"type":"MemberExpression","start":15074,"end":15095,"object":{"type":"MemberExpression","start":15074,"end":15086,"object":{"type":"ThisExpression","start":15074,"end":15078},"property":{"type":"Identifier","start":15079,"end":15086,"name":"options"},"computed":false},"property":{"type":"Identifier","start":15087,"end":15095,"name":"metadata"},"computed":false},{"type":"ObjectExpression","start":15105,"end":15327,"properties":[{"type":"Property","start":15117,"end":15317,"method":false,"shorthand":false,"computed":true,"key":{"type":"MemberExpression","start":15118,"end":15140,"object":{"type":"MemberExpression","start":15118,"end":15130,"object":{"type":"ThisExpression","start":15118,"end":15122},"property":{"type":"Identifier","start":15123,"end":15130,"name":"options"},"computed":false},"property":{"type":"Identifier","start":15131,"end":15140,"name":"fieldname"},"computed":false},"value":{"type":"ObjectExpression","start":15143,"end":15317,"properties":[{"type":"Property","start":15157,"end":15168,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":15157,"end":15162,"name":"value"},"value":{"type":"Identifier","start":15164,"end":15168,"name":"file"},"kind":"init"},{"type":"Property","start":15182,"end":15305,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":15182,"end":15189,"name":"options"},"value":{"type":"ObjectExpression","start":15191,"end":15305,"properties":[{"type":"Property","start":15207,"end":15236,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":15207,"end":15215,"name":"filename"},"value":{"type":"MemberExpression","start":15217,"end":15236,"object":{"type":"ThisExpression","start":15217,"end":15221},"property":{"type":"Identifier","start":15222,"end":15236,"name":"uploadFileName"},"computed":false},"kind":"init"},{"type":"Property","start":15252,"end":15291,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":15252,"end":15263,"name":"contentType"},"value":{"type":"MemberExpression","start":15265,"end":15291,"object":{"type":"MemberExpression","start":15265,"end":15286,"object":{"type":"MemberExpression","start":15265,"end":15277,"object":{"type":"ThisExpression","start":15265,"end":15269},"property":{"type":"Identifier","start":15270,"end":15277,"name":"options"},"computed":false},"property":{"type":"Identifier","start":15278,"end":15286,"name":"metadata"},"computed":false},"property":{"type":"Identifier","start":15287,"end":15291,"name":"type"},"computed":false},"kind":"init"}]},"kind":"init"}]},"kind":"init"}]}]}}}]},"alternate":{"type":"BlockStatement","start":15347,"end":15383,"body":[{"type":"ExpressionStatement","start":15355,"end":15377,"expression":{"type":"AssignmentExpression","start":15355,"end":15377,"operator":"=","left":{"type":"MemberExpression","start":15355,"end":15370,"object":{"type":"Identifier","start":15355,"end":15365,"name":"reqOptions"},"property":{"type":"Identifier","start":15366,"end":15370,"name":"body"},"computed":false},"right":{"type":"Identifier","start":15373,"end":15377,"name":"file"}}}]}},{"type":"ExpressionStatement","start":15389,"end":16527,"expression":{"type":"CallExpression","start":15389,"end":16527,"callee":{"type":"MemberExpression","start":15389,"end":15408,"object":{"type":"Identifier","start":15389,"end":15396,"name":"request"},"property":{"type":"Identifier","start":15397,"end":15407,"name":"httpMethod"},"computed":true},"arguments":[{"type":"Identifier","start":15409,"end":15419,"name":"reqOptions"},{"type":"ArrowFunctionExpression","start":15421,"end":16526,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":15422,"end":15427,"name":"error"},{"type":"Identifier","start":15429,"end":15437,"name":"response"},{"type":"Identifier","start":15439,"end":15443,"name":"body"}],"body":{"type":"BlockStatement","start":15448,"end":16526,"body":[{"type":"IfStatement","start":15456,"end":15575,"test":{"type":"Identifier","start":15460,"end":15465,"name":"error"},"consequent":{"type":"BlockStatement","start":15467,"end":15575,"body":[{"type":"ExpressionStatement","start":15477,"end":15522,"expression":{"type":"CallExpression","start":15477,"end":15522,"callee":{"type":"MemberExpression","start":15477,"end":15489,"object":{"type":"Identifier","start":15477,"end":15483,"name":"logger"},"property":{"type":"Identifier","start":15484,"end":15489,"name":"error"},"computed":false},"arguments":[{"type":"Identifier","start":15490,"end":15495,"name":"error"},{"type":"Literal","start":15497,"end":15521,"value":"upload.multipart.error","raw":"'upload.multipart.error'"}]}},{"type":"ExpressionStatement","start":15531,"end":15552,"expression":{"type":"CallExpression","start":15531,"end":15552,"callee":{"type":"MemberExpression","start":15531,"end":15545,"object":{"type":"ThisExpression","start":15531,"end":15535},"property":{"type":"Identifier","start":15536,"end":15545,"name":"emitError"},"computed":false},"arguments":[{"type":"Identifier","start":15546,"end":15551,"name":"error"}]}},{"type":"ReturnStatement","start":15561,"end":15567,"argument":null}]},"alternate":null},{"type":"VariableDeclaration","start":15582,"end":15614,"declarations":[{"type":"VariableDeclarator","start":15588,"end":15614,"id":{"type":"Identifier","start":15588,"end":15595,"name":"headers"},"init":{"type":"MemberExpression","start":15598,"end":15614,"object":{"type":"Identifier","start":15598,"end":15606,"name":"response"},"property":{"type":"Identifier","start":15607,"end":15614,"name":"headers"},"computed":false}}],"kind":"const"},{"type":"ExpressionStatement","start":15663,"end":15691,"expression":{"type":"UnaryExpression","start":15663,"end":15691,"operator":"delete","prefix":true,"argument":{"type":"MemberExpression","start":15670,"end":15691,"object":{"type":"Identifier","start":15670,"end":15677,"name":"headers"},"property":{"type":"Literal","start":15678,"end":15690,"value":"set-cookie","raw":"'set-cookie'"},"computed":true}}},{"type":"ExpressionStatement","start":15698,"end":15727,"expression":{"type":"UnaryExpression","start":15698,"end":15727,"operator":"delete","prefix":true,"argument":{"type":"MemberExpression","start":15705,"end":15727,"object":{"type":"Identifier","start":15705,"end":15712,"name":"headers"},"property":{"type":"Literal","start":15713,"end":15726,"value":"set-cookie2","raw":"'set-cookie2'"},"computed":true}}},{"type":"VariableDeclaration","start":15735,"end":15896,"declarations":[{"type":"VariableDeclarator","start":15741,"end":15896,"id":{"type":"Identifier","start":15741,"end":15748,"name":"respObj"},"init":{"type":"ObjectExpression","start":15751,"end":15896,"properties":[{"type":"Property","start":15761,"end":15790,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":15761,"end":15773,"name":"responseText"},"value":{"type":"CallExpression","start":15775,"end":15790,"callee":{"type":"MemberExpression","start":15775,"end":15788,"object":{"type":"Identifier","start":15775,"end":15779,"name":"body"},"property":{"type":"Identifier","start":15780,"end":15788,"name":"toString"},"computed":false},"arguments":[]},"kind":"init"},{"type":"Property","start":15800,"end":15827,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":15800,"end":15806,"name":"status"},"value":{"type":"MemberExpression","start":15808,"end":15827,"object":{"type":"Identifier","start":15808,"end":15816,"name":"response"},"property":{"type":"Identifier","start":15817,"end":15827,"name":"statusCode"},"computed":false},"kind":"init"},{"type":"Property","start":15837,"end":15871,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":15837,"end":15847,"name":"statusText"},"value":{"type":"MemberExpression","start":15849,"end":15871,"object":{"type":"Identifier","start":15849,"end":15857,"name":"response"},"property":{"type":"Identifier","start":15858,"end":15871,"name":"statusMessage"},"computed":false},"kind":"init"},{"type":"Property","start":15881,"end":15888,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":15881,"end":15888,"name":"headers"},"kind":"init","value":{"type":"Identifier","start":15881,"end":15888,"name":"headers"}}]}}],"kind":"const"},{"type":"IfStatement","start":15904,"end":16498,"test":{"type":"BinaryExpression","start":15908,"end":15934,"left":{"type":"MemberExpression","start":15908,"end":15927,"object":{"type":"Identifier","start":15908,"end":15916,"name":"response"},"property":{"type":"Identifier","start":15917,"end":15927,"name":"statusCode"},"computed":false},"operator":">=","right":{"type":"Literal","start":15931,"end":15934,"value":400,"raw":"400"}},"consequent":{"type":"BlockStatement","start":15936,"end":16112,"body":[{"type":"ExpressionStatement","start":15946,"end":16037,"expression":{"type":"CallExpression","start":15946,"end":16037,"callee":{"type":"MemberExpression","start":15946,"end":15958,"object":{"type":"Identifier","start":15946,"end":15952,"name":"logger"},"property":{"type":"Identifier","start":15953,"end":15958,"name":"error"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":15959,"end":16010,"expressions":[{"type":"MemberExpression","start":15989,"end":16008,"object":{"type":"Identifier","start":15989,"end":15997,"name":"response"},"property":{"type":"Identifier","start":15998,"end":16008,"name":"statusCode"},"computed":false}],"quasis":[{"type":"TemplateElement","start":15960,"end":15987,"value":{"raw":"upload failed with status: ","cooked":"upload failed with status: "},"tail":false},{"type":"TemplateElement","start":16009,"end":16009,"value":{"raw":"","cooked":""},"tail":true}]},{"type":"Literal","start":16012,"end":16036,"value":"upload.multipart.error","raw":"'upload.multipart.error'"}]}},{"type":"ExpressionStatement","start":16046,"end":16104,"expression":{"type":"CallExpression","start":16046,"end":16104,"callee":{"type":"MemberExpression","start":16046,"end":16060,"object":{"type":"ThisExpression","start":16046,"end":16050},"property":{"type":"Identifier","start":16051,"end":16060,"name":"emitError"},"computed":false},"arguments":[{"type":"NewExpression","start":16061,"end":16094,"callee":{"type":"Identifier","start":16065,"end":16070,"name":"Error"},"arguments":[{"type":"MemberExpression","start":16071,"end":16093,"object":{"type":"Identifier","start":16071,"end":16079,"name":"response"},"property":{"type":"Identifier","start":16080,"end":16093,"name":"statusMessage"},"computed":false}]},{"type":"Identifier","start":16096,"end":16103,"name":"respObj"}]}}]},"alternate":{"type":"IfStatement","start":16118,"end":16498,"test":{"type":"LogicalExpression","start":16122,"end":16196,"left":{"type":"BinaryExpression","start":16122,"end":16157,"left":{"type":"Identifier","start":16122,"end":16135,"name":"bytesUploaded"},"operator":"!==","right":{"type":"MemberExpression","start":16140,"end":16157,"object":{"type":"ThisExpression","start":16140,"end":16144},"property":{"type":"Identifier","start":16145,"end":16157,"name":"bytesWritten"},"computed":false}},"operator":"&&","right":{"type":"BinaryExpression","start":16161,"end":16196,"left":{"type":"Identifier","start":16161,"end":16174,"name":"bytesUploaded"},"operator":"!==","right":{"type":"MemberExpression","start":16179,"end":16196,"object":{"type":"MemberExpression","start":16179,"end":16191,"object":{"type":"ThisExpression","start":16179,"end":16183},"property":{"type":"Identifier","start":16184,"end":16191,"name":"options"},"computed":false},"property":{"type":"Identifier","start":16192,"end":16196,"name":"size"},"computed":false}}},"consequent":{"type":"BlockStatement","start":16198,"end":16429,"body":[{"type":"VariableDeclaration","start":16208,"end":16315,"declarations":[{"type":"VariableDeclarator","start":16214,"end":16315,"id":{"type":"Identifier","start":16214,"end":16220,"name":"errMsg"},"init":{"type":"TemplateLiteral","start":16223,"end":16315,"expressions":[{"type":"Identifier","start":16240,"end":16253,"name":"bytesUploaded"},{"type":"MemberExpression","start":16260,"end":16277,"object":{"type":"ThisExpression","start":16260,"end":16264},"property":{"type":"Identifier","start":16265,"end":16277,"name":"bytesWritten"},"computed":false},{"type":"MemberExpression","start":16294,"end":16313,"object":{"type":"Identifier","start":16294,"end":16302,"name":"response"},"property":{"type":"Identifier","start":16303,"end":16313,"name":"statusCode"},"computed":false}],"quasis":[{"type":"TemplateElement","start":16224,"end":16238,"value":{"raw":"uploaded only ","cooked":"uploaded only "},"tail":false},{"type":"TemplateElement","start":16254,"end":16258,"value":{"raw":" of ","cooked":" of "},"tail":false},{"type":"TemplateElement","start":16278,"end":16292,"value":{"raw":" with status: ","cooked":" with status: "},"tail":false},{"type":"TemplateElement","start":16314,"end":16314,"value":{"raw":"","cooked":""},"tail":true}]}}],"kind":"const"},{"type":"ExpressionStatement","start":16324,"end":16379,"expression":{"type":"CallExpression","start":16324,"end":16379,"callee":{"type":"MemberExpression","start":16324,"end":16336,"object":{"type":"Identifier","start":16324,"end":16330,"name":"logger"},"property":{"type":"Identifier","start":16331,"end":16336,"name":"error"},"computed":false},"arguments":[{"type":"Identifier","start":16337,"end":16343,"name":"errMsg"},{"type":"Literal","start":16345,"end":16378,"value":"upload.multipart.mismatch.error","raw":"'upload.multipart.mismatch.error'"}]}},{"type":"ExpressionStatement","start":16388,"end":16421,"expression":{"type":"CallExpression","start":16388,"end":16421,"callee":{"type":"MemberExpression","start":16388,"end":16402,"object":{"type":"ThisExpression","start":16388,"end":16392},"property":{"type":"Identifier","start":16393,"end":16402,"name":"emitError"},"computed":false},"arguments":[{"type":"NewExpression","start":16403,"end":16420,"callee":{"type":"Identifier","start":16407,"end":16412,"name":"Error"},"arguments":[{"type":"Identifier","start":16413,"end":16419,"name":"errMsg"}]}]}}]},"alternate":{"type":"BlockStatement","start":16435,"end":16498,"body":[{"type":"ExpressionStatement","start":16445,"end":16490,"expression":{"type":"CallExpression","start":16445,"end":16490,"callee":{"type":"MemberExpression","start":16445,"end":16461,"object":{"type":"ThisExpression","start":16445,"end":16449},"property":{"type":"Identifier","start":16450,"end":16461,"name":"emitSuccess"},"computed":false},"arguments":[{"type":"Literal","start":16462,"end":16466,"value":null,"raw":"null"},{"type":"ObjectExpression","start":16468,"end":16489,"properties":[{"type":"Property","start":16470,"end":16487,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":16470,"end":16478,"name":"response"},"value":{"type":"Identifier","start":16480,"end":16487,"name":"respObj"},"kind":"init"}]}]}}]}}},{"type":"ExpressionStatement","start":16506,"end":16520,"expression":{"type":"CallExpression","start":16506,"end":16520,"callee":{"type":"MemberExpression","start":16506,"end":16518,"object":{"type":"ThisExpression","start":16506,"end":16510},"property":{"type":"Identifier","start":16511,"end":16518,"name":"cleanUp"},"computed":false},"arguments":[]}}]}}]}}]}}},{"type":"MethodDefinition","start":16600,"end":16722,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":16600,"end":16617,"name":"uploadS3Multipart"},"value":{"type":"FunctionExpression","start":16618,"end":16722,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":16621,"end":16722,"body":[{"type":"VariableDeclaration","start":16627,"end":16670,"declarations":[{"type":"VariableDeclarator","start":16633,"end":16670,"id":{"type":"Identifier","start":16633,"end":16637,"name":"file"},"init":{"type":"CallExpression","start":16640,"end":16670,"callee":{"type":"MemberExpression","start":16640,"end":16659,"object":{"type":"Identifier","start":16640,"end":16642,"name":"fs"},"property":{"type":"Identifier","start":16643,"end":16659,"name":"createReadStream"},"computed":false},"arguments":[{"type":"MemberExpression","start":16660,"end":16669,"object":{"type":"ThisExpression","start":16660,"end":16664},"property":{"type":"Identifier","start":16665,"end":16669,"name":"path"},"computed":false}]}}],"kind":"const"},{"type":"ReturnStatement","start":16676,"end":16718,"argument":{"type":"CallExpression","start":16683,"end":16718,"callee":{"type":"MemberExpression","start":16683,"end":16712,"object":{"type":"ThisExpression","start":16683,"end":16687},"property":{"type":"Identifier","start":16688,"end":16712,"name":"_uploadS3MultipartStream"},"computed":false},"arguments":[{"type":"Identifier","start":16713,"end":16717,"name":"file"}]}}]}}},{"type":"MethodDefinition","start":16766,"end":17876,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":16766,"end":16790,"name":"_uploadS3MultipartStream"},"value":{"type":"FunctionExpression","start":16791,"end":17876,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":16792,"end":16798,"name":"stream"}],"body":{"type":"BlockStatement","start":16800,"end":17876,"body":[{"type":"IfStatement","start":16806,"end":16943,"test":{"type":"UnaryExpression","start":16810,"end":16826,"operator":"!","prefix":true,"argument":{"type":"MemberExpression","start":16811,"end":16826,"object":{"type":"MemberExpression","start":16811,"end":16823,"object":{"type":"ThisExpression","start":16811,"end":16815},"property":{"type":"Identifier","start":16816,"end":16823,"name":"options"},"computed":false},"property":{"type":"Identifier","start":16824,"end":16826,"name":"s3"},"computed":false}},"consequent":{"type":"BlockStatement","start":16828,"end":16943,"body":[{"type":"ExpressionStatement","start":16836,"end":16924,"expression":{"type":"CallExpression","start":16836,"end":16924,"callee":{"type":"MemberExpression","start":16836,"end":16850,"object":{"type":"ThisExpression","start":16836,"end":16840},"property":{"type":"Identifier","start":16841,"end":16850,"name":"emitError"},"computed":false},"arguments":[{"type":"NewExpression","start":16851,"end":16923,"callee":{"type":"Identifier","start":16855,"end":16860,"name":"Error"},"arguments":[{"type":"Literal","start":16861,"end":16922,"value":"The S3 client is not configured on this companion instance.","raw":"'The S3 client is not configured on this companion instance.'"}]}]}},{"type":"ReturnStatement","start":16931,"end":16937,"argument":null}]},"alternate":null},{"type":"VariableDeclaration","start":16949,"end":17020,"declarations":[{"type":"VariableDeclarator","start":16955,"end":17020,"id":{"type":"Identifier","start":16955,"end":16963,"name":"filename"},"init":{"type":"LogicalExpression","start":16966,"end":17020,"left":{"type":"MemberExpression","start":16966,"end":16992,"object":{"type":"MemberExpression","start":16966,"end":16987,"object":{"type":"MemberExpression","start":16966,"end":16978,"object":{"type":"ThisExpression","start":16966,"end":16970},"property":{"type":"Identifier","start":16971,"end":16978,"name":"options"},"computed":false},"property":{"type":"Identifier","start":16979,"end":16987,"name":"metadata"},"computed":false},"property":{"type":"Identifier","start":16988,"end":16992,"name":"name"},"computed":false},"operator":"||","right":{"type":"CallExpression","start":16996,"end":17020,"callee":{"type":"MemberExpression","start":16996,"end":17009,"object":{"type":"Identifier","start":16996,"end":17000,"name":"path"},"property":{"type":"Identifier","start":17001,"end":17009,"name":"basename"},"computed":false},"arguments":[{"type":"MemberExpression","start":17010,"end":17019,"object":{"type":"ThisExpression","start":17010,"end":17014},"property":{"type":"Identifier","start":17015,"end":17019,"name":"path"},"computed":false}]}}}],"kind":"const"},{"type":"VariableDeclaration","start":17025,"end":17068,"declarations":[{"type":"VariableDeclarator","start":17031,"end":17068,"id":{"type":"ObjectPattern","start":17031,"end":17050,"properties":[{"type":"Property","start":17033,"end":17039,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":17033,"end":17039,"name":"client"},"kind":"init","value":{"type":"Identifier","start":17033,"end":17039,"name":"client"}},{"type":"Property","start":17041,"end":17048,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":17041,"end":17048,"name":"options"},"kind":"init","value":{"type":"Identifier","start":17041,"end":17048,"name":"options"}}]},"init":{"type":"MemberExpression","start":17053,"end":17068,"object":{"type":"MemberExpression","start":17053,"end":17065,"object":{"type":"ThisExpression","start":17053,"end":17057},"property":{"type":"Identifier","start":17058,"end":17065,"name":"options"},"computed":false},"property":{"type":"Identifier","start":17066,"end":17068,"name":"s3"},"computed":false}}],"kind":"const"},{"type":"VariableDeclaration","start":17074,"end":17297,"declarations":[{"type":"VariableDeclarator","start":17080,"end":17297,"id":{"type":"Identifier","start":17080,"end":17086,"name":"upload"},"init":{"type":"CallExpression","start":17089,"end":17297,"callee":{"type":"MemberExpression","start":17089,"end":17102,"object":{"type":"Identifier","start":17089,"end":17095,"name":"client"},"property":{"type":"Identifier","start":17096,"end":17102,"name":"upload"},"computed":false},"arguments":[{"type":"ObjectExpression","start":17103,"end":17296,"properties":[{"type":"Property","start":17111,"end":17133,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":17111,"end":17117,"name":"Bucket"},"value":{"type":"MemberExpression","start":17119,"end":17133,"object":{"type":"Identifier","start":17119,"end":17126,"name":"options"},"property":{"type":"Identifier","start":17127,"end":17133,"name":"bucket"},"computed":false},"kind":"init"},{"type":"Property","start":17141,"end":17199,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":17141,"end":17144,"name":"Key"},"value":{"type":"CallExpression","start":17146,"end":17199,"callee":{"type":"MemberExpression","start":17146,"end":17160,"object":{"type":"Identifier","start":17146,"end":17153,"name":"options"},"property":{"type":"Identifier","start":17154,"end":17160,"name":"getKey"},"computed":false},"arguments":[{"type":"Literal","start":17161,"end":17165,"value":null,"raw":"null"},{"type":"Identifier","start":17167,"end":17175,"name":"filename"},{"type":"MemberExpression","start":17177,"end":17198,"object":{"type":"MemberExpression","start":17177,"end":17189,"object":{"type":"ThisExpression","start":17177,"end":17181},"property":{"type":"Identifier","start":17182,"end":17189,"name":"options"},"computed":false},"property":{"type":"Identifier","start":17190,"end":17198,"name":"metadata"},"computed":false}]},"kind":"init"},{"type":"Property","start":17207,"end":17223,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":17207,"end":17210,"name":"ACL"},"value":{"type":"MemberExpression","start":17212,"end":17223,"object":{"type":"Identifier","start":17212,"end":17219,"name":"options"},"property":{"type":"Identifier","start":17220,"end":17223,"name":"acl"},"computed":false},"kind":"init"},{"type":"Property","start":17231,"end":17270,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":17231,"end":17242,"name":"ContentType"},"value":{"type":"MemberExpression","start":17244,"end":17270,"object":{"type":"MemberExpression","start":17244,"end":17265,"object":{"type":"MemberExpression","start":17244,"end":17256,"object":{"type":"ThisExpression","start":17244,"end":17248},"property":{"type":"Identifier","start":17249,"end":17256,"name":"options"},"computed":false},"property":{"type":"Identifier","start":17257,"end":17265,"name":"metadata"},"computed":false},"property":{"type":"Identifier","start":17266,"end":17270,"name":"type"},"computed":false},"kind":"init"},{"type":"Property","start":17278,"end":17290,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":17278,"end":17282,"name":"Body"},"value":{"type":"Identifier","start":17284,"end":17290,"name":"stream"},"kind":"init"}]}]}}],"kind":"const"},{"type":"ExpressionStatement","start":17303,"end":17325,"expression":{"type":"AssignmentExpression","start":17303,"end":17325,"operator":"=","left":{"type":"MemberExpression","start":17303,"end":17316,"object":{"type":"ThisExpression","start":17303,"end":17307},"property":{"type":"Identifier","start":17308,"end":17316,"name":"s3Upload"},"computed":false},"right":{"type":"Identifier","start":17319,"end":17325,"name":"upload"}}},{"type":"ExpressionStatement","start":17331,"end":17433,"expression":{"type":"CallExpression","start":17331,"end":17433,"callee":{"type":"MemberExpression","start":17331,"end":17340,"object":{"type":"Identifier","start":17331,"end":17337,"name":"upload"},"property":{"type":"Identifier","start":17338,"end":17340,"name":"on"},"computed":false},"arguments":[{"type":"Literal","start":17341,"end":17361,"value":"httpUploadProgress","raw":"'httpUploadProgress'"},{"type":"ArrowFunctionExpression","start":17363,"end":17432,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"ObjectPattern","start":17364,"end":17381,"properties":[{"type":"Property","start":17366,"end":17372,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":17366,"end":17372,"name":"loaded"},"kind":"init","value":{"type":"Identifier","start":17366,"end":17372,"name":"loaded"}},{"type":"Property","start":17374,"end":17379,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":17374,"end":17379,"name":"total"},"kind":"init","value":{"type":"Identifier","start":17374,"end":17379,"name":"total"}}]}],"body":{"type":"BlockStatement","start":17386,"end":17432,"body":[{"type":"ExpressionStatement","start":17394,"end":17426,"expression":{"type":"CallExpression","start":17394,"end":17426,"callee":{"type":"MemberExpression","start":17394,"end":17411,"object":{"type":"ThisExpression","start":17394,"end":17398},"property":{"type":"Identifier","start":17399,"end":17411,"name":"emitProgress"},"computed":false},"arguments":[{"type":"Identifier","start":17412,"end":17418,"name":"loaded"},{"type":"Identifier","start":17420,"end":17425,"name":"total"}]}}]}}]}},{"type":"ExpressionStatement","start":17439,"end":17872,"expression":{"type":"CallExpression","start":17439,"end":17872,"callee":{"type":"MemberExpression","start":17439,"end":17450,"object":{"type":"Identifier","start":17439,"end":17445,"name":"upload"},"property":{"type":"Identifier","start":17446,"end":17450,"name":"send"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":17451,"end":17871,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":17452,"end":17457,"name":"error"},{"type":"Identifier","start":17459,"end":17463,"name":"data"}],"body":{"type":"BlockStatement","start":17468,"end":17871,"body":[{"type":"ExpressionStatement","start":17476,"end":17496,"expression":{"type":"AssignmentExpression","start":17476,"end":17496,"operator":"=","left":{"type":"MemberExpression","start":17476,"end":17489,"object":{"type":"ThisExpression","start":17476,"end":17480},"property":{"type":"Identifier","start":17481,"end":17489,"name":"s3Upload"},"computed":false},"right":{"type":"Literal","start":17492,"end":17496,"value":null,"raw":"null"}}},{"type":"IfStatement","start":17503,"end":17844,"test":{"type":"Identifier","start":17507,"end":17512,"name":"error"},"consequent":{"type":"BlockStatement","start":17514,"end":17553,"body":[{"type":"ExpressionStatement","start":17524,"end":17545,"expression":{"type":"CallExpression","start":17524,"end":17545,"callee":{"type":"MemberExpression","start":17524,"end":17538,"object":{"type":"ThisExpression","start":17524,"end":17528},"property":{"type":"Identifier","start":17529,"end":17538,"name":"emitError"},"computed":false},"arguments":[{"type":"Identifier","start":17539,"end":17544,"name":"error"}]}}]},"alternate":{"type":"BlockStatement","start":17559,"end":17844,"body":[{"type":"VariableDeclaration","start":17569,"end":17625,"declarations":[{"type":"VariableDeclarator","start":17575,"end":17625,"id":{"type":"Identifier","start":17575,"end":17578,"name":"url"},"init":{"type":"ConditionalExpression","start":17581,"end":17625,"test":{"type":"LogicalExpression","start":17581,"end":17602,"left":{"type":"Identifier","start":17581,"end":17585,"name":"data"},"operator":"&&","right":{"type":"MemberExpression","start":17589,"end":17602,"object":{"type":"Identifier","start":17589,"end":17593,"name":"data"},"property":{"type":"Identifier","start":17594,"end":17602,"name":"Location"},"computed":false}},"consequent":{"type":"MemberExpression","start":17605,"end":17618,"object":{"type":"Identifier","start":17605,"end":17609,"name":"data"},"property":{"type":"Identifier","start":17610,"end":17618,"name":"Location"},"computed":false},"alternate":{"type":"Literal","start":17621,"end":17625,"value":null,"raw":"null"}}}],"kind":"const"},{"type":"ExpressionStatement","start":17634,"end":17836,"expression":{"type":"CallExpression","start":17634,"end":17836,"callee":{"type":"MemberExpression","start":17634,"end":17650,"object":{"type":"ThisExpression","start":17634,"end":17638},"property":{"type":"Identifier","start":17639,"end":17650,"name":"emitSuccess"},"computed":false},"arguments":[{"type":"Identifier","start":17651,"end":17654,"name":"url"},{"type":"ObjectExpression","start":17656,"end":17835,"properties":[{"type":"Property","start":17668,"end":17825,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":17668,"end":17676,"name":"response"},"value":{"type":"ObjectExpression","start":17678,"end":17825,"properties":[{"type":"Property","start":17692,"end":17726,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":17692,"end":17704,"name":"responseText"},"value":{"type":"CallExpression","start":17706,"end":17726,"callee":{"type":"MemberExpression","start":17706,"end":17720,"object":{"type":"Identifier","start":17706,"end":17710,"name":"JSON"},"property":{"type":"Identifier","start":17711,"end":17720,"name":"stringify"},"computed":false},"arguments":[{"type":"Identifier","start":17721,"end":17725,"name":"data"}]},"kind":"init"},{"type":"Property","start":17740,"end":17813,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":17740,"end":17747,"name":"headers"},"value":{"type":"ObjectExpression","start":17749,"end":17813,"properties":[{"type":"Property","start":17765,"end":17799,"method":false,"shorthand":false,"computed":false,"key":{"type":"Literal","start":17765,"end":17779,"value":"content-type","raw":"'content-type'"},"value":{"type":"Literal","start":17781,"end":17799,"value":"application/json","raw":"'application/json'"},"kind":"init"}]},"kind":"init"}]},"kind":"init"}]}]}}]}},{"type":"ExpressionStatement","start":17851,"end":17865,"expression":{"type":"CallExpression","start":17851,"end":17865,"callee":{"type":"MemberExpression","start":17851,"end":17863,"object":{"type":"ThisExpression","start":17851,"end":17855},"property":{"type":"Identifier","start":17856,"end":17863,"name":"cleanUp"},"computed":false},"arguments":[]}}]}}]}}]}}}]}},{"type":"ExpressionStatement","start":17880,"end":17919,"expression":{"type":"AssignmentExpression","start":17880,"end":17919,"operator":"=","left":{"type":"MemberExpression","start":17880,"end":17905,"object":{"type":"Identifier","start":17880,"end":17888,"name":"Uploader"},"property":{"type":"Identifier","start":17889,"end":17905,"name":"FILE_NAME_PREFIX"},"computed":false},"right":{"type":"Literal","start":17908,"end":17919,"value":"uppy-file","raw":"'uppy-file'"}}},{"type":"ExpressionStatement","start":17920,"end":17957,"expression":{"type":"AssignmentExpression","start":17920,"end":17957,"operator":"=","left":{"type":"MemberExpression","start":17920,"end":17943,"object":{"type":"Identifier","start":17920,"end":17928,"name":"Uploader"},"property":{"type":"Identifier","start":17929,"end":17943,"name":"STORAGE_PREFIX"},"computed":false},"right":{"type":"Literal","start":17946,"end":17957,"value":"companion","raw":"'companion'"}}},{"type":"ExpressionStatement","start":17959,"end":17984,"expression":{"type":"AssignmentExpression","start":17959,"end":17984,"operator":"=","left":{"type":"MemberExpression","start":17959,"end":17973,"object":{"type":"Identifier","start":17959,"end":17965,"name":"module"},"property":{"type":"Identifier","start":17966,"end":17973,"name":"exports"},"computed":false},"right":{"type":"Identifier","start":17976,"end":17984,"name":"Uploader"}}}],"sourceType":"script"}