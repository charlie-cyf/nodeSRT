{"type":"Program","start":0,"end":9721,"body":[{"type":"ExpressionStatement","start":67,"end":93,"expression":{"type":"CallExpression","start":67,"end":93,"callee":{"type":"MemberExpression","start":67,"end":76,"object":{"type":"Identifier","start":67,"end":71,"name":"jest"},"property":{"type":"Identifier","start":72,"end":76,"name":"mock"},"computed":false},"arguments":[{"type":"Literal","start":77,"end":92,"value":"tus-js-client","raw":"'tus-js-client'"}]}},{"type":"ExpressionStatement","start":94,"end":113,"expression":{"type":"CallExpression","start":94,"end":113,"callee":{"type":"MemberExpression","start":94,"end":103,"object":{"type":"Identifier","start":94,"end":98,"name":"jest"},"property":{"type":"Identifier","start":99,"end":103,"name":"mock"},"computed":false},"arguments":[{"type":"Literal","start":104,"end":112,"value":"purest","raw":"'purest'"}]}},{"type":"ExpressionStatement","start":114,"end":878,"expression":{"type":"CallExpression","start":114,"end":878,"callee":{"type":"MemberExpression","start":114,"end":123,"object":{"type":"Identifier","start":114,"end":118,"name":"jest"},"property":{"type":"Identifier","start":119,"end":123,"name":"mock"},"computed":false},"arguments":[{"type":"Literal","start":124,"end":162,"value":"../../src/server/helpers/oauth-state","raw":"'../../src/server/helpers/oauth-state'"},{"type":"ArrowFunctionExpression","start":164,"end":877,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":170,"end":877,"body":[{"type":"ReturnStatement","start":174,"end":875,"argument":{"type":"ObjectExpression","start":181,"end":875,"properties":[{"type":"Property","start":187,"end":235,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":187,"end":200,"name":"generateState"},"value":{"type":"ArrowFunctionExpression","start":202,"end":235,"id":null,"expression":true,"generator":false,"async":false,"params":[],"body":{"type":"Literal","start":208,"end":235,"value":"some-cool-nice-encrytpion","raw":"'some-cool-nice-encrytpion'"}},"kind":"init"},{"type":"Property","start":241,"end":286,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":241,"end":251,"name":"addToState"},"value":{"type":"ArrowFunctionExpression","start":253,"end":286,"id":null,"expression":true,"generator":false,"async":false,"params":[],"body":{"type":"Literal","start":259,"end":286,"value":"some-cool-nice-encrytpion","raw":"'some-cool-nice-encrytpion'"}},"kind":"init"},{"type":"Property","start":292,"end":871,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":292,"end":304,"name":"getFromState"},"value":{"type":"ArrowFunctionExpression","start":306,"end":871,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":307,"end":312,"name":"state"},{"type":"Identifier","start":314,"end":317,"name":"key"}],"body":{"type":"BlockStatement","start":322,"end":871,"body":[{"type":"IfStatement","start":330,"end":427,"test":{"type":"BinaryExpression","start":334,"end":377,"left":{"type":"Identifier","start":334,"end":339,"name":"state"},"operator":"===","right":{"type":"Literal","start":344,"end":377,"value":"state-with-invalid-instance-url","raw":"'state-with-invalid-instance-url'"}},"consequent":{"type":"BlockStatement","start":379,"end":427,"body":[{"type":"ReturnStatement","start":389,"end":419,"argument":{"type":"Literal","start":396,"end":419,"value":"http://localhost:3452","raw":"'http://localhost:3452'"}}]},"alternate":null},{"type":"IfStatement","start":435,"end":559,"test":{"type":"LogicalExpression","start":439,"end":502,"left":{"type":"BinaryExpression","start":439,"end":475,"left":{"type":"Identifier","start":439,"end":444,"name":"state"},"operator":"===","right":{"type":"Literal","start":449,"end":475,"value":"state-with-older-version","raw":"'state-with-older-version'"}},"operator":"&&","right":{"type":"BinaryExpression","start":479,"end":502,"left":{"type":"Identifier","start":479,"end":482,"name":"key"},"operator":"===","right":{"type":"Literal","start":487,"end":502,"value":"clientVersion","raw":"'clientVersion'"}}},"consequent":{"type":"BlockStatement","start":504,"end":559,"body":[{"type":"ReturnStatement","start":514,"end":551,"argument":{"type":"Literal","start":521,"end":551,"value":"@uppy/companion-client=1.0.1","raw":"'@uppy/companion-client=1.0.1'"}}]},"alternate":null},{"type":"IfStatement","start":567,"end":691,"test":{"type":"LogicalExpression","start":571,"end":634,"left":{"type":"BinaryExpression","start":571,"end":607,"left":{"type":"Identifier","start":571,"end":576,"name":"state"},"operator":"===","right":{"type":"Literal","start":581,"end":607,"value":"state-with-newer-version","raw":"'state-with-newer-version'"}},"operator":"&&","right":{"type":"BinaryExpression","start":611,"end":634,"left":{"type":"Identifier","start":611,"end":614,"name":"key"},"operator":"===","right":{"type":"Literal","start":619,"end":634,"value":"clientVersion","raw":"'clientVersion'"}}},"consequent":{"type":"BlockStatement","start":636,"end":691,"body":[{"type":"ReturnStatement","start":646,"end":683,"argument":{"type":"Literal","start":653,"end":683,"value":"@uppy/companion-client=1.0.3","raw":"'@uppy/companion-client=1.0.3'"}}]},"alternate":null},{"type":"IfStatement","start":699,"end":827,"test":{"type":"LogicalExpression","start":703,"end":776,"left":{"type":"BinaryExpression","start":703,"end":749,"left":{"type":"Identifier","start":703,"end":708,"name":"state"},"operator":"===","right":{"type":"Literal","start":713,"end":749,"value":"state-with-newer-version-old-style","raw":"'state-with-newer-version-old-style'"}},"operator":"&&","right":{"type":"BinaryExpression","start":753,"end":776,"left":{"type":"Identifier","start":753,"end":756,"name":"key"},"operator":"===","right":{"type":"Literal","start":761,"end":776,"value":"clientVersion","raw":"'clientVersion'"}}},"consequent":{"type":"BlockStatement","start":778,"end":827,"body":[{"type":"ReturnStatement","start":788,"end":819,"argument":{"type":"Literal","start":795,"end":819,"value":"companion-client:1.0.2","raw":"'companion-client:1.0.2'"}}]},"alternate":null},{"type":"ReturnStatement","start":835,"end":865,"argument":{"type":"Literal","start":842,"end":865,"value":"http://localhost:3020","raw":"'http://localhost:3020'"}}]}},"kind":"init"}]}}]}}]}},{"type":"VariableDeclaration","start":880,"end":916,"declarations":[{"type":"VariableDeclarator","start":886,"end":916,"id":{"type":"Identifier","start":886,"end":893,"name":"request"},"init":{"type":"CallExpression","start":896,"end":916,"callee":{"type":"Identifier","start":896,"end":903,"name":"require"},"arguments":[{"type":"Literal","start":904,"end":915,"value":"supertest","raw":"'supertest'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":917,"end":977,"declarations":[{"type":"VariableDeclarator","start":923,"end":977,"id":{"type":"Identifier","start":923,"end":935,"name":"tokenService"},"init":{"type":"CallExpression","start":938,"end":977,"callee":{"type":"Identifier","start":938,"end":945,"name":"require"},"arguments":[{"type":"Literal","start":946,"end":976,"value":"../../src/server/helpers/jwt","raw":"'../../src/server/helpers/jwt'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":978,"end":1025,"declarations":[{"type":"VariableDeclarator","start":984,"end":1025,"id":{"type":"ObjectPattern","start":984,"end":998,"properties":[{"type":"Property","start":986,"end":996,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":986,"end":996,"name":"authServer"},"kind":"init","value":{"type":"Identifier","start":986,"end":996,"name":"authServer"}}]},"init":{"type":"CallExpression","start":1001,"end":1025,"callee":{"type":"Identifier","start":1001,"end":1008,"name":"require"},"arguments":[{"type":"Literal","start":1009,"end":1024,"value":"../mockserver","raw":"'../mockserver'"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":1026,"end":1095,"declarations":[{"type":"VariableDeclarator","start":1032,"end":1095,"id":{"type":"Identifier","start":1032,"end":1040,"name":"authData"},"init":{"type":"ObjectExpression","start":1043,"end":1095,"properties":[{"type":"Property","start":1047,"end":1069,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1047,"end":1054,"name":"dropbox"},"value":{"type":"Literal","start":1056,"end":1069,"value":"token value","raw":"'token value'"},"kind":"init"},{"type":"Property","start":1073,"end":1093,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1073,"end":1078,"name":"drive"},"value":{"type":"Literal","start":1080,"end":1093,"value":"token value","raw":"'token value'"},"kind":"init"}]}}],"kind":"const"},{"type":"VariableDeclaration","start":1096,"end":1176,"declarations":[{"type":"VariableDeclarator","start":1102,"end":1176,"id":{"type":"Identifier","start":1102,"end":1107,"name":"token"},"init":{"type":"CallExpression","start":1110,"end":1176,"callee":{"type":"MemberExpression","start":1110,"end":1136,"object":{"type":"Identifier","start":1110,"end":1122,"name":"tokenService"},"property":{"type":"Identifier","start":1123,"end":1136,"name":"generateToken"},"computed":false},"arguments":[{"type":"Identifier","start":1137,"end":1145,"name":"authData"},{"type":"MemberExpression","start":1147,"end":1175,"object":{"type":"MemberExpression","start":1147,"end":1158,"object":{"type":"Identifier","start":1147,"end":1154,"name":"process"},"property":{"type":"Identifier","start":1155,"end":1158,"name":"env"},"computed":false},"property":{"type":"Identifier","start":1159,"end":1175,"name":"COMPANION_SECRET"},"computed":false}]}}],"kind":"const"},{"type":"VariableDeclaration","start":1177,"end":1224,"declarations":[{"type":"VariableDeclarator","start":1183,"end":1224,"id":{"type":"Identifier","start":1183,"end":1194,"name":"OAUTH_STATE"},"init":{"type":"Literal","start":1197,"end":1224,"value":"some-cool-nice-encrytpion","raw":"'some-cool-nice-encrytpion'"}}],"kind":"const"},{"type":"ExpressionStatement","start":1226,"end":1510,"expression":{"type":"CallExpression","start":1226,"end":1510,"callee":{"type":"Identifier","start":1226,"end":1234,"name":"describe"},"arguments":[{"type":"Literal","start":1235,"end":1252,"value":"set i-am header","raw":"'set i-am header'"},{"type":"ArrowFunctionExpression","start":1254,"end":1509,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":1260,"end":1509,"body":[{"type":"ExpressionStatement","start":1264,"end":1507,"expression":{"type":"CallExpression","start":1264,"end":1507,"callee":{"type":"Identifier","start":1264,"end":1268,"name":"test"},"arguments":[{"type":"Literal","start":1269,"end":1298,"value":"set i-am header in response","raw":"'set i-am header in response'"},{"type":"ArrowFunctionExpression","start":1300,"end":1506,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":1306,"end":1506,"body":[{"type":"ReturnStatement","start":1312,"end":1502,"argument":{"type":"CallExpression","start":1319,"end":1502,"callee":{"type":"MemberExpression","start":1319,"end":1435,"object":{"type":"CallExpression","start":1319,"end":1423,"callee":{"type":"MemberExpression","start":1319,"end":1418,"object":{"type":"CallExpression","start":1319,"end":1404,"callee":{"type":"MemberExpression","start":1319,"end":1378,"object":{"type":"CallExpression","start":1319,"end":1367,"callee":{"type":"MemberExpression","start":1319,"end":1349,"object":{"type":"CallExpression","start":1319,"end":1338,"callee":{"type":"Identifier","start":1319,"end":1326,"name":"request"},"arguments":[{"type":"Identifier","start":1327,"end":1337,"name":"authServer"}]},"property":{"type":"Identifier","start":1346,"end":1349,"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":1350,"end":1366,"value":"/dropbox/list/","raw":"'/dropbox/list/'"}]},"property":{"type":"Identifier","start":1375,"end":1378,"name":"set"},"computed":false},"arguments":[{"type":"Literal","start":1379,"end":1396,"value":"uppy-auth-token","raw":"'uppy-auth-token'"},{"type":"Identifier","start":1398,"end":1403,"name":"token"}]},"property":{"type":"Identifier","start":1412,"end":1418,"name":"expect"},"computed":false},"arguments":[{"type":"Literal","start":1419,"end":1422,"value":200,"raw":"200"}]},"property":{"type":"Identifier","start":1431,"end":1435,"name":"then"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":1436,"end":1501,"id":null,"expression":true,"generator":false,"async":false,"params":[{"type":"Identifier","start":1437,"end":1440,"name":"res"}],"body":{"type":"CallExpression","start":1445,"end":1501,"callee":{"type":"MemberExpression","start":1445,"end":1476,"object":{"type":"CallExpression","start":1445,"end":1471,"callee":{"type":"Identifier","start":1445,"end":1451,"name":"expect"},"arguments":[{"type":"MemberExpression","start":1452,"end":1470,"object":{"type":"MemberExpression","start":1452,"end":1462,"object":{"type":"Identifier","start":1452,"end":1455,"name":"res"},"property":{"type":"Identifier","start":1456,"end":1462,"name":"header"},"computed":false},"property":{"type":"Literal","start":1463,"end":1469,"value":"i-am","raw":"'i-am'"},"computed":true}]},"property":{"type":"Identifier","start":1472,"end":1476,"name":"toBe"},"computed":false},"arguments":[{"type":"Literal","start":1477,"end":1500,"value":"http://localhost:3020","raw":"'http://localhost:3020'"}]}}]}}]}}]}}]}}]}},{"type":"ExpressionStatement","start":1512,"end":2019,"expression":{"type":"CallExpression","start":1512,"end":2019,"callee":{"type":"Identifier","start":1512,"end":1520,"name":"describe"},"arguments":[{"type":"Literal","start":1521,"end":1542,"value":"list provider files","raw":"'list provider files'"},{"type":"ArrowFunctionExpression","start":1544,"end":2018,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":1550,"end":2018,"body":[{"type":"ExpressionStatement","start":1554,"end":1781,"expression":{"type":"CallExpression","start":1554,"end":1781,"callee":{"type":"Identifier","start":1554,"end":1558,"name":"test"},"arguments":[{"type":"Literal","start":1559,"end":1583,"value":"list files for dropbox","raw":"'list files for dropbox'"},{"type":"ArrowFunctionExpression","start":1585,"end":1780,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":1591,"end":1780,"body":[{"type":"ReturnStatement","start":1597,"end":1776,"argument":{"type":"CallExpression","start":1604,"end":1776,"callee":{"type":"MemberExpression","start":1604,"end":1720,"object":{"type":"CallExpression","start":1604,"end":1708,"callee":{"type":"MemberExpression","start":1604,"end":1703,"object":{"type":"CallExpression","start":1604,"end":1689,"callee":{"type":"MemberExpression","start":1604,"end":1663,"object":{"type":"CallExpression","start":1604,"end":1652,"callee":{"type":"MemberExpression","start":1604,"end":1634,"object":{"type":"CallExpression","start":1604,"end":1623,"callee":{"type":"Identifier","start":1604,"end":1611,"name":"request"},"arguments":[{"type":"Identifier","start":1612,"end":1622,"name":"authServer"}]},"property":{"type":"Identifier","start":1631,"end":1634,"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":1635,"end":1651,"value":"/dropbox/list/","raw":"'/dropbox/list/'"}]},"property":{"type":"Identifier","start":1660,"end":1663,"name":"set"},"computed":false},"arguments":[{"type":"Literal","start":1664,"end":1681,"value":"uppy-auth-token","raw":"'uppy-auth-token'"},{"type":"Identifier","start":1683,"end":1688,"name":"token"}]},"property":{"type":"Identifier","start":1697,"end":1703,"name":"expect"},"computed":false},"arguments":[{"type":"Literal","start":1704,"end":1707,"value":200,"raw":"200"}]},"property":{"type":"Identifier","start":1716,"end":1720,"name":"then"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":1721,"end":1775,"id":null,"expression":true,"generator":false,"async":false,"params":[{"type":"Identifier","start":1722,"end":1725,"name":"res"}],"body":{"type":"CallExpression","start":1730,"end":1775,"callee":{"type":"MemberExpression","start":1730,"end":1760,"object":{"type":"CallExpression","start":1730,"end":1755,"callee":{"type":"Identifier","start":1730,"end":1736,"name":"expect"},"arguments":[{"type":"MemberExpression","start":1737,"end":1754,"object":{"type":"MemberExpression","start":1737,"end":1745,"object":{"type":"Identifier","start":1737,"end":1740,"name":"res"},"property":{"type":"Identifier","start":1741,"end":1745,"name":"body"},"computed":false},"property":{"type":"Identifier","start":1746,"end":1754,"name":"username"},"computed":false}]},"property":{"type":"Identifier","start":1756,"end":1760,"name":"toBe"},"computed":false},"arguments":[{"type":"Literal","start":1761,"end":1774,"value":"foo@bar.com","raw":"'foo@bar.com'"}]}}]}}]}}]}},{"type":"ExpressionStatement","start":1785,"end":2016,"expression":{"type":"CallExpression","start":1785,"end":2016,"callee":{"type":"Identifier","start":1785,"end":1789,"name":"test"},"arguments":[{"type":"Literal","start":1790,"end":1819,"value":"list files for google drive","raw":"'list files for google drive'"},{"type":"ArrowFunctionExpression","start":1821,"end":2015,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":1827,"end":2015,"body":[{"type":"ReturnStatement","start":1833,"end":2011,"argument":{"type":"CallExpression","start":1840,"end":2011,"callee":{"type":"MemberExpression","start":1840,"end":1954,"object":{"type":"CallExpression","start":1840,"end":1942,"callee":{"type":"MemberExpression","start":1840,"end":1937,"object":{"type":"CallExpression","start":1840,"end":1923,"callee":{"type":"MemberExpression","start":1840,"end":1897,"object":{"type":"CallExpression","start":1840,"end":1886,"callee":{"type":"MemberExpression","start":1840,"end":1870,"object":{"type":"CallExpression","start":1840,"end":1859,"callee":{"type":"Identifier","start":1840,"end":1847,"name":"request"},"arguments":[{"type":"Identifier","start":1848,"end":1858,"name":"authServer"}]},"property":{"type":"Identifier","start":1867,"end":1870,"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":1871,"end":1885,"value":"/drive/list/","raw":"'/drive/list/'"}]},"property":{"type":"Identifier","start":1894,"end":1897,"name":"set"},"computed":false},"arguments":[{"type":"Literal","start":1898,"end":1915,"value":"uppy-auth-token","raw":"'uppy-auth-token'"},{"type":"Identifier","start":1917,"end":1922,"name":"token"}]},"property":{"type":"Identifier","start":1931,"end":1937,"name":"expect"},"computed":false},"arguments":[{"type":"Literal","start":1938,"end":1941,"value":200,"raw":"200"}]},"property":{"type":"Identifier","start":1950,"end":1954,"name":"then"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":1955,"end":2010,"id":null,"expression":true,"generator":false,"async":false,"params":[{"type":"Identifier","start":1956,"end":1959,"name":"res"}],"body":{"type":"CallExpression","start":1964,"end":2010,"callee":{"type":"MemberExpression","start":1964,"end":1994,"object":{"type":"CallExpression","start":1964,"end":1989,"callee":{"type":"Identifier","start":1964,"end":1970,"name":"expect"},"arguments":[{"type":"MemberExpression","start":1971,"end":1988,"object":{"type":"MemberExpression","start":1971,"end":1979,"object":{"type":"Identifier","start":1971,"end":1974,"name":"res"},"property":{"type":"Identifier","start":1975,"end":1979,"name":"body"},"computed":false},"property":{"type":"Identifier","start":1980,"end":1988,"name":"username"},"computed":false}]},"property":{"type":"Identifier","start":1990,"end":1994,"name":"toBe"},"computed":false},"arguments":[{"type":"Literal","start":1995,"end":2009,"value":"ife@bala.com","raw":"'ife@bala.com'"}]}}]}}]}}]}}]}}]}},{"type":"ExpressionStatement","start":2021,"end":5388,"expression":{"type":"CallExpression","start":2021,"end":5388,"callee":{"type":"Identifier","start":2021,"end":2029,"name":"describe"},"arguments":[{"type":"Literal","start":2030,"end":2052,"value":"validate upload data","raw":"'validate upload data'"},{"type":"ArrowFunctionExpression","start":2054,"end":5387,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":2060,"end":5387,"body":[{"type":"ExpressionStatement","start":2064,"end":2485,"expression":{"type":"CallExpression","start":2064,"end":2485,"callee":{"type":"Identifier","start":2064,"end":2068,"name":"test"},"arguments":[{"type":"Literal","start":2069,"end":2108,"value":"invalid upload protocol gets rejected","raw":"'invalid upload protocol gets rejected'"},{"type":"ArrowFunctionExpression","start":2110,"end":2484,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":2116,"end":2484,"body":[{"type":"ReturnStatement","start":2122,"end":2480,"argument":{"type":"CallExpression","start":2129,"end":2480,"callee":{"type":"MemberExpression","start":2129,"end":2406,"object":{"type":"CallExpression","start":2129,"end":2394,"callee":{"type":"MemberExpression","start":2129,"end":2389,"object":{"type":"CallExpression","start":2129,"end":2375,"callee":{"type":"MemberExpression","start":2129,"end":2280,"object":{"type":"CallExpression","start":2129,"end":2268,"callee":{"type":"MemberExpression","start":2129,"end":2232,"object":{"type":"CallExpression","start":2129,"end":2221,"callee":{"type":"MemberExpression","start":2129,"end":2195,"object":{"type":"CallExpression","start":2129,"end":2184,"callee":{"type":"MemberExpression","start":2129,"end":2160,"object":{"type":"CallExpression","start":2129,"end":2148,"callee":{"type":"Identifier","start":2129,"end":2136,"name":"request"},"arguments":[{"type":"Identifier","start":2137,"end":2147,"name":"authServer"}]},"property":{"type":"Identifier","start":2156,"end":2160,"name":"post"},"computed":false},"arguments":[{"type":"Literal","start":2161,"end":2183,"value":"/drive/get/README.md","raw":"'/drive/get/README.md'"}]},"property":{"type":"Identifier","start":2192,"end":2195,"name":"set"},"computed":false},"arguments":[{"type":"Literal","start":2196,"end":2213,"value":"uppy-auth-token","raw":"'uppy-auth-token'"},{"type":"Identifier","start":2215,"end":2220,"name":"token"}]},"property":{"type":"Identifier","start":2229,"end":2232,"name":"set"},"computed":false},"arguments":[{"type":"Literal","start":2233,"end":2247,"value":"Content-Type","raw":"'Content-Type'"},{"type":"Literal","start":2249,"end":2267,"value":"application/json","raw":"'application/json'"}]},"property":{"type":"Identifier","start":2276,"end":2280,"name":"send"},"computed":false},"arguments":[{"type":"ObjectExpression","start":2281,"end":2374,"properties":[{"type":"Property","start":2291,"end":2334,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2291,"end":2299,"name":"endpoint"},"value":{"type":"Literal","start":2301,"end":2334,"value":"http://url.myendpoint.com/files","raw":"'http://url.myendpoint.com/files'"},"kind":"init"},{"type":"Property","start":2344,"end":2366,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2344,"end":2352,"name":"protocol"},"value":{"type":"Literal","start":2354,"end":2366,"value":"tusInvalid","raw":"'tusInvalid'"},"kind":"init"}]}]},"property":{"type":"Identifier","start":2383,"end":2389,"name":"expect"},"computed":false},"arguments":[{"type":"Literal","start":2390,"end":2393,"value":400,"raw":"400"}]},"property":{"type":"Identifier","start":2402,"end":2406,"name":"then"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":2407,"end":2479,"id":null,"expression":true,"generator":false,"async":false,"params":[{"type":"Identifier","start":2408,"end":2411,"name":"res"}],"body":{"type":"CallExpression","start":2416,"end":2479,"callee":{"type":"MemberExpression","start":2416,"end":2445,"object":{"type":"CallExpression","start":2416,"end":2440,"callee":{"type":"Identifier","start":2416,"end":2422,"name":"expect"},"arguments":[{"type":"MemberExpression","start":2423,"end":2439,"object":{"type":"MemberExpression","start":2423,"end":2431,"object":{"type":"Identifier","start":2423,"end":2426,"name":"res"},"property":{"type":"Identifier","start":2427,"end":2431,"name":"body"},"computed":false},"property":{"type":"Identifier","start":2432,"end":2439,"name":"message"},"computed":false}]},"property":{"type":"Identifier","start":2441,"end":2445,"name":"toBe"},"computed":false},"arguments":[{"type":"Literal","start":2446,"end":2478,"value":"unsupported protocol specified","raw":"'unsupported protocol specified'"}]}}]}}]}}]}},{"type":"ExpressionStatement","start":2489,"end":2924,"expression":{"type":"CallExpression","start":2489,"end":2924,"callee":{"type":"Identifier","start":2489,"end":2493,"name":"test"},"arguments":[{"type":"Literal","start":2494,"end":2534,"value":"invalid upload fieldname gets rejected","raw":"'invalid upload fieldname gets rejected'"},{"type":"ArrowFunctionExpression","start":2536,"end":2923,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":2542,"end":2923,"body":[{"type":"ReturnStatement","start":2548,"end":2919,"argument":{"type":"CallExpression","start":2555,"end":2919,"callee":{"type":"MemberExpression","start":2555,"end":2849,"object":{"type":"CallExpression","start":2555,"end":2837,"callee":{"type":"MemberExpression","start":2555,"end":2832,"object":{"type":"CallExpression","start":2555,"end":2818,"callee":{"type":"MemberExpression","start":2555,"end":2706,"object":{"type":"CallExpression","start":2555,"end":2694,"callee":{"type":"MemberExpression","start":2555,"end":2658,"object":{"type":"CallExpression","start":2555,"end":2647,"callee":{"type":"MemberExpression","start":2555,"end":2621,"object":{"type":"CallExpression","start":2555,"end":2610,"callee":{"type":"MemberExpression","start":2555,"end":2586,"object":{"type":"CallExpression","start":2555,"end":2574,"callee":{"type":"Identifier","start":2555,"end":2562,"name":"request"},"arguments":[{"type":"Identifier","start":2563,"end":2573,"name":"authServer"}]},"property":{"type":"Identifier","start":2582,"end":2586,"name":"post"},"computed":false},"arguments":[{"type":"Literal","start":2587,"end":2609,"value":"/drive/get/README.md","raw":"'/drive/get/README.md'"}]},"property":{"type":"Identifier","start":2618,"end":2621,"name":"set"},"computed":false},"arguments":[{"type":"Literal","start":2622,"end":2639,"value":"uppy-auth-token","raw":"'uppy-auth-token'"},{"type":"Identifier","start":2641,"end":2646,"name":"token"}]},"property":{"type":"Identifier","start":2655,"end":2658,"name":"set"},"computed":false},"arguments":[{"type":"Literal","start":2659,"end":2673,"value":"Content-Type","raw":"'Content-Type'"},{"type":"Literal","start":2675,"end":2693,"value":"application/json","raw":"'application/json'"}]},"property":{"type":"Identifier","start":2702,"end":2706,"name":"send"},"computed":false},"arguments":[{"type":"ObjectExpression","start":2707,"end":2817,"properties":[{"type":"Property","start":2717,"end":2760,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2717,"end":2725,"name":"endpoint"},"value":{"type":"Literal","start":2727,"end":2760,"value":"http://url.myendpoint.com/files","raw":"'http://url.myendpoint.com/files'"},"kind":"init"},{"type":"Property","start":2770,"end":2785,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2770,"end":2778,"name":"protocol"},"value":{"type":"Literal","start":2780,"end":2785,"value":"tus","raw":"'tus'"},"kind":"init"},{"type":"Property","start":2795,"end":2809,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2795,"end":2804,"name":"fieldname"},"value":{"type":"Literal","start":2806,"end":2809,"value":390,"raw":"390"},"kind":"init"}]}]},"property":{"type":"Identifier","start":2826,"end":2832,"name":"expect"},"computed":false},"arguments":[{"type":"Literal","start":2833,"end":2836,"value":400,"raw":"400"}]},"property":{"type":"Identifier","start":2845,"end":2849,"name":"then"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":2850,"end":2918,"id":null,"expression":true,"generator":false,"async":false,"params":[{"type":"Identifier","start":2851,"end":2854,"name":"res"}],"body":{"type":"CallExpression","start":2859,"end":2918,"callee":{"type":"MemberExpression","start":2859,"end":2888,"object":{"type":"CallExpression","start":2859,"end":2883,"callee":{"type":"Identifier","start":2859,"end":2865,"name":"expect"},"arguments":[{"type":"MemberExpression","start":2866,"end":2882,"object":{"type":"MemberExpression","start":2866,"end":2874,"object":{"type":"Identifier","start":2866,"end":2869,"name":"res"},"property":{"type":"Identifier","start":2870,"end":2874,"name":"body"},"computed":false},"property":{"type":"Identifier","start":2875,"end":2882,"name":"message"},"computed":false}]},"property":{"type":"Identifier","start":2884,"end":2888,"name":"toBe"},"computed":false},"arguments":[{"type":"Literal","start":2889,"end":2917,"value":"fieldname must be a string","raw":"'fieldname must be a string'"}]}}]}}]}}]}},{"type":"ExpressionStatement","start":2928,"end":3391,"expression":{"type":"CallExpression","start":2928,"end":3391,"callee":{"type":"Identifier","start":2928,"end":2932,"name":"test"},"arguments":[{"type":"Literal","start":2933,"end":2972,"value":"invalid upload metadata gets rejected","raw":"'invalid upload metadata gets rejected'"},{"type":"ArrowFunctionExpression","start":2974,"end":3390,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":2980,"end":3390,"body":[{"type":"ReturnStatement","start":2986,"end":3386,"argument":{"type":"CallExpression","start":2993,"end":3386,"callee":{"type":"MemberExpression","start":2993,"end":3316,"object":{"type":"CallExpression","start":2993,"end":3304,"callee":{"type":"MemberExpression","start":2993,"end":3299,"object":{"type":"CallExpression","start":2993,"end":3285,"callee":{"type":"MemberExpression","start":2993,"end":3144,"object":{"type":"CallExpression","start":2993,"end":3132,"callee":{"type":"MemberExpression","start":2993,"end":3096,"object":{"type":"CallExpression","start":2993,"end":3085,"callee":{"type":"MemberExpression","start":2993,"end":3059,"object":{"type":"CallExpression","start":2993,"end":3048,"callee":{"type":"MemberExpression","start":2993,"end":3024,"object":{"type":"CallExpression","start":2993,"end":3012,"callee":{"type":"Identifier","start":2993,"end":3000,"name":"request"},"arguments":[{"type":"Identifier","start":3001,"end":3011,"name":"authServer"}]},"property":{"type":"Identifier","start":3020,"end":3024,"name":"post"},"computed":false},"arguments":[{"type":"Literal","start":3025,"end":3047,"value":"/drive/get/README.md","raw":"'/drive/get/README.md'"}]},"property":{"type":"Identifier","start":3056,"end":3059,"name":"set"},"computed":false},"arguments":[{"type":"Literal","start":3060,"end":3077,"value":"uppy-auth-token","raw":"'uppy-auth-token'"},{"type":"Identifier","start":3079,"end":3084,"name":"token"}]},"property":{"type":"Identifier","start":3093,"end":3096,"name":"set"},"computed":false},"arguments":[{"type":"Literal","start":3097,"end":3111,"value":"Content-Type","raw":"'Content-Type'"},{"type":"Literal","start":3113,"end":3131,"value":"application/json","raw":"'application/json'"}]},"property":{"type":"Identifier","start":3140,"end":3144,"name":"send"},"computed":false},"arguments":[{"type":"ObjectExpression","start":3145,"end":3284,"properties":[{"type":"Property","start":3155,"end":3198,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3155,"end":3163,"name":"endpoint"},"value":{"type":"Literal","start":3165,"end":3198,"value":"http://url.myendpoint.com/files","raw":"'http://url.myendpoint.com/files'"},"kind":"init"},{"type":"Property","start":3208,"end":3223,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3208,"end":3216,"name":"protocol"},"value":{"type":"Literal","start":3218,"end":3223,"value":"tus","raw":"'tus'"},"kind":"init"},{"type":"Property","start":3233,"end":3276,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3233,"end":3241,"name":"metadata"},"value":{"type":"Literal","start":3243,"end":3276,"value":"I am a string instead of object","raw":"'I am a string instead of object'"},"kind":"init"}]}]},"property":{"type":"Identifier","start":3293,"end":3299,"name":"expect"},"computed":false},"arguments":[{"type":"Literal","start":3300,"end":3303,"value":400,"raw":"400"}]},"property":{"type":"Identifier","start":3312,"end":3316,"name":"then"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":3317,"end":3385,"id":null,"expression":true,"generator":false,"async":false,"params":[{"type":"Identifier","start":3318,"end":3321,"name":"res"}],"body":{"type":"CallExpression","start":3326,"end":3385,"callee":{"type":"MemberExpression","start":3326,"end":3355,"object":{"type":"CallExpression","start":3326,"end":3350,"callee":{"type":"Identifier","start":3326,"end":3332,"name":"expect"},"arguments":[{"type":"MemberExpression","start":3333,"end":3349,"object":{"type":"MemberExpression","start":3333,"end":3341,"object":{"type":"Identifier","start":3333,"end":3336,"name":"res"},"property":{"type":"Identifier","start":3337,"end":3341,"name":"body"},"computed":false},"property":{"type":"Identifier","start":3342,"end":3349,"name":"message"},"computed":false}]},"property":{"type":"Identifier","start":3351,"end":3355,"name":"toBe"},"computed":false},"arguments":[{"type":"Literal","start":3356,"end":3384,"value":"metadata must be an object","raw":"'metadata must be an object'"}]}}]}}]}}]}},{"type":"ExpressionStatement","start":3395,"end":3854,"expression":{"type":"CallExpression","start":3395,"end":3854,"callee":{"type":"Identifier","start":3395,"end":3399,"name":"test"},"arguments":[{"type":"Literal","start":3400,"end":3437,"value":"invalid upload headers get rejected","raw":"'invalid upload headers get rejected'"},{"type":"ArrowFunctionExpression","start":3439,"end":3853,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":3445,"end":3853,"body":[{"type":"ReturnStatement","start":3451,"end":3849,"argument":{"type":"CallExpression","start":3458,"end":3849,"callee":{"type":"MemberExpression","start":3458,"end":3780,"object":{"type":"CallExpression","start":3458,"end":3768,"callee":{"type":"MemberExpression","start":3458,"end":3763,"object":{"type":"CallExpression","start":3458,"end":3749,"callee":{"type":"MemberExpression","start":3458,"end":3609,"object":{"type":"CallExpression","start":3458,"end":3597,"callee":{"type":"MemberExpression","start":3458,"end":3561,"object":{"type":"CallExpression","start":3458,"end":3550,"callee":{"type":"MemberExpression","start":3458,"end":3524,"object":{"type":"CallExpression","start":3458,"end":3513,"callee":{"type":"MemberExpression","start":3458,"end":3489,"object":{"type":"CallExpression","start":3458,"end":3477,"callee":{"type":"Identifier","start":3458,"end":3465,"name":"request"},"arguments":[{"type":"Identifier","start":3466,"end":3476,"name":"authServer"}]},"property":{"type":"Identifier","start":3485,"end":3489,"name":"post"},"computed":false},"arguments":[{"type":"Literal","start":3490,"end":3512,"value":"/drive/get/README.md","raw":"'/drive/get/README.md'"}]},"property":{"type":"Identifier","start":3521,"end":3524,"name":"set"},"computed":false},"arguments":[{"type":"Literal","start":3525,"end":3542,"value":"uppy-auth-token","raw":"'uppy-auth-token'"},{"type":"Identifier","start":3544,"end":3549,"name":"token"}]},"property":{"type":"Identifier","start":3558,"end":3561,"name":"set"},"computed":false},"arguments":[{"type":"Literal","start":3562,"end":3576,"value":"Content-Type","raw":"'Content-Type'"},{"type":"Literal","start":3578,"end":3596,"value":"application/json","raw":"'application/json'"}]},"property":{"type":"Identifier","start":3605,"end":3609,"name":"send"},"computed":false},"arguments":[{"type":"ObjectExpression","start":3610,"end":3748,"properties":[{"type":"Property","start":3620,"end":3663,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3620,"end":3628,"name":"endpoint"},"value":{"type":"Literal","start":3630,"end":3663,"value":"http://url.myendpoint.com/files","raw":"'http://url.myendpoint.com/files'"},"kind":"init"},{"type":"Property","start":3673,"end":3688,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3673,"end":3681,"name":"protocol"},"value":{"type":"Literal","start":3683,"end":3688,"value":"tus","raw":"'tus'"},"kind":"init"},{"type":"Property","start":3698,"end":3740,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3698,"end":3705,"name":"headers"},"value":{"type":"Literal","start":3707,"end":3740,"value":"I am a string instead of object","raw":"'I am a string instead of object'"},"kind":"init"}]}]},"property":{"type":"Identifier","start":3757,"end":3763,"name":"expect"},"computed":false},"arguments":[{"type":"Literal","start":3764,"end":3767,"value":400,"raw":"400"}]},"property":{"type":"Identifier","start":3776,"end":3780,"name":"then"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":3781,"end":3848,"id":null,"expression":true,"generator":false,"async":false,"params":[{"type":"Identifier","start":3782,"end":3785,"name":"res"}],"body":{"type":"CallExpression","start":3790,"end":3848,"callee":{"type":"MemberExpression","start":3790,"end":3819,"object":{"type":"CallExpression","start":3790,"end":3814,"callee":{"type":"Identifier","start":3790,"end":3796,"name":"expect"},"arguments":[{"type":"MemberExpression","start":3797,"end":3813,"object":{"type":"MemberExpression","start":3797,"end":3805,"object":{"type":"Identifier","start":3797,"end":3800,"name":"res"},"property":{"type":"Identifier","start":3801,"end":3805,"name":"body"},"computed":false},"property":{"type":"Identifier","start":3806,"end":3813,"name":"message"},"computed":false}]},"property":{"type":"Identifier","start":3815,"end":3819,"name":"toBe"},"computed":false},"arguments":[{"type":"Literal","start":3820,"end":3847,"value":"headers must be an object","raw":"'headers must be an object'"}]}}]}}]}}]}},{"type":"ExpressionStatement","start":3858,"end":4308,"expression":{"type":"CallExpression","start":3858,"end":4308,"callee":{"type":"Identifier","start":3858,"end":3862,"name":"test"},"arguments":[{"type":"Literal","start":3863,"end":3905,"value":"invalid upload HTTP Method gets rejected","raw":"'invalid upload HTTP Method gets rejected'"},{"type":"ArrowFunctionExpression","start":3907,"end":4307,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":3913,"end":4307,"body":[{"type":"ReturnStatement","start":3919,"end":4303,"argument":{"type":"CallExpression","start":3926,"end":4303,"callee":{"type":"MemberExpression","start":3926,"end":4226,"object":{"type":"CallExpression","start":3926,"end":4214,"callee":{"type":"MemberExpression","start":3926,"end":4209,"object":{"type":"CallExpression","start":3926,"end":4195,"callee":{"type":"MemberExpression","start":3926,"end":4077,"object":{"type":"CallExpression","start":3926,"end":4065,"callee":{"type":"MemberExpression","start":3926,"end":4029,"object":{"type":"CallExpression","start":3926,"end":4018,"callee":{"type":"MemberExpression","start":3926,"end":3992,"object":{"type":"CallExpression","start":3926,"end":3981,"callee":{"type":"MemberExpression","start":3926,"end":3957,"object":{"type":"CallExpression","start":3926,"end":3945,"callee":{"type":"Identifier","start":3926,"end":3933,"name":"request"},"arguments":[{"type":"Identifier","start":3934,"end":3944,"name":"authServer"}]},"property":{"type":"Identifier","start":3953,"end":3957,"name":"post"},"computed":false},"arguments":[{"type":"Literal","start":3958,"end":3980,"value":"/drive/get/README.md","raw":"'/drive/get/README.md'"}]},"property":{"type":"Identifier","start":3989,"end":3992,"name":"set"},"computed":false},"arguments":[{"type":"Literal","start":3993,"end":4010,"value":"uppy-auth-token","raw":"'uppy-auth-token'"},{"type":"Identifier","start":4012,"end":4017,"name":"token"}]},"property":{"type":"Identifier","start":4026,"end":4029,"name":"set"},"computed":false},"arguments":[{"type":"Literal","start":4030,"end":4044,"value":"Content-Type","raw":"'Content-Type'"},{"type":"Literal","start":4046,"end":4064,"value":"application/json","raw":"'application/json'"}]},"property":{"type":"Identifier","start":4073,"end":4077,"name":"send"},"computed":false},"arguments":[{"type":"ObjectExpression","start":4078,"end":4194,"properties":[{"type":"Property","start":4088,"end":4131,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4088,"end":4096,"name":"endpoint"},"value":{"type":"Literal","start":4098,"end":4131,"value":"http://url.myendpoint.com/files","raw":"'http://url.myendpoint.com/files'"},"kind":"init"},{"type":"Property","start":4141,"end":4156,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4141,"end":4149,"name":"protocol"},"value":{"type":"Literal","start":4151,"end":4156,"value":"tus","raw":"'tus'"},"kind":"init"},{"type":"Property","start":4166,"end":4186,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4166,"end":4176,"name":"httpMethod"},"value":{"type":"Literal","start":4178,"end":4186,"value":"DELETE","raw":"'DELETE'"},"kind":"init"}]}]},"property":{"type":"Identifier","start":4203,"end":4209,"name":"expect"},"computed":false},"arguments":[{"type":"Literal","start":4210,"end":4213,"value":400,"raw":"400"}]},"property":{"type":"Identifier","start":4222,"end":4226,"name":"then"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":4227,"end":4302,"id":null,"expression":true,"generator":false,"async":false,"params":[{"type":"Identifier","start":4228,"end":4231,"name":"res"}],"body":{"type":"CallExpression","start":4236,"end":4302,"callee":{"type":"MemberExpression","start":4236,"end":4265,"object":{"type":"CallExpression","start":4236,"end":4260,"callee":{"type":"Identifier","start":4236,"end":4242,"name":"expect"},"arguments":[{"type":"MemberExpression","start":4243,"end":4259,"object":{"type":"MemberExpression","start":4243,"end":4251,"object":{"type":"Identifier","start":4243,"end":4246,"name":"res"},"property":{"type":"Identifier","start":4247,"end":4251,"name":"body"},"computed":false},"property":{"type":"Identifier","start":4252,"end":4259,"name":"message"},"computed":false}]},"property":{"type":"Identifier","start":4261,"end":4265,"name":"toBe"},"computed":false},"arguments":[{"type":"Literal","start":4266,"end":4301,"value":"unsupported HTTP METHOD specified","raw":"'unsupported HTTP METHOD specified'"}]}}]}}]}}]}},{"type":"ExpressionStatement","start":4312,"end":4838,"expression":{"type":"CallExpression","start":4312,"end":4838,"callee":{"type":"Identifier","start":4312,"end":4316,"name":"test"},"arguments":[{"type":"Literal","start":4317,"end":4353,"value":"valid upload data is allowed - tus","raw":"'valid upload data is allowed - tus'"},{"type":"ArrowFunctionExpression","start":4355,"end":4837,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":4361,"end":4837,"body":[{"type":"ReturnStatement","start":4367,"end":4833,"argument":{"type":"CallExpression","start":4374,"end":4833,"callee":{"type":"MemberExpression","start":4374,"end":4828,"object":{"type":"CallExpression","start":4374,"end":4814,"callee":{"type":"MemberExpression","start":4374,"end":4525,"object":{"type":"CallExpression","start":4374,"end":4513,"callee":{"type":"MemberExpression","start":4374,"end":4477,"object":{"type":"CallExpression","start":4374,"end":4466,"callee":{"type":"MemberExpression","start":4374,"end":4440,"object":{"type":"CallExpression","start":4374,"end":4429,"callee":{"type":"MemberExpression","start":4374,"end":4405,"object":{"type":"CallExpression","start":4374,"end":4393,"callee":{"type":"Identifier","start":4374,"end":4381,"name":"request"},"arguments":[{"type":"Identifier","start":4382,"end":4392,"name":"authServer"}]},"property":{"type":"Identifier","start":4401,"end":4405,"name":"post"},"computed":false},"arguments":[{"type":"Literal","start":4406,"end":4428,"value":"/drive/get/README.md","raw":"'/drive/get/README.md'"}]},"property":{"type":"Identifier","start":4437,"end":4440,"name":"set"},"computed":false},"arguments":[{"type":"Literal","start":4441,"end":4458,"value":"uppy-auth-token","raw":"'uppy-auth-token'"},{"type":"Identifier","start":4460,"end":4465,"name":"token"}]},"property":{"type":"Identifier","start":4474,"end":4477,"name":"set"},"computed":false},"arguments":[{"type":"Literal","start":4478,"end":4492,"value":"Content-Type","raw":"'Content-Type'"},{"type":"Literal","start":4494,"end":4512,"value":"application/json","raw":"'application/json'"}]},"property":{"type":"Identifier","start":4521,"end":4525,"name":"send"},"computed":false},"arguments":[{"type":"ObjectExpression","start":4526,"end":4813,"properties":[{"type":"Property","start":4536,"end":4579,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4536,"end":4544,"name":"endpoint"},"value":{"type":"Literal","start":4546,"end":4579,"value":"http://url.myendpoint.com/files","raw":"'http://url.myendpoint.com/files'"},"kind":"init"},{"type":"Property","start":4589,"end":4604,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4589,"end":4597,"name":"protocol"},"value":{"type":"Literal","start":4599,"end":4604,"value":"tus","raw":"'tus'"},"kind":"init"},{"type":"Property","start":4614,"end":4632,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4614,"end":4624,"name":"httpMethod"},"value":{"type":"Literal","start":4626,"end":4632,"value":"POST","raw":"'POST'"},"kind":"init"},{"type":"Property","start":4642,"end":4701,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4642,"end":4649,"name":"headers"},"value":{"type":"ObjectExpression","start":4651,"end":4701,"properties":[{"type":"Property","start":4663,"end":4691,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4663,"end":4675,"name":"customheader"},"value":{"type":"Literal","start":4677,"end":4691,"value":"header value","raw":"'header value'"},"kind":"init"}]},"kind":"init"},{"type":"Property","start":4711,"end":4771,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4711,"end":4719,"name":"metadata"},"value":{"type":"ObjectExpression","start":4721,"end":4771,"properties":[{"type":"Property","start":4733,"end":4761,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4733,"end":4743,"name":"mymetadata"},"value":{"type":"Literal","start":4745,"end":4761,"value":"matadata value","raw":"'matadata value'"},"kind":"init"}]},"kind":"init"},{"type":"Property","start":4781,"end":4805,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4781,"end":4790,"name":"fieldname"},"value":{"type":"Literal","start":4792,"end":4805,"value":"uploadField","raw":"'uploadField'"},"kind":"init"}]}]},"property":{"type":"Identifier","start":4822,"end":4828,"name":"expect"},"computed":false},"arguments":[{"type":"Literal","start":4829,"end":4832,"value":200,"raw":"200"}]}}]}}]}},{"type":"ExpressionStatement","start":4842,"end":5385,"expression":{"type":"CallExpression","start":4842,"end":5385,"callee":{"type":"Identifier","start":4842,"end":4846,"name":"test"},"arguments":[{"type":"Literal","start":4847,"end":4892,"value":"valid upload data is allowed - s3-multipart","raw":"'valid upload data is allowed - s3-multipart'"},{"type":"ArrowFunctionExpression","start":4894,"end":5384,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":4900,"end":5384,"body":[{"type":"ReturnStatement","start":4906,"end":5380,"argument":{"type":"CallExpression","start":4913,"end":5380,"callee":{"type":"MemberExpression","start":4913,"end":5375,"object":{"type":"CallExpression","start":4913,"end":5361,"callee":{"type":"MemberExpression","start":4913,"end":5064,"object":{"type":"CallExpression","start":4913,"end":5052,"callee":{"type":"MemberExpression","start":4913,"end":5016,"object":{"type":"CallExpression","start":4913,"end":5005,"callee":{"type":"MemberExpression","start":4913,"end":4979,"object":{"type":"CallExpression","start":4913,"end":4968,"callee":{"type":"MemberExpression","start":4913,"end":4944,"object":{"type":"CallExpression","start":4913,"end":4932,"callee":{"type":"Identifier","start":4913,"end":4920,"name":"request"},"arguments":[{"type":"Identifier","start":4921,"end":4931,"name":"authServer"}]},"property":{"type":"Identifier","start":4940,"end":4944,"name":"post"},"computed":false},"arguments":[{"type":"Literal","start":4945,"end":4967,"value":"/drive/get/README.md","raw":"'/drive/get/README.md'"}]},"property":{"type":"Identifier","start":4976,"end":4979,"name":"set"},"computed":false},"arguments":[{"type":"Literal","start":4980,"end":4997,"value":"uppy-auth-token","raw":"'uppy-auth-token'"},{"type":"Identifier","start":4999,"end":5004,"name":"token"}]},"property":{"type":"Identifier","start":5013,"end":5016,"name":"set"},"computed":false},"arguments":[{"type":"Literal","start":5017,"end":5031,"value":"Content-Type","raw":"'Content-Type'"},{"type":"Literal","start":5033,"end":5051,"value":"application/json","raw":"'application/json'"}]},"property":{"type":"Identifier","start":5060,"end":5064,"name":"send"},"computed":false},"arguments":[{"type":"ObjectExpression","start":5065,"end":5360,"properties":[{"type":"Property","start":5075,"end":5118,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":5075,"end":5083,"name":"endpoint"},"value":{"type":"Literal","start":5085,"end":5118,"value":"http://url.myendpoint.com/files","raw":"'http://url.myendpoint.com/files'"},"kind":"init"},{"type":"Property","start":5128,"end":5152,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":5128,"end":5136,"name":"protocol"},"value":{"type":"Literal","start":5138,"end":5152,"value":"s3-multipart","raw":"'s3-multipart'"},"kind":"init"},{"type":"Property","start":5162,"end":5179,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":5162,"end":5172,"name":"httpMethod"},"value":{"type":"Literal","start":5174,"end":5179,"value":"PUT","raw":"'PUT'"},"kind":"init"},{"type":"Property","start":5189,"end":5248,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":5189,"end":5196,"name":"headers"},"value":{"type":"ObjectExpression","start":5198,"end":5248,"properties":[{"type":"Property","start":5210,"end":5238,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":5210,"end":5222,"name":"customheader"},"value":{"type":"Literal","start":5224,"end":5238,"value":"header value","raw":"'header value'"},"kind":"init"}]},"kind":"init"},{"type":"Property","start":5258,"end":5318,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":5258,"end":5266,"name":"metadata"},"value":{"type":"ObjectExpression","start":5268,"end":5318,"properties":[{"type":"Property","start":5280,"end":5308,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":5280,"end":5290,"name":"mymetadata"},"value":{"type":"Literal","start":5292,"end":5308,"value":"matadata value","raw":"'matadata value'"},"kind":"init"}]},"kind":"init"},{"type":"Property","start":5328,"end":5352,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":5328,"end":5337,"name":"fieldname"},"value":{"type":"Literal","start":5339,"end":5352,"value":"uploadField","raw":"'uploadField'"},"kind":"init"}]}]},"property":{"type":"Identifier","start":5369,"end":5375,"name":"expect"},"computed":false},"arguments":[{"type":"Literal","start":5376,"end":5379,"value":200,"raw":"200"}]}}]}}]}}]}}]}},{"type":"ExpressionStatement","start":5390,"end":5826,"expression":{"type":"CallExpression","start":5390,"end":5826,"callee":{"type":"Identifier","start":5390,"end":5398,"name":"describe"},"arguments":[{"type":"Literal","start":5399,"end":5423,"value":"download provdier file","raw":"'download provdier file'"},{"type":"ArrowFunctionExpression","start":5425,"end":5825,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":5431,"end":5825,"body":[{"type":"ExpressionStatement","start":5435,"end":5823,"expression":{"type":"CallExpression","start":5435,"end":5823,"callee":{"type":"Identifier","start":5435,"end":5439,"name":"test"},"arguments":[{"type":"Literal","start":5440,"end":5486,"value":"specified file gets downloaded from provider","raw":"'specified file gets downloaded from provider'"},{"type":"ArrowFunctionExpression","start":5488,"end":5822,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":5494,"end":5822,"body":[{"type":"ReturnStatement","start":5500,"end":5818,"argument":{"type":"CallExpression","start":5507,"end":5818,"callee":{"type":"MemberExpression","start":5507,"end":5772,"object":{"type":"CallExpression","start":5507,"end":5760,"callee":{"type":"MemberExpression","start":5507,"end":5755,"object":{"type":"CallExpression","start":5507,"end":5741,"callee":{"type":"MemberExpression","start":5507,"end":5658,"object":{"type":"CallExpression","start":5507,"end":5646,"callee":{"type":"MemberExpression","start":5507,"end":5610,"object":{"type":"CallExpression","start":5507,"end":5599,"callee":{"type":"MemberExpression","start":5507,"end":5573,"object":{"type":"CallExpression","start":5507,"end":5562,"callee":{"type":"MemberExpression","start":5507,"end":5538,"object":{"type":"CallExpression","start":5507,"end":5526,"callee":{"type":"Identifier","start":5507,"end":5514,"name":"request"},"arguments":[{"type":"Identifier","start":5515,"end":5525,"name":"authServer"}]},"property":{"type":"Identifier","start":5534,"end":5538,"name":"post"},"computed":false},"arguments":[{"type":"Literal","start":5539,"end":5561,"value":"/drive/get/README.md","raw":"'/drive/get/README.md'"}]},"property":{"type":"Identifier","start":5570,"end":5573,"name":"set"},"computed":false},"arguments":[{"type":"Literal","start":5574,"end":5591,"value":"uppy-auth-token","raw":"'uppy-auth-token'"},{"type":"Identifier","start":5593,"end":5598,"name":"token"}]},"property":{"type":"Identifier","start":5607,"end":5610,"name":"set"},"computed":false},"arguments":[{"type":"Literal","start":5611,"end":5625,"value":"Content-Type","raw":"'Content-Type'"},{"type":"Literal","start":5627,"end":5645,"value":"application/json","raw":"'application/json'"}]},"property":{"type":"Identifier","start":5654,"end":5658,"name":"send"},"computed":false},"arguments":[{"type":"ObjectExpression","start":5659,"end":5740,"properties":[{"type":"Property","start":5669,"end":5707,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":5669,"end":5677,"name":"endpoint"},"value":{"type":"Literal","start":5679,"end":5707,"value":"http://master.tus.io/files","raw":"'http://master.tus.io/files'"},"kind":"init"},{"type":"Property","start":5717,"end":5732,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":5717,"end":5725,"name":"protocol"},"value":{"type":"Literal","start":5727,"end":5732,"value":"tus","raw":"'tus'"},"kind":"init"}]}]},"property":{"type":"Identifier","start":5749,"end":5755,"name":"expect"},"computed":false},"arguments":[{"type":"Literal","start":5756,"end":5759,"value":200,"raw":"200"}]},"property":{"type":"Identifier","start":5768,"end":5772,"name":"then"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":5773,"end":5817,"id":null,"expression":true,"generator":false,"async":false,"params":[{"type":"Identifier","start":5774,"end":5777,"name":"res"}],"body":{"type":"CallExpression","start":5782,"end":5817,"callee":{"type":"MemberExpression","start":5782,"end":5815,"object":{"type":"CallExpression","start":5782,"end":5804,"callee":{"type":"Identifier","start":5782,"end":5788,"name":"expect"},"arguments":[{"type":"MemberExpression","start":5789,"end":5803,"object":{"type":"MemberExpression","start":5789,"end":5797,"object":{"type":"Identifier","start":5789,"end":5792,"name":"res"},"property":{"type":"Identifier","start":5793,"end":5797,"name":"body"},"computed":false},"property":{"type":"Identifier","start":5798,"end":5803,"name":"token"},"computed":false}]},"property":{"type":"Identifier","start":5805,"end":5815,"name":"toBeTruthy"},"computed":false},"arguments":[]}}]}}]}}]}}]}}]}},{"type":"ExpressionStatement","start":5828,"end":8477,"expression":{"type":"CallExpression","start":5828,"end":8477,"callee":{"type":"Identifier","start":5828,"end":5836,"name":"describe"},"arguments":[{"type":"Literal","start":5837,"end":5858,"value":"test authentication","raw":"'test authentication'"},{"type":"ArrowFunctionExpression","start":5860,"end":8476,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":5866,"end":8476,"body":[{"type":"ExpressionStatement","start":5870,"end":6159,"expression":{"type":"CallExpression","start":5870,"end":6159,"callee":{"type":"Identifier","start":5870,"end":5874,"name":"test"},"arguments":[{"type":"Literal","start":5875,"end":5928,"value":"authentication callback redirects to send-token url","raw":"'authentication callback redirects to send-token url'"},{"type":"ArrowFunctionExpression","start":5930,"end":6158,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":5936,"end":6158,"body":[{"type":"ReturnStatement","start":5942,"end":6154,"argument":{"type":"CallExpression","start":5949,"end":6154,"callee":{"type":"MemberExpression","start":5949,"end":6031,"object":{"type":"CallExpression","start":5949,"end":6017,"callee":{"type":"MemberExpression","start":5949,"end":6012,"object":{"type":"CallExpression","start":5949,"end":5998,"callee":{"type":"MemberExpression","start":5949,"end":5979,"object":{"type":"CallExpression","start":5949,"end":5968,"callee":{"type":"Identifier","start":5949,"end":5956,"name":"request"},"arguments":[{"type":"Identifier","start":5957,"end":5967,"name":"authServer"}]},"property":{"type":"Identifier","start":5976,"end":5979,"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":5980,"end":5997,"value":"/drive/callback","raw":"'/drive/callback'"}]},"property":{"type":"Identifier","start":6006,"end":6012,"name":"expect"},"computed":false},"arguments":[{"type":"Literal","start":6013,"end":6016,"value":302,"raw":"302"}]},"property":{"type":"Identifier","start":6025,"end":6031,"name":"expect"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":6032,"end":6153,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":6033,"end":6036,"name":"res"}],"body":{"type":"BlockStatement","start":6041,"end":6153,"body":[{"type":"ExpressionStatement","start":6051,"end":6145,"expression":{"type":"CallExpression","start":6051,"end":6145,"callee":{"type":"MemberExpression","start":6051,"end":6088,"object":{"type":"CallExpression","start":6051,"end":6078,"callee":{"type":"Identifier","start":6051,"end":6057,"name":"expect"},"arguments":[{"type":"MemberExpression","start":6058,"end":6077,"object":{"type":"MemberExpression","start":6058,"end":6068,"object":{"type":"Identifier","start":6058,"end":6061,"name":"res"},"property":{"type":"Identifier","start":6062,"end":6068,"name":"header"},"computed":false},"property":{"type":"Identifier","start":6069,"end":6077,"name":"location"},"computed":false}]},"property":{"type":"Identifier","start":6079,"end":6088,"name":"toContain"},"computed":false},"arguments":[{"type":"Literal","start":6089,"end":6144,"value":"http://localhost:3020/drive/send-token?uppyAuthToken=","raw":"'http://localhost:3020/drive/send-token?uppyAuthToken='"}]}}]}}]}}]}}]}},{"type":"ExpressionStatement","start":6163,"end":6951,"expression":{"type":"CallExpression","start":6163,"end":6951,"callee":{"type":"Identifier","start":6163,"end":6167,"name":"test"},"arguments":[{"type":"Literal","start":6168,"end":6209,"value":"the token gets sent via cookie and html","raw":"'the token gets sent via cookie and html'"},{"type":"ArrowFunctionExpression","start":6211,"end":6950,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":6217,"end":6950,"body":[{"type":"ReturnStatement","start":6299,"end":6946,"argument":{"type":"CallExpression","start":6306,"end":6946,"callee":{"type":"MemberExpression","start":6306,"end":6446,"object":{"type":"CallExpression","start":6306,"end":6432,"callee":{"type":"MemberExpression","start":6306,"end":6427,"object":{"type":"CallExpression","start":6306,"end":6413,"callee":{"type":"MemberExpression","start":6306,"end":6336,"object":{"type":"CallExpression","start":6306,"end":6325,"callee":{"type":"Identifier","start":6306,"end":6313,"name":"request"},"arguments":[{"type":"Identifier","start":6314,"end":6324,"name":"authServer"}]},"property":{"type":"Identifier","start":6333,"end":6336,"name":"get"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":6337,"end":6412,"expressions":[{"type":"Identifier","start":6374,"end":6379,"name":"token"}],"quasis":[{"type":"TemplateElement","start":6338,"end":6372,"value":{"raw":"/dropbox/send-token?uppyAuthToken=","cooked":"/dropbox/send-token?uppyAuthToken="},"tail":false},{"type":"TemplateElement","start":6380,"end":6411,"value":{"raw":"&state=state-with-newer-version","cooked":"&state=state-with-newer-version"},"tail":true}]}]},"property":{"type":"Identifier","start":6421,"end":6427,"name":"expect"},"computed":false},"arguments":[{"type":"Literal","start":6428,"end":6431,"value":200,"raw":"200"}]},"property":{"type":"Identifier","start":6440,"end":6446,"name":"expect"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":6447,"end":6945,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":6448,"end":6451,"name":"res"}],"body":{"type":"BlockStatement","start":6456,"end":6945,"body":[{"type":"VariableDeclaration","start":6466,"end":6561,"declarations":[{"type":"VariableDeclarator","start":6472,"end":6561,"id":{"type":"Identifier","start":6472,"end":6481,"name":"authToken"},"init":{"type":"MemberExpression","start":6484,"end":6561,"object":{"type":"CallExpression","start":6484,"end":6558,"callee":{"type":"MemberExpression","start":6484,"end":6531,"object":{"type":"MemberExpression","start":6484,"end":6525,"object":{"type":"CallExpression","start":6484,"end":6522,"callee":{"type":"MemberExpression","start":6484,"end":6517,"object":{"type":"MemberExpression","start":6484,"end":6511,"object":{"type":"MemberExpression","start":6484,"end":6508,"object":{"type":"MemberExpression","start":6484,"end":6494,"object":{"type":"Identifier","start":6484,"end":6487,"name":"res"},"property":{"type":"Identifier","start":6488,"end":6494,"name":"header"},"computed":false},"property":{"type":"Literal","start":6495,"end":6507,"value":"set-cookie","raw":"'set-cookie'"},"computed":true},"property":{"type":"Literal","start":6509,"end":6510,"value":0,"raw":"0"},"computed":true},"property":{"type":"Identifier","start":6512,"end":6517,"name":"split"},"computed":false},"arguments":[{"type":"Literal","start":6518,"end":6521,"value":";","raw":"';'"}]},"property":{"type":"Literal","start":6523,"end":6524,"value":0,"raw":"0"},"computed":true},"property":{"type":"Identifier","start":6526,"end":6531,"name":"split"},"computed":false},"arguments":[{"type":"Literal","start":6532,"end":6557,"value":"uppyAuthToken--dropbox=","raw":"'uppyAuthToken--dropbox='"}]},"property":{"type":"Literal","start":6559,"end":6560,"value":1,"raw":"1"},"computed":true}}],"kind":"const"},{"type":"ExpressionStatement","start":6570,"end":6602,"expression":{"type":"CallExpression","start":6570,"end":6602,"callee":{"type":"MemberExpression","start":6570,"end":6595,"object":{"type":"CallExpression","start":6570,"end":6587,"callee":{"type":"Identifier","start":6570,"end":6576,"name":"expect"},"arguments":[{"type":"Identifier","start":6577,"end":6586,"name":"authToken"}]},"property":{"type":"Identifier","start":6588,"end":6595,"name":"toEqual"},"computed":false},"arguments":[{"type":"Identifier","start":6596,"end":6601,"name":"token"}]}},{"type":"VariableDeclaration","start":6611,"end":6901,"declarations":[{"type":"VariableDeclarator","start":6617,"end":6901,"id":{"type":"Identifier","start":6617,"end":6621,"name":"body"},"init":{"type":"TemplateLiteral","start":6624,"end":6901,"expressions":[{"type":"Identifier","start":6780,"end":6785,"name":"token"}],"quasis":[{"type":"TemplateElement","start":6625,"end":6778,"value":{"raw":"\n    <!DOCTYPE html>\n    <html>\n    <head>\n        <meta charset=\"utf-8\" />\n        <script>\n          window.opener.postMessage(JSON.stringify({token: \"","cooked":"\n    <!DOCTYPE html>\n    <html>\n    <head>\n        <meta charset=\"utf-8\" />\n        <script>\n          window.opener.postMessage(JSON.stringify({token: \""},"tail":false},{"type":"TemplateElement","start":6786,"end":6900,"value":{"raw":"\"}), \"http://localhost:3020\")\n          window.close()\n        </script>\n    </head>\n    <body></body>\n    </html>","cooked":"\"}), \"http://localhost:3020\")\n          window.close()\n        </script>\n    </head>\n    <body></body>\n    </html>"},"tail":true}]}}],"kind":"const"},{"type":"ExpressionStatement","start":6910,"end":6937,"expression":{"type":"CallExpression","start":6910,"end":6937,"callee":{"type":"MemberExpression","start":6910,"end":6931,"object":{"type":"CallExpression","start":6910,"end":6926,"callee":{"type":"Identifier","start":6910,"end":6916,"name":"expect"},"arguments":[{"type":"MemberExpression","start":6917,"end":6925,"object":{"type":"Identifier","start":6917,"end":6920,"name":"res"},"property":{"type":"Identifier","start":6921,"end":6925,"name":"text"},"computed":false}]},"property":{"type":"Identifier","start":6927,"end":6931,"name":"toBe"},"computed":false},"arguments":[{"type":"Identifier","start":6932,"end":6936,"name":"body"}]}}]}}]}}]}}]}},{"type":"ExpressionStatement","start":6955,"end":7590,"expression":{"type":"CallExpression","start":6955,"end":7590,"callee":{"type":"Identifier","start":6955,"end":6959,"name":"test"},"arguments":[{"type":"Literal","start":6960,"end":7011,"value":"the token gets to older clients without stringify","raw":"'the token gets to older clients without stringify'"},{"type":"ArrowFunctionExpression","start":7013,"end":7589,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":7019,"end":7589,"body":[{"type":"ReturnStatement","start":7101,"end":7585,"argument":{"type":"CallExpression","start":7108,"end":7585,"callee":{"type":"MemberExpression","start":7108,"end":7246,"object":{"type":"CallExpression","start":7108,"end":7232,"callee":{"type":"MemberExpression","start":7108,"end":7227,"object":{"type":"CallExpression","start":7108,"end":7213,"callee":{"type":"MemberExpression","start":7108,"end":7138,"object":{"type":"CallExpression","start":7108,"end":7127,"callee":{"type":"Identifier","start":7108,"end":7115,"name":"request"},"arguments":[{"type":"Identifier","start":7116,"end":7126,"name":"authServer"}]},"property":{"type":"Identifier","start":7135,"end":7138,"name":"get"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":7139,"end":7212,"expressions":[{"type":"Identifier","start":7174,"end":7179,"name":"token"}],"quasis":[{"type":"TemplateElement","start":7140,"end":7172,"value":{"raw":"/drive/send-token?uppyAuthToken=","cooked":"/drive/send-token?uppyAuthToken="},"tail":false},{"type":"TemplateElement","start":7180,"end":7211,"value":{"raw":"&state=state-with-older-version","cooked":"&state=state-with-older-version"},"tail":true}]}]},"property":{"type":"Identifier","start":7221,"end":7227,"name":"expect"},"computed":false},"arguments":[{"type":"Literal","start":7228,"end":7231,"value":200,"raw":"200"}]},"property":{"type":"Identifier","start":7240,"end":7246,"name":"expect"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":7247,"end":7584,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":7248,"end":7251,"name":"res"}],"body":{"type":"BlockStatement","start":7256,"end":7584,"body":[{"type":"VariableDeclaration","start":7266,"end":7540,"declarations":[{"type":"VariableDeclarator","start":7272,"end":7540,"id":{"type":"Identifier","start":7272,"end":7276,"name":"body"},"init":{"type":"TemplateLiteral","start":7279,"end":7540,"expressions":[{"type":"Identifier","start":7420,"end":7425,"name":"token"}],"quasis":[{"type":"TemplateElement","start":7280,"end":7418,"value":{"raw":"\n    <!DOCTYPE html>\n    <html>\n    <head>\n        <meta charset=\"utf-8\" />\n        <script>\n          window.opener.postMessage({token: \"","cooked":"\n    <!DOCTYPE html>\n    <html>\n    <head>\n        <meta charset=\"utf-8\" />\n        <script>\n          window.opener.postMessage({token: \""},"tail":false},{"type":"TemplateElement","start":7426,"end":7539,"value":{"raw":"\"}, \"http://localhost:3020\")\n          window.close()\n        </script>\n    </head>\n    <body></body>\n    </html>","cooked":"\"}, \"http://localhost:3020\")\n          window.close()\n        </script>\n    </head>\n    <body></body>\n    </html>"},"tail":true}]}}],"kind":"const"},{"type":"ExpressionStatement","start":7549,"end":7576,"expression":{"type":"CallExpression","start":7549,"end":7576,"callee":{"type":"MemberExpression","start":7549,"end":7570,"object":{"type":"CallExpression","start":7549,"end":7565,"callee":{"type":"Identifier","start":7549,"end":7555,"name":"expect"},"arguments":[{"type":"MemberExpression","start":7556,"end":7564,"object":{"type":"Identifier","start":7556,"end":7559,"name":"res"},"property":{"type":"Identifier","start":7560,"end":7564,"name":"text"},"computed":false}]},"property":{"type":"Identifier","start":7566,"end":7570,"name":"toBe"},"computed":false},"arguments":[{"type":"Identifier","start":7571,"end":7575,"name":"body"}]}}]}}]}}]}}]}},{"type":"ExpressionStatement","start":7594,"end":8265,"expression":{"type":"CallExpression","start":7594,"end":8265,"callee":{"type":"Identifier","start":7594,"end":7598,"name":"test"},"arguments":[{"type":"Literal","start":7599,"end":7660,"value":"the token gets sent to newer clients with old version style","raw":"'the token gets sent to newer clients with old version style'"},{"type":"ArrowFunctionExpression","start":7662,"end":8264,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":7668,"end":8264,"body":[{"type":"ReturnStatement","start":7750,"end":8260,"argument":{"type":"CallExpression","start":7757,"end":8260,"callee":{"type":"MemberExpression","start":7757,"end":7905,"object":{"type":"CallExpression","start":7757,"end":7891,"callee":{"type":"MemberExpression","start":7757,"end":7886,"object":{"type":"CallExpression","start":7757,"end":7872,"callee":{"type":"MemberExpression","start":7757,"end":7787,"object":{"type":"CallExpression","start":7757,"end":7776,"callee":{"type":"Identifier","start":7757,"end":7764,"name":"request"},"arguments":[{"type":"Identifier","start":7765,"end":7775,"name":"authServer"}]},"property":{"type":"Identifier","start":7784,"end":7787,"name":"get"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":7788,"end":7871,"expressions":[{"type":"Identifier","start":7823,"end":7828,"name":"token"}],"quasis":[{"type":"TemplateElement","start":7789,"end":7821,"value":{"raw":"/drive/send-token?uppyAuthToken=","cooked":"/drive/send-token?uppyAuthToken="},"tail":false},{"type":"TemplateElement","start":7829,"end":7870,"value":{"raw":"&state=state-with-newer-version-old-style","cooked":"&state=state-with-newer-version-old-style"},"tail":true}]}]},"property":{"type":"Identifier","start":7880,"end":7886,"name":"expect"},"computed":false},"arguments":[{"type":"Literal","start":7887,"end":7890,"value":200,"raw":"200"}]},"property":{"type":"Identifier","start":7899,"end":7905,"name":"expect"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":7906,"end":8259,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":7907,"end":7910,"name":"res"}],"body":{"type":"BlockStatement","start":7915,"end":8259,"body":[{"type":"VariableDeclaration","start":7925,"end":8215,"declarations":[{"type":"VariableDeclarator","start":7931,"end":8215,"id":{"type":"Identifier","start":7931,"end":7935,"name":"body"},"init":{"type":"TemplateLiteral","start":7938,"end":8215,"expressions":[{"type":"Identifier","start":8094,"end":8099,"name":"token"}],"quasis":[{"type":"TemplateElement","start":7939,"end":8092,"value":{"raw":"\n    <!DOCTYPE html>\n    <html>\n    <head>\n        <meta charset=\"utf-8\" />\n        <script>\n          window.opener.postMessage(JSON.stringify({token: \"","cooked":"\n    <!DOCTYPE html>\n    <html>\n    <head>\n        <meta charset=\"utf-8\" />\n        <script>\n          window.opener.postMessage(JSON.stringify({token: \""},"tail":false},{"type":"TemplateElement","start":8100,"end":8214,"value":{"raw":"\"}), \"http://localhost:3020\")\n          window.close()\n        </script>\n    </head>\n    <body></body>\n    </html>","cooked":"\"}), \"http://localhost:3020\")\n          window.close()\n        </script>\n    </head>\n    <body></body>\n    </html>"},"tail":true}]}}],"kind":"const"},{"type":"ExpressionStatement","start":8224,"end":8251,"expression":{"type":"CallExpression","start":8224,"end":8251,"callee":{"type":"MemberExpression","start":8224,"end":8245,"object":{"type":"CallExpression","start":8224,"end":8240,"callee":{"type":"Identifier","start":8224,"end":8230,"name":"expect"},"arguments":[{"type":"MemberExpression","start":8231,"end":8239,"object":{"type":"Identifier","start":8231,"end":8234,"name":"res"},"property":{"type":"Identifier","start":8235,"end":8239,"name":"text"},"computed":false}]},"property":{"type":"Identifier","start":8241,"end":8245,"name":"toBe"},"computed":false},"arguments":[{"type":"Identifier","start":8246,"end":8250,"name":"body"}]}}]}}]}}]}}]}},{"type":"ExpressionStatement","start":8269,"end":8474,"expression":{"type":"CallExpression","start":8269,"end":8474,"callee":{"type":"Identifier","start":8269,"end":8273,"name":"test"},"arguments":[{"type":"Literal","start":8274,"end":8291,"value":"logout provider","raw":"'logout provider'"},{"type":"ArrowFunctionExpression","start":8293,"end":8473,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":8299,"end":8473,"body":[{"type":"ReturnStatement","start":8305,"end":8469,"argument":{"type":"CallExpression","start":8312,"end":8469,"callee":{"type":"MemberExpression","start":8312,"end":8428,"object":{"type":"CallExpression","start":8312,"end":8416,"callee":{"type":"MemberExpression","start":8312,"end":8411,"object":{"type":"CallExpression","start":8312,"end":8397,"callee":{"type":"MemberExpression","start":8312,"end":8371,"object":{"type":"CallExpression","start":8312,"end":8360,"callee":{"type":"MemberExpression","start":8312,"end":8342,"object":{"type":"CallExpression","start":8312,"end":8331,"callee":{"type":"Identifier","start":8312,"end":8319,"name":"request"},"arguments":[{"type":"Identifier","start":8320,"end":8330,"name":"authServer"}]},"property":{"type":"Identifier","start":8339,"end":8342,"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":8343,"end":8359,"value":"/drive/logout/","raw":"'/drive/logout/'"}]},"property":{"type":"Identifier","start":8368,"end":8371,"name":"set"},"computed":false},"arguments":[{"type":"Literal","start":8372,"end":8389,"value":"uppy-auth-token","raw":"'uppy-auth-token'"},{"type":"Identifier","start":8391,"end":8396,"name":"token"}]},"property":{"type":"Identifier","start":8405,"end":8411,"name":"expect"},"computed":false},"arguments":[{"type":"Literal","start":8412,"end":8415,"value":200,"raw":"200"}]},"property":{"type":"Identifier","start":8424,"end":8428,"name":"then"},"computed":false},"arguments":[{"type":"ArrowFunctionExpression","start":8429,"end":8468,"id":null,"expression":true,"generator":false,"async":false,"params":[{"type":"Identifier","start":8430,"end":8433,"name":"res"}],"body":{"type":"CallExpression","start":8438,"end":8468,"callee":{"type":"MemberExpression","start":8438,"end":8462,"object":{"type":"CallExpression","start":8438,"end":8457,"callee":{"type":"Identifier","start":8438,"end":8444,"name":"expect"},"arguments":[{"type":"MemberExpression","start":8445,"end":8456,"object":{"type":"MemberExpression","start":8445,"end":8453,"object":{"type":"Identifier","start":8445,"end":8448,"name":"res"},"property":{"type":"Identifier","start":8449,"end":8453,"name":"body"},"computed":false},"property":{"type":"Identifier","start":8454,"end":8456,"name":"ok"},"computed":false}]},"property":{"type":"Identifier","start":8458,"end":8462,"name":"toBe"},"computed":false},"arguments":[{"type":"Literal","start":8463,"end":8467,"value":true,"raw":"true"}]}}]}}]}}]}}]}}]}},{"type":"ExpressionStatement","start":8479,"end":9073,"expression":{"type":"CallExpression","start":8479,"end":9073,"callee":{"type":"Identifier","start":8479,"end":8487,"name":"describe"},"arguments":[{"type":"Literal","start":8488,"end":8509,"value":"connect to provider","raw":"'connect to provider'"},{"type":"ArrowFunctionExpression","start":8511,"end":9072,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":8517,"end":9072,"body":[{"type":"ExpressionStatement","start":8521,"end":8796,"expression":{"type":"CallExpression","start":8521,"end":8796,"callee":{"type":"Identifier","start":8521,"end":8525,"name":"test"},"arguments":[{"type":"Literal","start":8526,"end":8568,"value":"connect to dropbox via grant.js endpoint","raw":"'connect to dropbox via grant.js endpoint'"},{"type":"ArrowFunctionExpression","start":8570,"end":8795,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":8576,"end":8795,"body":[{"type":"ReturnStatement","start":8582,"end":8791,"argument":{"type":"CallExpression","start":8589,"end":8791,"callee":{"type":"MemberExpression","start":8589,"end":8717,"object":{"type":"CallExpression","start":8589,"end":8703,"callee":{"type":"MemberExpression","start":8589,"end":8698,"object":{"type":"CallExpression","start":8589,"end":8684,"callee":{"type":"MemberExpression","start":8589,"end":8658,"object":{"type":"CallExpression","start":8589,"end":8647,"callee":{"type":"MemberExpression","start":8589,"end":8619,"object":{"type":"CallExpression","start":8589,"end":8608,"callee":{"type":"Identifier","start":8589,"end":8596,"name":"request"},"arguments":[{"type":"Identifier","start":8597,"end":8607,"name":"authServer"}]},"property":{"type":"Identifier","start":8616,"end":8619,"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":8620,"end":8646,"value":"/dropbox/connect?foo=bar","raw":"'/dropbox/connect?foo=bar'"}]},"property":{"type":"Identifier","start":8655,"end":8658,"name":"set"},"computed":false},"arguments":[{"type":"Literal","start":8659,"end":8676,"value":"uppy-auth-token","raw":"'uppy-auth-token'"},{"type":"Identifier","start":8678,"end":8683,"name":"token"}]},"property":{"type":"Identifier","start":8692,"end":8698,"name":"expect"},"computed":false},"arguments":[{"type":"Literal","start":8699,"end":8702,"value":302,"raw":"302"}]},"property":{"type":"Identifier","start":8711,"end":8717,"name":"expect"},"computed":false},"arguments":[{"type":"Literal","start":8718,"end":8728,"value":"Location","raw":"'Location'"},{"type":"TemplateLiteral","start":8730,"end":8790,"expressions":[{"type":"Identifier","start":8777,"end":8788,"name":"OAUTH_STATE"}],"quasis":[{"type":"TemplateElement","start":8731,"end":8775,"value":{"raw":"http://localhost:3020/connect/dropbox?state=","cooked":"http://localhost:3020/connect/dropbox?state="},"tail":false},{"type":"TemplateElement","start":8789,"end":8789,"value":{"raw":"","cooked":""},"tail":true}]}]}}]}}]}},{"type":"ExpressionStatement","start":8800,"end":9070,"expression":{"type":"CallExpression","start":8800,"end":9070,"callee":{"type":"Identifier","start":8800,"end":8804,"name":"test"},"arguments":[{"type":"Literal","start":8805,"end":8845,"value":"connect to drive via grant.js endpoint","raw":"'connect to drive via grant.js endpoint'"},{"type":"ArrowFunctionExpression","start":8847,"end":9069,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":8853,"end":9069,"body":[{"type":"ReturnStatement","start":8859,"end":9065,"argument":{"type":"CallExpression","start":8866,"end":9065,"callee":{"type":"MemberExpression","start":8866,"end":8992,"object":{"type":"CallExpression","start":8866,"end":8978,"callee":{"type":"MemberExpression","start":8866,"end":8973,"object":{"type":"CallExpression","start":8866,"end":8959,"callee":{"type":"MemberExpression","start":8866,"end":8933,"object":{"type":"CallExpression","start":8866,"end":8922,"callee":{"type":"MemberExpression","start":8866,"end":8896,"object":{"type":"CallExpression","start":8866,"end":8885,"callee":{"type":"Identifier","start":8866,"end":8873,"name":"request"},"arguments":[{"type":"Identifier","start":8874,"end":8884,"name":"authServer"}]},"property":{"type":"Identifier","start":8893,"end":8896,"name":"get"},"computed":false},"arguments":[{"type":"Literal","start":8897,"end":8921,"value":"/drive/connect?foo=bar","raw":"'/drive/connect?foo=bar'"}]},"property":{"type":"Identifier","start":8930,"end":8933,"name":"set"},"computed":false},"arguments":[{"type":"Literal","start":8934,"end":8951,"value":"uppy-auth-token","raw":"'uppy-auth-token'"},{"type":"Identifier","start":8953,"end":8958,"name":"token"}]},"property":{"type":"Identifier","start":8967,"end":8973,"name":"expect"},"computed":false},"arguments":[{"type":"Literal","start":8974,"end":8977,"value":302,"raw":"302"}]},"property":{"type":"Identifier","start":8986,"end":8992,"name":"expect"},"computed":false},"arguments":[{"type":"Literal","start":8993,"end":9003,"value":"Location","raw":"'Location'"},{"type":"TemplateLiteral","start":9005,"end":9064,"expressions":[{"type":"Identifier","start":9051,"end":9062,"name":"OAUTH_STATE"}],"quasis":[{"type":"TemplateElement","start":9006,"end":9049,"value":{"raw":"http://localhost:3020/connect/google?state=","cooked":"http://localhost:3020/connect/google?state="},"tail":false},{"type":"TemplateElement","start":9063,"end":9063,"value":{"raw":"","cooked":""},"tail":true}]}]}}]}}]}}]}}]}},{"type":"ExpressionStatement","start":9075,"end":9720,"expression":{"type":"CallExpression","start":9075,"end":9720,"callee":{"type":"Identifier","start":9075,"end":9083,"name":"describe"},"arguments":[{"type":"Literal","start":9084,"end":9107,"value":"handle oauth redirect","raw":"'handle oauth redirect'"},{"type":"ArrowFunctionExpression","start":9109,"end":9719,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":9115,"end":9719,"body":[{"type":"ExpressionStatement","start":9119,"end":9410,"expression":{"type":"CallExpression","start":9119,"end":9410,"callee":{"type":"Identifier","start":9119,"end":9123,"name":"test"},"arguments":[{"type":"Literal","start":9124,"end":9159,"value":"redirect to a valid uppy instance","raw":"'redirect to a valid uppy instance'"},{"type":"ArrowFunctionExpression","start":9161,"end":9409,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":9167,"end":9409,"body":[{"type":"ReturnStatement","start":9173,"end":9405,"argument":{"type":"CallExpression","start":9180,"end":9405,"callee":{"type":"MemberExpression","start":9180,"end":9322,"object":{"type":"CallExpression","start":9180,"end":9308,"callee":{"type":"MemberExpression","start":9180,"end":9303,"object":{"type":"CallExpression","start":9180,"end":9289,"callee":{"type":"MemberExpression","start":9180,"end":9263,"object":{"type":"CallExpression","start":9180,"end":9252,"callee":{"type":"MemberExpression","start":9180,"end":9210,"object":{"type":"CallExpression","start":9180,"end":9199,"callee":{"type":"Identifier","start":9180,"end":9187,"name":"request"},"arguments":[{"type":"Identifier","start":9188,"end":9198,"name":"authServer"}]},"property":{"type":"Identifier","start":9207,"end":9210,"name":"get"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":9211,"end":9251,"expressions":[{"type":"Identifier","start":9238,"end":9249,"name":"OAUTH_STATE"}],"quasis":[{"type":"TemplateElement","start":9212,"end":9236,"value":{"raw":"/dropbox/redirect?state=","cooked":"/dropbox/redirect?state="},"tail":false},{"type":"TemplateElement","start":9250,"end":9250,"value":{"raw":"","cooked":""},"tail":true}]}]},"property":{"type":"Identifier","start":9260,"end":9263,"name":"set"},"computed":false},"arguments":[{"type":"Literal","start":9264,"end":9281,"value":"uppy-auth-token","raw":"'uppy-auth-token'"},{"type":"Identifier","start":9283,"end":9288,"name":"token"}]},"property":{"type":"Identifier","start":9297,"end":9303,"name":"expect"},"computed":false},"arguments":[{"type":"Literal","start":9304,"end":9307,"value":302,"raw":"302"}]},"property":{"type":"Identifier","start":9316,"end":9322,"name":"expect"},"computed":false},"arguments":[{"type":"Literal","start":9323,"end":9333,"value":"Location","raw":"'Location'"},{"type":"TemplateLiteral","start":9335,"end":9404,"expressions":[{"type":"Identifier","start":9391,"end":9402,"name":"OAUTH_STATE"}],"quasis":[{"type":"TemplateElement","start":9336,"end":9389,"value":{"raw":"http://localhost:3020/connect/dropbox/callback?state=","cooked":"http://localhost:3020/connect/dropbox/callback?state="},"tail":false},{"type":"TemplateElement","start":9403,"end":9403,"value":{"raw":"","cooked":""},"tail":true}]}]}}]}}]}},{"type":"ExpressionStatement","start":9414,"end":9717,"expression":{"type":"CallExpression","start":9414,"end":9717,"callee":{"type":"Identifier","start":9414,"end":9418,"name":"test"},"arguments":[{"type":"Literal","start":9419,"end":9462,"value":"do not redirect to invalid uppy instances","raw":"'do not redirect to invalid uppy instances'"},{"type":"ArrowFunctionExpression","start":9464,"end":9716,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":9470,"end":9716,"body":[{"type":"VariableDeclaration","start":9476,"end":9523,"declarations":[{"type":"VariableDeclarator","start":9482,"end":9523,"id":{"type":"Identifier","start":9482,"end":9487,"name":"state"},"init":{"type":"Literal","start":9490,"end":9523,"value":"state-with-invalid-instance-url","raw":"'state-with-invalid-instance-url'"}}],"kind":"const"},{"type":"ReturnStatement","start":9583,"end":9712,"argument":{"type":"CallExpression","start":9590,"end":9712,"callee":{"type":"MemberExpression","start":9590,"end":9707,"object":{"type":"CallExpression","start":9590,"end":9693,"callee":{"type":"MemberExpression","start":9590,"end":9667,"object":{"type":"CallExpression","start":9590,"end":9656,"callee":{"type":"MemberExpression","start":9590,"end":9620,"object":{"type":"CallExpression","start":9590,"end":9609,"callee":{"type":"Identifier","start":9590,"end":9597,"name":"request"},"arguments":[{"type":"Identifier","start":9598,"end":9608,"name":"authServer"}]},"property":{"type":"Identifier","start":9617,"end":9620,"name":"get"},"computed":false},"arguments":[{"type":"TemplateLiteral","start":9621,"end":9655,"expressions":[{"type":"Identifier","start":9648,"end":9653,"name":"state"}],"quasis":[{"type":"TemplateElement","start":9622,"end":9646,"value":{"raw":"/dropbox/redirect?state=","cooked":"/dropbox/redirect?state="},"tail":false},{"type":"TemplateElement","start":9654,"end":9654,"value":{"raw":"","cooked":""},"tail":true}]}]},"property":{"type":"Identifier","start":9664,"end":9667,"name":"set"},"computed":false},"arguments":[{"type":"Literal","start":9668,"end":9685,"value":"uppy-auth-token","raw":"'uppy-auth-token'"},{"type":"Identifier","start":9687,"end":9692,"name":"token"}]},"property":{"type":"Identifier","start":9701,"end":9707,"name":"expect"},"computed":false},"arguments":[{"type":"Literal","start":9708,"end":9711,"value":400,"raw":"400"}]}}]}}]}}]}}]}}],"sourceType":"script"}