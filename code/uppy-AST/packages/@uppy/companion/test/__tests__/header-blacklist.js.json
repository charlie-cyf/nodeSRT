{"type":"Program","start":0,"end":1925,"body":[{"type":"VariableDeclaration","start":56,"end":123,"declarations":[{"type":"VariableDeclarator","start":62,"end":123,"id":{"type":"Identifier","start":62,"end":76,"name":"headerSanitize"},"init":{"type":"CallExpression","start":79,"end":123,"callee":{"type":"Identifier","start":79,"end":86,"name":"require"},"arguments":[{"type":"Literal","start":87,"end":122,"value":"../../src/server/header-blacklist","raw":"'../../src/server/header-blacklist'"}]}}],"kind":"const"},{"type":"ExpressionStatement","start":125,"end":1924,"expression":{"type":"CallExpression","start":125,"end":1924,"callee":{"type":"Identifier","start":125,"end":133,"name":"describe"},"arguments":[{"type":"Literal","start":134,"end":161,"value":"Header black-list testing","raw":"'Header black-list testing'"},{"type":"ArrowFunctionExpression","start":163,"end":1923,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":169,"end":1923,"body":[{"type":"ExpressionStatement","start":173,"end":402,"expression":{"type":"CallExpression","start":173,"end":402,"callee":{"type":"Identifier","start":173,"end":177,"name":"test"},"arguments":[{"type":"Literal","start":178,"end":207,"value":"All headers invalid by name","raw":"'All headers invalid by name'"},{"type":"ArrowFunctionExpression","start":209,"end":401,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":215,"end":401,"body":[{"type":"VariableDeclaration","start":221,"end":364,"declarations":[{"type":"VariableDeclarator","start":227,"end":364,"id":{"type":"Identifier","start":227,"end":234,"name":"headers"},"init":{"type":"CallExpression","start":237,"end":364,"callee":{"type":"Identifier","start":237,"end":251,"name":"headerSanitize"},"arguments":[{"type":"ObjectExpression","start":252,"end":363,"properties":[{"type":"Property","start":260,"end":296,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":260,"end":266,"name":"origin"},"value":{"type":"Literal","start":268,"end":296,"value":"http://www.transloadit.com","raw":"'http://www.transloadit.com'"},"kind":"init"},{"type":"Property","start":304,"end":327,"method":false,"shorthand":false,"computed":false,"key":{"type":"Literal","start":304,"end":320,"value":"Accept-Charset","raw":"'Accept-Charset'"},"value":{"type":"Literal","start":322,"end":327,"value":"...","raw":"'...'"},"kind":"init"},{"type":"Property","start":335,"end":357,"method":false,"shorthand":false,"computed":false,"key":{"type":"Literal","start":335,"end":351,"value":"content-Length","raw":"'content-Length'"},"value":{"type":"Literal","start":353,"end":357,"value":1234,"raw":"1234"},"kind":"init"}]}]}}],"kind":"const"},{"type":"ExpressionStatement","start":370,"end":397,"expression":{"type":"CallExpression","start":370,"end":397,"callee":{"type":"MemberExpression","start":370,"end":393,"object":{"type":"CallExpression","start":370,"end":385,"callee":{"type":"Identifier","start":370,"end":376,"name":"expect"},"arguments":[{"type":"Identifier","start":377,"end":384,"name":"headers"}]},"property":{"type":"Identifier","start":386,"end":393,"name":"toEqual"},"computed":false},"arguments":[{"type":"ObjectExpression","start":394,"end":396,"properties":[]}]}}]}}]}},{"type":"ExpressionStatement","start":406,"end":843,"expression":{"type":"CallExpression","start":406,"end":843,"callee":{"type":"Identifier","start":406,"end":410,"name":"test"},"arguments":[{"type":"Literal","start":411,"end":441,"value":"All headers invalid by regex","raw":"'All headers invalid by regex'"},{"type":"ArrowFunctionExpression","start":443,"end":842,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":449,"end":842,"body":[{"type":"VariableDeclaration","start":455,"end":806,"declarations":[{"type":"VariableDeclarator","start":461,"end":806,"id":{"type":"Identifier","start":461,"end":468,"name":"headers"},"init":{"type":"CallExpression","start":471,"end":806,"callee":{"type":"Identifier","start":471,"end":485,"name":"headerSanitize"},"arguments":[{"type":"ObjectExpression","start":486,"end":805,"properties":[{"type":"Property","start":494,"end":534,"method":false,"shorthand":false,"computed":false,"key":{"type":"Literal","start":494,"end":513,"value":"Proxy-header-fake","raw":"'Proxy-header-fake'"},"value":{"type":"Literal","start":515,"end":534,"value":"proxy-header-fake","raw":"'proxy-header-fake'"},"kind":"init"},{"type":"Property","start":542,"end":594,"method":false,"shorthand":false,"computed":false,"key":{"type":"Literal","start":542,"end":567,"value":"proxy-header-fake-lower","raw":"'proxy-header-fake-lower'"},"value":{"type":"Literal","start":569,"end":594,"value":"proxy-header-fake-lower","raw":"'proxy-header-fake-lower'"},"kind":"init"},{"type":"Property","start":602,"end":637,"method":false,"shorthand":false,"computed":false,"key":{"type":"Literal","start":602,"end":610,"value":"proxy-","raw":"'proxy-'"},"value":{"type":"Literal","start":612,"end":637,"value":"proxy-header-fake-empty","raw":"'proxy-header-fake-empty'"},"kind":"init"},{"type":"Property","start":645,"end":671,"method":false,"shorthand":false,"computed":false,"key":{"type":"Literal","start":645,"end":651,"value":"Sec-","raw":"'Sec-'"},"value":{"type":"Literal","start":653,"end":671,"value":"sec-header-empty","raw":"'sec-header-empty'"},"kind":"init"},{"type":"Property","start":679,"end":711,"method":false,"shorthand":false,"computed":false,"key":{"type":"Literal","start":679,"end":685,"value":"sec-","raw":"'sec-'"},"value":{"type":"Literal","start":687,"end":711,"value":"sec-lower-header-empty","raw":"'sec-lower-header-empty'"},"kind":"init"},{"type":"Property","start":719,"end":755,"method":false,"shorthand":false,"computed":false,"key":{"type":"Literal","start":719,"end":736,"value":"Sec-header-fake","raw":"'Sec-header-fake'"},"value":{"type":"Literal","start":738,"end":755,"value":"sec-header-fake","raw":"'sec-header-fake'"},"kind":"init"},{"type":"Property","start":763,"end":799,"method":false,"shorthand":false,"computed":false,"key":{"type":"Literal","start":763,"end":780,"value":"sec-header-fake","raw":"'sec-header-fake'"},"value":{"type":"Literal","start":782,"end":799,"value":"sec-header-fake","raw":"'sec-header-fake'"},"kind":"init"}]}]}}],"kind":"const"},{"type":"ExpressionStatement","start":811,"end":838,"expression":{"type":"CallExpression","start":811,"end":838,"callee":{"type":"MemberExpression","start":811,"end":834,"object":{"type":"CallExpression","start":811,"end":826,"callee":{"type":"Identifier","start":811,"end":817,"name":"expect"},"arguments":[{"type":"Identifier","start":818,"end":825,"name":"headers"}]},"property":{"type":"Identifier","start":827,"end":834,"name":"toEqual"},"computed":false},"arguments":[{"type":"ObjectExpression","start":835,"end":837,"properties":[]}]}}]}}]}},{"type":"ExpressionStatement","start":847,"end":1072,"expression":{"type":"CallExpression","start":847,"end":1072,"callee":{"type":"Identifier","start":847,"end":851,"name":"test"},"arguments":[{"type":"Literal","start":852,"end":891,"value":"All headers invalid by name and regex","raw":"'All headers invalid by name and regex'"},{"type":"ArrowFunctionExpression","start":893,"end":1071,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":899,"end":1071,"body":[{"type":"VariableDeclaration","start":905,"end":1035,"declarations":[{"type":"VariableDeclarator","start":911,"end":1035,"id":{"type":"Identifier","start":911,"end":918,"name":"headers"},"init":{"type":"CallExpression","start":921,"end":1035,"callee":{"type":"Identifier","start":921,"end":935,"name":"headerSanitize"},"arguments":[{"type":"ObjectExpression","start":936,"end":1034,"properties":[{"type":"Property","start":944,"end":984,"method":false,"shorthand":false,"computed":false,"key":{"type":"Literal","start":944,"end":963,"value":"Proxy-header-fake","raw":"'Proxy-header-fake'"},"value":{"type":"Literal","start":965,"end":984,"value":"proxy-header-fake","raw":"'proxy-header-fake'"},"kind":"init"},{"type":"Property","start":992,"end":1028,"method":false,"shorthand":false,"computed":false,"key":{"type":"Literal","start":992,"end":1009,"value":"Sec-header-fake","raw":"'Sec-header-fake'"},"value":{"type":"Literal","start":1011,"end":1028,"value":"sec-header-fake","raw":"'sec-header-fake'"},"kind":"init"}]}]}}],"kind":"const"},{"type":"ExpressionStatement","start":1040,"end":1067,"expression":{"type":"CallExpression","start":1040,"end":1067,"callee":{"type":"MemberExpression","start":1040,"end":1063,"object":{"type":"CallExpression","start":1040,"end":1055,"callee":{"type":"Identifier","start":1040,"end":1046,"name":"expect"},"arguments":[{"type":"Identifier","start":1047,"end":1054,"name":"headers"}]},"property":{"type":"Identifier","start":1056,"end":1063,"name":"toEqual"},"computed":false},"arguments":[{"type":"ObjectExpression","start":1064,"end":1066,"properties":[]}]}}]}}]}},{"type":"ExpressionStatement","start":1076,"end":1569,"expression":{"type":"CallExpression","start":1076,"end":1569,"callee":{"type":"Identifier","start":1076,"end":1080,"name":"test"},"arguments":[{"type":"Literal","start":1081,"end":1113,"value":"Returning only allowed headers","raw":"'Returning only allowed headers'"},{"type":"ArrowFunctionExpression","start":1115,"end":1568,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":1121,"end":1568,"body":[{"type":"VariableDeclaration","start":1127,"end":1366,"declarations":[{"type":"VariableDeclarator","start":1133,"end":1366,"id":{"type":"Identifier","start":1133,"end":1140,"name":"headers"},"init":{"type":"CallExpression","start":1143,"end":1366,"callee":{"type":"Identifier","start":1143,"end":1157,"name":"headerSanitize"},"arguments":[{"type":"ObjectExpression","start":1158,"end":1365,"properties":[{"type":"Property","start":1166,"end":1195,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1166,"end":1179,"name":"Authorization"},"value":{"type":"Literal","start":1181,"end":1195,"value":"Basic Xxxxxx","raw":"'Basic Xxxxxx'"},"kind":"init"},{"type":"Property","start":1203,"end":1237,"method":false,"shorthand":false,"computed":false,"key":{"type":"Literal","start":1203,"end":1217,"value":"Content-Type","raw":"'Content-Type'"},"value":{"type":"Literal","start":1219,"end":1237,"value":"application/json","raw":"'application/json'"},"kind":"init"},{"type":"Property","start":1245,"end":1267,"method":false,"shorthand":false,"computed":false,"key":{"type":"Literal","start":1245,"end":1261,"value":"Content-Length","raw":"'Content-Length'"},"value":{"type":"Literal","start":1263,"end":1267,"value":1234,"raw":"1234"},"kind":"init"},{"type":"Property","start":1275,"end":1315,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1275,"end":1282,"name":"Expires"},"value":{"type":"Literal","start":1284,"end":1315,"value":"Wed, 21 Oct 2015 07:28:00 GMT","raw":"'Wed, 21 Oct 2015 07:28:00 GMT'"},"kind":"init"},{"type":"Property","start":1323,"end":1359,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1323,"end":1329,"name":"Origin"},"value":{"type":"Literal","start":1331,"end":1359,"value":"http://www.transloadit.com","raw":"'http://www.transloadit.com'"},"kind":"init"}]}]}}],"kind":"const"},{"type":"ExpressionStatement","start":1371,"end":1415,"expression":{"type":"CallExpression","start":1371,"end":1415,"callee":{"type":"MemberExpression","start":1371,"end":1412,"object":{"type":"CallExpression","start":1371,"end":1399,"callee":{"type":"Identifier","start":1371,"end":1377,"name":"expect"},"arguments":[{"type":"CallExpression","start":1378,"end":1398,"callee":{"type":"MemberExpression","start":1378,"end":1389,"object":{"type":"Identifier","start":1378,"end":1384,"name":"Object"},"property":{"type":"Identifier","start":1385,"end":1389,"name":"keys"},"computed":false},"arguments":[{"type":"Identifier","start":1390,"end":1397,"name":"headers"}]}]},"property":{"type":"Identifier","start":1400,"end":1412,"name":"toHaveLength"},"computed":false},"arguments":[{"type":"Literal","start":1413,"end":1414,"value":3,"raw":"3"}]}},{"type":"ExpressionStatement","start":1420,"end":1467,"expression":{"type":"CallExpression","start":1420,"end":1467,"callee":{"type":"MemberExpression","start":1420,"end":1450,"object":{"type":"CallExpression","start":1420,"end":1435,"callee":{"type":"Identifier","start":1420,"end":1426,"name":"expect"},"arguments":[{"type":"Identifier","start":1427,"end":1434,"name":"headers"}]},"property":{"type":"Identifier","start":1436,"end":1450,"name":"toHaveProperty"},"computed":false},"arguments":[{"type":"Literal","start":1451,"end":1466,"value":"Authorization","raw":"'Authorization'"}]}},{"type":"ExpressionStatement","start":1472,"end":1518,"expression":{"type":"CallExpression","start":1472,"end":1518,"callee":{"type":"MemberExpression","start":1472,"end":1502,"object":{"type":"CallExpression","start":1472,"end":1487,"callee":{"type":"Identifier","start":1472,"end":1478,"name":"expect"},"arguments":[{"type":"Identifier","start":1479,"end":1486,"name":"headers"}]},"property":{"type":"Identifier","start":1488,"end":1502,"name":"toHaveProperty"},"computed":false},"arguments":[{"type":"Literal","start":1503,"end":1517,"value":"Content-Type","raw":"'Content-Type'"}]}},{"type":"ExpressionStatement","start":1523,"end":1564,"expression":{"type":"CallExpression","start":1523,"end":1564,"callee":{"type":"MemberExpression","start":1523,"end":1553,"object":{"type":"CallExpression","start":1523,"end":1538,"callee":{"type":"Identifier","start":1523,"end":1529,"name":"expect"},"arguments":[{"type":"Identifier","start":1530,"end":1537,"name":"headers"}]},"property":{"type":"Identifier","start":1539,"end":1553,"name":"toHaveProperty"},"computed":false},"arguments":[{"type":"Literal","start":1554,"end":1563,"value":"Expires","raw":"'Expires'"}]}}]}}]}},{"type":"ExpressionStatement","start":1573,"end":1921,"expression":{"type":"CallExpression","start":1573,"end":1921,"callee":{"type":"Identifier","start":1573,"end":1577,"name":"test"},"arguments":[{"type":"Literal","start":1578,"end":1629,"value":"Return empty object when headers is not an object","raw":"'Return empty object when headers is not an object'"},{"type":"ArrowFunctionExpression","start":1631,"end":1920,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":1637,"end":1920,"body":[{"type":"ExpressionStatement","start":1643,"end":1681,"expression":{"type":"CallExpression","start":1643,"end":1681,"callee":{"type":"MemberExpression","start":1643,"end":1677,"object":{"type":"CallExpression","start":1643,"end":1669,"callee":{"type":"Identifier","start":1643,"end":1649,"name":"expect"},"arguments":[{"type":"CallExpression","start":1650,"end":1668,"callee":{"type":"Identifier","start":1650,"end":1664,"name":"headerSanitize"},"arguments":[{"type":"ObjectExpression","start":1665,"end":1667,"properties":[]}]}]},"property":{"type":"Identifier","start":1670,"end":1677,"name":"toEqual"},"computed":false},"arguments":[{"type":"ObjectExpression","start":1678,"end":1680,"properties":[]}]}},{"type":"ExpressionStatement","start":1686,"end":1726,"expression":{"type":"CallExpression","start":1686,"end":1726,"callee":{"type":"MemberExpression","start":1686,"end":1722,"object":{"type":"CallExpression","start":1686,"end":1714,"callee":{"type":"Identifier","start":1686,"end":1692,"name":"expect"},"arguments":[{"type":"CallExpression","start":1693,"end":1713,"callee":{"type":"Identifier","start":1693,"end":1707,"name":"headerSanitize"},"arguments":[{"type":"Literal","start":1708,"end":1712,"value":null,"raw":"null"}]}]},"property":{"type":"Identifier","start":1715,"end":1722,"name":"toEqual"},"computed":false},"arguments":[{"type":"ObjectExpression","start":1723,"end":1725,"properties":[]}]}},{"type":"ExpressionStatement","start":1731,"end":1776,"expression":{"type":"CallExpression","start":1731,"end":1776,"callee":{"type":"MemberExpression","start":1731,"end":1772,"object":{"type":"CallExpression","start":1731,"end":1764,"callee":{"type":"Identifier","start":1731,"end":1737,"name":"expect"},"arguments":[{"type":"CallExpression","start":1738,"end":1763,"callee":{"type":"Identifier","start":1738,"end":1752,"name":"headerSanitize"},"arguments":[{"type":"Identifier","start":1753,"end":1762,"name":"undefined"}]}]},"property":{"type":"Identifier","start":1765,"end":1772,"name":"toEqual"},"computed":false},"arguments":[{"type":"ObjectExpression","start":1773,"end":1775,"properties":[]}]}},{"type":"ExpressionStatement","start":1781,"end":1844,"expression":{"type":"CallExpression","start":1781,"end":1844,"callee":{"type":"MemberExpression","start":1781,"end":1840,"object":{"type":"CallExpression","start":1781,"end":1832,"callee":{"type":"Identifier","start":1781,"end":1787,"name":"expect"},"arguments":[{"type":"CallExpression","start":1788,"end":1831,"callee":{"type":"Identifier","start":1788,"end":1802,"name":"headerSanitize"},"arguments":[{"type":"Literal","start":1803,"end":1830,"value":"Authorization: Basic 1234","raw":"'Authorization: Basic 1234'"}]}]},"property":{"type":"Identifier","start":1833,"end":1840,"name":"toEqual"},"computed":false},"arguments":[{"type":"ObjectExpression","start":1841,"end":1843,"properties":[]}]}},{"type":"ExpressionStatement","start":1849,"end":1916,"expression":{"type":"CallExpression","start":1849,"end":1916,"callee":{"type":"MemberExpression","start":1849,"end":1912,"object":{"type":"CallExpression","start":1849,"end":1904,"callee":{"type":"Identifier","start":1849,"end":1855,"name":"expect"},"arguments":[{"type":"CallExpression","start":1856,"end":1903,"callee":{"type":"Identifier","start":1856,"end":1870,"name":"headerSanitize"},"arguments":[{"type":"ArrayExpression","start":1871,"end":1902,"elements":[{"type":"Literal","start":1872,"end":1887,"value":"Authorization","raw":"'Authorization'"},{"type":"Literal","start":1889,"end":1901,"value":"Basic 1234","raw":"'Basic 1234'"}]}]}]},"property":{"type":"Identifier","start":1905,"end":1912,"name":"toEqual"},"computed":false},"arguments":[{"type":"ObjectExpression","start":1913,"end":1915,"properties":[]}]}}]}}]}}]}}]}}],"sourceType":"script"}