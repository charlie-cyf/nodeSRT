{"type":"Program","start":0,"end":5221,"body":[{"type":"VariableDeclaration","start":0,"end":38,"declarations":[{"type":"VariableDeclarator","start":6,"end":38,"id":{"type":"Identifier","start":6,"end":16,"name":"UppySocket"},"init":{"type":"CallExpression","start":19,"end":38,"callee":{"type":"Identifier","start":19,"end":26,"name":"require"},"arguments":[{"type":"Literal","start":27,"end":37,"value":"./Socket","raw":"'./Socket'"}]}}],"kind":"const"},{"type":"ExpressionStatement","start":40,"end":5220,"expression":{"type":"CallExpression","start":40,"end":5220,"callee":{"type":"Identifier","start":40,"end":48,"name":"describe"},"arguments":[{"type":"Literal","start":49,"end":57,"value":"Socket","raw":"'Socket'"},{"type":"ArrowFunctionExpression","start":59,"end":5219,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":65,"end":5219,"body":[{"type":"VariableDeclaration","start":69,"end":96,"declarations":[{"type":"VariableDeclarator","start":73,"end":96,"id":{"type":"Identifier","start":73,"end":96,"name":"webSocketConstructorSpy"},"init":null}],"kind":"let"},{"type":"VariableDeclaration","start":99,"end":120,"declarations":[{"type":"VariableDeclarator","start":103,"end":120,"id":{"type":"Identifier","start":103,"end":120,"name":"webSocketCloseSpy"},"init":null}],"kind":"let"},{"type":"VariableDeclaration","start":123,"end":143,"declarations":[{"type":"VariableDeclarator","start":127,"end":143,"id":{"type":"Identifier","start":127,"end":143,"name":"webSocketSendSpy"},"init":null}],"kind":"let"},{"type":"ExpressionStatement","start":147,"end":634,"expression":{"type":"CallExpression","start":147,"end":634,"callee":{"type":"Identifier","start":147,"end":157,"name":"beforeEach"},"arguments":[{"type":"ArrowFunctionExpression","start":158,"end":633,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":164,"end":633,"body":[{"type":"ExpressionStatement","start":170,"end":205,"expression":{"type":"AssignmentExpression","start":170,"end":205,"operator":"=","left":{"type":"Identifier","start":170,"end":193,"name":"webSocketConstructorSpy"},"right":{"type":"CallExpression","start":196,"end":205,"callee":{"type":"MemberExpression","start":196,"end":203,"object":{"type":"Identifier","start":196,"end":200,"name":"jest"},"property":{"type":"Identifier","start":201,"end":203,"name":"fn"},"computed":false},"arguments":[]}}},{"type":"ExpressionStatement","start":210,"end":239,"expression":{"type":"AssignmentExpression","start":210,"end":239,"operator":"=","left":{"type":"Identifier","start":210,"end":227,"name":"webSocketCloseSpy"},"right":{"type":"CallExpression","start":230,"end":239,"callee":{"type":"MemberExpression","start":230,"end":237,"object":{"type":"Identifier","start":230,"end":234,"name":"jest"},"property":{"type":"Identifier","start":235,"end":237,"name":"fn"},"computed":false},"arguments":[]}}},{"type":"ExpressionStatement","start":244,"end":272,"expression":{"type":"AssignmentExpression","start":244,"end":272,"operator":"=","left":{"type":"Identifier","start":244,"end":260,"name":"webSocketSendSpy"},"right":{"type":"CallExpression","start":263,"end":272,"callee":{"type":"MemberExpression","start":263,"end":270,"object":{"type":"Identifier","start":263,"end":267,"name":"jest"},"property":{"type":"Identifier","start":268,"end":270,"name":"fn"},"computed":false},"arguments":[]}}},{"type":"ExpressionStatement","start":278,"end":629,"expression":{"type":"AssignmentExpression","start":278,"end":629,"operator":"=","left":{"type":"MemberExpression","start":278,"end":294,"object":{"type":"Identifier","start":278,"end":284,"name":"global"},"property":{"type":"Identifier","start":285,"end":294,"name":"WebSocket"},"computed":false},"right":{"type":"ClassExpression","start":297,"end":629,"id":{"type":"Identifier","start":303,"end":312,"name":"WebSocket"},"superClass":null,"body":{"type":"ClassBody","start":313,"end":629,"body":[{"type":"MethodDefinition","start":321,"end":391,"kind":"constructor","static":false,"computed":false,"key":{"type":"Identifier","start":321,"end":332,"name":"constructor"},"value":{"type":"FunctionExpression","start":333,"end":391,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":334,"end":340,"name":"target"}],"body":{"type":"BlockStatement","start":342,"end":391,"body":[{"type":"ExpressionStatement","start":352,"end":383,"expression":{"type":"CallExpression","start":352,"end":383,"callee":{"type":"Identifier","start":352,"end":375,"name":"webSocketConstructorSpy"},"arguments":[{"type":"Identifier","start":376,"end":382,"name":"target"}]}}]}}},{"type":"MethodDefinition","start":399,"end":453,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":399,"end":404,"name":"close"},"value":{"type":"FunctionExpression","start":405,"end":453,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":406,"end":410,"name":"args"}],"body":{"type":"BlockStatement","start":412,"end":453,"body":[{"type":"ExpressionStatement","start":422,"end":445,"expression":{"type":"CallExpression","start":422,"end":445,"callee":{"type":"Identifier","start":422,"end":439,"name":"webSocketCloseSpy"},"arguments":[{"type":"Identifier","start":440,"end":444,"name":"args"}]}}]}}},{"type":"MethodDefinition","start":461,"end":513,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":461,"end":465,"name":"send"},"value":{"type":"FunctionExpression","start":466,"end":513,"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":467,"end":471,"name":"json"}],"body":{"type":"BlockStatement","start":473,"end":513,"body":[{"type":"ExpressionStatement","start":483,"end":505,"expression":{"type":"CallExpression","start":483,"end":505,"callee":{"type":"Identifier","start":483,"end":499,"name":"webSocketSendSpy"},"arguments":[{"type":"Identifier","start":500,"end":504,"name":"json"}]}}]}}},{"type":"MethodDefinition","start":521,"end":567,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":521,"end":532,"name":"triggerOpen"},"value":{"type":"FunctionExpression","start":533,"end":567,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":536,"end":567,"body":[{"type":"ExpressionStatement","start":546,"end":559,"expression":{"type":"CallExpression","start":546,"end":559,"callee":{"type":"MemberExpression","start":546,"end":557,"object":{"type":"ThisExpression","start":546,"end":550},"property":{"type":"Identifier","start":551,"end":557,"name":"onopen"},"computed":false},"arguments":[]}}]}}},{"type":"MethodDefinition","start":575,"end":623,"kind":"method","static":false,"computed":false,"key":{"type":"Identifier","start":575,"end":587,"name":"triggerClose"},"value":{"type":"FunctionExpression","start":588,"end":623,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":591,"end":623,"body":[{"type":"ExpressionStatement","start":601,"end":615,"expression":{"type":"CallExpression","start":601,"end":615,"callee":{"type":"MemberExpression","start":601,"end":613,"object":{"type":"ThisExpression","start":601,"end":605},"property":{"type":"Identifier","start":606,"end":613,"name":"onclose"},"computed":false},"arguments":[]}}]}}}]}}}}]}}]}},{"type":"ExpressionStatement","start":637,"end":692,"expression":{"type":"CallExpression","start":637,"end":692,"callee":{"type":"Identifier","start":637,"end":646,"name":"afterEach"},"arguments":[{"type":"ArrowFunctionExpression","start":647,"end":691,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":653,"end":691,"body":[{"type":"ExpressionStatement","start":659,"end":687,"expression":{"type":"AssignmentExpression","start":659,"end":687,"operator":"=","left":{"type":"MemberExpression","start":659,"end":675,"object":{"type":"Identifier","start":659,"end":665,"name":"global"},"property":{"type":"Identifier","start":666,"end":675,"name":"WebSocket"},"computed":false},"right":{"type":"Identifier","start":678,"end":687,"name":"undefined"}}}]}}]}},{"type":"ExpressionStatement","start":696,"end":880,"expression":{"type":"CallExpression","start":696,"end":880,"callee":{"type":"Identifier","start":696,"end":698,"name":"it"},"arguments":[{"type":"Literal","start":699,"end":722,"value":"should expose a class","raw":"'should expose a class'"},{"type":"ArrowFunctionExpression","start":724,"end":879,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":730,"end":879,"body":[{"type":"ExpressionStatement","start":736,"end":781,"expression":{"type":"CallExpression","start":736,"end":781,"callee":{"type":"MemberExpression","start":736,"end":767,"object":{"type":"CallExpression","start":736,"end":759,"callee":{"type":"Identifier","start":736,"end":742,"name":"expect"},"arguments":[{"type":"MemberExpression","start":743,"end":758,"object":{"type":"Identifier","start":743,"end":753,"name":"UppySocket"},"property":{"type":"Identifier","start":754,"end":758,"name":"name"},"computed":false}]},"property":{"type":"Identifier","start":760,"end":767,"name":"toEqual"},"computed":false},"arguments":[{"type":"Literal","start":768,"end":780,"value":"UppySocket","raw":"'UppySocket'"}]}},{"type":"ExpressionStatement","start":786,"end":875,"expression":{"type":"CallExpression","start":786,"end":875,"callee":{"type":"Identifier","start":786,"end":792,"name":"expect"},"arguments":[{"type":"BinaryExpression","start":800,"end":869,"left":{"type":"NewExpression","start":800,"end":847,"callee":{"type":"Identifier","start":804,"end":814,"name":"UppySocket"},"arguments":[{"type":"ObjectExpression","start":815,"end":846,"properties":[{"type":"Property","start":825,"end":838,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":825,"end":831,"name":"target"},"value":{"type":"Literal","start":833,"end":838,"value":"foo","raw":"'foo'"},"kind":"init"}]}]},"operator":"instanceof","right":{"type":"Identifier","start":859,"end":869,"name":"UppySocket"}}]}}]}}]}},{"type":"ExpressionStatement","start":884,"end":1067,"expression":{"type":"CallExpression","start":884,"end":1067,"callee":{"type":"Identifier","start":884,"end":886,"name":"it"},"arguments":[{"type":"Literal","start":887,"end":917,"value":"should setup a new WebSocket","raw":"'should setup a new WebSocket'"},{"type":"ArrowFunctionExpression","start":919,"end":1066,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":925,"end":1066,"body":[{"type":"ExpressionStatement","start":931,"end":964,"expression":{"type":"NewExpression","start":931,"end":964,"callee":{"type":"Identifier","start":935,"end":945,"name":"UppySocket"},"arguments":[{"type":"ObjectExpression","start":946,"end":963,"properties":[{"type":"Property","start":948,"end":961,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":948,"end":954,"name":"target"},"value":{"type":"Literal","start":956,"end":961,"value":"foo","raw":"'foo'"},"kind":"init"}]}]}},{"type":"ExpressionStatement","start":999,"end":1062,"expression":{"type":"CallExpression","start":999,"end":1062,"callee":{"type":"MemberExpression","start":999,"end":1055,"object":{"type":"CallExpression","start":999,"end":1047,"callee":{"type":"Identifier","start":999,"end":1005,"name":"expect"},"arguments":[{"type":"MemberExpression","start":1006,"end":1046,"object":{"type":"MemberExpression","start":1006,"end":1043,"object":{"type":"MemberExpression","start":1006,"end":1040,"object":{"type":"MemberExpression","start":1006,"end":1034,"object":{"type":"Identifier","start":1006,"end":1029,"name":"webSocketConstructorSpy"},"property":{"type":"Identifier","start":1030,"end":1034,"name":"mock"},"computed":false},"property":{"type":"Identifier","start":1035,"end":1040,"name":"calls"},"computed":false},"property":{"type":"Literal","start":1041,"end":1042,"value":0,"raw":"0"},"computed":true},"property":{"type":"Literal","start":1044,"end":1045,"value":0,"raw":"0"},"computed":true}]},"property":{"type":"Identifier","start":1048,"end":1055,"name":"toEqual"},"computed":false},"arguments":[{"type":"Literal","start":1056,"end":1061,"value":"foo","raw":"'foo'"}]}}]}}]}},{"type":"ExpressionStatement","start":1071,"end":1505,"expression":{"type":"CallExpression","start":1071,"end":1505,"callee":{"type":"Identifier","start":1071,"end":1073,"name":"it"},"arguments":[{"type":"Literal","start":1074,"end":1141,"value":"should send a message via the websocket if the connection is open","raw":"'should send a message via the websocket if the connection is open'"},{"type":"ArrowFunctionExpression","start":1143,"end":1504,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":1149,"end":1504,"body":[{"type":"VariableDeclaration","start":1155,"end":1207,"declarations":[{"type":"VariableDeclarator","start":1161,"end":1207,"id":{"type":"Identifier","start":1161,"end":1171,"name":"uppySocket"},"init":{"type":"NewExpression","start":1174,"end":1207,"callee":{"type":"Identifier","start":1178,"end":1188,"name":"UppySocket"},"arguments":[{"type":"ObjectExpression","start":1189,"end":1206,"properties":[{"type":"Property","start":1191,"end":1204,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1191,"end":1197,"name":"target"},"value":{"type":"Literal","start":1199,"end":1204,"value":"foo","raw":"'foo'"},"kind":"init"}]}]}}],"kind":"const"},{"type":"VariableDeclaration","start":1212,"end":1255,"declarations":[{"type":"VariableDeclarator","start":1218,"end":1255,"id":{"type":"Identifier","start":1218,"end":1235,"name":"webSocketInstance"},"init":{"type":"MemberExpression","start":1238,"end":1255,"object":{"type":"Identifier","start":1238,"end":1248,"name":"uppySocket"},"property":{"type":"Identifier","start":1249,"end":1255,"name":"socket"},"computed":false}}],"kind":"const"},{"type":"ExpressionStatement","start":1260,"end":1291,"expression":{"type":"CallExpression","start":1260,"end":1291,"callee":{"type":"MemberExpression","start":1260,"end":1289,"object":{"type":"Identifier","start":1260,"end":1277,"name":"webSocketInstance"},"property":{"type":"Identifier","start":1278,"end":1289,"name":"triggerOpen"},"computed":false},"arguments":[]}},{"type":"ExpressionStatement","start":1297,"end":1326,"expression":{"type":"CallExpression","start":1297,"end":1326,"callee":{"type":"MemberExpression","start":1297,"end":1312,"object":{"type":"Identifier","start":1297,"end":1307,"name":"uppySocket"},"property":{"type":"Identifier","start":1308,"end":1312,"name":"send"},"computed":false},"arguments":[{"type":"Literal","start":1313,"end":1318,"value":"bar","raw":"'bar'"},{"type":"Literal","start":1320,"end":1325,"value":"boo","raw":"'boo'"}]}},{"type":"ExpressionStatement","start":1331,"end":1384,"expression":{"type":"CallExpression","start":1331,"end":1384,"callee":{"type":"MemberExpression","start":1331,"end":1381,"object":{"type":"CallExpression","start":1331,"end":1373,"callee":{"type":"Identifier","start":1331,"end":1337,"name":"expect"},"arguments":[{"type":"MemberExpression","start":1338,"end":1372,"object":{"type":"MemberExpression","start":1338,"end":1365,"object":{"type":"MemberExpression","start":1338,"end":1359,"object":{"type":"Identifier","start":1338,"end":1354,"name":"webSocketSendSpy"},"property":{"type":"Identifier","start":1355,"end":1359,"name":"mock"},"computed":false},"property":{"type":"Identifier","start":1360,"end":1365,"name":"calls"},"computed":false},"property":{"type":"Identifier","start":1366,"end":1372,"name":"length"},"computed":false}]},"property":{"type":"Identifier","start":1374,"end":1381,"name":"toEqual"},"computed":false},"arguments":[{"type":"Literal","start":1382,"end":1383,"value":1,"raw":"1"}]}},{"type":"ExpressionStatement","start":1389,"end":1500,"expression":{"type":"CallExpression","start":1389,"end":1500,"callee":{"type":"MemberExpression","start":1389,"end":1435,"object":{"type":"CallExpression","start":1389,"end":1427,"callee":{"type":"Identifier","start":1389,"end":1395,"name":"expect"},"arguments":[{"type":"MemberExpression","start":1396,"end":1426,"object":{"type":"MemberExpression","start":1396,"end":1423,"object":{"type":"MemberExpression","start":1396,"end":1417,"object":{"type":"Identifier","start":1396,"end":1412,"name":"webSocketSendSpy"},"property":{"type":"Identifier","start":1413,"end":1417,"name":"mock"},"computed":false},"property":{"type":"Identifier","start":1418,"end":1423,"name":"calls"},"computed":false},"property":{"type":"Literal","start":1424,"end":1425,"value":0,"raw":"0"},"computed":true}]},"property":{"type":"Identifier","start":1428,"end":1435,"name":"toEqual"},"computed":false},"arguments":[{"type":"ArrayExpression","start":1436,"end":1499,"elements":[{"type":"CallExpression","start":1444,"end":1493,"callee":{"type":"MemberExpression","start":1444,"end":1458,"object":{"type":"Identifier","start":1444,"end":1448,"name":"JSON"},"property":{"type":"Identifier","start":1449,"end":1458,"name":"stringify"},"computed":false},"arguments":[{"type":"ObjectExpression","start":1459,"end":1492,"properties":[{"type":"Property","start":1461,"end":1474,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1461,"end":1467,"name":"action"},"value":{"type":"Literal","start":1469,"end":1474,"value":"bar","raw":"'bar'"},"kind":"init"},{"type":"Property","start":1476,"end":1490,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1476,"end":1483,"name":"payload"},"value":{"type":"Literal","start":1485,"end":1490,"value":"boo","raw":"'boo'"},"kind":"init"}]}]}]}]}}]}}]}},{"type":"ExpressionStatement","start":1509,"end":1826,"expression":{"type":"CallExpression","start":1509,"end":1826,"callee":{"type":"Identifier","start":1509,"end":1511,"name":"it"},"arguments":[{"type":"Literal","start":1512,"end":1586,"value":"should queue the message for the websocket if the connection is not open","raw":"'should queue the message for the websocket if the connection is not open'"},{"type":"ArrowFunctionExpression","start":1588,"end":1825,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":1594,"end":1825,"body":[{"type":"VariableDeclaration","start":1600,"end":1652,"declarations":[{"type":"VariableDeclarator","start":1606,"end":1652,"id":{"type":"Identifier","start":1606,"end":1616,"name":"uppySocket"},"init":{"type":"NewExpression","start":1619,"end":1652,"callee":{"type":"Identifier","start":1623,"end":1633,"name":"UppySocket"},"arguments":[{"type":"ObjectExpression","start":1634,"end":1651,"properties":[{"type":"Property","start":1636,"end":1649,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1636,"end":1642,"name":"target"},"value":{"type":"Literal","start":1644,"end":1649,"value":"foo","raw":"'foo'"},"kind":"init"}]}]}}],"kind":"const"},{"type":"ExpressionStatement","start":1658,"end":1687,"expression":{"type":"CallExpression","start":1658,"end":1687,"callee":{"type":"MemberExpression","start":1658,"end":1673,"object":{"type":"Identifier","start":1658,"end":1668,"name":"uppySocket"},"property":{"type":"Identifier","start":1669,"end":1673,"name":"send"},"computed":false},"arguments":[{"type":"Literal","start":1674,"end":1679,"value":"bar","raw":"'bar'"},{"type":"Literal","start":1681,"end":1686,"value":"boo","raw":"'boo'"}]}},{"type":"ExpressionStatement","start":1692,"end":1763,"expression":{"type":"CallExpression","start":1692,"end":1763,"callee":{"type":"MemberExpression","start":1692,"end":1726,"object":{"type":"CallExpression","start":1692,"end":1718,"callee":{"type":"Identifier","start":1692,"end":1698,"name":"expect"},"arguments":[{"type":"MemberExpression","start":1699,"end":1717,"object":{"type":"Identifier","start":1699,"end":1709,"name":"uppySocket"},"property":{"type":"Identifier","start":1710,"end":1717,"name":"_queued"},"computed":false}]},"property":{"type":"Identifier","start":1719,"end":1726,"name":"toEqual"},"computed":false},"arguments":[{"type":"ArrayExpression","start":1727,"end":1762,"elements":[{"type":"ObjectExpression","start":1728,"end":1761,"properties":[{"type":"Property","start":1730,"end":1743,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1730,"end":1736,"name":"action"},"value":{"type":"Literal","start":1738,"end":1743,"value":"bar","raw":"'bar'"},"kind":"init"},{"type":"Property","start":1745,"end":1759,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1745,"end":1752,"name":"payload"},"value":{"type":"Literal","start":1754,"end":1759,"value":"boo","raw":"'boo'"},"kind":"init"}]}]}]}},{"type":"ExpressionStatement","start":1768,"end":1821,"expression":{"type":"CallExpression","start":1768,"end":1821,"callee":{"type":"MemberExpression","start":1768,"end":1818,"object":{"type":"CallExpression","start":1768,"end":1810,"callee":{"type":"Identifier","start":1768,"end":1774,"name":"expect"},"arguments":[{"type":"MemberExpression","start":1775,"end":1809,"object":{"type":"MemberExpression","start":1775,"end":1802,"object":{"type":"MemberExpression","start":1775,"end":1796,"object":{"type":"Identifier","start":1775,"end":1791,"name":"webSocketSendSpy"},"property":{"type":"Identifier","start":1792,"end":1796,"name":"mock"},"computed":false},"property":{"type":"Identifier","start":1797,"end":1802,"name":"calls"},"computed":false},"property":{"type":"Identifier","start":1803,"end":1809,"name":"length"},"computed":false}]},"property":{"type":"Identifier","start":1811,"end":1818,"name":"toEqual"},"computed":false},"arguments":[{"type":"Literal","start":1819,"end":1820,"value":0,"raw":"0"}]}}]}}]}},{"type":"ExpressionStatement","start":1830,"end":2698,"expression":{"type":"CallExpression","start":1830,"end":2698,"callee":{"type":"Identifier","start":1830,"end":1832,"name":"it"},"arguments":[{"type":"Literal","start":1833,"end":1952,"value":"should queue any messages for the websocket if the connection is not open, then send them when the connection is open","raw":"'should queue any messages for the websocket if the connection is not open, then send them when the connection is open'"},{"type":"ArrowFunctionExpression","start":1954,"end":2697,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":1960,"end":2697,"body":[{"type":"VariableDeclaration","start":1966,"end":2018,"declarations":[{"type":"VariableDeclarator","start":1972,"end":2018,"id":{"type":"Identifier","start":1972,"end":1982,"name":"uppySocket"},"init":{"type":"NewExpression","start":1985,"end":2018,"callee":{"type":"Identifier","start":1989,"end":1999,"name":"UppySocket"},"arguments":[{"type":"ObjectExpression","start":2000,"end":2017,"properties":[{"type":"Property","start":2002,"end":2015,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2002,"end":2008,"name":"target"},"value":{"type":"Literal","start":2010,"end":2015,"value":"foo","raw":"'foo'"},"kind":"init"}]}]}}],"kind":"const"},{"type":"VariableDeclaration","start":2023,"end":2066,"declarations":[{"type":"VariableDeclarator","start":2029,"end":2066,"id":{"type":"Identifier","start":2029,"end":2046,"name":"webSocketInstance"},"init":{"type":"MemberExpression","start":2049,"end":2066,"object":{"type":"Identifier","start":2049,"end":2059,"name":"uppySocket"},"property":{"type":"Identifier","start":2060,"end":2066,"name":"socket"},"computed":false}}],"kind":"const"},{"type":"ExpressionStatement","start":2072,"end":2101,"expression":{"type":"CallExpression","start":2072,"end":2101,"callee":{"type":"MemberExpression","start":2072,"end":2087,"object":{"type":"Identifier","start":2072,"end":2082,"name":"uppySocket"},"property":{"type":"Identifier","start":2083,"end":2087,"name":"send"},"computed":false},"arguments":[{"type":"Literal","start":2088,"end":2093,"value":"bar","raw":"'bar'"},{"type":"Literal","start":2095,"end":2100,"value":"boo","raw":"'boo'"}]}},{"type":"ExpressionStatement","start":2106,"end":2135,"expression":{"type":"CallExpression","start":2106,"end":2135,"callee":{"type":"MemberExpression","start":2106,"end":2121,"object":{"type":"Identifier","start":2106,"end":2116,"name":"uppySocket"},"property":{"type":"Identifier","start":2117,"end":2121,"name":"send"},"computed":false},"arguments":[{"type":"Literal","start":2122,"end":2127,"value":"moo","raw":"'moo'"},{"type":"Literal","start":2129,"end":2134,"value":"baa","raw":"'baa'"}]}},{"type":"ExpressionStatement","start":2140,"end":2264,"expression":{"type":"CallExpression","start":2140,"end":2264,"callee":{"type":"MemberExpression","start":2140,"end":2174,"object":{"type":"CallExpression","start":2140,"end":2166,"callee":{"type":"Identifier","start":2140,"end":2146,"name":"expect"},"arguments":[{"type":"MemberExpression","start":2147,"end":2165,"object":{"type":"Identifier","start":2147,"end":2157,"name":"uppySocket"},"property":{"type":"Identifier","start":2158,"end":2165,"name":"_queued"},"computed":false}]},"property":{"type":"Identifier","start":2167,"end":2174,"name":"toEqual"},"computed":false},"arguments":[{"type":"ArrayExpression","start":2175,"end":2263,"elements":[{"type":"ObjectExpression","start":2183,"end":2216,"properties":[{"type":"Property","start":2185,"end":2198,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2185,"end":2191,"name":"action"},"value":{"type":"Literal","start":2193,"end":2198,"value":"bar","raw":"'bar'"},"kind":"init"},{"type":"Property","start":2200,"end":2214,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2200,"end":2207,"name":"payload"},"value":{"type":"Literal","start":2209,"end":2214,"value":"boo","raw":"'boo'"},"kind":"init"}]},{"type":"ObjectExpression","start":2224,"end":2257,"properties":[{"type":"Property","start":2226,"end":2239,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2226,"end":2232,"name":"action"},"value":{"type":"Literal","start":2234,"end":2239,"value":"moo","raw":"'moo'"},"kind":"init"},{"type":"Property","start":2241,"end":2255,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2241,"end":2248,"name":"payload"},"value":{"type":"Literal","start":2250,"end":2255,"value":"baa","raw":"'baa'"},"kind":"init"}]}]}]}},{"type":"ExpressionStatement","start":2269,"end":2322,"expression":{"type":"CallExpression","start":2269,"end":2322,"callee":{"type":"MemberExpression","start":2269,"end":2319,"object":{"type":"CallExpression","start":2269,"end":2311,"callee":{"type":"Identifier","start":2269,"end":2275,"name":"expect"},"arguments":[{"type":"MemberExpression","start":2276,"end":2310,"object":{"type":"MemberExpression","start":2276,"end":2303,"object":{"type":"MemberExpression","start":2276,"end":2297,"object":{"type":"Identifier","start":2276,"end":2292,"name":"webSocketSendSpy"},"property":{"type":"Identifier","start":2293,"end":2297,"name":"mock"},"computed":false},"property":{"type":"Identifier","start":2298,"end":2303,"name":"calls"},"computed":false},"property":{"type":"Identifier","start":2304,"end":2310,"name":"length"},"computed":false}]},"property":{"type":"Identifier","start":2312,"end":2319,"name":"toEqual"},"computed":false},"arguments":[{"type":"Literal","start":2320,"end":2321,"value":0,"raw":"0"}]}},{"type":"ExpressionStatement","start":2328,"end":2359,"expression":{"type":"CallExpression","start":2328,"end":2359,"callee":{"type":"MemberExpression","start":2328,"end":2357,"object":{"type":"Identifier","start":2328,"end":2345,"name":"webSocketInstance"},"property":{"type":"Identifier","start":2346,"end":2357,"name":"triggerOpen"},"computed":false},"arguments":[]}},{"type":"ExpressionStatement","start":2365,"end":2403,"expression":{"type":"CallExpression","start":2365,"end":2403,"callee":{"type":"MemberExpression","start":2365,"end":2399,"object":{"type":"CallExpression","start":2365,"end":2391,"callee":{"type":"Identifier","start":2365,"end":2371,"name":"expect"},"arguments":[{"type":"MemberExpression","start":2372,"end":2390,"object":{"type":"Identifier","start":2372,"end":2382,"name":"uppySocket"},"property":{"type":"Identifier","start":2383,"end":2390,"name":"_queued"},"computed":false}]},"property":{"type":"Identifier","start":2392,"end":2399,"name":"toEqual"},"computed":false},"arguments":[{"type":"ArrayExpression","start":2400,"end":2402,"elements":[]}]}},{"type":"ExpressionStatement","start":2408,"end":2461,"expression":{"type":"CallExpression","start":2408,"end":2461,"callee":{"type":"MemberExpression","start":2408,"end":2458,"object":{"type":"CallExpression","start":2408,"end":2450,"callee":{"type":"Identifier","start":2408,"end":2414,"name":"expect"},"arguments":[{"type":"MemberExpression","start":2415,"end":2449,"object":{"type":"MemberExpression","start":2415,"end":2442,"object":{"type":"MemberExpression","start":2415,"end":2436,"object":{"type":"Identifier","start":2415,"end":2431,"name":"webSocketSendSpy"},"property":{"type":"Identifier","start":2432,"end":2436,"name":"mock"},"computed":false},"property":{"type":"Identifier","start":2437,"end":2442,"name":"calls"},"computed":false},"property":{"type":"Identifier","start":2443,"end":2449,"name":"length"},"computed":false}]},"property":{"type":"Identifier","start":2451,"end":2458,"name":"toEqual"},"computed":false},"arguments":[{"type":"Literal","start":2459,"end":2460,"value":2,"raw":"2"}]}},{"type":"ExpressionStatement","start":2466,"end":2577,"expression":{"type":"CallExpression","start":2466,"end":2577,"callee":{"type":"MemberExpression","start":2466,"end":2512,"object":{"type":"CallExpression","start":2466,"end":2504,"callee":{"type":"Identifier","start":2466,"end":2472,"name":"expect"},"arguments":[{"type":"MemberExpression","start":2473,"end":2503,"object":{"type":"MemberExpression","start":2473,"end":2500,"object":{"type":"MemberExpression","start":2473,"end":2494,"object":{"type":"Identifier","start":2473,"end":2489,"name":"webSocketSendSpy"},"property":{"type":"Identifier","start":2490,"end":2494,"name":"mock"},"computed":false},"property":{"type":"Identifier","start":2495,"end":2500,"name":"calls"},"computed":false},"property":{"type":"Literal","start":2501,"end":2502,"value":0,"raw":"0"},"computed":true}]},"property":{"type":"Identifier","start":2505,"end":2512,"name":"toEqual"},"computed":false},"arguments":[{"type":"ArrayExpression","start":2513,"end":2576,"elements":[{"type":"CallExpression","start":2521,"end":2570,"callee":{"type":"MemberExpression","start":2521,"end":2535,"object":{"type":"Identifier","start":2521,"end":2525,"name":"JSON"},"property":{"type":"Identifier","start":2526,"end":2535,"name":"stringify"},"computed":false},"arguments":[{"type":"ObjectExpression","start":2536,"end":2569,"properties":[{"type":"Property","start":2538,"end":2551,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2538,"end":2544,"name":"action"},"value":{"type":"Literal","start":2546,"end":2551,"value":"bar","raw":"'bar'"},"kind":"init"},{"type":"Property","start":2553,"end":2567,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2553,"end":2560,"name":"payload"},"value":{"type":"Literal","start":2562,"end":2567,"value":"boo","raw":"'boo'"},"kind":"init"}]}]}]}]}},{"type":"ExpressionStatement","start":2582,"end":2693,"expression":{"type":"CallExpression","start":2582,"end":2693,"callee":{"type":"MemberExpression","start":2582,"end":2628,"object":{"type":"CallExpression","start":2582,"end":2620,"callee":{"type":"Identifier","start":2582,"end":2588,"name":"expect"},"arguments":[{"type":"MemberExpression","start":2589,"end":2619,"object":{"type":"MemberExpression","start":2589,"end":2616,"object":{"type":"MemberExpression","start":2589,"end":2610,"object":{"type":"Identifier","start":2589,"end":2605,"name":"webSocketSendSpy"},"property":{"type":"Identifier","start":2606,"end":2610,"name":"mock"},"computed":false},"property":{"type":"Identifier","start":2611,"end":2616,"name":"calls"},"computed":false},"property":{"type":"Literal","start":2617,"end":2618,"value":1,"raw":"1"},"computed":true}]},"property":{"type":"Identifier","start":2621,"end":2628,"name":"toEqual"},"computed":false},"arguments":[{"type":"ArrayExpression","start":2629,"end":2692,"elements":[{"type":"CallExpression","start":2637,"end":2686,"callee":{"type":"MemberExpression","start":2637,"end":2651,"object":{"type":"Identifier","start":2637,"end":2641,"name":"JSON"},"property":{"type":"Identifier","start":2642,"end":2651,"name":"stringify"},"computed":false},"arguments":[{"type":"ObjectExpression","start":2652,"end":2685,"properties":[{"type":"Property","start":2654,"end":2667,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2654,"end":2660,"name":"action"},"value":{"type":"Literal","start":2662,"end":2667,"value":"moo","raw":"'moo'"},"kind":"init"},{"type":"Property","start":2669,"end":2683,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2669,"end":2676,"name":"payload"},"value":{"type":"Literal","start":2678,"end":2683,"value":"baa","raw":"'baa'"},"kind":"init"}]}]}]}]}}]}}]}},{"type":"ExpressionStatement","start":2702,"end":3160,"expression":{"type":"CallExpression","start":2702,"end":3160,"callee":{"type":"Identifier","start":2702,"end":2704,"name":"it"},"arguments":[{"type":"Literal","start":2705,"end":2780,"value":"should start queuing any messages when the websocket connection is closed","raw":"'should start queuing any messages when the websocket connection is closed'"},{"type":"ArrowFunctionExpression","start":2782,"end":3159,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":2788,"end":3159,"body":[{"type":"VariableDeclaration","start":2794,"end":2846,"declarations":[{"type":"VariableDeclarator","start":2800,"end":2846,"id":{"type":"Identifier","start":2800,"end":2810,"name":"uppySocket"},"init":{"type":"NewExpression","start":2813,"end":2846,"callee":{"type":"Identifier","start":2817,"end":2827,"name":"UppySocket"},"arguments":[{"type":"ObjectExpression","start":2828,"end":2845,"properties":[{"type":"Property","start":2830,"end":2843,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2830,"end":2836,"name":"target"},"value":{"type":"Literal","start":2838,"end":2843,"value":"foo","raw":"'foo'"},"kind":"init"}]}]}}],"kind":"const"},{"type":"VariableDeclaration","start":2851,"end":2894,"declarations":[{"type":"VariableDeclarator","start":2857,"end":2894,"id":{"type":"Identifier","start":2857,"end":2874,"name":"webSocketInstance"},"init":{"type":"MemberExpression","start":2877,"end":2894,"object":{"type":"Identifier","start":2877,"end":2887,"name":"uppySocket"},"property":{"type":"Identifier","start":2888,"end":2894,"name":"socket"},"computed":false}}],"kind":"const"},{"type":"ExpressionStatement","start":2899,"end":2930,"expression":{"type":"CallExpression","start":2899,"end":2930,"callee":{"type":"MemberExpression","start":2899,"end":2928,"object":{"type":"Identifier","start":2899,"end":2916,"name":"webSocketInstance"},"property":{"type":"Identifier","start":2917,"end":2928,"name":"triggerOpen"},"computed":false},"arguments":[]}},{"type":"ExpressionStatement","start":2935,"end":2964,"expression":{"type":"CallExpression","start":2935,"end":2964,"callee":{"type":"MemberExpression","start":2935,"end":2950,"object":{"type":"Identifier","start":2935,"end":2945,"name":"uppySocket"},"property":{"type":"Identifier","start":2946,"end":2950,"name":"send"},"computed":false},"arguments":[{"type":"Literal","start":2951,"end":2956,"value":"bar","raw":"'bar'"},{"type":"Literal","start":2958,"end":2963,"value":"boo","raw":"'boo'"}]}},{"type":"ExpressionStatement","start":2969,"end":3007,"expression":{"type":"CallExpression","start":2969,"end":3007,"callee":{"type":"MemberExpression","start":2969,"end":3003,"object":{"type":"CallExpression","start":2969,"end":2995,"callee":{"type":"Identifier","start":2969,"end":2975,"name":"expect"},"arguments":[{"type":"MemberExpression","start":2976,"end":2994,"object":{"type":"Identifier","start":2976,"end":2986,"name":"uppySocket"},"property":{"type":"Identifier","start":2987,"end":2994,"name":"_queued"},"computed":false}]},"property":{"type":"Identifier","start":2996,"end":3003,"name":"toEqual"},"computed":false},"arguments":[{"type":"ArrayExpression","start":3004,"end":3006,"elements":[]}]}},{"type":"ExpressionStatement","start":3013,"end":3045,"expression":{"type":"CallExpression","start":3013,"end":3045,"callee":{"type":"MemberExpression","start":3013,"end":3043,"object":{"type":"Identifier","start":3013,"end":3030,"name":"webSocketInstance"},"property":{"type":"Identifier","start":3031,"end":3043,"name":"triggerClose"},"computed":false},"arguments":[]}},{"type":"ExpressionStatement","start":3050,"end":3079,"expression":{"type":"CallExpression","start":3050,"end":3079,"callee":{"type":"MemberExpression","start":3050,"end":3065,"object":{"type":"Identifier","start":3050,"end":3060,"name":"uppySocket"},"property":{"type":"Identifier","start":3061,"end":3065,"name":"send"},"computed":false},"arguments":[{"type":"Literal","start":3066,"end":3071,"value":"bar","raw":"'bar'"},{"type":"Literal","start":3073,"end":3078,"value":"boo","raw":"'boo'"}]}},{"type":"ExpressionStatement","start":3084,"end":3155,"expression":{"type":"CallExpression","start":3084,"end":3155,"callee":{"type":"MemberExpression","start":3084,"end":3118,"object":{"type":"CallExpression","start":3084,"end":3110,"callee":{"type":"Identifier","start":3084,"end":3090,"name":"expect"},"arguments":[{"type":"MemberExpression","start":3091,"end":3109,"object":{"type":"Identifier","start":3091,"end":3101,"name":"uppySocket"},"property":{"type":"Identifier","start":3102,"end":3109,"name":"_queued"},"computed":false}]},"property":{"type":"Identifier","start":3111,"end":3118,"name":"toEqual"},"computed":false},"arguments":[{"type":"ArrayExpression","start":3119,"end":3154,"elements":[{"type":"ObjectExpression","start":3120,"end":3153,"properties":[{"type":"Property","start":3122,"end":3135,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3122,"end":3128,"name":"action"},"value":{"type":"Literal","start":3130,"end":3135,"value":"bar","raw":"'bar'"},"kind":"init"},{"type":"Property","start":3137,"end":3151,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3137,"end":3144,"name":"payload"},"value":{"type":"Literal","start":3146,"end":3151,"value":"boo","raw":"'boo'"},"kind":"init"}]}]}]}}]}}]}},{"type":"ExpressionStatement","start":3164,"end":3457,"expression":{"type":"CallExpression","start":3164,"end":3457,"callee":{"type":"Identifier","start":3164,"end":3166,"name":"it"},"arguments":[{"type":"Literal","start":3167,"end":3219,"value":"should close the websocket when it is force closed","raw":"'should close the websocket when it is force closed'"},{"type":"ArrowFunctionExpression","start":3221,"end":3456,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":3227,"end":3456,"body":[{"type":"VariableDeclaration","start":3233,"end":3285,"declarations":[{"type":"VariableDeclarator","start":3239,"end":3285,"id":{"type":"Identifier","start":3239,"end":3249,"name":"uppySocket"},"init":{"type":"NewExpression","start":3252,"end":3285,"callee":{"type":"Identifier","start":3256,"end":3266,"name":"UppySocket"},"arguments":[{"type":"ObjectExpression","start":3267,"end":3284,"properties":[{"type":"Property","start":3269,"end":3282,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3269,"end":3275,"name":"target"},"value":{"type":"Literal","start":3277,"end":3282,"value":"foo","raw":"'foo'"},"kind":"init"}]}]}}],"kind":"const"},{"type":"VariableDeclaration","start":3290,"end":3333,"declarations":[{"type":"VariableDeclarator","start":3296,"end":3333,"id":{"type":"Identifier","start":3296,"end":3313,"name":"webSocketInstance"},"init":{"type":"MemberExpression","start":3316,"end":3333,"object":{"type":"Identifier","start":3316,"end":3326,"name":"uppySocket"},"property":{"type":"Identifier","start":3327,"end":3333,"name":"socket"},"computed":false}}],"kind":"const"},{"type":"ExpressionStatement","start":3338,"end":3369,"expression":{"type":"CallExpression","start":3338,"end":3369,"callee":{"type":"MemberExpression","start":3338,"end":3367,"object":{"type":"Identifier","start":3338,"end":3355,"name":"webSocketInstance"},"property":{"type":"Identifier","start":3356,"end":3367,"name":"triggerOpen"},"computed":false},"arguments":[]}},{"type":"ExpressionStatement","start":3375,"end":3393,"expression":{"type":"CallExpression","start":3375,"end":3393,"callee":{"type":"MemberExpression","start":3375,"end":3391,"object":{"type":"Identifier","start":3375,"end":3385,"name":"uppySocket"},"property":{"type":"Identifier","start":3386,"end":3391,"name":"close"},"computed":false},"arguments":[]}},{"type":"ExpressionStatement","start":3398,"end":3452,"expression":{"type":"CallExpression","start":3398,"end":3452,"callee":{"type":"MemberExpression","start":3398,"end":3449,"object":{"type":"CallExpression","start":3398,"end":3441,"callee":{"type":"Identifier","start":3398,"end":3404,"name":"expect"},"arguments":[{"type":"MemberExpression","start":3405,"end":3440,"object":{"type":"MemberExpression","start":3405,"end":3433,"object":{"type":"MemberExpression","start":3405,"end":3427,"object":{"type":"Identifier","start":3405,"end":3422,"name":"webSocketCloseSpy"},"property":{"type":"Identifier","start":3423,"end":3427,"name":"mock"},"computed":false},"property":{"type":"Identifier","start":3428,"end":3433,"name":"calls"},"computed":false},"property":{"type":"Identifier","start":3434,"end":3440,"name":"length"},"computed":false}]},"property":{"type":"Identifier","start":3442,"end":3449,"name":"toEqual"},"computed":false},"arguments":[{"type":"Literal","start":3450,"end":3451,"value":1,"raw":"1"}]}}]}}]}},{"type":"ExpressionStatement","start":3461,"end":4004,"expression":{"type":"CallExpression","start":3461,"end":4004,"callee":{"type":"Identifier","start":3461,"end":3463,"name":"it"},"arguments":[{"type":"Literal","start":3464,"end":3531,"value":"should be able to subscribe to messages received on the websocket","raw":"'should be able to subscribe to messages received on the websocket'"},{"type":"ArrowFunctionExpression","start":3533,"end":4003,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":3539,"end":4003,"body":[{"type":"VariableDeclaration","start":3545,"end":3597,"declarations":[{"type":"VariableDeclarator","start":3551,"end":3597,"id":{"type":"Identifier","start":3551,"end":3561,"name":"uppySocket"},"init":{"type":"NewExpression","start":3564,"end":3597,"callee":{"type":"Identifier","start":3568,"end":3578,"name":"UppySocket"},"arguments":[{"type":"ObjectExpression","start":3579,"end":3596,"properties":[{"type":"Property","start":3581,"end":3594,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3581,"end":3587,"name":"target"},"value":{"type":"Literal","start":3589,"end":3594,"value":"foo","raw":"'foo'"},"kind":"init"}]}]}}],"kind":"const"},{"type":"VariableDeclaration","start":3602,"end":3645,"declarations":[{"type":"VariableDeclarator","start":3608,"end":3645,"id":{"type":"Identifier","start":3608,"end":3625,"name":"webSocketInstance"},"init":{"type":"MemberExpression","start":3628,"end":3645,"object":{"type":"Identifier","start":3628,"end":3638,"name":"uppySocket"},"property":{"type":"Identifier","start":3639,"end":3645,"name":"socket"},"computed":false}}],"kind":"const"},{"type":"VariableDeclaration","start":3651,"end":3688,"declarations":[{"type":"VariableDeclarator","start":3657,"end":3688,"id":{"type":"Identifier","start":3657,"end":3676,"name":"emitterListenerMock"},"init":{"type":"CallExpression","start":3679,"end":3688,"callee":{"type":"MemberExpression","start":3679,"end":3686,"object":{"type":"Identifier","start":3679,"end":3683,"name":"jest"},"property":{"type":"Identifier","start":3684,"end":3686,"name":"fn"},"computed":false},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","start":3693,"end":3733,"expression":{"type":"CallExpression","start":3693,"end":3733,"callee":{"type":"MemberExpression","start":3693,"end":3706,"object":{"type":"Identifier","start":3693,"end":3703,"name":"uppySocket"},"property":{"type":"Identifier","start":3704,"end":3706,"name":"on"},"computed":false},"arguments":[{"type":"Literal","start":3707,"end":3711,"value":"hi","raw":"'hi'"},{"type":"Identifier","start":3713,"end":3732,"name":"emitterListenerMock"}]}},{"type":"ExpressionStatement","start":3739,"end":3770,"expression":{"type":"CallExpression","start":3739,"end":3770,"callee":{"type":"MemberExpression","start":3739,"end":3768,"object":{"type":"Identifier","start":3739,"end":3756,"name":"webSocketInstance"},"property":{"type":"Identifier","start":3757,"end":3768,"name":"triggerOpen"},"computed":false},"arguments":[]}},{"type":"ExpressionStatement","start":3775,"end":3871,"expression":{"type":"CallExpression","start":3775,"end":3871,"callee":{"type":"MemberExpression","start":3775,"end":3802,"object":{"type":"Identifier","start":3775,"end":3792,"name":"webSocketInstance"},"property":{"type":"Identifier","start":3793,"end":3802,"name":"onmessage"},"computed":false},"arguments":[{"type":"ObjectExpression","start":3803,"end":3870,"properties":[{"type":"Property","start":3811,"end":3864,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3811,"end":3815,"name":"data"},"value":{"type":"CallExpression","start":3817,"end":3864,"callee":{"type":"MemberExpression","start":3817,"end":3831,"object":{"type":"Identifier","start":3817,"end":3821,"name":"JSON"},"property":{"type":"Identifier","start":3822,"end":3831,"name":"stringify"},"computed":false},"arguments":[{"type":"ObjectExpression","start":3832,"end":3863,"properties":[{"type":"Property","start":3834,"end":3846,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3834,"end":3840,"name":"action"},"value":{"type":"Literal","start":3842,"end":3846,"value":"hi","raw":"'hi'"},"kind":"init"},{"type":"Property","start":3848,"end":3861,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3848,"end":3855,"name":"payload"},"value":{"type":"Literal","start":3857,"end":3861,"value":"ho","raw":"'ho'"},"kind":"init"}]}]},"kind":"init"}]}]}},{"type":"ExpressionStatement","start":3876,"end":3999,"expression":{"type":"CallExpression","start":3876,"end":3999,"callee":{"type":"MemberExpression","start":3876,"end":3922,"object":{"type":"CallExpression","start":3876,"end":3914,"callee":{"type":"Identifier","start":3876,"end":3882,"name":"expect"},"arguments":[{"type":"MemberExpression","start":3883,"end":3913,"object":{"type":"MemberExpression","start":3883,"end":3907,"object":{"type":"Identifier","start":3883,"end":3902,"name":"emitterListenerMock"},"property":{"type":"Identifier","start":3903,"end":3907,"name":"mock"},"computed":false},"property":{"type":"Identifier","start":3908,"end":3913,"name":"calls"},"computed":false}]},"property":{"type":"Identifier","start":3915,"end":3922,"name":"toEqual"},"computed":false},"arguments":[{"type":"ArrayExpression","start":3923,"end":3998,"elements":[{"type":"ArrayExpression","start":3931,"end":3992,"elements":[{"type":"Literal","start":3932,"end":3936,"value":"ho","raw":"'ho'"},{"type":"Identifier","start":3938,"end":3947,"name":"undefined"},{"type":"Identifier","start":3949,"end":3958,"name":"undefined"},{"type":"Identifier","start":3960,"end":3969,"name":"undefined"},{"type":"Identifier","start":3971,"end":3980,"name":"undefined"},{"type":"Identifier","start":3982,"end":3991,"name":"undefined"}]}]}]}}]}}]}},{"type":"ExpressionStatement","start":4008,"end":4675,"expression":{"type":"CallExpression","start":4008,"end":4675,"callee":{"type":"Identifier","start":4008,"end":4010,"name":"it"},"arguments":[{"type":"Literal","start":4011,"end":4066,"value":"should be able to emit messages and subscribe to them","raw":"'should be able to emit messages and subscribe to them'"},{"type":"ArrowFunctionExpression","start":4068,"end":4674,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":4074,"end":4674,"body":[{"type":"VariableDeclaration","start":4080,"end":4132,"declarations":[{"type":"VariableDeclarator","start":4086,"end":4132,"id":{"type":"Identifier","start":4086,"end":4096,"name":"uppySocket"},"init":{"type":"NewExpression","start":4099,"end":4132,"callee":{"type":"Identifier","start":4103,"end":4113,"name":"UppySocket"},"arguments":[{"type":"ObjectExpression","start":4114,"end":4131,"properties":[{"type":"Property","start":4116,"end":4129,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4116,"end":4122,"name":"target"},"value":{"type":"Literal","start":4124,"end":4129,"value":"foo","raw":"'foo'"},"kind":"init"}]}]}}],"kind":"const"},{"type":"VariableDeclaration","start":4138,"end":4175,"declarations":[{"type":"VariableDeclarator","start":4144,"end":4175,"id":{"type":"Identifier","start":4144,"end":4163,"name":"emitterListenerMock"},"init":{"type":"CallExpression","start":4166,"end":4175,"callee":{"type":"MemberExpression","start":4166,"end":4173,"object":{"type":"Identifier","start":4166,"end":4170,"name":"jest"},"property":{"type":"Identifier","start":4171,"end":4173,"name":"fn"},"computed":false},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","start":4180,"end":4220,"expression":{"type":"CallExpression","start":4180,"end":4220,"callee":{"type":"MemberExpression","start":4180,"end":4193,"object":{"type":"Identifier","start":4180,"end":4190,"name":"uppySocket"},"property":{"type":"Identifier","start":4191,"end":4193,"name":"on"},"computed":false},"arguments":[{"type":"Literal","start":4194,"end":4198,"value":"hi","raw":"'hi'"},{"type":"Identifier","start":4200,"end":4219,"name":"emitterListenerMock"}]}},{"type":"ExpressionStatement","start":4226,"end":4253,"expression":{"type":"CallExpression","start":4226,"end":4253,"callee":{"type":"MemberExpression","start":4226,"end":4241,"object":{"type":"Identifier","start":4226,"end":4236,"name":"uppySocket"},"property":{"type":"Identifier","start":4237,"end":4241,"name":"emit"},"computed":false},"arguments":[{"type":"Literal","start":4242,"end":4246,"value":"hi","raw":"'hi'"},{"type":"Literal","start":4248,"end":4252,"value":"ho","raw":"'ho'"}]}},{"type":"ExpressionStatement","start":4258,"end":4285,"expression":{"type":"CallExpression","start":4258,"end":4285,"callee":{"type":"MemberExpression","start":4258,"end":4273,"object":{"type":"Identifier","start":4258,"end":4268,"name":"uppySocket"},"property":{"type":"Identifier","start":4269,"end":4273,"name":"emit"},"computed":false},"arguments":[{"type":"Literal","start":4274,"end":4278,"value":"hi","raw":"'hi'"},{"type":"Literal","start":4280,"end":4284,"value":"ho","raw":"'ho'"}]}},{"type":"ExpressionStatement","start":4290,"end":4332,"expression":{"type":"CallExpression","start":4290,"end":4332,"callee":{"type":"MemberExpression","start":4290,"end":4305,"object":{"type":"Identifier","start":4290,"end":4300,"name":"uppySocket"},"property":{"type":"Identifier","start":4301,"end":4305,"name":"emit"},"computed":false},"arguments":[{"type":"Literal","start":4306,"end":4310,"value":"hi","raw":"'hi'"},{"type":"Literal","start":4312,"end":4331,"value":"off to work we go","raw":"'off to work we go'"}]}},{"type":"ExpressionStatement","start":4338,"end":4670,"expression":{"type":"CallExpression","start":4338,"end":4670,"callee":{"type":"MemberExpression","start":4338,"end":4384,"object":{"type":"CallExpression","start":4338,"end":4376,"callee":{"type":"Identifier","start":4338,"end":4344,"name":"expect"},"arguments":[{"type":"MemberExpression","start":4345,"end":4375,"object":{"type":"MemberExpression","start":4345,"end":4369,"object":{"type":"Identifier","start":4345,"end":4364,"name":"emitterListenerMock"},"property":{"type":"Identifier","start":4365,"end":4369,"name":"mock"},"computed":false},"property":{"type":"Identifier","start":4370,"end":4375,"name":"calls"},"computed":false}]},"property":{"type":"Identifier","start":4377,"end":4384,"name":"toEqual"},"computed":false},"arguments":[{"type":"ArrayExpression","start":4385,"end":4669,"elements":[{"type":"ArrayExpression","start":4393,"end":4454,"elements":[{"type":"Literal","start":4394,"end":4398,"value":"ho","raw":"'ho'"},{"type":"Identifier","start":4400,"end":4409,"name":"undefined"},{"type":"Identifier","start":4411,"end":4420,"name":"undefined"},{"type":"Identifier","start":4422,"end":4431,"name":"undefined"},{"type":"Identifier","start":4433,"end":4442,"name":"undefined"},{"type":"Identifier","start":4444,"end":4453,"name":"undefined"}]},{"type":"ArrayExpression","start":4462,"end":4523,"elements":[{"type":"Literal","start":4463,"end":4467,"value":"ho","raw":"'ho'"},{"type":"Identifier","start":4469,"end":4478,"name":"undefined"},{"type":"Identifier","start":4480,"end":4489,"name":"undefined"},{"type":"Identifier","start":4491,"end":4500,"name":"undefined"},{"type":"Identifier","start":4502,"end":4511,"name":"undefined"},{"type":"Identifier","start":4513,"end":4522,"name":"undefined"}]},{"type":"ArrayExpression","start":4531,"end":4663,"elements":[{"type":"Literal","start":4541,"end":4560,"value":"off to work we go","raw":"'off to work we go'"},{"type":"Identifier","start":4570,"end":4579,"name":"undefined"},{"type":"Identifier","start":4589,"end":4598,"name":"undefined"},{"type":"Identifier","start":4608,"end":4617,"name":"undefined"},{"type":"Identifier","start":4627,"end":4636,"name":"undefined"},{"type":"Identifier","start":4646,"end":4655,"name":"undefined"}]}]}]}}]}}]}},{"type":"ExpressionStatement","start":4679,"end":5217,"expression":{"type":"CallExpression","start":4679,"end":5217,"callee":{"type":"Identifier","start":4679,"end":4681,"name":"it"},"arguments":[{"type":"Literal","start":4682,"end":4754,"value":"should be able to subscribe to the first event for a particular action","raw":"'should be able to subscribe to the first event for a particular action'"},{"type":"ArrowFunctionExpression","start":4756,"end":5216,"id":null,"expression":false,"generator":false,"async":false,"params":[],"body":{"type":"BlockStatement","start":4762,"end":5216,"body":[{"type":"VariableDeclaration","start":4768,"end":4820,"declarations":[{"type":"VariableDeclarator","start":4774,"end":4820,"id":{"type":"Identifier","start":4774,"end":4784,"name":"uppySocket"},"init":{"type":"NewExpression","start":4787,"end":4820,"callee":{"type":"Identifier","start":4791,"end":4801,"name":"UppySocket"},"arguments":[{"type":"ObjectExpression","start":4802,"end":4819,"properties":[{"type":"Property","start":4804,"end":4817,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4804,"end":4810,"name":"target"},"value":{"type":"Literal","start":4812,"end":4817,"value":"foo","raw":"'foo'"},"kind":"init"}]}]}}],"kind":"const"},{"type":"VariableDeclaration","start":4826,"end":4863,"declarations":[{"type":"VariableDeclarator","start":4832,"end":4863,"id":{"type":"Identifier","start":4832,"end":4851,"name":"emitterListenerMock"},"init":{"type":"CallExpression","start":4854,"end":4863,"callee":{"type":"MemberExpression","start":4854,"end":4861,"object":{"type":"Identifier","start":4854,"end":4858,"name":"jest"},"property":{"type":"Identifier","start":4859,"end":4861,"name":"fn"},"computed":false},"arguments":[]}}],"kind":"const"},{"type":"ExpressionStatement","start":4868,"end":4910,"expression":{"type":"CallExpression","start":4868,"end":4910,"callee":{"type":"MemberExpression","start":4868,"end":4883,"object":{"type":"Identifier","start":4868,"end":4878,"name":"uppySocket"},"property":{"type":"Identifier","start":4879,"end":4883,"name":"once"},"computed":false},"arguments":[{"type":"Literal","start":4884,"end":4888,"value":"hi","raw":"'hi'"},{"type":"Identifier","start":4890,"end":4909,"name":"emitterListenerMock"}]}},{"type":"ExpressionStatement","start":4916,"end":4943,"expression":{"type":"CallExpression","start":4916,"end":4943,"callee":{"type":"MemberExpression","start":4916,"end":4931,"object":{"type":"Identifier","start":4916,"end":4926,"name":"uppySocket"},"property":{"type":"Identifier","start":4927,"end":4931,"name":"emit"},"computed":false},"arguments":[{"type":"Literal","start":4932,"end":4936,"value":"hi","raw":"'hi'"},{"type":"Literal","start":4938,"end":4942,"value":"ho","raw":"'ho'"}]}},{"type":"ExpressionStatement","start":4948,"end":4975,"expression":{"type":"CallExpression","start":4948,"end":4975,"callee":{"type":"MemberExpression","start":4948,"end":4963,"object":{"type":"Identifier","start":4948,"end":4958,"name":"uppySocket"},"property":{"type":"Identifier","start":4959,"end":4963,"name":"emit"},"computed":false},"arguments":[{"type":"Literal","start":4964,"end":4968,"value":"hi","raw":"'hi'"},{"type":"Literal","start":4970,"end":4974,"value":"ho","raw":"'ho'"}]}},{"type":"ExpressionStatement","start":4980,"end":5022,"expression":{"type":"CallExpression","start":4980,"end":5022,"callee":{"type":"MemberExpression","start":4980,"end":4995,"object":{"type":"Identifier","start":4980,"end":4990,"name":"uppySocket"},"property":{"type":"Identifier","start":4991,"end":4995,"name":"emit"},"computed":false},"arguments":[{"type":"Literal","start":4996,"end":5000,"value":"hi","raw":"'hi'"},{"type":"Literal","start":5002,"end":5021,"value":"off to work we go","raw":"'off to work we go'"}]}},{"type":"ExpressionStatement","start":5028,"end":5084,"expression":{"type":"CallExpression","start":5028,"end":5084,"callee":{"type":"MemberExpression","start":5028,"end":5081,"object":{"type":"CallExpression","start":5028,"end":5073,"callee":{"type":"Identifier","start":5028,"end":5034,"name":"expect"},"arguments":[{"type":"MemberExpression","start":5035,"end":5072,"object":{"type":"MemberExpression","start":5035,"end":5065,"object":{"type":"MemberExpression","start":5035,"end":5059,"object":{"type":"Identifier","start":5035,"end":5054,"name":"emitterListenerMock"},"property":{"type":"Identifier","start":5055,"end":5059,"name":"mock"},"computed":false},"property":{"type":"Identifier","start":5060,"end":5065,"name":"calls"},"computed":false},"property":{"type":"Identifier","start":5066,"end":5072,"name":"length"},"computed":false}]},"property":{"type":"Identifier","start":5074,"end":5081,"name":"toEqual"},"computed":false},"arguments":[{"type":"Literal","start":5082,"end":5083,"value":1,"raw":"1"}]}},{"type":"ExpressionStatement","start":5089,"end":5212,"expression":{"type":"CallExpression","start":5089,"end":5212,"callee":{"type":"MemberExpression","start":5089,"end":5135,"object":{"type":"CallExpression","start":5089,"end":5127,"callee":{"type":"Identifier","start":5089,"end":5095,"name":"expect"},"arguments":[{"type":"MemberExpression","start":5096,"end":5126,"object":{"type":"MemberExpression","start":5096,"end":5120,"object":{"type":"Identifier","start":5096,"end":5115,"name":"emitterListenerMock"},"property":{"type":"Identifier","start":5116,"end":5120,"name":"mock"},"computed":false},"property":{"type":"Identifier","start":5121,"end":5126,"name":"calls"},"computed":false}]},"property":{"type":"Identifier","start":5128,"end":5135,"name":"toEqual"},"computed":false},"arguments":[{"type":"ArrayExpression","start":5136,"end":5211,"elements":[{"type":"ArrayExpression","start":5144,"end":5205,"elements":[{"type":"Literal","start":5145,"end":5149,"value":"ho","raw":"'ho'"},{"type":"Identifier","start":5151,"end":5160,"name":"undefined"},{"type":"Identifier","start":5162,"end":5171,"name":"undefined"},{"type":"Identifier","start":5173,"end":5182,"name":"undefined"},{"type":"Identifier","start":5184,"end":5193,"name":"undefined"},{"type":"Identifier","start":5195,"end":5204,"name":"undefined"}]}]}]}}]}}]}}]}}]}}],"sourceType":"script"}